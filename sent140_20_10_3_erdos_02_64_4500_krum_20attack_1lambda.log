Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
Degree statistics: avg=4.80, min=2, max=7
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5476 ± 0.0630 | min=0.4928 max=0.6475
         : test loss mean=16.8678 ± 15.8547
         : individual accs = ['0.612493', '0.647489', '0.624912', '0.514244', '0.496910', '0.495721', '0.495469', '0.501116', '0.630125', '0.641272', '0.507738', '0.505034', '0.499234', '0.492828', '0.493994', '0.520181', '0.499826', '0.502209', '0.641429', '0.630738']
         : correct/total = [(8717, 14232), (9217, 14235), (8915, 14266), (7311, 14217), (7075, 14238), (7125, 14373), (7108, 14346), (7183, 14334), (9007, 14294), (9217, 14373), (7283, 14344), (7223, 14302), (7166, 14354), (7078, 14362), (7074, 14320), (7488, 14395), (7192, 14389), (7160, 14257), (9141, 14251), (9082, 14399)]
         : compromised: 0.4975, honest: 0.5602
Round 002: test acc mean=0.6171 ± 0.0671 | min=0.4935 max=0.6674
         : test loss mean=2.9970 ± 5.7237
         : individual accs = ['0.648890', '0.667369', '0.639633', '0.662798', '0.651496', '0.496278', '0.652307', '0.506000', '0.658458', '0.659570', '0.661949', '0.648930', '0.657796', '0.493525', '0.507682', '0.645849', '0.655779', '0.503542', '0.657919', '0.665532']
         : correct/total = [(9235, 14232), (9500, 14235), (9125, 14266), (9423, 14217), (9276, 14238), (7133, 14373), (9358, 14346), (7253, 14334), (9412, 14294), (9480, 14373), (9495, 14344), (9281, 14302), (9442, 14354), (7088, 14362), (7270, 14320), (9297, 14395), (9436, 14389), (7179, 14257), (9376, 14251), (9583, 14399)]
         : compromised: 0.5378, honest: 0.6369
Round 003: test acc mean=0.6447 ± 0.0514 | min=0.4926 max=0.6799
         : test loss mean=1.7626 ± 3.6724
         : individual accs = ['0.660062', '0.679944', '0.655475', '0.655905', '0.670038', '0.494747', '0.662833', '0.634645', '0.673709', '0.663536', '0.664459', '0.662355', '0.669987', '0.642529', '0.492598', '0.667037', '0.664396', '0.647401', '0.668304', '0.664699']
         : correct/total = [(9394, 14232), (9679, 14235), (9351, 14266), (9325, 14217), (9540, 14238), (7111, 14373), (9509, 14346), (9097, 14334), (9630, 14294), (9537, 14373), (9531, 14344), (9473, 14302), (9617, 14354), (9228, 14362), (7054, 14320), (9602, 14395), (9560, 14389), (9230, 14257), (9524, 14251), (9571, 14399)]
         : compromised: 0.6137, honest: 0.6525
Round 004: test acc mean=0.6540 ± 0.0651 | min=0.4957 max=0.6918
         : test loss mean=1.8671 ± 3.2940
         : individual accs = ['0.677347', '0.690270', '0.681480', '0.683337', '0.686122', '0.495721', '0.683117', '0.500419', '0.677207', '0.685243', '0.689905', '0.652706', '0.676884', '0.668013', '0.505656', '0.667871', '0.691292', '0.691801', '0.685215', '0.689770']
         : correct/total = [(9640, 14232), (9826, 14235), (9722, 14266), (9715, 14217), (9769, 14238), (7125, 14373), (9800, 14346), (7173, 14334), (9680, 14294), (9849, 14373), (9896, 14344), (9335, 14302), (9716, 14354), (9594, 14362), (7241, 14320), (9614, 14395), (9947, 14389), (9863, 14257), (9765, 14251), (9932, 14399)]
         : compromised: 0.6331, honest: 0.6592
Round 005: test acc mean=0.6539 ± 0.0697 | min=0.4930 max=0.7012
         : test loss mean=2.4227 ± 5.1463
         : individual accs = ['0.697302', '0.701159', '0.689121', '0.670184', '0.697289', '0.497043', '0.683257', '0.492954', '0.687911', '0.645446', '0.694576', '0.682981', '0.640100', '0.692731', '0.493296', '0.633137', '0.695462', '0.693764', '0.690057', '0.699285']
         : correct/total = [(9924, 14232), (9981, 14235), (9831, 14266), (9528, 14217), (9928, 14238), (7144, 14373), (9802, 14346), (7066, 14334), (9833, 14294), (9277, 14373), (9963, 14344), (9768, 14302), (9188, 14354), (9949, 14362), (7064, 14320), (9114, 14395), (10007, 14389), (9891, 14257), (9834, 14251), (10069, 14399)]
         : compromised: 0.6309, honest: 0.6596
Round 006: test acc mean=0.6680 ± 0.0689 | min=0.5039 max=0.7121
         : test loss mean=1.8616 ± 3.6318
         : individual accs = ['0.702993', '0.712118', '0.665498', '0.703102', '0.700169', '0.503931', '0.693155', '0.504535', '0.686442', '0.699506', '0.701408', '0.685009', '0.709001', '0.695446', '0.508450', '0.703161', '0.693794', '0.695939', '0.690618', '0.705466']
         : correct/total = [(10005, 14232), (10137, 14235), (9494, 14266), (9996, 14217), (9969, 14238), (7243, 14373), (9944, 14346), (7232, 14334), (9812, 14294), (10054, 14373), (10061, 14344), (9797, 14302), (10177, 14354), (9988, 14362), (7281, 14320), (10122, 14395), (9983, 14389), (9922, 14257), (9842, 14251), (10158, 14399)]
         : compromised: 0.6511, honest: 0.6722
Round 007: test acc mean=0.6833 ± 0.0664 | min=0.4823 max=0.7157
         : test loss mean=1.3051 ± 2.6000
         : individual accs = ['0.707631', '0.712680', '0.708958', '0.707252', '0.715690', '0.490573', '0.713091', '0.709014', '0.704771', '0.707507', '0.706637', '0.709621', '0.709907', '0.709999', '0.482332', '0.677944', '0.707971', '0.710318', '0.695179', '0.678936']
         : correct/total = [(10071, 14232), (10145, 14235), (10114, 14266), (10055, 14217), (10190, 14238), (7051, 14373), (10230, 14346), (10163, 14334), (10074, 14294), (10169, 14373), (10136, 14344), (10149, 14302), (10190, 14354), (10197, 14362), (6907, 14320), (9759, 14395), (10187, 14389), (10127, 14257), (9907, 14251), (9776, 14399)]
         : compromised: 0.6552, honest: 0.6903
Round 008: test acc mean=0.6774 ± 0.0754 | min=0.4964 max=0.7238
         : test loss mean=1.7663 ± 2.8954
         : individual accs = ['0.711987', '0.708254', '0.703771', '0.723781', '0.701924', '0.499548', '0.714764', '0.705735', '0.709528', '0.716204', '0.706428', '0.703678', '0.717013', '0.710556', '0.496439', '0.704481', '0.713323', '0.500666', '0.682549', '0.717619']
         : correct/total = [(10133, 14232), (10082, 14235), (10040, 14266), (10290, 14217), (9994, 14238), (7180, 14373), (10254, 14346), (10116, 14334), (10142, 14294), (10294, 14373), (10133, 14344), (10064, 14302), (10292, 14354), (10205, 14362), (7109, 14320), (10141, 14395), (10264, 14389), (7138, 14257), (9727, 14251), (10333, 14399)]
         : compromised: 0.6069, honest: 0.6950
Round 009: test acc mean=0.6767 ± 0.0770 | min=0.4953 max=0.7276
         : test loss mean=3.8520 ± 7.8435
         : individual accs = ['0.707560', '0.723779', '0.697112', '0.720757', '0.727560', '0.496556', '0.696989', '0.692968', '0.714775', '0.716134', '0.689347', '0.689694', '0.698133', '0.719120', '0.495321', '0.689684', '0.723469', '0.495265', '0.716160', '0.723036']
         : correct/total = [(10070, 14232), (10303, 14235), (9945, 14266), (10247, 14217), (10359, 14238), (7137, 14373), (9999, 14346), (9933, 14334), (10217, 14294), (10293, 14373), (9888, 14344), (9864, 14302), (10021, 14354), (10328, 14362), (7093, 14320), (9928, 14395), (10410, 14389), (7061, 14257), (10206, 14251), (10411, 14399)]
         : compromised: 0.6023, honest: 0.6953
Round 010: test acc mean=0.6914 ± 0.0660 | min=0.4883 max=0.7245
         : test loss mean=1.1067 ± 1.6644
         : individual accs = ['0.708825', '0.717808', '0.708327', '0.710487', '0.721731', '0.488346', '0.708281', '0.718920', '0.721072', '0.706951', '0.719255', '0.717732', '0.714923', '0.718841', '0.501746', '0.718027', '0.708319', '0.724486', '0.708161', '0.685673']
         : correct/total = [(10088, 14232), (10218, 14235), (10105, 14266), (10101, 14217), (10276, 14238), (7019, 14373), (10161, 14346), (10305, 14334), (10307, 14294), (10161, 14373), (10317, 14344), (10265, 14302), (10262, 14354), (10324, 14362), (7185, 14320), (10336, 14395), (10192, 14389), (10329, 14257), (10092, 14251), (9873, 14399)]
         : compromised: 0.6616, honest: 0.6988

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 20.0% compromised
Final accuracy - Compromised: 0.6616, Honest: 0.6988
Overall test accuracy: mean=0.6914 ± 0.0660
