Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 4500 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Degree statistics: avg=19.00, min=19, max=19
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: gaussian, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.0514 ± 0.0034 | min=0.0469 max=0.0618
         : test loss mean=3.6911 ± 0.0153
         : individual accs = ['0.051599', '0.051630', '0.050723', '0.048465', '0.051088', '0.048052', '0.049130', '0.051276', '0.047960', '0.053075', '0.050447', '0.061770', '0.053750', '0.046938', '0.048124', '0.056342', '0.055141', '0.050203', '0.052889', '0.048450']
         : correct/total = [(213, 4128), (217, 4203), (207, 4081), (210, 4333), (209, 4091), (206, 4287), (206, 4193), (223, 4349), (201, 4191), (227, 4277), (209, 4143), (259, 4193), (220, 4093), (197, 4197), (195, 4052), (227, 4029), (229, 4153), (210, 4183), (216, 4084), (200, 4128)]
         : compromised: 0.0497, honest: 0.0518
Round 002: test acc mean=0.0514 ± 0.0034 | min=0.0469 max=0.0618
         : test loss mean=3.6798 ± 0.0186
         : individual accs = ['0.051599', '0.051630', '0.050723', '0.048465', '0.051088', '0.048052', '0.049130', '0.051276', '0.047960', '0.053075', '0.050447', '0.061770', '0.053750', '0.046938', '0.048124', '0.056342', '0.055141', '0.050203', '0.052889', '0.048450']
         : correct/total = [(213, 4128), (217, 4203), (207, 4081), (210, 4333), (209, 4091), (206, 4287), (206, 4193), (223, 4349), (201, 4191), (227, 4277), (209, 4143), (259, 4193), (220, 4093), (197, 4197), (195, 4052), (227, 4029), (229, 4153), (210, 4183), (216, 4084), (200, 4128)]
         : compromised: 0.0497, honest: 0.0518
Round 003: test acc mean=0.0514 ± 0.0034 | min=0.0469 max=0.0618
         : test loss mean=3.6802 ± 0.0186
         : individual accs = ['0.051599', '0.051630', '0.050723', '0.048465', '0.051088', '0.048052', '0.049130', '0.051276', '0.047960', '0.053075', '0.050447', '0.061770', '0.053750', '0.046938', '0.048124', '0.056342', '0.055141', '0.050203', '0.052889', '0.048450']
         : correct/total = [(213, 4128), (217, 4203), (207, 4081), (210, 4333), (209, 4091), (206, 4287), (206, 4193), (223, 4349), (201, 4191), (227, 4277), (209, 4143), (259, 4193), (220, 4093), (197, 4197), (195, 4052), (227, 4029), (229, 4153), (210, 4183), (216, 4084), (200, 4128)]
         : compromised: 0.0497, honest: 0.0518
Round 004: test acc mean=0.0526 ± 0.0036 | min=0.0474 max=0.0637
         : test loss mean=3.6659 ± 0.0174
         : individual accs = ['0.052568', '0.052106', '0.051948', '0.049388', '0.052066', '0.048752', '0.050083', '0.052426', '0.049869', '0.054711', '0.051653', '0.063678', '0.055216', '0.047415', '0.050099', '0.057334', '0.056345', '0.052116', '0.055338', '0.049176']
         : correct/total = [(217, 4128), (219, 4203), (212, 4081), (214, 4333), (213, 4091), (209, 4287), (210, 4193), (228, 4349), (209, 4191), (234, 4277), (214, 4143), (267, 4193), (226, 4093), (199, 4197), (203, 4052), (231, 4029), (234, 4153), (218, 4183), (226, 4084), (203, 4128)]
         : compromised: 0.0509, honest: 0.0530
Round 005: test acc mean=0.0832 ± 0.0051 | min=0.0758 max=0.0938
         : test loss mean=3.6570 ± 0.0168
         : individual accs = ['0.085756', '0.078277', '0.093605', '0.077083', '0.083109', '0.081875', '0.081088', '0.082318', '0.079933', '0.078794', '0.087859', '0.079418', '0.086978', '0.090064', '0.093781', '0.084636', '0.082832', '0.075783', '0.084476', '0.076793']
         : correct/total = [(354, 4128), (329, 4203), (382, 4081), (334, 4333), (340, 4091), (351, 4287), (340, 4193), (358, 4349), (335, 4191), (337, 4277), (364, 4143), (333, 4193), (356, 4093), (378, 4197), (380, 4052), (341, 4029), (344, 4153), (317, 4183), (345, 4084), (317, 4128)]
         : compromised: 0.0837, honest: 0.0831
Round 006: test acc mean=0.0958 ± 0.0048 | min=0.0869 max=0.1039
         : test loss mean=3.6383 ± 0.0192
         : individual accs = ['0.095446', '0.087081', '0.091644', '0.093700', '0.096553', '0.087240', '0.092774', '0.095424', '0.099738', '0.095862', '0.086894', '0.096351', '0.094552', '0.099595', '0.103899', '0.102755', '0.098483', '0.097060', '0.098923', '0.101502']
         : correct/total = [(394, 4128), (366, 4203), (374, 4081), (406, 4333), (395, 4091), (374, 4287), (389, 4193), (415, 4349), (418, 4191), (410, 4277), (360, 4143), (404, 4193), (387, 4093), (418, 4197), (421, 4052), (414, 4029), (409, 4153), (406, 4183), (404, 4084), (419, 4128)]
         : compromised: 0.0946, honest: 0.0961
Round 007: test acc mean=0.1961 ± 0.0091 | min=0.1782 max=0.2173
         : test loss mean=3.5917 ± 0.0188
         : individual accs = ['0.205911', '0.195575', '0.217349', '0.178168', '0.195062', '0.194542', '0.190556', '0.197287', '0.185159', '0.191256', '0.189959', '0.201765', '0.194967', '0.193948', '0.207552', '0.205510', '0.205394', '0.188860', '0.198825', '0.183624']
         : correct/total = [(850, 4128), (822, 4203), (887, 4081), (772, 4333), (798, 4091), (834, 4287), (799, 4193), (858, 4349), (776, 4191), (818, 4277), (787, 4143), (846, 4193), (798, 4093), (814, 4197), (841, 4052), (828, 4029), (853, 4153), (790, 4183), (812, 4084), (758, 4128)]
         : compromised: 0.1931, honest: 0.1968
Round 008: test acc mean=0.1872 ± 0.0088 | min=0.1676 max=0.2051
         : test loss mean=3.4786 ± 0.0209
         : individual accs = ['0.194525', '0.181537', '0.205097', '0.167551', '0.181618', '0.192676', '0.185547', '0.189239', '0.179671', '0.180033', '0.189476', '0.181731', '0.189348', '0.196092', '0.201629', '0.194837', '0.189983', '0.182405', '0.187071', '0.174419']
         : correct/total = [(803, 4128), (763, 4203), (837, 4081), (726, 4333), (743, 4091), (826, 4287), (778, 4193), (823, 4349), (753, 4191), (770, 4277), (785, 4143), (762, 4193), (775, 4093), (823, 4197), (817, 4052), (785, 4029), (789, 4153), (763, 4183), (764, 4084), (720, 4128)]
         : compromised: 0.1901, honest: 0.1865
Round 009: test acc mean=0.2895 ± 0.0109 | min=0.2624 max=0.3080
         : test loss mean=3.1884 ± 0.0266
         : individual accs = ['0.299419', '0.290983', '0.308013', '0.262405', '0.299682', '0.286681', '0.282375', '0.291101', '0.274398', '0.277765', '0.282887', '0.292154', '0.296848', '0.292590', '0.294916', '0.302308', '0.296894', '0.275879', '0.298972', '0.283430']
         : correct/total = [(1236, 4128), (1223, 4203), (1257, 4081), (1137, 4333), (1226, 4091), (1229, 4287), (1184, 4193), (1266, 4349), (1150, 4191), (1188, 4277), (1172, 4143), (1225, 4193), (1215, 4093), (1228, 4197), (1195, 4052), (1218, 4029), (1233, 4153), (1154, 4183), (1221, 4084), (1170, 4128)]
         : compromised: 0.2880, honest: 0.2899
Round 010: test acc mean=0.3656 ± 0.0114 | min=0.3351 max=0.3803
         : test loss mean=2.7934 ± 0.0281
         : individual accs = ['0.372578', '0.371163', '0.380299', '0.335103', '0.375214', '0.370189', '0.350584', '0.364222', '0.359341', '0.349076', '0.358436', '0.372287', '0.368190', '0.372885', '0.376851', '0.374535', '0.367204', '0.362658', '0.378795', '0.352713']
         : correct/total = [(1538, 4128), (1560, 4203), (1552, 4081), (1452, 4333), (1535, 4091), (1587, 4287), (1470, 4193), (1584, 4349), (1506, 4191), (1493, 4277), (1485, 4143), (1561, 4193), (1507, 4093), (1565, 4197), (1527, 4052), (1509, 4029), (1525, 4153), (1517, 4183), (1547, 4084), (1456, 4128)]
         : compromised: 0.3685, honest: 0.3649

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: krum
Attack: gaussian, 20.0% compromised
Final accuracy - Compromised: 0.3685, Honest: 0.3649
Overall test accuracy: mean=0.3656 ± 0.0114
