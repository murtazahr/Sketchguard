Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
Degree statistics: avg=4.80, min=2, max=7
Attack: Compromised 14/20 nodes: [1, 2, 3, 5, 6, 8, 11, 12, 13, 14, 15, 17, 18, 19]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.4981 ± 0.0082 | min=0.4822 max=0.5153
         : test loss mean=3.1298 ± 1.5155
         : individual accs = ['0.493325', '0.490973', '0.486892', '0.507491', '0.502739', '0.503722', '0.502928', '0.493582', '0.482160', '0.504975', '0.494702', '0.493358', '0.508499', '0.503621', '0.499232', '0.501355', '0.491348', '0.498352', '0.487194', '0.515314']
         : correct/total = [(7021, 14232), (6989, 14235), (6946, 14266), (7215, 14217), (7158, 14238), (7240, 14373), (7215, 14346), (7075, 14334), (6892, 14294), (7258, 14373), (7096, 14344), (7056, 14302), (7299, 14354), (7233, 14362), (7149, 14320), (7217, 14395), (7070, 14389), (7105, 14257), (6943, 14251), (7420, 14399)]
         : compromised: 0.4986, honest: 0.4968
Round 002: test acc mean=0.5033 ± 0.0090 | min=0.4788 max=0.5166
         : test loss mean=2.6493 ± 1.4503
         : individual accs = ['0.516582', '0.478820', '0.504556', '0.510867', '0.497823', '0.508592', '0.503694', '0.504744', '0.511263', '0.511375', '0.492819', '0.509649', '0.508081', '0.500418', '0.501816', '0.513303', '0.504483', '0.504454', '0.490913', '0.490867']
         : correct/total = [(7352, 14232), (6816, 14235), (7198, 14266), (7263, 14217), (7088, 14238), (7310, 14373), (7226, 14346), (7235, 14334), (7308, 14294), (7350, 14373), (7069, 14344), (7289, 14302), (7293, 14354), (7187, 14362), (7186, 14320), (7389, 14395), (7259, 14389), (7192, 14257), (6996, 14251), (7068, 14399)]
         : compromised: 0.5027, honest: 0.5046
Round 003: test acc mean=0.4995 ± 0.0108 | min=0.4790 max=0.5187
         : test loss mean=1.0582 ± 0.3641
         : individual accs = ['0.505972', '0.485423', '0.506659', '0.502427', '0.508850', '0.503514', '0.518681', '0.503279', '0.490206', '0.505183', '0.485220', '0.478954', '0.508708', '0.496727', '0.513757', '0.483154', '0.505873', '0.488532', '0.505228', '0.493506']
         : correct/total = [(7201, 14232), (6910, 14235), (7228, 14266), (7143, 14217), (7245, 14238), (7237, 14373), (7441, 14346), (7214, 14334), (7007, 14294), (7261, 14373), (6960, 14344), (6850, 14302), (7302, 14354), (7134, 14362), (7357, 14320), (6955, 14395), (7279, 14389), (6965, 14257), (7200, 14251), (7106, 14399)]
         : compromised: 0.4982, honest: 0.5024
Round 004: test acc mean=0.5080 ± 0.0072 | min=0.4909 max=0.5183
         : test loss mean=0.9051 ± 0.6303
         : individual accs = ['0.507659', '0.513172', '0.513599', '0.517409', '0.507375', '0.495652', '0.502509', '0.504325', '0.518329', '0.512976', '0.504671', '0.509719', '0.506897', '0.490948', '0.514525', '0.503161', '0.513865', '0.515396', '0.509859', '0.497604']
         : correct/total = [(7225, 14232), (7305, 14235), (7327, 14266), (7356, 14217), (7224, 14238), (7124, 14373), (7209, 14346), (7229, 14334), (7409, 14294), (7373, 14373), (7239, 14344), (7290, 14302), (7276, 14354), (7051, 14362), (7368, 14320), (7243, 14395), (7394, 14389), (7348, 14257), (7266, 14251), (7165, 14399)]
         : compromised: 0.5078, honest: 0.5085
Round 005: test acc mean=0.5244 ± 0.0173 | min=0.4945 max=0.5573
         : test loss mean=1.0399 ± 1.4478
         : individual accs = ['0.523609', '0.503196', '0.532104', '0.519519', '0.547900', '0.545954', '0.536456', '0.545905', '0.529453', '0.525290', '0.542596', '0.507971', '0.521039', '0.504804', '0.494483', '0.557277', '0.527347', '0.506067', '0.511683', '0.505730']
         : correct/total = [(7452, 14232), (7163, 14235), (7591, 14266), (7386, 14217), (7801, 14238), (7847, 14373), (7696, 14346), (7825, 14334), (7568, 14294), (7550, 14373), (7783, 14344), (7265, 14302), (7479, 14354), (7250, 14362), (7081, 14320), (8022, 14395), (7588, 14389), (7215, 14257), (7292, 14251), (7282, 14399)]
         : compromised: 0.5197, honest: 0.5354
Round 006: test acc mean=0.5389 ± 0.0203 | min=0.4909 max=0.5686
         : test loss mean=0.9812 ± 1.2551
         : individual accs = ['0.537099', '0.533685', '0.551661', '0.506014', '0.563000', '0.562026', '0.548934', '0.568578', '0.535260', '0.539136', '0.557376', '0.535240', '0.533649', '0.507798', '0.490852', '0.567141', '0.540969', '0.536859', '0.519262', '0.543579']
         : correct/total = [(7644, 14232), (7597, 14235), (7870, 14266), (7194, 14217), (8016, 14238), (8078, 14373), (7875, 14346), (8150, 14334), (7651, 14294), (7749, 14373), (7995, 14344), (7655, 14302), (7660, 14354), (7293, 14362), (7029, 14320), (8164, 14395), (7784, 14389), (7654, 14257), (7400, 14251), (7827, 14399)]
         : compromised: 0.5337, honest: 0.5510
Round 007: test acc mean=0.5546 ± 0.0182 | min=0.5096 max=0.5742
         : test loss mean=1.1276 ± 1.9296
         : individual accs = ['0.556773', '0.561714', '0.556218', '0.520996', '0.572693', '0.574132', '0.554092', '0.574159', '0.548342', '0.551311', '0.565114', '0.566005', '0.546538', '0.509609', '0.521648', '0.573532', '0.551254', '0.571228', '0.548242', '0.567470']
         : correct/total = [(7924, 14232), (7996, 14235), (7935, 14266), (7407, 14217), (8154, 14238), (8252, 14373), (7949, 14346), (8230, 14334), (7838, 14294), (7924, 14373), (8106, 14344), (8095, 14302), (7845, 14354), (7319, 14362), (7470, 14320), (8256, 14395), (7932, 14389), (8144, 14257), (7813, 14251), (8171, 14399)]
         : compromised: 0.5514, honest: 0.5619
Round 008: test acc mean=0.5627 ± 0.0195 | min=0.5081 max=0.5852
         : test loss mean=1.1861 ± 2.2018
         : individual accs = ['0.550098', '0.577801', '0.552853', '0.535345', '0.580770', '0.580394', '0.555068', '0.585182', '0.555338', '0.547972', '0.576966', '0.572368', '0.555107', '0.508077', '0.545461', '0.584092', '0.558204', '0.581469', '0.571398', '0.581013']
         : correct/total = [(7829, 14232), (8225, 14235), (7887, 14266), (7611, 14217), (8269, 14238), (8342, 14373), (7963, 14346), (8388, 14334), (7938, 14294), (7876, 14373), (8276, 14344), (8186, 14302), (7968, 14354), (7297, 14362), (7811, 14320), (8408, 14395), (8032, 14389), (8290, 14257), (8143, 14251), (8366, 14399)]
         : compromised: 0.5611, honest: 0.5665
Round 009: test acc mean=0.5689 ± 0.0197 | min=0.5038 max=0.5885
         : test loss mean=0.9473 ± 1.1745
         : individual accs = ['0.560708', '0.585458', '0.567854', '0.554758', '0.585335', '0.586795', '0.567406', '0.586717', '0.556807', '0.560704', '0.578291', '0.581667', '0.557754', '0.503760', '0.547346', '0.588468', '0.561054', '0.586168', '0.581924', '0.578443']
         : correct/total = [(7980, 14232), (8334, 14235), (8101, 14266), (7887, 14217), (8334, 14238), (8434, 14373), (8140, 14346), (8410, 14334), (7959, 14294), (8059, 14373), (8295, 14344), (8319, 14302), (8006, 14354), (7235, 14362), (7838, 14320), (8471, 14395), (8073, 14389), (8357, 14257), (8293, 14251), (8329, 14399)]
         : compromised: 0.5675, honest: 0.5721
Round 010: test acc mean=0.5758 ± 0.0213 | min=0.5032 max=0.5994
         : test loss mean=0.8477 ± 0.7591
         : individual accs = ['0.567173', '0.597752', '0.569536', '0.570303', '0.595098', '0.596535', '0.567754', '0.596065', '0.564223', '0.564670', '0.583798', '0.583695', '0.565975', '0.503203', '0.559637', '0.599375', '0.568212', '0.595848', '0.585994', '0.581777']
         : correct/total = [(8072, 14232), (8509, 14235), (8125, 14266), (8108, 14217), (8473, 14238), (8574, 14373), (8145, 14346), (8544, 14334), (8065, 14294), (8116, 14373), (8374, 14344), (8348, 14302), (8124, 14354), (7227, 14362), (8014, 14320), (8628, 14395), (8176, 14389), (8495, 14257), (8351, 14251), (8377, 14399)]
         : compromised: 0.5744, honest: 0.5792

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: krum, 70.0% compromised
Final accuracy - Compromised: 0.5744, Honest: 0.5792
Overall test accuracy: mean=0.5758 ± 0.0213

=== BALANCE SUMMARY ===
Node 0: acceptance=0.467
Node 1: acceptance=0.283
Node 2: acceptance=0.360
Node 3: acceptance=0.400
Node 4: acceptance=0.400
Node 5: acceptance=0.360
Node 6: acceptance=0.360
Node 7: acceptance=0.520
Node 8: acceptance=0.600
Node 9: acceptance=0.467
Node 10: acceptance=0.400
Node 11: acceptance=0.257
Node 12: acceptance=0.386
Node 13: acceptance=0.200
Node 14: acceptance=0.314
Node 15: acceptance=0.333
Node 16: acceptance=0.360
Node 17: acceptance=0.480
Node 18: acceptance=0.400
Node 19: acceptance=0.600

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.032s (73.2%)
    - Aggregation: 0.012s (26.8%)
  TOTALS:
    - Total computation: 0.044s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.044s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.023s
  - Aggregation: 0.005s
  - Model transfer: 0.000s
  - Total per node: 0.029s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 0.468s
  - Total aggregation: 0.104s
  - Total model transfer: 0.000s
  - Grand total: 0.572s
  - Mean acceptance rate: 0.397

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
