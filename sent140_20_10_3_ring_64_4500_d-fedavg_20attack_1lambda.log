Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5100 ± 0.0174 | min=0.4882 max=0.5652
         : test loss mean=2.5642 ± 3.0076
         : individual accs = ['0.534992', '0.565227', '0.488224', '0.512415', '0.510395', '0.505183', '0.506483', '0.524766', '0.502169', '0.533779', '0.502022', '0.508880', '0.504180', '0.497215', '0.495321', '0.507815', '0.493363', '0.496668', '0.500246', '0.510035']
         : correct/total = [(7614, 14232), (8046, 14235), (6965, 14266), (7285, 14217), (7267, 14238), (7261, 14373), (7266, 14346), (7522, 14334), (7178, 14294), (7672, 14373), (7201, 14344), (7278, 14302), (7237, 14354), (7141, 14362), (7093, 14320), (7310, 14395), (7099, 14389), (7081, 14257), (7129, 14251), (7344, 14399)]
         : compromised: 0.5008, honest: 0.5123
Round 002: test acc mean=0.5245 ± 0.0531 | min=0.4703 max=0.6388
         : test loss mean=2.4249 ± 3.0942
         : individual accs = ['0.626616', '0.638848', '0.626104', '0.498769', '0.494522', '0.492660', '0.490241', '0.507255', '0.511613', '0.622904', '0.470301', '0.480213', '0.498189', '0.501810', '0.496927', '0.505245', '0.495448', '0.508312', '0.508877', '0.515661']
         : correct/total = [(8918, 14232), (9094, 14235), (8932, 14266), (7091, 14217), (7041, 14238), (7081, 14373), (7033, 14346), (7271, 14334), (7313, 14294), (8953, 14373), (6746, 14344), (6868, 14302), (7151, 14354), (7207, 14362), (7116, 14320), (7273, 14395), (7129, 14389), (7247, 14257), (7252, 14251), (7425, 14399)]
         : compromised: 0.5002, honest: 0.5306
Round 003: test acc mean=0.5127 ± 0.0330 | min=0.4765 max=0.6242
         : test loss mean=1.0280 ± 0.6160
         : individual accs = ['0.574691', '0.624236', '0.514300', '0.476472', '0.505549', '0.495930', '0.492751', '0.508721', '0.538688', '0.495304', '0.537646', '0.497273', '0.496795', '0.503621', '0.501117', '0.498854', '0.499548', '0.495616', '0.501017', '0.495868']
         : correct/total = [(8179, 14232), (8886, 14235), (7337, 14266), (6774, 14217), (7198, 14238), (7128, 14373), (7069, 14346), (7292, 14334), (7700, 14294), (7119, 14373), (7712, 14344), (7112, 14302), (7131, 14354), (7233, 14362), (7176, 14320), (7181, 14395), (7188, 14389), (7066, 14257), (7140, 14251), (7140, 14399)]
         : compromised: 0.4980, honest: 0.5164
Round 004: test acc mean=0.5294 ± 0.0453 | min=0.4789 max=0.6361
         : test loss mean=1.0137 ± 0.6573
         : individual accs = ['0.508151', '0.636108', '0.604795', '0.547443', '0.511729', '0.506575', '0.488638', '0.575624', '0.615153', '0.580046', '0.509342', '0.505174', '0.511843', '0.499721', '0.502374', '0.478916', '0.509278', '0.491688', '0.501298', '0.504202']
         : correct/total = [(7232, 14232), (9055, 14235), (8628, 14266), (7783, 14217), (7286, 14238), (7281, 14373), (7010, 14346), (8251, 14334), (8793, 14294), (8337, 14373), (7306, 14344), (7225, 14302), (7347, 14354), (7177, 14362), (7194, 14320), (6894, 14395), (7328, 14389), (7010, 14257), (7144, 14251), (7260, 14399)]
         : compromised: 0.5025, honest: 0.5361
Round 005: test acc mean=0.5379 ± 0.0453 | min=0.4955 max=0.6455
         : test loss mean=0.8872 ± 0.4199
         : individual accs = ['0.613617', '0.645522', '0.617342', '0.515580', '0.525846', '0.515480', '0.499651', '0.592368', '0.580803', '0.563835', '0.517917', '0.508530', '0.495541', '0.516502', '0.517528', '0.499410', '0.522760', '0.495897', '0.504105', '0.509897']
         : correct/total = [(8733, 14232), (9189, 14235), (8807, 14266), (7330, 14217), (7487, 14238), (7409, 14373), (7168, 14346), (8491, 14334), (8302, 14294), (8104, 14373), (7429, 14344), (7273, 14302), (7113, 14354), (7418, 14362), (7411, 14320), (7189, 14395), (7522, 14389), (7070, 14257), (7184, 14251), (7342, 14399)]
         : compromised: 0.5059, honest: 0.5459
Round 006: test acc mean=0.5520 ± 0.0519 | min=0.4947 max=0.6413
         : test loss mean=0.8529 ± 0.3776
         : individual accs = ['0.584317', '0.641307', '0.603323', '0.581557', '0.514609', '0.504627', '0.499721', '0.617274', '0.630964', '0.573228', '0.612521', '0.512656', '0.511147', '0.498190', '0.499232', '0.527058', '0.510181', '0.494704', '0.508666', '0.614418']
         : correct/total = [(8316, 14232), (9129, 14235), (8607, 14266), (8268, 14217), (7327, 14238), (7253, 14373), (7169, 14346), (8848, 14334), (9019, 14294), (8239, 14373), (8786, 14344), (7332, 14302), (7337, 14354), (7155, 14362), (7149, 14320), (7587, 14395), (7341, 14389), (7053, 14257), (7249, 14251), (8847, 14399)]
         : compromised: 0.5022, honest: 0.5644
Round 007: test acc mean=0.5607 ± 0.0543 | min=0.4953 max=0.6465
         : test loss mean=0.7960 ± 0.2952
         : individual accs = ['0.634064', '0.644187', '0.646502', '0.593937', '0.532729', '0.525290', '0.499930', '0.567741', '0.639289', '0.628122', '0.579476', '0.552860', '0.504877', '0.508564', '0.529818', '0.500035', '0.510042', '0.495265', '0.516455', '0.605320']
         : correct/total = [(9024, 14232), (9170, 14235), (9223, 14266), (8444, 14217), (7585, 14238), (7550, 14373), (7172, 14346), (8138, 14334), (9138, 14294), (9028, 14373), (8312, 14344), (7907, 14302), (7247, 14354), (7304, 14362), (7587, 14320), (7198, 14395), (7339, 14389), (7061, 14257), (7360, 14251), (8716, 14399)]
         : compromised: 0.5085, honest: 0.5738
Round 008: test acc mean=0.5627 ± 0.0574 | min=0.4953 max=0.6426
         : test loss mean=0.7956 ± 0.3126
         : individual accs = ['0.642636', '0.634844', '0.640334', '0.545052', '0.532519', '0.503096', '0.514359', '0.633877', '0.636911', '0.612885', '0.629601', '0.523633', '0.510938', '0.496170', '0.508799', '0.537131', '0.529849', '0.495336', '0.509438', '0.617265']
         : correct/total = [(9146, 14232), (9037, 14235), (9135, 14266), (7749, 14217), (7582, 14238), (7231, 14373), (7379, 14346), (9086, 14334), (9104, 14294), (8809, 14373), (9031, 14344), (7489, 14302), (7334, 14354), (7126, 14362), (7286, 14320), (7732, 14395), (7624, 14389), (7062, 14257), (7260, 14251), (8888, 14399)]
         : compromised: 0.5014, honest: 0.5781
Round 009: test acc mean=0.5752 ± 0.0550 | min=0.4993 max=0.6530
         : test loss mean=0.7542 ± 0.2409
         : individual accs = ['0.649874', '0.653038', '0.649446', '0.621580', '0.548673', '0.499339', '0.533459', '0.590135', '0.629425', '0.644820', '0.624163', '0.543560', '0.512819', '0.513856', '0.553492', '0.502327', '0.561193', '0.500596', '0.553716', '0.618446']
         : correct/total = [(9249, 14232), (9296, 14235), (9265, 14266), (8837, 14217), (7812, 14238), (7177, 14373), (7653, 14346), (8459, 14334), (8997, 14294), (9268, 14373), (8953, 14344), (7774, 14302), (7361, 14354), (7380, 14362), (7926, 14320), (7231, 14395), (8075, 14389), (7137, 14257), (7891, 14251), (8905, 14399)]
         : compromised: 0.5067, honest: 0.5923
Round 010: test acc mean=0.5778 ± 0.0623 | min=0.4952 max=0.6581
         : test loss mean=0.7660 ± 0.2775
         : individual accs = ['0.647625', '0.658096', '0.655755', '0.524583', '0.534204', '0.508105', '0.523839', '0.643505', '0.647265', '0.646768', '0.645706', '0.536079', '0.508778', '0.503899', '0.552584', '0.602015', '0.565710', '0.495195', '0.510490', '0.645114']
         : correct/total = [(9217, 14232), (9368, 14235), (9355, 14266), (7458, 14217), (7606, 14238), (7303, 14373), (7515, 14346), (9224, 14334), (9252, 14294), (9296, 14373), (9262, 14344), (7667, 14302), (7303, 14354), (7237, 14362), (7913, 14320), (8666, 14395), (8140, 14389), (7060, 14257), (7275, 14251), (9289, 14399)]
         : compromised: 0.5040, honest: 0.5962

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: d-fedavg
Attack: directed_deviation, 20.0% compromised
Final accuracy - Compromised: 0.5040, Honest: 0.5962
Overall test accuracy: mean=0.5778 ± 0.0623
