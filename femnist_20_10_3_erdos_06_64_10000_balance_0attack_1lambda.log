Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4999 ± 0.0338 | min=0.4424 max=0.5562
         : test loss mean=3.7409 ± 0.0252
         : individual accs = ['0.556202', '0.489888', '0.525852', '0.486268', '0.442435', '0.552601', '0.494634', '0.490917', '0.532570', '0.463643', '0.463915', '0.532077', '0.469582', '0.466524', '0.518756', '0.529908', '0.476764', '0.545302', '0.503918', '0.455911']
         : correct/total = [(2296, 4128), (2059, 4203), (2146, 4081), (2107, 4333), (1810, 4091), (2369, 4287), (2074, 4193), (2135, 4349), (2232, 4191), (1983, 4277), (1922, 4143), (2231, 4193), (1922, 4093), (1958, 4197), (2102, 4052), (2135, 4029), (1980, 4153), (2281, 4183), (2058, 4084), (1882, 4128)]
Round 002: test acc mean=0.6857 ± 0.0202 | min=0.6232 max=0.7196
         : test loss mean=3.4007 ± 0.0314
         : individual accs = ['0.679990', '0.688794', '0.673609', '0.695361', '0.680029', '0.719617', '0.623181', '0.684525', '0.690050', '0.706804', '0.691045', '0.703077', '0.698998', '0.671909', '0.703603', '0.700422', '0.658078', '0.677265', '0.694662', '0.673207']
         : correct/total = [(2807, 4128), (2895, 4203), (2749, 4081), (3013, 4333), (2782, 4091), (3085, 4287), (2613, 4193), (2977, 4349), (2892, 4191), (3023, 4277), (2863, 4143), (2948, 4193), (2861, 4093), (2820, 4197), (2851, 4052), (2822, 4029), (2733, 4153), (2833, 4183), (2837, 4084), (2779, 4128)]
Round 003: test acc mean=0.7115 ± 0.0177 | min=0.6793 max=0.7408
         : test loss mean=3.1303 ± 0.0397
         : individual accs = ['0.740795', '0.709017', '0.680470', '0.730672', '0.699096', '0.679263', '0.717625', '0.723845', '0.729182', '0.692775', '0.702148', '0.739089', '0.729294', '0.712890', '0.726802', '0.716059', '0.693475', '0.709060', '0.702008', '0.697432']
         : correct/total = [(3058, 4128), (2980, 4203), (2777, 4081), (3166, 4333), (2860, 4091), (2912, 4287), (3009, 4193), (3148, 4349), (3056, 4191), (2963, 4277), (2909, 4143), (3099, 4193), (2985, 4093), (2992, 4197), (2945, 4052), (2885, 4029), (2880, 4153), (2966, 4183), (2867, 4084), (2879, 4128)]
Round 004: test acc mean=0.7105 ± 0.0209 | min=0.6676 max=0.7381
         : test loss mean=2.6916 ± 0.0592
         : individual accs = ['0.706638', '0.733048', '0.671894', '0.711747', '0.736984', '0.708887', '0.738135', '0.726834', '0.720115', '0.695113', '0.667632', '0.722156', '0.671634', '0.712175', '0.735439', '0.725490', '0.709126', '0.715276', '0.709354', '0.692587']
         : correct/total = [(2917, 4128), (3081, 4203), (2742, 4081), (3084, 4333), (3015, 4091), (3039, 4287), (3095, 4193), (3161, 4349), (3018, 4191), (2973, 4277), (2766, 4143), (3028, 4193), (2749, 4093), (2989, 4197), (2980, 4052), (2923, 4029), (2945, 4153), (2992, 4183), (2897, 4084), (2859, 4128)]
Round 005: test acc mean=0.6774 ± 0.0259 | min=0.5910 max=0.7120
         : test loss mean=2.1297 ± 0.0711
         : individual accs = ['0.703488', '0.673804', '0.591032', '0.643434', '0.674896', '0.699790', '0.694491', '0.688664', '0.677643', '0.688099', '0.663287', '0.669688', '0.696066', '0.665714', '0.679911', '0.674361', '0.702143', '0.660053', '0.712047', '0.689922']
         : correct/total = [(2904, 4128), (2832, 4203), (2412, 4081), (2788, 4333), (2761, 4091), (3000, 4287), (2912, 4193), (2995, 4349), (2840, 4191), (2943, 4277), (2748, 4143), (2808, 4193), (2849, 4093), (2794, 4197), (2755, 4052), (2717, 4029), (2916, 4153), (2761, 4183), (2908, 4084), (2848, 4128)]
Round 006: test acc mean=0.7149 ± 0.0150 | min=0.6761 max=0.7396
         : test loss mean=1.4482 ± 0.0587
         : individual accs = ['0.676114', '0.718059', '0.713306', '0.710593', '0.720117', '0.708421', '0.726210', '0.721775', '0.693629', '0.696516', '0.725320', '0.705461', '0.725629', '0.737908', '0.723346', '0.739638', '0.698772', '0.721014', '0.725514', '0.710756']
         : correct/total = [(2791, 4128), (3018, 4203), (2911, 4081), (3079, 4333), (2946, 4091), (3037, 4287), (3045, 4193), (3139, 4349), (2907, 4191), (2979, 4277), (3005, 4143), (2958, 4193), (2970, 4093), (3097, 4197), (2931, 4052), (2980, 4029), (2902, 4153), (3016, 4183), (2963, 4084), (2934, 4128)]
Round 007: test acc mean=0.7801 ± 0.0090 | min=0.7628 max=0.7953
         : test loss mean=0.8992 ± 0.0416
         : individual accs = ['0.778828', '0.781823', '0.762803', '0.774060', '0.771205', '0.793329', '0.794181', '0.787767', '0.781675', '0.776479', '0.780835', '0.764131', '0.768385', '0.781034', '0.784057', '0.790022', '0.777751', '0.781736', '0.795299', '0.775921']
         : correct/total = [(3215, 4128), (3286, 4203), (3113, 4081), (3354, 4333), (3155, 4091), (3401, 4287), (3330, 4193), (3426, 4349), (3276, 4191), (3321, 4277), (3235, 4143), (3204, 4193), (3145, 4093), (3278, 4197), (3177, 4052), (3183, 4029), (3230, 4153), (3270, 4183), (3248, 4084), (3203, 4128)]
Round 008: test acc mean=0.8126 ± 0.0079 | min=0.7953 max=0.8246
         : test loss mean=0.6286 ± 0.0231
         : individual accs = ['0.805717', '0.814656', '0.804950', '0.817909', '0.796627', '0.824586', '0.819938', '0.820418', '0.819136', '0.810147', '0.802559', '0.818984', '0.809919', '0.812247', '0.821323', '0.814346', '0.811462', '0.816161', '0.814887', '0.795300']
         : correct/total = [(3326, 4128), (3424, 4203), (3285, 4081), (3544, 4333), (3259, 4091), (3535, 4287), (3438, 4193), (3568, 4349), (3433, 4191), (3465, 4277), (3325, 4143), (3434, 4193), (3315, 4093), (3409, 4197), (3328, 4052), (3281, 4029), (3370, 4153), (3414, 4183), (3328, 4084), (3283, 4128)]
Round 009: test acc mean=0.8301 ± 0.0057 | min=0.8222 max=0.8449
         : test loss mean=0.5379 ± 0.0187
         : individual accs = ['0.824128', '0.833928', '0.827003', '0.833833', '0.824493', '0.831351', '0.834963', '0.833065', '0.844906', '0.833762', '0.823799', '0.826854', '0.825312', '0.828925', '0.836624', '0.834947', '0.828798', '0.822376', '0.831538', '0.822190']
         : correct/total = [(3402, 4128), (3505, 4203), (3375, 4081), (3613, 4333), (3373, 4091), (3564, 4287), (3501, 4193), (3623, 4349), (3541, 4191), (3566, 4277), (3413, 4143), (3467, 4193), (3378, 4093), (3479, 4197), (3390, 4052), (3364, 4029), (3442, 4153), (3440, 4183), (3396, 4084), (3394, 4128)]
Round 010: test acc mean=0.8390 ± 0.0059 | min=0.8262 max=0.8490
         : test loss mean=0.4994 ± 0.0182
         : individual accs = ['0.831880', '0.845586', '0.833619', '0.840988', '0.828159', '0.837415', '0.842595', '0.842263', '0.848962', '0.841945', '0.826213', '0.833771', '0.840948', '0.840600', '0.845015', '0.844626', '0.840356', '0.842697', '0.839128', '0.832364']
         : correct/total = [(3434, 4128), (3554, 4203), (3402, 4081), (3644, 4333), (3388, 4091), (3590, 4287), (3533, 4193), (3663, 4349), (3558, 4191), (3601, 4277), (3423, 4143), (3496, 4193), (3442, 4093), (3528, 4197), (3424, 4052), (3403, 4029), (3490, 4153), (3525, 4183), (3427, 4084), (3436, 4128)]

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: balance
Overall test accuracy: mean=0.8390 ± 0.0059

=== BALANCE SUMMARY ===
Node 0: acceptance=1.000
Node 1: acceptance=1.000
Node 2: acceptance=1.000
Node 3: acceptance=1.000
Node 4: acceptance=1.000
Node 5: acceptance=1.000
Node 6: acceptance=1.000
Node 7: acceptance=1.000
Node 8: acceptance=1.000
Node 9: acceptance=1.000
Node 10: acceptance=1.000
Node 11: acceptance=1.000
Node 12: acceptance=1.000
Node 13: acceptance=1.000
Node 14: acceptance=1.000
Node 15: acceptance=1.000
Node 16: acceptance=1.000
Node 17: acceptance=1.000
Node 18: acceptance=1.000
Node 19: acceptance=1.000

Performance Summary:
  - Distance computation time: 1.239s (42.7%)
  - Filtering time: 1.366s (47.1%)
  - Aggregation time: 0.295s (10.2%)
  - Total time: 2.900s
  - Mean acceptance rate: 1.000

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
