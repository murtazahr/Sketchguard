Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.6010 ± 0.0569 | min=0.4983 max=0.6475
         : test loss mean=8.4469 ± 16.0460
         : individual accs = ['0.637366', '0.647489', '0.610402', '0.614968', '0.623613', '0.637167', '0.502649', '0.622018', '0.500630', '0.641272', '0.643196', '0.498322', '0.642469', '0.642250', '0.507263', '0.617923', '0.639238', '0.639195', '0.641429', '0.512049']
         : correct/total = [(9071, 14232), (9217, 14235), (8708, 14266), (8743, 14217), (8879, 14238), (9158, 14373), (7211, 14346), (8916, 14334), (7156, 14294), (9217, 14373), (9226, 14344), (7127, 14302), (9222, 14354), (9224, 14362), (7264, 14320), (8895, 14395), (9198, 14389), (9113, 14257), (9141, 14251), (7373, 14399)]
         : compromised: 0.6397, honest: 0.5967
Round 002: test acc mean=0.6520 ± 0.0118 | min=0.6264 max=0.6680
         : test loss mean=0.6215 ± 0.0088
         : individual accs = ['0.654933', '0.662311', '0.656596', '0.659703', '0.663085', '0.658109', '0.648125', '0.650551', '0.667973', '0.636193', '0.655535', '0.650189', '0.636826', '0.640092', '0.626397', '0.659048', '0.655709', '0.662622', '0.630061', '0.666782']
         : correct/total = [(9321, 14232), (9428, 14235), (9367, 14266), (9379, 14217), (9441, 14238), (9459, 14373), (9298, 14346), (9325, 14334), (9548, 14294), (9144, 14373), (9403, 14344), (9299, 14302), (9141, 14354), (9193, 14362), (8970, 14320), (9487, 14395), (9435, 14389), (9447, 14257), (8979, 14251), (9601, 14399)]
         : compromised: 0.6491, honest: 0.6524
Round 003: test acc mean=0.6530 ± 0.0160 | min=0.6303 max=0.6778
         : test loss mean=0.6250 ± 0.0177
         : individual accs = ['0.640458', '0.640112', '0.639352', '0.677569', '0.644473', '0.675085', '0.638087', '0.643226', '0.653141', '0.671885', '0.677775', '0.639771', '0.644698', '0.647960', '0.637081', '0.668010', '0.668914', '0.644806', '0.630342', '0.676505']
         : correct/total = [(9115, 14232), (9112, 14235), (9121, 14266), (9633, 14217), (9176, 14238), (9703, 14373), (9154, 14346), (9220, 14334), (9336, 14294), (9657, 14373), (9722, 14344), (9150, 14302), (9254, 14354), (9306, 14362), (9123, 14320), (9616, 14395), (9625, 14389), (9193, 14257), (8983, 14251), (9741, 14399)]
         : compromised: 0.6615, honest: 0.6520
Round 004: test acc mean=0.6757 ± 0.0078 | min=0.6570 max=0.6914
         : test loss mean=0.5970 ± 0.0070
         : individual accs = ['0.677277', '0.672006', '0.670896', '0.671168', '0.683102', '0.679816', '0.657047', '0.675876', '0.678047', '0.667780', '0.681400', '0.661586', '0.675561', '0.683888', '0.678701', '0.675651', '0.678643', '0.684015', '0.670690', '0.691437']
         : correct/total = [(9639, 14232), (9566, 14235), (9571, 14266), (9542, 14217), (9726, 14238), (9771, 14373), (9426, 14346), (9688, 14334), (9692, 14294), (9598, 14373), (9774, 14344), (9462, 14302), (9697, 14354), (9822, 14362), (9719, 14320), (9726, 14395), (9765, 14389), (9752, 14257), (9558, 14251), (9956, 14399)]
         : compromised: 0.6819, honest: 0.6750
Round 005: test acc mean=0.6860 ± 0.0073 | min=0.6702 max=0.6981
         : test loss mean=0.5863 ± 0.0090
         : individual accs = ['0.674536', '0.698068', '0.677415', '0.680383', '0.687667', '0.697558', '0.684302', '0.687735', '0.689240', '0.679747', '0.688581', '0.686827', '0.690121', '0.685977', '0.686243', '0.670233', '0.692473', '0.689907', '0.676865', '0.695465']
         : correct/total = [(9600, 14232), (9937, 14235), (9664, 14266), (9673, 14217), (9791, 14238), (10026, 14373), (9817, 14346), (9858, 14334), (9852, 14294), (9770, 14373), (9877, 14344), (9823, 14302), (9906, 14354), (9852, 14362), (9827, 14320), (9648, 14395), (9964, 14389), (9836, 14257), (9646, 14251), (10014, 14399)]
         : compromised: 0.6918, honest: 0.6853
Round 006: test acc mean=0.6946 ± 0.0089 | min=0.6636 max=0.7078
         : test loss mean=0.5756 ± 0.0080
         : individual accs = ['0.694280', '0.707763', '0.685967', '0.695224', '0.697781', '0.696097', '0.691273', '0.696456', '0.701483', '0.691644', '0.703709', '0.698154', '0.693744', '0.706517', '0.692668', '0.689684', '0.692195', '0.663604', '0.695741', '0.697965']
         : correct/total = [(9881, 14232), (10075, 14235), (9786, 14266), (9884, 14217), (9935, 14238), (10005, 14373), (9917, 14346), (9983, 14334), (10027, 14294), (9941, 14373), (10094, 14344), (9985, 14302), (9958, 14354), (10147, 14362), (9919, 14320), (9928, 14395), (9960, 14389), (9461, 14257), (9915, 14251), (10050, 14399)]
         : compromised: 0.7013, honest: 0.6939
Round 007: test acc mean=0.7037 ± 0.0070 | min=0.6891 max=0.7144
         : test loss mean=0.5642 ± 0.0083
         : individual accs = ['0.690908', '0.714436', '0.701108', '0.709784', '0.710001', '0.710777', '0.709605', '0.707409', '0.703232', '0.702637', '0.708589', '0.708572', '0.706493', '0.708049', '0.689106', '0.694199', '0.694836', '0.706741', '0.697565', '0.700743']
         : correct/total = [(9833, 14232), (10170, 14235), (10002, 14266), (10091, 14217), (10109, 14238), (10216, 14373), (10180, 14346), (10140, 14334), (10052, 14294), (10099, 14373), (10164, 14344), (10134, 14302), (10141, 14354), (10169, 14362), (9868, 14320), (9993, 14395), (9998, 14389), (10076, 14257), (9941, 14251), (10090, 14399)]
         : compromised: 0.7094, honest: 0.7031
Round 008: test acc mean=0.7016 ± 0.0106 | min=0.6756 max=0.7152
         : test loss mean=0.5703 ± 0.0144
         : individual accs = ['0.681914', '0.705515', '0.698935', '0.714637', '0.703118', '0.706255', '0.705284', '0.701619', '0.715055', '0.710081', '0.715212', '0.700881', '0.693744', '0.703105', '0.683310', '0.698923', '0.701786', '0.710177', '0.675602', '0.707410']
         : correct/total = [(9705, 14232), (10043, 14235), (9971, 14266), (10160, 14217), (10011, 14238), (10151, 14373), (10118, 14346), (10057, 14334), (10221, 14294), (10206, 14373), (10259, 14344), (10024, 14302), (9958, 14354), (10098, 14362), (9785, 14320), (10061, 14395), (10098, 14389), (10125, 14257), (9628, 14251), (10186, 14399)]
         : compromised: 0.7047, honest: 0.7013
Round 009: test acc mean=0.7096 ± 0.0073 | min=0.6908 max=0.7264
         : test loss mean=0.5596 ± 0.0095
         : individual accs = ['0.711917', '0.714506', '0.706225', '0.708799', '0.704664', '0.690809', '0.706887', '0.713478', '0.714915', '0.708829', '0.698341', '0.711789', '0.709907', '0.710138', '0.708729', '0.707259', '0.711655', '0.726380', '0.704582', '0.722133']
         : correct/total = [(10132, 14232), (10171, 14235), (10075, 14266), (10077, 14217), (10033, 14238), (9929, 14373), (10141, 14346), (10227, 14334), (10219, 14294), (10188, 14373), (10017, 14344), (10180, 14302), (10190, 14354), (10199, 14362), (10149, 14320), (10181, 14395), (10240, 14389), (10356, 14257), (10041, 14251), (10398, 14399)]
         : compromised: 0.7005, honest: 0.7106
Round 010: test acc mean=0.7161 ± 0.0054 | min=0.7066 max=0.7249
         : test loss mean=0.5486 ± 0.0063
         : individual accs = ['0.712690', '0.721953', '0.710360', '0.719491', '0.721169', '0.707020', '0.708560', '0.713688', '0.715405', '0.713630', '0.716118', '0.719130', '0.721262', '0.706587', '0.714246', '0.717888', '0.724929', '0.723995', '0.712231', '0.720953']
         : correct/total = [(10143, 14232), (10277, 14235), (10134, 14266), (10229, 14217), (10268, 14238), (10162, 14373), (10165, 14346), (10230, 14334), (10226, 14294), (10257, 14373), (10272, 14344), (10285, 14302), (10353, 14354), (10148, 14362), (10228, 14320), (10334, 14395), (10431, 14389), (10322, 14257), (10150, 14251), (10381, 14399)]
         : compromised: 0.7068, honest: 0.7171

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 10.0% compromised
Final accuracy - Compromised: 0.7068, Honest: 0.7171
Overall test accuracy: mean=0.7161 ± 0.0054
