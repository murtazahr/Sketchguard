Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: directed_deviation, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4864 ± 0.0350 | min=0.4336 max=0.5528
         : test loss mean=3.7495 ± 0.0282
         : individual accs = ['0.544574', '0.484892', '0.508209', '0.467344', '0.440724', '0.552834', '0.489626', '0.445390', '0.505369', '0.454057', '0.460053', '0.521822', '0.463230', '0.433643', '0.512340', '0.528915', '0.466891', '0.519723', '0.479432', '0.449612']
         : correct/total = [(2248, 4128), (2038, 4203), (2074, 4081), (2025, 4333), (1803, 4091), (2370, 4287), (2053, 4193), (1937, 4349), (2118, 4191), (1942, 4277), (1906, 4143), (2188, 4193), (1896, 4093), (1820, 4197), (2076, 4052), (2131, 4029), (1939, 4153), (2174, 4183), (1958, 4084), (1856, 4128)]
         : compromised: 0.4932, honest: 0.4857
Round 002: test acc mean=0.6861 ± 0.0175 | min=0.6399 max=0.7068
         : test loss mean=3.3692 ± 0.0500
         : individual accs = ['0.689196', '0.691649', '0.665523', '0.702054', '0.685651', '0.704455', '0.639876', '0.682226', '0.696015', '0.706804', '0.693700', '0.700215', '0.700709', '0.658327', '0.702369', '0.691239', '0.664580', '0.676070', '0.698335', '0.672965']
         : correct/total = [(2845, 4128), (2907, 4203), (2716, 4081), (3042, 4333), (2805, 4091), (3020, 4287), (2683, 4193), (2967, 4349), (2917, 4191), (3023, 4277), (2874, 4143), (2936, 4193), (2868, 4093), (2763, 4197), (2846, 4052), (2785, 4029), (2760, 4153), (2828, 4183), (2852, 4084), (2778, 4128)]
         : compromised: 0.6814, honest: 0.6866
Round 003: test acc mean=0.7122 ± 0.0224 | min=0.6403 max=0.7398
         : test loss mean=3.0404 ± 0.0913
         : individual accs = ['0.739099', '0.721152', '0.680961', '0.726748', '0.706918', '0.640308', '0.724064', '0.733272', '0.719399', '0.698621', '0.705769', '0.735035', '0.739800', '0.695020', '0.727542', '0.714321', '0.701180', '0.718384', '0.709354', '0.706153']
         : correct/total = [(3051, 4128), (3031, 4203), (2779, 4081), (3149, 4333), (2892, 4091), (2745, 4287), (3036, 4193), (3189, 4349), (3015, 4191), (2988, 4277), (2924, 4143), (3082, 4193), (3028, 4093), (2917, 4197), (2948, 4052), (2878, 4029), (2912, 4153), (3005, 4183), (2897, 4084), (2915, 4128)]
         : compromised: 0.6677, honest: 0.7171
Round 004: test acc mean=0.7138 ± 0.0223 | min=0.6587 max=0.7453
         : test loss mean=2.5517 ± 0.1266
         : individual accs = ['0.714874', '0.741851', '0.691007', '0.706208', '0.740161', '0.658736', '0.733604', '0.731433', '0.701503', '0.704466', '0.676563', '0.726449', '0.696799', '0.703121', '0.745311', '0.737156', '0.714183', '0.730576', '0.719882', '0.701550']
         : correct/total = [(2951, 4128), (3118, 4203), (2820, 4081), (3060, 4333), (3028, 4091), (2824, 4287), (3076, 4193), (3181, 4349), (2940, 4191), (3013, 4277), (2803, 4143), (3046, 4193), (2852, 4093), (2951, 4197), (3020, 4052), (2970, 4029), (2966, 4153), (3056, 4183), (2940, 4084), (2896, 4128)]
         : compromised: 0.6809, honest: 0.7174
Round 005: test acc mean=0.7016 ± 0.0243 | min=0.6562 max=0.7397
         : test loss mean=1.9546 ± 0.1331
         : individual accs = ['0.723837', '0.692838', '0.656212', '0.672282', '0.725495', '0.664567', '0.699022', '0.712808', '0.715581', '0.715221', '0.681149', '0.686621', '0.725385', '0.656898', '0.701382', '0.714818', '0.731038', '0.702128', '0.739716', '0.714390']
         : correct/total = [(2988, 4128), (2912, 4203), (2678, 4081), (2913, 4333), (2968, 4091), (2849, 4287), (2931, 4193), (3100, 4349), (2999, 4191), (3059, 4277), (2822, 4143), (2879, 4193), (2969, 4093), (2757, 4197), (2842, 4052), (2880, 4029), (3036, 4153), (2937, 4183), (3021, 4084), (2949, 4128)]
         : compromised: 0.6607, honest: 0.7061
Round 006: test acc mean=0.7435 ± 0.0166 | min=0.6951 max=0.7712
         : test loss mean=1.2927 ± 0.1016
         : individual accs = ['0.719477', '0.733286', '0.753492', '0.741288', '0.746028', '0.695125', '0.744813', '0.760175', '0.753281', '0.720131', '0.740043', '0.743143', '0.752016', '0.745533', '0.748519', '0.771159', '0.751264', '0.750896', '0.763712', '0.735707']
         : correct/total = [(2970, 4128), (3082, 4203), (3075, 4081), (3212, 4333), (3052, 4091), (2980, 4287), (3123, 4193), (3306, 4349), (3157, 4191), (3080, 4277), (3066, 4143), (3116, 4193), (3078, 4093), (3129, 4197), (3033, 4052), (3107, 4029), (3120, 4153), (3141, 4183), (3119, 4084), (3037, 4128)]
         : compromised: 0.7203, honest: 0.7460
Round 007: test acc mean=0.7904 ± 0.0093 | min=0.7751 max=0.8053
         : test loss mean=0.8392 ± 0.0543
         : individual accs = ['0.790940', '0.789436', '0.777015', '0.794138', '0.783183', '0.789363', '0.802767', '0.796505', '0.805297', '0.784662', '0.783732', '0.775101', '0.783044', '0.786514', '0.796150', '0.804666', '0.798700', '0.785800', '0.804358', '0.776890']
         : correct/total = [(3265, 4128), (3318, 4203), (3171, 4081), (3441, 4333), (3204, 4091), (3384, 4287), (3366, 4193), (3464, 4349), (3375, 4191), (3356, 4277), (3247, 4143), (3250, 4193), (3205, 4093), (3301, 4197), (3226, 4052), (3242, 4029), (3317, 4153), (3287, 4183), (3285, 4084), (3207, 4128)]
         : compromised: 0.7879, honest: 0.7907
Round 008: test acc mean=0.8153 ± 0.0089 | min=0.7902 max=0.8245
         : test loss mean=0.6228 ± 0.0318
         : individual accs = ['0.806686', '0.816798', '0.811811', '0.821371', '0.801760', '0.822953', '0.820176', '0.822258', '0.824147', '0.816694', '0.803765', '0.822561', '0.810897', '0.820110', '0.824531', '0.824274', '0.815555', '0.810184', '0.818560', '0.790213']
         : correct/total = [(3330, 4128), (3433, 4203), (3313, 4081), (3559, 4333), (3280, 4091), (3528, 4287), (3439, 4193), (3576, 4349), (3454, 4191), (3493, 4277), (3330, 4143), (3449, 4193), (3319, 4093), (3442, 4197), (3341, 4052), (3321, 4029), (3387, 4153), (3389, 4183), (3343, 4084), (3262, 4128)]
         : compromised: 0.8215, honest: 0.8146
Round 009: test acc mean=0.8306 ± 0.0062 | min=0.8198 max=0.8473
         : test loss mean=0.5371 ± 0.0197
         : individual accs = ['0.822917', '0.830359', '0.826023', '0.835449', '0.824737', '0.833450', '0.833532', '0.830306', '0.847292', '0.838906', '0.826213', '0.829955', '0.828488', '0.831785', '0.836377', '0.835443', '0.829280', '0.822854', '0.828355', '0.819767']
         : correct/total = [(3397, 4128), (3490, 4203), (3371, 4081), (3620, 4333), (3374, 4091), (3573, 4287), (3495, 4193), (3611, 4349), (3551, 4191), (3588, 4277), (3423, 4143), (3480, 4193), (3391, 4093), (3491, 4197), (3389, 4052), (3366, 4029), (3444, 4153), (3442, 4183), (3383, 4084), (3384, 4128)]
         : compromised: 0.8326, honest: 0.8303
Round 010: test acc mean=0.8392 ± 0.0052 | min=0.8296 max=0.8464
         : test loss mean=0.4993 ± 0.0183
         : individual accs = ['0.830669', '0.844635', '0.833864', '0.840988', '0.829626', '0.836716', '0.843549', '0.841113', '0.843713', '0.841244', '0.830075', '0.834009', '0.840948', '0.843698', '0.846002', '0.846364', '0.839393', '0.842936', '0.840108', '0.835029']
         : correct/total = [(3429, 4128), (3550, 4203), (3403, 4081), (3644, 4333), (3394, 4091), (3587, 4287), (3537, 4193), (3658, 4349), (3536, 4191), (3598, 4277), (3439, 4143), (3497, 4193), (3442, 4093), (3541, 4197), (3428, 4052), (3410, 4029), (3486, 4153), (3526, 4183), (3431, 4084), (3447, 4128)]
         : compromised: 0.8402, honest: 0.8391

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: directed_deviation, 10.0% compromised
Final accuracy - Compromised: 0.8402, Honest: 0.8391
Overall test accuracy: mean=0.8392 ± 0.0052

=== BALANCE SUMMARY ===
Node 0: acceptance=0.917
Node 1: acceptance=0.900
Node 2: acceptance=1.000
Node 3: acceptance=0.857
Node 4: acceptance=0.889
Node 5: acceptance=1.000
Node 6: acceptance=0.833
Node 7: acceptance=0.909
Node 8: acceptance=0.714
Node 9: acceptance=1.000
Node 10: acceptance=1.000
Node 11: acceptance=0.833
Node 12: acceptance=0.917
Node 13: acceptance=1.000
Node 14: acceptance=0.857
Node 15: acceptance=0.889
Node 16: acceptance=1.000
Node 17: acceptance=0.875
Node 18: acceptance=0.917
Node 19: acceptance=0.800

Performance Summary:
  - Distance computation time: 0.923s (42.2%)
  - Filtering time: 1.039s (47.5%)
  - Aggregation time: 0.227s (10.4%)
  - Total time: 2.189s
  - Mean acceptance rate: 0.905

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
