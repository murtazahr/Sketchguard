Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: directed_deviation, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4957 ± 0.0345 | min=0.4395 max=0.5543
         : test loss mean=3.7419 ± 0.0242
         : individual accs = ['0.554264', '0.481799', '0.515560', '0.494346', '0.439501', '0.548402', '0.489387', '0.485859', '0.536387', '0.457096', '0.460053', '0.529692', '0.463230', '0.461282', '0.513820', '0.534376', '0.470262', '0.530959', '0.498286', '0.449370']
         : correct/total = [(2288, 4128), (2025, 4203), (2104, 4081), (2142, 4333), (1798, 4091), (2351, 4287), (2052, 4193), (2113, 4349), (2248, 4191), (1955, 4277), (1906, 4143), (2221, 4193), (1896, 4093), (1936, 4197), (2082, 4052), (2153, 4029), (1953, 4153), (2221, 4183), (2035, 4084), (1855, 4128)]
         : compromised: 0.5048, honest: 0.4947
Round 002: test acc mean=0.6847 ± 0.0181 | min=0.6356 max=0.7047
         : test loss mean=3.3943 ± 0.0459
         : individual accs = ['0.683382', '0.688318', '0.666013', '0.698592', '0.674407', '0.703989', '0.635583', '0.696712', '0.690289', '0.704700', '0.689597', '0.702123', '0.698754', '0.663569', '0.696693', '0.698188', '0.657115', '0.670093', '0.699070', '0.677083']
         : correct/total = [(2821, 4128), (2893, 4203), (2718, 4081), (3027, 4333), (2759, 4091), (3018, 4287), (2665, 4193), (3030, 4349), (2893, 4191), (3014, 4277), (2857, 4143), (2944, 4193), (2860, 4093), (2785, 4197), (2823, 4052), (2813, 4029), (2729, 4153), (2803, 4183), (2855, 4084), (2795, 4128)]
         : compromised: 0.6838, honest: 0.6848
Round 003: test acc mean=0.7085 ± 0.0243 | min=0.6359 max=0.7379
         : test loss mean=3.1006 ± 0.0835
         : individual accs = ['0.737888', '0.715917', '0.666013', '0.725133', '0.698362', '0.635876', '0.725256', '0.729133', '0.728704', '0.694178', '0.695631', '0.732650', '0.735158', '0.700024', '0.725814', '0.711095', '0.693715', '0.707626', '0.704701', '0.706638']
         : correct/total = [(3046, 4128), (3009, 4203), (2718, 4081), (3142, 4333), (2857, 4091), (2726, 4287), (3041, 4193), (3171, 4349), (3054, 4191), (2969, 4277), (2882, 4143), (3072, 4193), (3009, 4093), (2938, 4197), (2941, 4052), (2865, 4029), (2881, 4153), (2960, 4183), (2878, 4084), (2917, 4128)]
         : compromised: 0.6679, honest: 0.7130
Round 004: test acc mean=0.7062 ± 0.0256 | min=0.6461 max=0.7392
         : test loss mean=2.6298 ± 0.1188
         : individual accs = ['0.712694', '0.736379', '0.665033', '0.713363', '0.739184', '0.646139', '0.732888', '0.724534', '0.715104', '0.697218', '0.663046', '0.715717', '0.679453', '0.690493', '0.734946', '0.721023', '0.713701', '0.721970', '0.707884', '0.692345']
         : correct/total = [(2942, 4128), (3095, 4203), (2714, 4081), (3091, 4333), (3024, 4091), (2770, 4287), (3073, 4193), (3151, 4349), (2997, 4191), (2982, 4277), (2747, 4143), (3001, 4193), (2781, 4093), (2898, 4197), (2978, 4052), (2905, 4029), (2964, 4153), (3020, 4183), (2891, 4084), (2858, 4128)]
         : compromised: 0.6683, honest: 0.7104
Round 005: test acc mean=0.6824 ± 0.0309 | min=0.6126 max=0.7243
         : test loss mean=2.0386 ± 0.1287
         : individual accs = ['0.711483', '0.690697', '0.615290', '0.665820', '0.705451', '0.627945', '0.704269', '0.704070', '0.684324', '0.692775', '0.672218', '0.676365', '0.701930', '0.612580', '0.676209', '0.681062', '0.721406', '0.694239', '0.724290', '0.685320']
         : correct/total = [(2937, 4128), (2903, 4203), (2511, 4081), (2885, 4333), (2886, 4091), (2692, 4287), (2953, 4193), (3062, 4349), (2868, 4191), (2963, 4277), (2785, 4143), (2836, 4193), (2873, 4093), (2571, 4197), (2740, 4052), (2744, 4029), (2996, 4153), (2904, 4183), (2958, 4084), (2829, 4128)]
         : compromised: 0.6203, honest: 0.6893
Round 006: test acc mean=0.7279 ± 0.0185 | min=0.6615 max=0.7473
         : test loss mean=1.3392 ± 0.0903
         : individual accs = ['0.703246', '0.735427', '0.731193', '0.727210', '0.739184', '0.661535', '0.739089', '0.741550', '0.722023', '0.714987', '0.736906', '0.726687', '0.734669', '0.719562', '0.732971', '0.743361', '0.736335', '0.741095', '0.747307', '0.724322']
         : correct/total = [(2903, 4128), (3091, 4203), (2984, 4081), (3151, 4333), (3024, 4091), (2836, 4287), (3099, 4193), (3225, 4349), (3026, 4191), (3058, 4277), (3053, 4143), (3047, 4193), (3007, 4093), (3020, 4197), (2970, 4052), (2995, 4029), (3058, 4153), (3100, 4183), (3052, 4084), (2990, 4128)]
         : compromised: 0.6905, honest: 0.7321
Round 007: test acc mean=0.7874 ± 0.0072 | min=0.7751 max=0.8002
         : test loss mean=0.8324 ± 0.0367
         : individual accs = ['0.781734', '0.787057', '0.775055', '0.789522', '0.779516', '0.788430', '0.797997', '0.794665', '0.794560', '0.789806', '0.783973', '0.781064', '0.775959', '0.778175', '0.794176', '0.791263', '0.792439', '0.790103', '0.800196', '0.781977']
         : correct/total = [(3227, 4128), (3308, 4203), (3163, 4081), (3421, 4333), (3189, 4091), (3380, 4287), (3346, 4193), (3456, 4349), (3330, 4191), (3378, 4277), (3248, 4143), (3275, 4193), (3176, 4093), (3266, 4197), (3218, 4052), (3188, 4029), (3291, 4153), (3305, 4183), (3268, 4084), (3228, 4128)]
         : compromised: 0.7833, honest: 0.7878
Round 008: test acc mean=0.8151 ± 0.0073 | min=0.7992 max=0.8238
         : test loss mean=0.6114 ± 0.0230
         : individual accs = ['0.803779', '0.819415', '0.813036', '0.817678', '0.800293', '0.821554', '0.819223', '0.820878', '0.822477', '0.819733', '0.806179', '0.822800', '0.811874', '0.815344', '0.823791', '0.818565', '0.817000', '0.812575', '0.817581', '0.799176']
         : correct/total = [(3318, 4128), (3444, 4203), (3318, 4081), (3543, 4333), (3274, 4091), (3522, 4287), (3435, 4193), (3570, 4349), (3447, 4191), (3506, 4277), (3340, 4143), (3450, 4193), (3323, 4093), (3422, 4197), (3338, 4052), (3298, 4029), (3393, 4153), (3399, 4183), (3339, 4084), (3299, 4128)]
         : compromised: 0.8184, honest: 0.8148
Round 009: test acc mean=0.8303 ± 0.0058 | min=0.8212 max=0.8449
         : test loss mean=0.5329 ± 0.0182
         : individual accs = ['0.822674', '0.831549', '0.825778', '0.836834', '0.824737', '0.830884', '0.832340', '0.831456', '0.844906', '0.837737', '0.824765', '0.829239', '0.829954', '0.831546', '0.836130', '0.835195', '0.829762', '0.821420', '0.828844', '0.821221']
         : correct/total = [(3396, 4128), (3495, 4203), (3370, 4081), (3626, 4333), (3374, 4091), (3562, 4287), (3490, 4193), (3616, 4349), (3541, 4191), (3583, 4277), (3417, 4143), (3477, 4193), (3397, 4093), (3490, 4197), (3388, 4052), (3365, 4029), (3446, 4153), (3436, 4183), (3385, 4084), (3390, 4128)]
         : compromised: 0.8312, honest: 0.8303
Round 010: test acc mean=0.8392 ± 0.0055 | min=0.8286 max=0.8469
         : test loss mean=0.4976 ± 0.0188
         : individual accs = ['0.832607', '0.844635', '0.833619', '0.840988', '0.828648', '0.836249', '0.846649', '0.841113', '0.843474', '0.842413', '0.828868', '0.833294', '0.839238', '0.842507', '0.843781', '0.846860', '0.840838', '0.845565', '0.839128', '0.834302']
         : correct/total = [(3437, 4128), (3550, 4203), (3402, 4081), (3644, 4333), (3390, 4091), (3585, 4287), (3550, 4193), (3658, 4349), (3535, 4191), (3603, 4277), (3434, 4143), (3494, 4193), (3435, 4093), (3536, 4197), (3419, 4052), (3412, 4029), (3492, 4153), (3537, 4183), (3427, 4084), (3444, 4128)]
         : compromised: 0.8394, honest: 0.8392

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: directed_deviation, 10.0% compromised
Final accuracy - Compromised: 0.8394, Honest: 0.8392
Overall test accuracy: mean=0.8392 ± 0.0055

=== BALANCE SUMMARY ===
Node 0: acceptance=0.875
Node 1: acceptance=0.909
Node 2: acceptance=0.833
Node 3: acceptance=0.875
Node 4: acceptance=0.909
Node 5: acceptance=0.933
Node 6: acceptance=0.857
Node 7: acceptance=0.929
Node 8: acceptance=0.800
Node 9: acceptance=0.923
Node 10: acceptance=0.889
Node 11: acceptance=0.857
Node 12: acceptance=0.917
Node 13: acceptance=0.923
Node 14: acceptance=0.867
Node 15: acceptance=0.909
Node 16: acceptance=0.923
Node 17: acceptance=0.889
Node 18: acceptance=0.875
Node 19: acceptance=0.875

Performance Summary:
  - Distance computation time: 1.110s (43.3%)
  - Filtering time: 1.238s (48.2%)
  - Aggregation time: 0.219s (8.5%)
  - Total time: 2.567s
  - Mean acceptance rate: 0.888

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
