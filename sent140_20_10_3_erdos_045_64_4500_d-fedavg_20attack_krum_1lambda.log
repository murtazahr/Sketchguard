Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5011 ± 0.0126 | min=0.4806 max=0.5368
         : test loss mean=1.4318 ± 0.9020
         : individual accs = ['0.521571', '0.512680', '0.513038', '0.487796', '0.536803', '0.499200', '0.480552', '0.495954', '0.503428', '0.495234', '0.498397', '0.497972', '0.508151', '0.497215', '0.489316', '0.500035', '0.506568', '0.492881', '0.485720', '0.500243']
         : correct/total = [(7423, 14232), (7298, 14235), (7319, 14266), (6935, 14217), (7643, 14238), (7175, 14373), (6894, 14346), (7109, 14334), (7196, 14294), (7118, 14373), (7149, 14344), (7122, 14302), (7294, 14354), (7141, 14362), (7007, 14320), (7198, 14395), (7289, 14389), (7027, 14257), (6922, 14251), (7203, 14399)]
         : compromised: 0.4994, honest: 0.5016
Round 002: test acc mean=0.4976 ± 0.0083 | min=0.4819 max=0.5147
         : test loss mean=1.2485 ± 0.5413
         : individual accs = ['0.493395', '0.507130', '0.487172', '0.506788', '0.492274', '0.503374', '0.502997', '0.490163', '0.514691', '0.495234', '0.503346', '0.495875', '0.507663', '0.496101', '0.491550', '0.481903', '0.498575', '0.485165', '0.495053', '0.504271']
         : correct/total = [(7022, 14232), (7219, 14235), (6950, 14266), (7205, 14217), (7009, 14238), (7235, 14373), (7216, 14346), (7026, 14334), (7357, 14294), (7118, 14373), (7220, 14344), (7092, 14302), (7287, 14354), (7125, 14362), (7039, 14320), (6937, 14395), (7174, 14389), (6917, 14257), (7055, 14251), (7261, 14399)]
         : compromised: 0.4981, honest: 0.4975
Round 003: test acc mean=0.4953 ± 0.0067 | min=0.4828 max=0.5093
         : test loss mean=0.7928 ± 0.2502
         : individual accs = ['0.492833', '0.482754', '0.509253', '0.484561', '0.494522', '0.504766', '0.499791', '0.492605', '0.483210', '0.505531', '0.499303', '0.493777', '0.496308', '0.493455', '0.492877', '0.496144', '0.492599', '0.499264', '0.495123', '0.498298']
         : correct/total = [(7014, 14232), (6872, 14235), (7265, 14266), (6889, 14217), (7041, 14238), (7255, 14373), (7170, 14346), (7061, 14334), (6907, 14294), (7266, 14373), (7162, 14344), (7062, 14302), (7124, 14354), (7087, 14362), (7058, 14320), (7142, 14395), (7088, 14389), (7118, 14257), (7056, 14251), (7175, 14399)]
         : compromised: 0.4984, honest: 0.4946
Round 004: test acc mean=0.5165 ± 0.0107 | min=0.4937 max=0.5378
         : test loss mean=0.7618 ± 0.1404
         : individual accs = ['0.526490', '0.517808', '0.516262', '0.520996', '0.526057', '0.521951', '0.521748', '0.516674', '0.516790', '0.498435', '0.509481', '0.537757', '0.493730', '0.509121', '0.518506', '0.531712', '0.526513', '0.507119', '0.503824', '0.509202']
         : correct/total = [(7493, 14232), (7371, 14235), (7365, 14266), (7407, 14217), (7490, 14238), (7502, 14373), (7485, 14346), (7406, 14334), (7387, 14294), (7164, 14373), (7308, 14344), (7691, 14302), (7087, 14354), (7312, 14362), (7425, 14320), (7654, 14395), (7576, 14389), (7230, 14257), (7180, 14251), (7332, 14399)]
         : compromised: 0.5080, honest: 0.5186
Round 005: test acc mean=0.4982 ± 0.0118 | min=0.4830 max=0.5391
         : test loss mean=0.8002 ± 0.2399
         : individual accs = ['0.492622', '0.483035', '0.514650', '0.484912', '0.495224', '0.497600', '0.503206', '0.492675', '0.497901', '0.507966', '0.498536', '0.494127', '0.501115', '0.485517', '0.492737', '0.539076', '0.493432', '0.495195', '0.495614', '0.498854']
         : correct/total = [(7011, 14232), (6876, 14235), (7342, 14266), (6894, 14217), (7051, 14238), (7152, 14373), (7219, 14346), (7062, 14334), (7117, 14294), (7301, 14373), (7151, 14344), (7067, 14302), (7193, 14354), (6973, 14362), (7056, 14320), (7760, 14395), (7100, 14389), (7060, 14257), (7063, 14251), (7183, 14399)]
         : compromised: 0.4949, honest: 0.4990
Round 006: test acc mean=0.5421 ± 0.0321 | min=0.4973 max=0.6052
         : test loss mean=0.7361 ± 0.1444
         : individual accs = ['0.516091', '0.547805', '0.605215', '0.521207', '0.567074', '0.518542', '0.565384', '0.550998', '0.527914', '0.604815', '0.505717', '0.557405', '0.497283', '0.560019', '0.555237', '0.581730', '0.540621', '0.505296', '0.505508', '0.507605']
         : correct/total = [(7345, 14232), (7798, 14235), (8634, 14266), (7410, 14217), (8074, 14238), (7453, 14373), (8111, 14346), (7898, 14334), (7546, 14294), (8693, 14373), (7254, 14344), (7972, 14302), (7138, 14354), (8043, 14362), (7951, 14320), (8374, 14395), (7779, 14389), (7204, 14257), (7204, 14251), (7309, 14399)]
         : compromised: 0.5203, honest: 0.5475
Round 007: test acc mean=0.5389 ± 0.0371 | min=0.4857 max=0.6245
         : test loss mean=0.7267 ± 0.1180
         : individual accs = ['0.562886', '0.553284', '0.585238', '0.485686', '0.580980', '0.509080', '0.577095', '0.522115', '0.501259', '0.585264', '0.501952', '0.565096', '0.502160', '0.540941', '0.515084', '0.624522', '0.522413', '0.530126', '0.513438', '0.500104']
         : correct/total = [(8011, 14232), (7876, 14235), (8349, 14266), (6905, 14217), (8272, 14238), (7317, 14373), (8279, 14346), (7484, 14334), (7165, 14294), (8412, 14373), (7200, 14344), (8082, 14302), (7208, 14354), (7769, 14362), (7376, 14320), (8990, 14395), (7517, 14389), (7558, 14257), (7317, 14251), (7201, 14399)]
         : compromised: 0.5206, honest: 0.5435
Round 008: test acc mean=0.5761 ± 0.0339 | min=0.4762 max=0.6310
         : test loss mean=0.7157 ± 0.1281
         : individual accs = ['0.599002', '0.609413', '0.598977', '0.589717', '0.592991', '0.588534', '0.585738', '0.566555', '0.541206', '0.631044', '0.591049', '0.582646', '0.476174', '0.596505', '0.572765', '0.599027', '0.566266', '0.545837', '0.571679', '0.516286']
         : correct/total = [(8525, 14232), (8675, 14235), (8545, 14266), (8384, 14217), (8443, 14238), (8459, 14373), (8403, 14346), (8121, 14334), (7736, 14294), (9070, 14373), (8478, 14344), (8333, 14302), (6835, 14354), (8567, 14362), (8202, 14320), (8623, 14395), (8148, 14389), (7782, 14257), (8147, 14251), (7434, 14399)]
         : compromised: 0.5518, honest: 0.5821
Round 009: test acc mean=0.5446 ± 0.0347 | min=0.4997 max=0.6075
         : test loss mean=0.7129 ± 0.0940
         : individual accs = ['0.535624', '0.536705', '0.594000', '0.520363', '0.578592', '0.517429', '0.567615', '0.541719', '0.510774', '0.607528', '0.516035', '0.559083', '0.499652', '0.597271', '0.527374', '0.605696', '0.546112', '0.510276', '0.514841', '0.505591']
         : correct/total = [(7623, 14232), (7640, 14235), (8474, 14266), (7398, 14217), (8238, 14238), (7437, 14373), (8143, 14346), (7765, 14334), (7301, 14294), (8732, 14373), (7402, 14344), (7996, 14302), (7172, 14354), (8578, 14362), (7552, 14320), (8719, 14395), (7858, 14389), (7275, 14257), (7337, 14251), (7280, 14399)]
         : compromised: 0.5312, honest: 0.5480
Round 010: test acc mean=0.5927 ± 0.0264 | min=0.5175 max=0.6246
         : test loss mean=0.7048 ± 0.1241
         : individual accs = ['0.605185', '0.621286', '0.614678', '0.599494', '0.608021', '0.610241', '0.597379', '0.585810', '0.549461', '0.624643', '0.615798', '0.594742', '0.550996', '0.588010', '0.585405', '0.621744', '0.586837', '0.591288', '0.585573', '0.517466']
         : correct/total = [(8613, 14232), (8844, 14235), (8769, 14266), (8523, 14217), (8657, 14238), (8771, 14373), (8570, 14346), (8397, 14334), (7854, 14294), (8978, 14373), (8833, 14344), (8506, 14302), (7909, 14354), (8445, 14362), (8383, 14320), (8950, 14395), (8444, 14389), (8430, 14257), (8345, 14251), (7451, 14399)]
         : compromised: 0.5851, honest: 0.5946

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: d-fedavg
Attack: krum, 20.0% compromised
Final accuracy - Compromised: 0.5851, Honest: 0.5946
Overall test accuracy: mean=0.5927 ± 0.0264
