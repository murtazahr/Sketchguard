Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
Degree statistics: avg=4.80, min=2, max=7
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5004 ± 0.0071 | min=0.4889 max=0.5146
         : test loss mean=5.1570 ± 4.0395
         : individual accs = ['0.512858', '0.507552', '0.488855', '0.494900', '0.495435', '0.502331', '0.491705', '0.514581', '0.493914', '0.500313', '0.497839', '0.497413', '0.492964', '0.503830', '0.501746', '0.502744', '0.505942', '0.502700', '0.491334', '0.508924']
         : correct/total = [(7299, 14232), (7225, 14235), (6974, 14266), (7036, 14217), (7054, 14238), (7220, 14373), (7054, 14346), (7376, 14334), (7060, 14294), (7191, 14373), (7141, 14344), (7114, 14302), (7076, 14354), (7236, 14362), (7185, 14320), (7237, 14395), (7280, 14389), (7167, 14257), (7002, 14251), (7328, 14399)]
         : compromised: 0.5000, honest: 0.5007
Round 002: test acc mean=0.4962 ± 0.0058 | min=0.4859 max=0.5069
         : test loss mean=5.6524 ± 3.7579
         : individual accs = ['0.493114', '0.494064', '0.495304', '0.506928', '0.497612', '0.491129', '0.498606', '0.487582', '0.485868', '0.486468', '0.501046', '0.496294', '0.494914', '0.502298', '0.499372', '0.499479', '0.503371', '0.496247', '0.489790', '0.503924']
         : correct/total = [(7018, 14232), (7033, 14235), (7066, 14266), (7207, 14217), (7085, 14238), (7059, 14373), (7153, 14346), (6989, 14334), (6945, 14294), (6992, 14373), (7187, 14344), (7098, 14302), (7104, 14354), (7214, 14362), (7151, 14320), (7190, 14395), (7243, 14389), (7075, 14257), (6980, 14251), (7256, 14399)]
         : compromised: 0.4955, honest: 0.4966
Round 003: test acc mean=0.5031 ± 0.0062 | min=0.4910 max=0.5189
         : test loss mean=1.8294 ± 1.8578
         : individual accs = ['0.497822', '0.518862', '0.510865', '0.508405', '0.501264', '0.505322', '0.503764', '0.491000', '0.505597', '0.510888', '0.502231', '0.501748', '0.503205', '0.494987', '0.504190', '0.498298', '0.500174', '0.494634', '0.503473', '0.505868']
         : correct/total = [(7085, 14232), (7386, 14235), (7288, 14266), (7228, 14217), (7137, 14238), (7263, 14373), (7227, 14346), (7038, 14334), (7227, 14294), (7343, 14373), (7204, 14344), (7176, 14302), (7223, 14354), (7109, 14362), (7220, 14320), (7173, 14395), (7197, 14389), (7052, 14257), (7175, 14251), (7284, 14399)]
         : compromised: 0.5033, honest: 0.5030
Round 004: test acc mean=0.4976 ± 0.0058 | min=0.4873 max=0.5100
         : test loss mean=3.4640 ± 3.9398
         : individual accs = ['0.491498', '0.502986', '0.487312', '0.497081', '0.492415', '0.501565', '0.496445', '0.510046', '0.493424', '0.494817', '0.498257', '0.493637', '0.497701', '0.509748', '0.500349', '0.503647', '0.496351', '0.492740', '0.491615', '0.500035']
         : correct/total = [(6995, 14232), (7160, 14235), (6952, 14266), (7067, 14217), (7011, 14238), (7209, 14373), (7122, 14346), (7311, 14334), (7053, 14294), (7112, 14373), (7147, 14344), (7060, 14302), (7144, 14354), (7321, 14362), (7165, 14320), (7250, 14395), (7142, 14389), (7025, 14257), (7006, 14251), (7200, 14399)]
         : compromised: 0.4988, honest: 0.4968
Round 005: test acc mean=0.5024 ± 0.0081 | min=0.4813 max=0.5145
         : test loss mean=1.6376 ± 1.8717
         : individual accs = ['0.514545', '0.513734', '0.500210', '0.509531', '0.496980', '0.500452', '0.497909', '0.491419', '0.512383', '0.510541', '0.497560', '0.500210', '0.503065', '0.481270', '0.510754', '0.496075', '0.498228', '0.508662', '0.502421', '0.501354']
         : correct/total = [(7323, 14232), (7313, 14235), (7136, 14266), (7244, 14217), (7076, 14238), (7193, 14373), (7143, 14346), (7044, 14334), (7324, 14294), (7338, 14373), (7137, 14344), (7154, 14302), (7221, 14354), (6912, 14362), (7314, 14320), (7141, 14395), (7169, 14389), (7252, 14257), (7160, 14251), (7219, 14399)]
         : compromised: 0.5026, honest: 0.5022
Round 006: test acc mean=0.5013 ± 0.0054 | min=0.4892 max=0.5088
         : test loss mean=2.6259 ± 3.1137
         : individual accs = ['0.489250', '0.497998', '0.494813', '0.504115', '0.498385', '0.494886', '0.506831', '0.507744', '0.500420', '0.497530', '0.500349', '0.501538', '0.508848', '0.508773', '0.504120', '0.506565', '0.495517', '0.502911', '0.507614', '0.496979']
         : correct/total = [(6963, 14232), (7089, 14235), (7059, 14266), (7167, 14217), (7096, 14238), (7113, 14373), (7271, 14346), (7278, 14334), (7153, 14294), (7151, 14373), (7177, 14344), (7173, 14302), (7304, 14354), (7307, 14362), (7219, 14320), (7292, 14395), (7130, 14389), (7170, 14257), (7234, 14251), (7156, 14399)]
         : compromised: 0.5033, honest: 0.4999
Round 007: test acc mean=0.5052 ± 0.0068 | min=0.4950 max=0.5248
         : test loss mean=1.4092 ± 1.4980
         : individual accs = ['0.508853', '0.509659', '0.497056', '0.500668', '0.509341', '0.500731', '0.501952', '0.505163', '0.503918', '0.524803', '0.507808', '0.499161', '0.504668', '0.515736', '0.503561', '0.503786', '0.498714', '0.494985', '0.512946', '0.501146']
         : correct/total = [(7242, 14232), (7255, 14235), (7091, 14266), (7118, 14217), (7252, 14238), (7197, 14373), (7201, 14346), (7241, 14334), (7203, 14294), (7543, 14373), (7284, 14344), (7139, 14302), (7244, 14354), (7407, 14362), (7211, 14320), (7252, 14395), (7176, 14389), (7057, 14257), (7310, 14251), (7216, 14399)]
         : compromised: 0.5052, honest: 0.5053
Round 008: test acc mean=0.5049 ± 0.0088 | min=0.4902 max=0.5204
         : test loss mean=2.4107 ± 3.4441
         : individual accs = ['0.513772', '0.519775', '0.495163', '0.501161', '0.502107', '0.495443', '0.512199', '0.505930', '0.502728', '0.508105', '0.490170', '0.494616', '0.506549', '0.510166', '0.501746', '0.504550', '0.493849', '0.520376', '0.500807', '0.519689']
         : correct/total = [(7312, 14232), (7399, 14235), (7064, 14266), (7125, 14217), (7149, 14238), (7121, 14373), (7348, 14346), (7252, 14334), (7186, 14294), (7303, 14373), (7031, 14344), (7074, 14302), (7271, 14354), (7327, 14362), (7185, 14320), (7263, 14395), (7106, 14389), (7419, 14257), (7137, 14251), (7483, 14399)]
         : compromised: 0.5062, honest: 0.5041
Round 009: test acc mean=0.5030 ± 0.0095 | min=0.4753 max=0.5238
         : test loss mean=1.7534 ± 2.0174
         : individual accs = ['0.510961', '0.510783', '0.508972', '0.505662', '0.503301', '0.497461', '0.499442', '0.501884', '0.513852', '0.507271', '0.495817', '0.504964', '0.475268', '0.492271', '0.503771', '0.500521', '0.494127', '0.505296', '0.523753', '0.504202']
         : correct/total = [(7272, 14232), (7271, 14235), (7261, 14266), (7189, 14217), (7166, 14238), (7150, 14373), (7165, 14346), (7194, 14334), (7345, 14294), (7291, 14373), (7112, 14344), (7222, 14302), (6822, 14354), (7070, 14362), (7214, 14320), (7205, 14395), (7110, 14389), (7204, 14257), (7464, 14251), (7260, 14399)]
         : compromised: 0.5017, honest: 0.5038
Round 010: test acc mean=0.5039 ± 0.0080 | min=0.4898 max=0.5228
         : test loss mean=2.3506 ± 3.0632
         : individual accs = ['0.513983', '0.492237', '0.489836', '0.502708', '0.504706', '0.495025', '0.502858', '0.502860', '0.501819', '0.508801', '0.502998', '0.496224', '0.505364', '0.509748', '0.512011', '0.504828', '0.497950', '0.522761', '0.514981', '0.496771']
         : correct/total = [(7315, 14232), (7007, 14235), (6988, 14266), (7147, 14217), (7186, 14238), (7115, 14373), (7214, 14346), (7208, 14334), (7173, 14294), (7313, 14373), (7215, 14344), (7097, 14302), (7254, 14354), (7321, 14362), (7332, 14320), (7267, 14395), (7165, 14389), (7453, 14257), (7339, 14251), (7153, 14399)]
         : compromised: 0.5060, honest: 0.5025

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: d-fedavg
Attack: directed_deviation, 40.0% compromised
Final accuracy - Compromised: 0.5060, Honest: 0.5025
Overall test accuracy: mean=0.5039 ± 0.0080
