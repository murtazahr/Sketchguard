Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 16/20 nodes: [1, 2, 3, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19]
Attack type: gaussian, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
UBAR ALGORITHM (Two-Stage Byzantine-resilient)
  - Model dimension: 1,174,986 parameters
  - Rho parameter: 0.19999999999999996
  - Stage 1: Distance-based filtering (select 20% closest neighbors)
  - Stage 2: Performance-based selection (loss comparison)
  - Complexity: O(deg(i)×d + deg(i)×inference)
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5350 ± 0.0200 | min=0.5066 max=0.5761
         : test loss mean=0.6911 ± 0.0015
         : individual accs = ['0.544056', '0.525395', '0.534417', '0.509601', '0.513977', '0.530509', '0.529416', '0.576113', '0.514132', '0.543589', '0.517987', '0.551391', '0.572175', '0.509052', '0.506564', '0.554081', '0.542359', '0.524023', '0.545646', '0.556080']
         : correct/total = [(7743, 14232), (7479, 14235), (7624, 14266), (7245, 14217), (7318, 14238), (7625, 14373), (7595, 14346), (8258, 14334), (7349, 14294), (7813, 14373), (7430, 14344), (7886, 14302), (8213, 14354), (7311, 14362), (7254, 14320), (7976, 14395), (7804, 14389), (7471, 14257), (7776, 14251), (8007, 14399)]
         : compromised: 0.5328, honest: 0.5441
         : ubar stats = ['Node 0: s1=0.188, s2=0.333', 'Node 1: s1=0.182, s2=1.000', 'Node 2: s1=0.167, s2=0.500']...
Round 002: test acc mean=0.5569 ± 0.0307 | min=0.5001 max=0.6050
         : test loss mean=0.6889 ± 0.0034
         : individual accs = ['0.590781', '0.500105', '0.577106', '0.563621', '0.556679', '0.520351', '0.534435', '0.589228', '0.553659', '0.582551', '0.544688', '0.605020', '0.587780', '0.513717', '0.500070', '0.588190', '0.559594', '0.554114', '0.580100', '0.537121']
         : correct/total = [(8408, 14232), (7119, 14235), (8233, 14266), (8013, 14217), (7926, 14238), (7479, 14373), (7667, 14346), (8446, 14334), (7914, 14294), (8373, 14373), (7813, 14344), (8653, 14302), (8437, 14354), (7378, 14362), (7161, 14320), (8467, 14395), (8052, 14389), (7900, 14257), (8267, 14251), (7734, 14399)]
         : compromised: 0.5527, honest: 0.5741
         : ubar stats = ['Node 0: s1=0.188, s2=0.333', 'Node 1: s1=0.182, s2=0.750', 'Node 2: s1=0.167, s2=0.500']...
Round 003: test acc mean=0.5476 ± 0.0254 | min=0.4991 max=0.5890
         : test loss mean=0.6878 ± 0.0023
         : individual accs = ['0.557125', '0.531156', '0.578158', '0.541394', '0.573255', '0.499061', '0.514220', '0.553858', '0.556107', '0.550755', '0.542038', '0.588799', '0.589034', '0.527573', '0.510754', '0.560750', '0.570714', '0.554885', '0.540594', '0.511702']
         : correct/total = [(7929, 14232), (7561, 14235), (8248, 14266), (7697, 14217), (8162, 14238), (7173, 14373), (7377, 14346), (7939, 14334), (7949, 14294), (7916, 14373), (7775, 14344), (8421, 14302), (8455, 14354), (7577, 14362), (7314, 14320), (8072, 14395), (8212, 14389), (7911, 14257), (7704, 14251), (7368, 14399)]
         : compromised: 0.5436, honest: 0.5637
         : ubar stats = ['Node 0: s1=0.188, s2=0.333', 'Node 1: s1=0.182, s2=0.833', 'Node 2: s1=0.167, s2=0.667']...
Round 004: test acc mean=0.5774 ± 0.0170 | min=0.5443 max=0.6048
         : test loss mean=0.6847 ± 0.0028
         : individual accs = ['0.586636', '0.581243', '0.589794', '0.551030', '0.592148', '0.547346', '0.566499', '0.583438', '0.589618', '0.574480', '0.570064', '0.599986', '0.604779', '0.572413', '0.544344', '0.589441', '0.586073', '0.583363', '0.584099', '0.551566']
         : correct/total = [(8349, 14232), (8274, 14235), (8414, 14266), (7834, 14217), (8431, 14238), (7867, 14373), (8127, 14346), (8363, 14334), (8428, 14294), (8257, 14373), (8177, 14344), (8581, 14302), (8681, 14354), (8221, 14362), (7795, 14320), (8485, 14395), (8433, 14389), (8317, 14257), (8324, 14251), (7942, 14399)]
         : compromised: 0.5750, honest: 0.5871
         : ubar stats = ['Node 0: s1=0.188, s2=0.500', 'Node 1: s1=0.182, s2=0.875', 'Node 2: s1=0.167, s2=0.750']...
Round 005: test acc mean=0.5966 ± 0.0109 | min=0.5774 max=0.6133
         : test loss mean=0.6777 ± 0.0052
         : individual accs = ['0.603078', '0.607095', '0.591336', '0.606809', '0.610760', '0.578376', '0.605744', '0.606739', '0.613264', '0.577402', '0.578500', '0.593973', '0.590985', '0.604651', '0.582332', '0.601111', '0.597123', '0.601739', '0.590695', '0.591222']
         : correct/total = [(8583, 14232), (8642, 14235), (8436, 14266), (8627, 14217), (8696, 14238), (8313, 14373), (8690, 14346), (8697, 14334), (8766, 14294), (8299, 14373), (8298, 14344), (8495, 14302), (8483, 14354), (8684, 14362), (8339, 14320), (8653, 14395), (8592, 14389), (8579, 14257), (8418, 14251), (8513, 14399)]
         : compromised: 0.5947, honest: 0.6044
         : ubar stats = ['Node 0: s1=0.188, s2=0.600', 'Node 1: s1=0.182, s2=0.800', 'Node 2: s1=0.167, s2=0.800']...
Round 006: test acc mean=0.6072 ± 0.0066 | min=0.5937 max=0.6174
         : test loss mean=0.6666 ± 0.0048
         : individual accs = ['0.610736', '0.615455', '0.605355', '0.614124', '0.611533', '0.607806', '0.612575', '0.611483', '0.609347', '0.603075', '0.610151', '0.603692', '0.608472', '0.617393', '0.593715', '0.601945', '0.606227', '0.611349', '0.595116', '0.595180']
         : correct/total = [(8692, 14232), (8761, 14235), (8636, 14266), (8731, 14217), (8707, 14238), (8736, 14373), (8788, 14346), (8765, 14334), (8710, 14294), (8668, 14373), (8752, 14344), (8634, 14302), (8734, 14354), (8867, 14362), (8502, 14320), (8665, 14395), (8723, 14389), (8716, 14257), (8481, 14251), (8570, 14399)]
         : compromised: 0.6065, honest: 0.6100
         : ubar stats = ['Node 0: s1=0.188, s2=0.667', 'Node 1: s1=0.182, s2=0.750', 'Node 2: s1=0.167, s2=0.750']...
Round 007: test acc mean=0.6186 ± 0.0042 | min=0.6096 max=0.6261
         : test loss mean=0.6553 ± 0.0027
         : individual accs = ['0.626124', '0.622269', '0.616010', '0.620947', '0.624034', '0.616086', '0.622194', '0.621320', '0.623688', '0.617616', '0.618028', '0.615648', '0.616205', '0.621362', '0.609637', '0.613755', '0.617833', '0.619696', '0.611536', '0.617196']
         : correct/total = [(8911, 14232), (8858, 14235), (8788, 14266), (8828, 14217), (8885, 14238), (8855, 14373), (8926, 14346), (8906, 14334), (8915, 14294), (8877, 14373), (8865, 14344), (8805, 14302), (8845, 14354), (8924, 14362), (8730, 14320), (8835, 14395), (8890, 14389), (8835, 14257), (8715, 14251), (8887, 14399)]
         : compromised: 0.6176, honest: 0.6223
         : ubar stats = ['Node 0: s1=0.188, s2=0.619', 'Node 1: s1=0.182, s2=0.714', 'Node 2: s1=0.167, s2=0.786']...
Round 008: test acc mean=0.6259 ± 0.0040 | min=0.6182 max=0.6330
         : test loss mean=0.6483 ± 0.0024
         : individual accs = ['0.633010', '0.627749', '0.620286', '0.630020', '0.628459', '0.621930', '0.629583', '0.628296', '0.630334', '0.621234', '0.628416', '0.620962', '0.628884', '0.627141', '0.618226', '0.623411', '0.622072', '0.627411', '0.623325', '0.626363']
         : correct/total = [(9009, 14232), (8936, 14235), (8849, 14266), (8957, 14217), (8948, 14238), (8939, 14373), (9032, 14346), (9006, 14334), (9010, 14294), (8929, 14373), (9014, 14344), (8881, 14302), (9027, 14354), (9007, 14362), (8853, 14320), (8974, 14395), (8951, 14389), (8945, 14257), (8883, 14251), (9019, 14399)]
         : compromised: 0.6253, honest: 0.6280
         : ubar stats = ['Node 0: s1=0.188, s2=0.583', 'Node 1: s1=0.182, s2=0.688', 'Node 2: s1=0.167, s2=0.812']...
Round 009: test acc mean=0.6323 ± 0.0038 | min=0.6247 max=0.6406
         : test loss mean=0.6429 ± 0.0020
         : individual accs = ['0.640599', '0.632666', '0.626805', '0.637125', '0.632252', '0.627913', '0.635160', '0.633459', '0.631804', '0.634801', '0.636921', '0.634387', '0.634875', '0.633616', '0.624721', '0.632581', '0.629856', '0.629936', '0.628166', '0.628238']
         : correct/total = [(9117, 14232), (9006, 14235), (8942, 14266), (9058, 14217), (9002, 14238), (9025, 14373), (9112, 14346), (9080, 14334), (9031, 14294), (9124, 14373), (9136, 14344), (9073, 14302), (9113, 14354), (9100, 14362), (8946, 14320), (9106, 14395), (9063, 14389), (8981, 14257), (8952, 14251), (9046, 14399)]
         : compromised: 0.6319, honest: 0.6340
         : ubar stats = ['Node 0: s1=0.188, s2=0.630', 'Node 1: s1=0.182, s2=0.667', 'Node 2: s1=0.167, s2=0.778']...
Round 010: test acc mean=0.6365 ± 0.0035 | min=0.6289 max=0.6436
         : test loss mean=0.6395 ± 0.0021
         : individual accs = ['0.640458', '0.642150', '0.633324', '0.638672', '0.639978', '0.633688', '0.634184', '0.634366', '0.634602', '0.639254', '0.643614', '0.636694', '0.637801', '0.638490', '0.628911', '0.637096', '0.632984', '0.634846', '0.634201', '0.633725']
         : correct/total = [(9115, 14232), (9141, 14235), (9035, 14266), (9080, 14217), (9112, 14238), (9108, 14373), (9098, 14346), (9093, 14334), (9071, 14294), (9188, 14373), (9232, 14344), (9106, 14302), (9155, 14354), (9170, 14362), (9006, 14320), (9171, 14395), (9108, 14389), (9051, 14257), (9038, 14251), (9125, 14399)]
         : compromised: 0.6363, honest: 0.6369
         : ubar stats = ['Node 0: s1=0.188, s2=0.633', 'Node 1: s1=0.182, s2=0.650', 'Node 2: s1=0.167, s2=0.750']...

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: ubar
Attack: gaussian, 80.0% compromised
Final accuracy - Compromised: 0.6363, Honest: 0.6369
Overall test accuracy: mean=0.6365 ± 0.0035

=== UBAR SUMMARY ===
Node 0: stage1=0.188, stage2=0.633, overall=0.119
Node 1: stage1=0.182, stage2=0.650, overall=0.118
Node 2: stage1=0.167, stage2=0.750, overall=0.125
Node 3: stage1=0.125, stage2=1.000, overall=0.125
Node 4: stage1=0.182, stage2=0.700, overall=0.127
Node 5: stage1=0.133, stage2=0.850, overall=0.113
Node 6: stage1=0.143, stage2=0.600, overall=0.086
Node 7: stage1=0.143, stage2=0.800, overall=0.114
Node 8: stage1=0.100, stage2=1.000, overall=0.100
Node 9: stage1=0.154, stage2=0.650, overall=0.100
Node 10: stage1=0.111, stage2=1.000, overall=0.111
Node 11: stage1=0.143, stage2=0.650, overall=0.093
Node 12: stage1=0.167, stage2=0.700, overall=0.117
Node 13: stage1=0.154, stage2=0.800, overall=0.123
Node 14: stage1=0.133, stage2=0.950, overall=0.127
Node 15: stage1=0.182, stage2=0.600, overall=0.109
Node 16: stage1=0.154, stage2=0.750, overall=0.115
Node 17: stage1=0.111, stage2=1.000, overall=0.111
Node 18: stage1=0.188, stage2=0.633, overall=0.119
Node 19: stage1=0.188, stage2=0.900, overall=0.169

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Distance computation: 0.080s (76.5%)
    - Loss computation: 0.019s (18.0%)
    - Aggregation: 0.006s (5.5%)
  TOTALS:
    - Total computation: 0.105s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.105s

=== PER-NODE AVERAGE TIME ===
  - Distance computation: 0.051s
  - Loss computation: 0.011s
  - Aggregation: 0.004s
  - Model transfer: 0.000s
  - Total per node: 0.066s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total distance computation: 1.024s
  - Total loss computation: 0.226s
  - Total aggregation: 0.079s
  - Total model transfer: 0.000s
  - Grand total: 1.329s
  - Mean Stage 1 acceptance rate: 0.152
  - Mean Stage 2 acceptance rate: 0.781
  - Overall acceptance rate: 0.119

UBAR Algorithm Properties:
  - Model dimension: 1,174,986
  - Rho parameter: 0.19999999999999996
  - Two-stage approach: Distance filtering + loss evaluation
  - Stage 1 selects: 20% of neighbors
  - Stage 2 uses: Training sample loss comparison
  - Theoretical complexity: O(deg(i)×d + deg(i)×inference)
  - Approach: UBAR paper implementation
