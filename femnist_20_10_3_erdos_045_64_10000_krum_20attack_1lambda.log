Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.0514 ± 0.0042 | min=0.0453 max=0.0618
         : test loss mean=3.6913 ± 0.0178
         : individual accs = ['0.051599', '0.052344', '0.048272', '0.048465', '0.045710', '0.045253', '0.049130', '0.051276', '0.047960', '0.053776', '0.050447', '0.061770', '0.053750', '0.046938', '0.048124', '0.056342', '0.058271', '0.050203', '0.052889', '0.055475']
         : correct/total = [(213, 4128), (220, 4203), (197, 4081), (210, 4333), (187, 4091), (194, 4287), (206, 4193), (223, 4349), (201, 4191), (230, 4277), (209, 4143), (259, 4193), (220, 4093), (197, 4197), (195, 4052), (227, 4029), (242, 4153), (210, 4183), (216, 4084), (229, 4128)]
         : compromised: 0.0490, honest: 0.0520
Round 002: test acc mean=0.0689 ± 0.0225 | min=0.0448 max=0.0997
         : test loss mean=3.6830 ± 0.0163
         : individual accs = ['0.050145', '0.048775', '0.045087', '0.044773', '0.047421', '0.048752', '0.087765', '0.094504', '0.047960', '0.050736', '0.047309', '0.093489', '0.099682', '0.097212', '0.092053', '0.093075', '0.054418', '0.050920', '0.093536', '0.090359']
         : correct/total = [(207, 4128), (205, 4203), (184, 4081), (194, 4333), (194, 4091), (209, 4287), (368, 4193), (411, 4349), (201, 4191), (217, 4277), (196, 4143), (392, 4193), (408, 4093), (408, 4197), (373, 4052), (375, 4029), (226, 4153), (213, 4183), (382, 4084), (373, 4128)]
         : compromised: 0.0741, honest: 0.0676
Round 003: test acc mean=0.0700 ± 0.0117 | min=0.0484 max=0.0913
         : test loss mean=3.6778 ± 0.0159
         : individual accs = ['0.058140', '0.075422', '0.067630', '0.068775', '0.059888', '0.070912', '0.091343', '0.083697', '0.060845', '0.071545', '0.063481', '0.063916', '0.080625', '0.075054', '0.080454', '0.050633', '0.087647', '0.059049', '0.082027', '0.048450']
         : correct/total = [(240, 4128), (317, 4203), (276, 4081), (298, 4333), (245, 4091), (304, 4287), (383, 4193), (364, 4349), (255, 4191), (306, 4277), (263, 4143), (268, 4193), (330, 4093), (315, 4197), (326, 4052), (204, 4029), (364, 4153), (247, 4183), (335, 4084), (200, 4128)]
         : compromised: 0.0714, honest: 0.0696
Round 004: test acc mean=0.0894 ± 0.0304 | min=0.0496 max=0.1517
         : test loss mean=3.6694 ± 0.0158
         : individual accs = ['0.117975', '0.109208', '0.057584', '0.059081', '0.057932', '0.109167', '0.105175', '0.115889', '0.049630', '0.063128', '0.055998', '0.059623', '0.089421', '0.069097', '0.088105', '0.151651', '0.114134', '0.109730', '0.063663', '0.141957']
         : correct/total = [(487, 4128), (459, 4203), (235, 4081), (256, 4333), (237, 4091), (468, 4287), (441, 4193), (504, 4349), (208, 4191), (270, 4277), (232, 4143), (250, 4193), (366, 4093), (290, 4197), (357, 4052), (611, 4029), (474, 4153), (459, 4183), (260, 4084), (586, 4128)]
         : compromised: 0.0944, honest: 0.0882
Round 005: test acc mean=0.1014 ± 0.0355 | min=0.0579 max=0.1665
         : test loss mean=3.6587 ± 0.0172
         : individual accs = ['0.069767', '0.122056', '0.074001', '0.062774', '0.117820', '0.123163', '0.067732', '0.068521', '0.124075', '0.063596', '0.161236', '0.125209', '0.131688', '0.166548', '0.076259', '0.070241', '0.070551', '0.147502', '0.128061', '0.057897']
         : correct/total = [(288, 4128), (513, 4203), (302, 4081), (272, 4333), (482, 4091), (528, 4287), (284, 4193), (298, 4349), (520, 4191), (272, 4277), (668, 4143), (525, 4193), (539, 4093), (699, 4197), (309, 4052), (283, 4029), (293, 4153), (617, 4183), (523, 4084), (239, 4128)]
         : compromised: 0.1422, honest: 0.0912
Round 006: test acc mean=0.1002 ± 0.0299 | min=0.0434 max=0.1517
         : test loss mean=3.6417 ± 0.0171
         : individual accs = ['0.072190', '0.087319', '0.151679', '0.132703', '0.045710', '0.043387', '0.101359', '0.094045', '0.054880', '0.136778', '0.110548', '0.097782', '0.095040', '0.097927', '0.104640', '0.100769', '0.096797', '0.142003', '0.096229', '0.141473']
         : correct/total = [(298, 4128), (367, 4203), (619, 4081), (575, 4333), (187, 4091), (186, 4287), (425, 4193), (409, 4349), (230, 4191), (585, 4277), (458, 4143), (410, 4193), (389, 4093), (411, 4197), (424, 4052), (406, 4029), (402, 4153), (594, 4183), (393, 4084), (584, 4128)]
         : compromised: 0.0946, honest: 0.1016
Round 007: test acc mean=0.1430 ± 0.0532 | min=0.0896 max=0.2806
         : test loss mean=3.6017 ± 0.0190
         : individual accs = ['0.114826', '0.195813', '0.280568', '0.123702', '0.092642', '0.092139', '0.188171', '0.094504', '0.121689', '0.093056', '0.131306', '0.118292', '0.203030', '0.194901', '0.203850', '0.104492', '0.201782', '0.089649', '0.095250', '0.120155']
         : correct/total = [(474, 4128), (823, 4203), (1145, 4081), (536, 4333), (379, 4091), (395, 4287), (789, 4193), (411, 4349), (510, 4191), (398, 4277), (544, 4143), (496, 4193), (831, 4093), (818, 4197), (826, 4052), (421, 4029), (838, 4153), (375, 4183), (389, 4084), (496, 4128)]
         : compromised: 0.1449, honest: 0.1425
Round 008: test acc mean=0.2003 ± 0.0245 | min=0.1472 max=0.2512
         : test loss mean=3.5122 ± 0.0210
         : individual accs = ['0.187258', '0.237449', '0.201176', '0.173321', '0.191885', '0.229998', '0.181254', '0.187169', '0.186590', '0.177461', '0.147236', '0.191033', '0.215001', '0.239218', '0.194965', '0.251179', '0.190465', '0.205355', '0.209843', '0.208091']
         : correct/total = [(773, 4128), (998, 4203), (821, 4081), (751, 4333), (785, 4091), (986, 4287), (760, 4193), (814, 4349), (782, 4191), (759, 4277), (610, 4143), (801, 4193), (880, 4093), (1004, 4197), (790, 4052), (1012, 4029), (791, 4153), (859, 4183), (857, 4084), (859, 4128)]
         : compromised: 0.2224, honest: 0.1948
Round 009: test acc mean=0.2644 ± 0.0206 | min=0.2180 max=0.2921
         : test loss mean=3.2751 ± 0.0279
         : individual accs = ['0.272529', '0.270759', '0.289880', '0.246711', '0.281838', '0.268719', '0.259719', '0.244884', '0.220234', '0.258359', '0.263336', '0.274982', '0.280479', '0.271146', '0.275913', '0.284438', '0.292078', '0.237628', '0.276445', '0.218023']
         : correct/total = [(1125, 4128), (1138, 4203), (1183, 4081), (1069, 4333), (1153, 4091), (1152, 4287), (1089, 4193), (1065, 4349), (923, 4191), (1105, 4277), (1091, 4143), (1153, 4193), (1148, 4093), (1138, 4197), (1118, 4052), (1146, 4029), (1213, 4153), (994, 4183), (1129, 4084), (900, 4128)]
         : compromised: 0.2645, honest: 0.2644
Round 010: test acc mean=0.3388 ± 0.0193 | min=0.3067 max=0.3746
         : test loss mean=2.8693 ± 0.0375
         : individual accs = ['0.333333', '0.331668', '0.347954', '0.333026', '0.349059', '0.347796', '0.313618', '0.367901', '0.309473', '0.346738', '0.323196', '0.336275', '0.334718', '0.321897', '0.374630', '0.373542', '0.358777', '0.325604', '0.340597', '0.306686']
         : correct/total = [(1376, 4128), (1394, 4203), (1420, 4081), (1443, 4333), (1428, 4091), (1491, 4287), (1315, 4193), (1600, 4349), (1297, 4191), (1483, 4277), (1339, 4143), (1410, 4193), (1370, 4093), (1351, 4197), (1518, 4052), (1505, 4029), (1490, 4153), (1362, 4183), (1391, 4084), (1266, 4128)]
         : compromised: 0.3325, honest: 0.3404

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 20.0% compromised
Final accuracy - Compromised: 0.3325, Honest: 0.3404
Overall test accuracy: mean=0.3388 ± 0.0193
