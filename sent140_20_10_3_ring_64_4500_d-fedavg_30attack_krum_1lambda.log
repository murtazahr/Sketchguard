Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5101 ± 0.0173 | min=0.4882 max=0.5652
         : test loss mean=5.0072 ± 6.7878
         : individual accs = ['0.534992', '0.565227', '0.488224', '0.512415', '0.510395', '0.505183', '0.506483', '0.524766', '0.502169', '0.533779', '0.502022', '0.508880', '0.503623', '0.509121', '0.491760', '0.500243', '0.495865', '0.502209', '0.496667', '0.507535']
         : correct/total = [(7614, 14232), (8046, 14235), (6965, 14266), (7285, 14217), (7267, 14238), (7261, 14373), (7266, 14346), (7522, 14334), (7178, 14294), (7672, 14373), (7201, 14344), (7278, 14302), (7229, 14354), (7312, 14362), (7042, 14320), (7201, 14395), (7135, 14389), (7160, 14257), (7078, 14251), (7308, 14399)]
         : compromised: 0.5014, honest: 0.5138
Round 002: test acc mean=0.5192 ± 0.0475 | min=0.4874 max=0.6367
         : test loss mean=4.9862 ± 5.9953
         : individual accs = ['0.491428', '0.636740', '0.628207', '0.515088', '0.494522', '0.494330', '0.502440', '0.494977', '0.512873', '0.628053', '0.501394', '0.499161', '0.503414', '0.506893', '0.495182', '0.504411', '0.495031', '0.487410', '0.495965', '0.495729']
         : correct/total = [(6994, 14232), (9064, 14235), (8962, 14266), (7323, 14217), (7041, 14238), (7105, 14373), (7208, 14346), (7095, 14334), (7331, 14294), (9027, 14373), (7192, 14344), (7139, 14302), (7226, 14354), (7280, 14362), (7091, 14320), (7261, 14395), (7123, 14389), (6949, 14257), (7068, 14251), (7138, 14399)]
         : compromised: 0.4972, honest: 0.5286
Round 003: test acc mean=0.5209 ± 0.0407 | min=0.4908 max=0.6236
         : test loss mean=1.7833 ± 2.4388
         : individual accs = ['0.517355', '0.616579', '0.607739', '0.506717', '0.515943', '0.498017', '0.502300', '0.493233', '0.498181', '0.623600', '0.498954', '0.505594', '0.504807', '0.490809', '0.516760', '0.493852', '0.500869', '0.513502', '0.509648', '0.502743']
         : correct/total = [(7363, 14232), (8777, 14235), (8670, 14266), (7204, 14217), (7346, 14238), (7158, 14373), (7206, 14346), (7070, 14334), (7121, 14294), (8963, 14373), (7157, 14344), (7231, 14302), (7246, 14354), (7049, 14362), (7400, 14320), (7109, 14395), (7207, 14389), (7321, 14257), (7263, 14251), (7239, 14399)]
         : compromised: 0.5056, honest: 0.5274
Round 004: test acc mean=0.5160 ± 0.0343 | min=0.4828 max=0.6227
         : test loss mean=2.4817 ± 3.0853
         : individual accs = ['0.534992', '0.622691', '0.587200', '0.518253', '0.496418', '0.498852', '0.505089', '0.503139', '0.498531', '0.560008', '0.498606', '0.490771', '0.496308', '0.511489', '0.494344', '0.506843', '0.512127', '0.500736', '0.499895', '0.482811']
         : correct/total = [(7614, 14232), (8864, 14235), (8377, 14266), (7368, 14217), (7068, 14238), (7170, 14373), (7246, 14346), (7212, 14334), (7126, 14294), (8049, 14373), (7152, 14344), (7019, 14302), (7124, 14354), (7346, 14362), (7079, 14320), (7296, 14395), (7369, 14389), (7139, 14257), (7124, 14251), (6952, 14399)]
         : compromised: 0.5003, honest: 0.5227
Round 005: test acc mean=0.5278 ± 0.0523 | min=0.4876 max=0.6335
         : test loss mean=2.8482 ± 4.6024
         : individual accs = ['0.493044', '0.633509', '0.630310', '0.487585', '0.501334', '0.495999', '0.495190', '0.533766', '0.627046', '0.632853', '0.507250', '0.504475', '0.498467', '0.494221', '0.504120', '0.501146', '0.504761', '0.503682', '0.509648', '0.497951']
         : correct/total = [(7017, 14232), (9018, 14235), (8992, 14266), (6932, 14217), (7138, 14238), (7129, 14373), (7104, 14346), (7651, 14334), (8963, 14294), (9096, 14373), (7276, 14344), (7215, 14302), (7155, 14354), (7098, 14362), (7219, 14320), (7214, 14395), (7263, 14389), (7181, 14257), (7263, 14251), (7170, 14399)]
         : compromised: 0.5010, honest: 0.5393
Round 006: test acc mean=0.5359 ± 0.0523 | min=0.4917 max=0.6326
         : test loss mean=1.9846 ± 2.7052
         : individual accs = ['0.579188', '0.629856', '0.631291', '0.596610', '0.503020', '0.506505', '0.502300', '0.520162', '0.610676', '0.632575', '0.511015', '0.495245', '0.504528', '0.506475', '0.491690', '0.498229', '0.493224', '0.495897', '0.501017', '0.508994']
         : correct/total = [(8243, 14232), (8966, 14235), (9006, 14266), (8482, 14217), (7162, 14238), (7280, 14373), (7206, 14346), (7456, 14334), (8729, 14294), (9092, 14373), (7330, 14344), (7083, 14302), (7242, 14354), (7274, 14362), (7041, 14320), (7172, 14395), (7097, 14389), (7070, 14257), (7140, 14251), (7329, 14399)]
         : compromised: 0.5010, honest: 0.5509
Round 007: test acc mean=0.5310 ± 0.0522 | min=0.4851 max=0.6468
         : test loss mean=2.8181 ± 3.9059
         : individual accs = ['0.503935', '0.646786', '0.635637', '0.485123', '0.505057', '0.504140', '0.500906', '0.509069', '0.629145', '0.623252', '0.529281', '0.506013', '0.499025', '0.492550', '0.507612', '0.516707', '0.510737', '0.504103', '0.509298', '0.501146']
         : correct/total = [(7172, 14232), (9207, 14235), (9068, 14266), (6897, 14217), (7191, 14238), (7246, 14373), (7186, 14346), (7297, 14334), (8993, 14294), (8958, 14373), (7592, 14344), (7237, 14302), (7163, 14354), (7074, 14362), (7269, 14320), (7438, 14395), (7349, 14389), (7187, 14257), (7258, 14251), (7216, 14399)]
         : compromised: 0.5028, honest: 0.5431
Round 008: test acc mean=0.5320 ± 0.0535 | min=0.4911 max=0.6405
         : test loss mean=2.3215 ± 3.0981
         : individual accs = ['0.533938', '0.623674', '0.632062', '0.522895', '0.493047', '0.493564', '0.496863', '0.574648', '0.632293', '0.640507', '0.500906', '0.496714', '0.503692', '0.510444', '0.491131', '0.503994', '0.502954', '0.492390', '0.497860', '0.496284']
         : correct/total = [(7599, 14232), (8878, 14235), (9017, 14266), (7434, 14217), (7020, 14238), (7094, 14373), (7128, 14346), (8237, 14334), (9038, 14294), (9206, 14373), (7185, 14344), (7104, 14302), (7230, 14354), (7331, 14362), (7033, 14320), (7255, 14395), (7237, 14389), (7020, 14257), (7095, 14251), (7146, 14399)]
         : compromised: 0.4982, honest: 0.5465
Round 009: test acc mean=0.5342 ± 0.0520 | min=0.4909 max=0.6499
         : test loss mean=3.0412 ± 4.8765
         : individual accs = ['0.542229', '0.649877', '0.645871', '0.495182', '0.504144', '0.505462', '0.493308', '0.530906', '0.607248', '0.621791', '0.564208', '0.495945', '0.502856', '0.490948', '0.512360', '0.507259', '0.504900', '0.507751', '0.502351', '0.499618']
         : correct/total = [(7717, 14232), (9251, 14235), (9214, 14266), (7040, 14217), (7178, 14238), (7265, 14373), (7077, 14346), (7610, 14334), (8680, 14294), (8937, 14373), (8093, 14344), (7093, 14302), (7218, 14354), (7051, 14362), (7337, 14320), (7302, 14395), (7265, 14389), (7239, 14257), (7159, 14251), (7194, 14399)]
         : compromised: 0.5036, honest: 0.5473
Round 010: test acc mean=0.5373 ± 0.0588 | min=0.4901 max=0.6575
         : test loss mean=2.1133 ± 3.2466
         : individual accs = ['0.543985', '0.657534', '0.652110', '0.547936', '0.494943', '0.495860', '0.493657', '0.542626', '0.636141', '0.651847', '0.528723', '0.490071', '0.506409', '0.505849', '0.494693', '0.512747', '0.500382', '0.495686', '0.493860', '0.500938']
         : correct/total = [(7742, 14232), (9360, 14235), (9303, 14266), (7790, 14217), (7047, 14238), (7127, 14373), (7082, 14346), (7778, 14334), (9093, 14294), (9369, 14373), (7584, 14344), (7009, 14302), (7269, 14354), (7265, 14362), (7084, 14320), (7381, 14395), (7200, 14389), (7067, 14257), (7038, 14251), (7213, 14399)]
         : compromised: 0.4987, honest: 0.5538

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: d-fedavg
Attack: krum, 30.0% compromised
Final accuracy - Compromised: 0.4987, Honest: 0.5538
Overall test accuracy: mean=0.5373 ± 0.0588
