Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Attack: Compromised 10/20 nodes: [1, 2, 5, 11, 12, 13, 14, 15, 17, 18]
Attack type: directed_deviation, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4983 ± 0.0345 | min=0.4467 max=0.5570
         : test loss mean=3.7481 ± 0.0250
         : individual accs = ['0.546512', '0.499167', '0.521931', '0.515117', '0.466879', '0.557033', '0.478893', '0.497586', '0.523503', '0.455226', '0.457157', '0.538040', '0.460298', '0.465094', '0.506663', '0.526433', '0.454370', '0.542912', '0.505877', '0.446705']
         : correct/total = [(2256, 4128), (2098, 4203), (2130, 4081), (2232, 4333), (1910, 4091), (2388, 4287), (2008, 4193), (2164, 4349), (2194, 4191), (1947, 4277), (1894, 4143), (2256, 4193), (1884, 4093), (1952, 4197), (2053, 4052), (2121, 4029), (1887, 4153), (2271, 4183), (2066, 4084), (1844, 4128)]
         : compromised: 0.5123, honest: 0.4842
Round 002: test acc mean=0.6713 ± 0.0226 | min=0.6098 max=0.7047
         : test loss mean=3.4066 ± 0.0771
         : individual accs = ['0.681686', '0.670711', '0.660132', '0.695361', '0.683207', '0.698857', '0.609826', '0.685215', '0.646624', '0.704700', '0.658219', '0.678512', '0.680430', '0.665952', '0.698914', '0.674113', '0.637130', '0.650729', '0.679726', '0.665698']
         : correct/total = [(2814, 4128), (2819, 4203), (2694, 4081), (3013, 4333), (2795, 4091), (2996, 4287), (2557, 4193), (2980, 4349), (2710, 4191), (3014, 4277), (2727, 4143), (2845, 4193), (2785, 4093), (2795, 4197), (2832, 4052), (2716, 4029), (2646, 4153), (2722, 4183), (2776, 4084), (2748, 4128)]
         : compromised: 0.6758, honest: 0.6668
Round 003: test acc mean=0.6780 ± 0.0291 | min=0.6254 max=0.7376
         : test loss mean=2.9999 ± 0.1908
         : individual accs = ['0.709787', '0.657626', '0.644205', '0.737595', '0.681252', '0.627945', '0.704746', '0.717176', '0.709139', '0.680617', '0.661115', '0.667541', '0.691913', '0.667143', '0.697433', '0.650534', '0.687214', '0.625388', '0.658668', '0.683140']
         : correct/total = [(2930, 4128), (2764, 4203), (2629, 4081), (3196, 4333), (2787, 4091), (2692, 4287), (2955, 4193), (3119, 4349), (2972, 4191), (2911, 4277), (2739, 4143), (2799, 4193), (2832, 4093), (2800, 4197), (2826, 4052), (2621, 4029), (2854, 4153), (2616, 4183), (2690, 4084), (2820, 4128)]
         : compromised: 0.6588, honest: 0.6972
Round 004: test acc mean=0.6589 ± 0.0468 | min=0.5759 max=0.7222
         : test loss mean=2.2065 ± 0.2545
         : individual accs = ['0.681686', '0.617892', '0.576819', '0.713363', '0.718162', '0.606951', '0.717386', '0.722235', '0.719876', '0.685761', '0.643254', '0.637014', '0.575861', '0.661663', '0.679171', '0.656242', '0.683121', '0.590963', '0.635651', '0.655766']
         : correct/total = [(2814, 4128), (2597, 4203), (2354, 4081), (3091, 4333), (2938, 4091), (2602, 4287), (3008, 4193), (3141, 4349), (3017, 4191), (2933, 4277), (2665, 4143), (2671, 4193), (2357, 4093), (2777, 4197), (2752, 4052), (2644, 4029), (2837, 4153), (2472, 4183), (2596, 4084), (2707, 4128)]
         : compromised: 0.6238, honest: 0.6941
Round 005: test acc mean=0.7197 ± 0.0318 | min=0.6505 max=0.7595
         : test loss mean=1.2922 ± 0.1689
         : individual accs = ['0.734738', '0.650488', '0.681696', '0.740595', '0.731606', '0.724283', '0.751014', '0.759485', '0.755667', '0.753566', '0.717113', '0.708085', '0.698021', '0.711937', '0.712241', '0.689749', '0.758969', '0.651685', '0.724535', '0.738372']
         : correct/total = [(3033, 4128), (2734, 4203), (2782, 4081), (3209, 4333), (2993, 4091), (3105, 4287), (3149, 4193), (3303, 4349), (3167, 4191), (3223, 4277), (2971, 4143), (2969, 4193), (2857, 4093), (2988, 4197), (2886, 4052), (2779, 4029), (3152, 4153), (2726, 4183), (2959, 4084), (3048, 4128)]
         : compromised: 0.6953, honest: 0.7441
Round 006: test acc mean=0.8002 ± 0.0077 | min=0.7861 max=0.8134
         : test loss mean=0.6994 ± 0.0350
         : individual accs = ['0.789486', '0.794195', '0.797109', '0.802216', '0.786116', '0.803126', '0.803482', '0.812601', '0.813410', '0.810615', '0.795800', '0.791319', '0.794772', '0.802478', '0.809477', '0.803922', '0.807368', '0.798470', '0.795544', '0.792151']
         : correct/total = [(3259, 4128), (3338, 4203), (3253, 4081), (3476, 4333), (3216, 4091), (3443, 4287), (3369, 4193), (3534, 4349), (3409, 4191), (3467, 4277), (3297, 4143), (3318, 4193), (3253, 4093), (3368, 4197), (3280, 4052), (3239, 4029), (3353, 4153), (3340, 4183), (3249, 4084), (3270, 4128)]
         : compromised: 0.7990, honest: 0.8013
Round 007: test acc mean=0.8251 ± 0.0060 | min=0.8156 max=0.8342
         : test loss mean=0.5561 ± 0.0212
         : individual accs = ['0.816860', '0.833690', '0.821367', '0.829910', '0.817160', '0.819687', '0.831624', '0.832145', '0.834168', '0.829320', '0.815593', '0.821607', '0.817005', '0.828449', '0.829961', '0.827749', '0.824705', '0.822615', '0.828355', '0.820736']
         : correct/total = [(3372, 4128), (3504, 4203), (3352, 4081), (3596, 4333), (3343, 4091), (3514, 4287), (3487, 4193), (3619, 4349), (3496, 4191), (3547, 4277), (3379, 4143), (3445, 4193), (3344, 4093), (3477, 4197), (3363, 4052), (3335, 4029), (3425, 4153), (3441, 4183), (3383, 4084), (3388, 4128)]
         : compromised: 0.8250, honest: 0.8252
Round 008: test acc mean=0.8315 ± 0.0067 | min=0.8137 max=0.8416
         : test loss mean=0.5153 ± 0.0200
         : individual accs = ['0.824370', '0.833690', '0.825288', '0.841219', '0.828159', '0.840215', '0.831624', '0.835364', '0.834407', '0.833528', '0.822834', '0.834248', '0.826533', '0.831546', '0.841560', '0.836932', '0.827835', '0.830983', '0.836925', '0.813711']
         : correct/total = [(3403, 4128), (3504, 4203), (3368, 4081), (3645, 4333), (3388, 4091), (3602, 4287), (3487, 4193), (3633, 4349), (3497, 4191), (3565, 4277), (3409, 4143), (3498, 4193), (3383, 4093), (3490, 4197), (3410, 4052), (3372, 4029), (3438, 4153), (3476, 4183), (3418, 4084), (3359, 4128)]
         : compromised: 0.8338, honest: 0.8293
Round 009: test acc mean=0.8425 ± 0.0060 | min=0.8323 max=0.8552
         : test loss mean=0.4815 ± 0.0184
         : individual accs = ['0.832849', '0.851059', '0.840970', '0.843065', '0.832315', '0.846046', '0.849273', '0.848931', '0.855166', '0.849427', '0.839006', '0.840925', '0.835817', '0.837503', '0.845262', '0.844875', '0.838189', '0.841023', '0.841087', '0.837452']
         : correct/total = [(3438, 4128), (3577, 4203), (3432, 4081), (3653, 4333), (3405, 4091), (3627, 4287), (3561, 4193), (3692, 4349), (3584, 4191), (3633, 4277), (3476, 4143), (3526, 4193), (3421, 4093), (3515, 4197), (3425, 4052), (3404, 4029), (3481, 4153), (3518, 4183), (3435, 4084), (3457, 4128)]
         : compromised: 0.8425, honest: 0.8426
Round 010: test acc mean=0.8471 ± 0.0057 | min=0.8354 max=0.8565
         : test loss mean=0.4639 ± 0.0195
         : individual accs = ['0.838663', '0.856531', '0.841460', '0.850681', '0.838426', '0.843947', '0.851896', '0.853070', '0.851825', '0.851765', '0.835385', '0.842356', '0.844857', '0.850131', '0.849704', '0.854306', '0.845172', '0.849629', '0.849412', '0.843023']
         : correct/total = [(3462, 4128), (3600, 4203), (3434, 4081), (3686, 4333), (3430, 4091), (3618, 4287), (3572, 4193), (3710, 4349), (3570, 4191), (3643, 4277), (3461, 4143), (3532, 4193), (3458, 4093), (3568, 4197), (3443, 4052), (3442, 4029), (3510, 4153), (3554, 4183), (3469, 4084), (3480, 4128)]
         : compromised: 0.8482, honest: 0.8460

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: balance
Attack: directed_deviation, 50.0% compromised
Final accuracy - Compromised: 0.8482, Honest: 0.8460
Overall test accuracy: mean=0.8471 ± 0.0057

=== BALANCE SUMMARY ===
Node 0: acceptance=0.474
Node 1: acceptance=0.526
Node 2: acceptance=0.526
Node 3: acceptance=0.474
Node 4: acceptance=0.474
Node 5: acceptance=0.526
Node 6: acceptance=0.474
Node 7: acceptance=0.474
Node 8: acceptance=0.474
Node 9: acceptance=0.474
Node 10: acceptance=0.474
Node 11: acceptance=0.526
Node 12: acceptance=0.526
Node 13: acceptance=0.526
Node 14: acceptance=0.526
Node 15: acceptance=0.526
Node 16: acceptance=0.474
Node 17: acceptance=0.526
Node 18: acceptance=0.526
Node 19: acceptance=0.474

Performance Summary:
  - Distance computation time: 1.540s (45.8%)
  - Filtering time: 1.638s (48.8%)
  - Aggregation time: 0.181s (5.4%)
  - Total time: 3.359s
  - Mean acceptance rate: 0.500

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
