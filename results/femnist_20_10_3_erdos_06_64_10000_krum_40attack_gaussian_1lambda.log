Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: gaussian, lambda: 1.0
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.5000 ± 0.1593 | min=0.0050 max=0.5860
         : test loss mean=1565227.1598 ± 4718001.8548
         : individual accs = ['0.562016', '0.564121', '0.531977', '0.555504', '0.553899', '0.578260', '0.534701', '0.556450', '0.586018', '0.540566', '0.045378', '0.563081', '0.553872', '0.524422', '0.566140', '0.554480', '0.525644', '0.005020', '0.573213', '0.524952']
         : correct/total = [(2320, 4128), (2371, 4203), (2171, 4081), (2407, 4333), (2266, 4091), (2479, 4287), (2242, 4193), (2420, 4349), (2456, 4191), (2312, 4277), (188, 4143), (2361, 4193), (2267, 4093), (2201, 4197), (2294, 4052), (2234, 4029), (2183, 4153), (21, 4183), (2341, 4084), (2167, 4128)]
         : compromised: 0.4910, honest: 0.5060
Round 002: test acc mean=0.6577 ± 0.2033 | min=0.0480 max=0.7544
         : test loss mean=nan ± nan
         : individual accs = ['0.716328', '0.718059', '0.715266', '0.723748', '0.711806', '0.728248', '0.737181', '0.754426', '0.736578', '0.714987', '0.048033', '0.729788', '0.726851', '0.724565', '0.717177', '0.720526', '0.722369', '0.049247', '0.720127', '0.738130']
         : correct/total = [(2957, 4128), (3018, 4203), (2919, 4081), (3136, 4333), (2912, 4091), (3122, 4287), (3091, 4193), (3281, 4349), (3087, 4191), (3058, 4277), (199, 4143), (3060, 4193), (2975, 4093), (3041, 4197), (2906, 4052), (2903, 4029), (3000, 4153), (206, 4183), (2941, 4084), (3047, 4128)]
         : compromised: 0.6393, honest: 0.6699
Round 003: test acc mean=0.7008 ± 0.2175 | min=0.0480 max=0.7878
         : test loss mean=nan ± nan
         : individual accs = ['0.767926', '0.787771', '0.770644', '0.759751', '0.771694', '0.766970', '0.780587', '0.776730', '0.780005', '0.775076', '0.048033', '0.764131', '0.776936', '0.777222', '0.777641', '0.770911', '0.772935', '0.049247', '0.781587', '0.761143']
         : correct/total = [(3170, 4128), (3311, 4203), (3145, 4081), (3292, 4333), (3157, 4091), (3288, 4287), (3273, 4193), (3378, 4349), (3269, 4191), (3315, 4277), (199, 4143), (3204, 4193), (3180, 4093), (3262, 4197), (3151, 4052), (3106, 4029), (3210, 4153), (206, 4183), (3192, 4084), (3142, 4128)]
         : compromised: 0.6852, honest: 0.7113
Round 004: test acc mean=0.7257 ± 0.2258 | min=0.0480 max=0.8160
         : test loss mean=nan ± nan
         : individual accs = ['0.796512', '0.808946', '0.783141', '0.803139', '0.792716', '0.795661', '0.813022', '0.793286', '0.816034', '0.811550', '0.048033', '0.796804', '0.802590', '0.804384', '0.807996', '0.809134', '0.798459', '0.049247', '0.796033', '0.787548']
         : correct/total = [(3288, 4128), (3400, 4203), (3196, 4081), (3480, 4333), (3243, 4091), (3411, 4287), (3409, 4193), (3450, 4349), (3420, 4191), (3471, 4277), (199, 4143), (3341, 4193), (3285, 4093), (3376, 4197), (3274, 4052), (3260, 4029), (3316, 4153), (206, 4183), (3251, 4084), (3251, 4128)]
         : compromised: 0.7077, honest: 0.7377
Round 005: test acc mean=0.7371 ± 0.2297 | min=0.0480 max=0.8284
         : test loss mean=nan ± nan
         : individual accs = ['0.813469', '0.823222', '0.814751', '0.807985', '0.803227', '0.813156', '0.820892', '0.799724', '0.828442', '0.818331', '0.048033', '0.792750', '0.812363', '0.817012', '0.817127', '0.826011', '0.815796', '0.049247', '0.823947', '0.796754']
         : correct/total = [(3358, 4128), (3460, 4203), (3325, 4081), (3501, 4333), (3286, 4091), (3486, 4287), (3442, 4193), (3478, 4349), (3472, 4191), (3500, 4277), (199, 4143), (3324, 4193), (3325, 4093), (3429, 4197), (3311, 4052), (3328, 4029), (3388, 4153), (206, 4183), (3365, 4084), (3289, 4128)]
         : compromised: 0.7186, honest: 0.7495
Round 006: test acc mean=0.7005 ± 0.2781 | min=0.0189 max=0.8298
         : test loss mean=nan ± nan
         : individual accs = ['0.815891', '0.807756', '0.818917', '0.826448', '0.811782', '0.018894', '0.823277', '0.821108', '0.815080', '0.829787', '0.048033', '0.808967', '0.808942', '0.806052', '0.822804', '0.825515', '0.818444', '0.049247', '0.820029', '0.812258']
         : correct/total = [(3368, 4128), (3395, 4203), (3342, 4081), (3581, 4333), (3321, 4091), (81, 4287), (3452, 4193), (3571, 4349), (3416, 4191), (3549, 4277), (199, 4143), (3392, 4193), (3311, 4093), (3383, 4197), (3334, 4052), (3326, 4029), (3399, 4153), (206, 4183), (3349, 4084), (3353, 4128)]
         : compromised: 0.6178, honest: 0.7555
Round 007: test acc mean=0.7478 ± 0.2331 | min=0.0480 max=0.8366
         : test loss mean=nan ± nan
         : individual accs = ['0.812742', '0.824887', '0.825533', '0.830833', '0.822048', '0.827618', '0.831386', '0.833985', '0.836555', '0.826514', '0.048033', '0.816838', '0.825556', '0.826543', '0.826999', '0.820551', '0.824464', '0.049247', '0.829579', '0.816860']
         : correct/total = [(3355, 4128), (3467, 4203), (3369, 4081), (3600, 4333), (3363, 4091), (3548, 4287), (3486, 4193), (3627, 4349), (3506, 4191), (3535, 4277), (199, 4143), (3425, 4193), (3379, 4093), (3469, 4197), (3351, 4052), (3306, 4029), (3424, 4153), (206, 4183), (3388, 4084), (3372, 4128)]
         : compromised: 0.7284, honest: 0.7608
Round 008: test acc mean=0.7502 ± 0.2340 | min=0.0480 max=0.8435
         : test loss mean=nan ± nan
         : individual accs = ['0.813469', '0.829883', '0.809605', '0.836141', '0.823271', '0.820854', '0.831386', '0.830766', '0.843474', '0.840309', '0.048033', '0.826616', '0.832152', '0.836788', '0.830454', '0.833706', '0.833133', '0.049247', '0.818805', '0.816618']
         : correct/total = [(3358, 4128), (3488, 4203), (3304, 4081), (3623, 4333), (3368, 4091), (3519, 4287), (3486, 4193), (3613, 4349), (3535, 4191), (3594, 4277), (199, 4143), (3466, 4193), (3406, 4093), (3512, 4197), (3365, 4052), (3359, 4029), (3460, 4153), (206, 4183), (3344, 4084), (3371, 4128)]
         : compromised: 0.7306, honest: 0.7633
Round 009: test acc mean=0.7517 ± 0.2345 | min=0.0480 max=0.8418
         : test loss mean=nan ± nan
         : individual accs = ['0.830669', '0.837735', '0.830434', '0.818601', '0.812515', '0.838348', '0.830670', '0.834215', '0.841804', '0.828852', '0.048033', '0.826139', '0.828976', '0.837980', '0.826259', '0.831224', '0.837226', '0.049247', '0.819785', '0.825581']
         : correct/total = [(3429, 4128), (3521, 4203), (3389, 4081), (3547, 4333), (3324, 4091), (3594, 4287), (3483, 4193), (3628, 4349), (3528, 4191), (3545, 4277), (199, 4143), (3464, 4193), (3393, 4093), (3517, 4197), (3348, 4052), (3349, 4029), (3477, 4153), (206, 4183), (3348, 4084), (3408, 4128)]
         : compromised: 0.7331, honest: 0.7642
Round 010: test acc mean=0.7140 ± 0.2822 | min=0.0301 max=0.8409
         : test loss mean=nan ± nan
         : individual accs = ['0.832122', '0.836069', '0.822593', '0.820909', '0.826693', '0.030091', '0.839494', '0.840883', '0.838463', '0.838438', '0.048033', '0.829478', '0.831908', '0.832499', '0.835390', '0.836684', '0.838671', '0.049247', '0.833252', '0.818798']
         : correct/total = [(3435, 4128), (3514, 4203), (3357, 4081), (3557, 4333), (3382, 4091), (129, 4287), (3520, 4193), (3657, 4349), (3514, 4191), (3586, 4277), (199, 4143), (3478, 4193), (3405, 4093), (3494, 4197), (3385, 4052), (3371, 4029), (3483, 4153), (206, 4183), (3403, 4084), (3380, 4128)]
         : compromised: 0.6347, honest: 0.7668

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: gaussian, 40.0% compromised
Final accuracy - Compromised: 0.6347, Honest: 0.7668
Overall test accuracy: mean=0.7140 ± 0.2822
