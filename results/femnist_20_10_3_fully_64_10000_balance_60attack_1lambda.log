Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Attack: Compromised 12/20 nodes: [1, 2, 3, 5, 8, 11, 12, 13, 14, 15, 17, 18]
Attack type: directed_deviation, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4891 ± 0.0381 | min=0.4311 max=0.5563
         : test loss mean=3.7518 ± 0.0284
         : individual accs = ['0.539486', '0.487747', '0.512864', '0.502885', '0.445857', '0.556333', '0.455760', '0.492067', '0.523503', '0.431143', '0.446778', '0.529931', '0.447593', '0.456755', '0.501481', '0.522959', '0.464243', '0.539804', '0.489961', '0.434593']
         : correct/total = [(2227, 4128), (2050, 4203), (2093, 4081), (2179, 4333), (1824, 4091), (2385, 4287), (1911, 4193), (2140, 4349), (2194, 4191), (1844, 4277), (1851, 4143), (2222, 4193), (1832, 4093), (1917, 4197), (2032, 4052), (2107, 4029), (1928, 4153), (2258, 4183), (2001, 4084), (1794, 4128)]
         : compromised: 0.5060, honest: 0.4637
Round 002: test acc mean=0.6647 ± 0.0239 | min=0.6067 max=0.7000
         : test loss mean=3.3771 ± 0.0962
         : individual accs = ['0.682897', '0.679990', '0.654006', '0.688438', '0.665852', '0.700023', '0.606725', '0.679237', '0.618707', '0.694178', '0.649047', '0.680897', '0.665771', '0.663093', '0.686821', '0.653512', '0.643631', '0.640210', '0.678991', '0.661822']
         : correct/total = [(2819, 4128), (2858, 4203), (2669, 4081), (2983, 4333), (2724, 4091), (3001, 4287), (2544, 4193), (2954, 4349), (2593, 4191), (2969, 4277), (2689, 4143), (2855, 4193), (2725, 4093), (2783, 4197), (2783, 4052), (2633, 4029), (2673, 4153), (2678, 4183), (2773, 4084), (2732, 4128)]
         : compromised: 0.6675, honest: 0.6604
Round 003: test acc mean=0.6618 ± 0.0304 | min=0.5957 max=0.7076
         : test loss mean=2.8628 ± 0.2228
         : individual accs = ['0.703004', '0.667380', '0.595687', '0.707593', '0.682229', '0.612550', '0.694491', '0.693493', '0.660702', '0.643675', '0.643254', '0.672549', '0.676277', '0.652371', '0.682379', '0.611814', '0.662172', '0.628496', '0.670421', '0.675872']
         : correct/total = [(2902, 4128), (2805, 4203), (2431, 4081), (3066, 4333), (2791, 4091), (2626, 4287), (2912, 4193), (3016, 4349), (2769, 4191), (2753, 4277), (2665, 4143), (2820, 4193), (2768, 4093), (2738, 4197), (2765, 4052), (2465, 4029), (2750, 4153), (2629, 4183), (2738, 4084), (2790, 4128)]
         : compromised: 0.6532, honest: 0.6748
Round 004: test acc mean=0.6675 ± 0.0366 | min=0.5898 max=0.7367
         : test loss mean=1.9275 ± 0.2404
         : individual accs = ['0.695494', '0.638591', '0.589806', '0.623356', '0.736739', '0.614882', '0.711185', '0.711198', '0.673586', '0.689736', '0.678735', '0.663964', '0.625458', '0.665952', '0.689042', '0.626458', '0.697327', '0.669615', '0.663320', '0.685320']
         : correct/total = [(2871, 4128), (2684, 4203), (2407, 4081), (2701, 4333), (3014, 4091), (2636, 4287), (2982, 4193), (3093, 4349), (2823, 4191), (2950, 4277), (2812, 4143), (2784, 4193), (2560, 4093), (2795, 4197), (2792, 4052), (2524, 4029), (2896, 4153), (2801, 4183), (2709, 4084), (2829, 4128)]
         : compromised: 0.6453, honest: 0.7007
Round 005: test acc mean=0.7536 ± 0.0178 | min=0.7064 max=0.7816
         : test loss mean=1.0128 ± 0.1150
         : individual accs = ['0.765019', '0.733048', '0.743445', '0.724210', '0.760694', '0.758106', '0.765323', '0.781559', '0.750656', '0.774608', '0.755733', '0.751252', '0.748351', '0.746486', '0.751234', '0.706379', '0.779196', '0.746354', '0.760039', '0.770833']
         : correct/total = [(3158, 4128), (3081, 4203), (3034, 4081), (3138, 4333), (3112, 4091), (3250, 4287), (3209, 4193), (3399, 4349), (3146, 4191), (3313, 4277), (3131, 4143), (3150, 4193), (3063, 4093), (3133, 4197), (3044, 4052), (2846, 4029), (3236, 4153), (3122, 4183), (3104, 4084), (3182, 4128)]
         : compromised: 0.7433, honest: 0.7691
Round 006: test acc mean=0.8102 ± 0.0065 | min=0.7988 max=0.8220
         : test loss mean=0.6240 ± 0.0209
         : individual accs = ['0.802568', '0.807756', '0.805440', '0.807062', '0.798827', '0.809424', '0.809444', '0.822028', '0.817705', '0.813888', '0.800869', '0.807298', '0.804056', '0.816297', '0.819102', '0.814842', '0.820130', '0.812575', '0.808521', '0.805475']
         : correct/total = [(3313, 4128), (3395, 4203), (3287, 4081), (3497, 4333), (3268, 4091), (3470, 4287), (3394, 4193), (3575, 4349), (3427, 4191), (3481, 4277), (3318, 4143), (3385, 4193), (3291, 4093), (3426, 4197), (3319, 4052), (3283, 4029), (3406, 4153), (3399, 4183), (3302, 4084), (3325, 4128)]
         : compromised: 0.8108, honest: 0.8092
Round 007: test acc mean=0.8298 ± 0.0059 | min=0.8172 max=0.8373
         : test loss mean=0.5352 ± 0.0186
         : individual accs = ['0.819525', '0.837259', '0.830434', '0.832218', '0.817160', '0.826685', '0.835679', '0.836974', '0.836555', '0.829086', '0.820179', '0.829955', '0.824823', '0.830355', '0.835884', '0.831968', '0.830725', '0.831700', '0.834721', '0.824370']
         : correct/total = [(3383, 4128), (3519, 4203), (3389, 4081), (3606, 4333), (3343, 4091), (3544, 4287), (3504, 4193), (3640, 4349), (3506, 4191), (3546, 4277), (3398, 4143), (3480, 4193), (3376, 4093), (3485, 4197), (3387, 4052), (3352, 4029), (3450, 4153), (3479, 4183), (3409, 4084), (3403, 4128)]
         : compromised: 0.8319, honest: 0.8267
Round 008: test acc mean=0.8348 ± 0.0066 | min=0.8198 max=0.8451
         : test loss mean=0.5021 ± 0.0191
         : individual accs = ['0.827519', '0.836307', '0.834844', '0.845142', '0.826937', '0.844413', '0.839256', '0.839733', '0.834646', '0.837269', '0.824041', '0.837825', '0.831175', '0.832738', '0.843781', '0.839662', '0.830725', '0.836959', '0.832762', '0.819767']
         : correct/total = [(3416, 4128), (3515, 4203), (3407, 4081), (3662, 4333), (3383, 4091), (3620, 4287), (3519, 4193), (3652, 4349), (3498, 4191), (3581, 4277), (3414, 4143), (3513, 4193), (3402, 4093), (3495, 4197), (3419, 4052), (3383, 4029), (3450, 4153), (3501, 4183), (3401, 4084), (3384, 4128)]
         : compromised: 0.8375, honest: 0.8307
Round 009: test acc mean=0.8442 ± 0.0055 | min=0.8338 max=0.8528
         : test loss mean=0.4740 ± 0.0178
         : individual accs = ['0.834787', '0.851059', '0.843911', '0.846065', '0.833781', '0.847213', '0.850227', '0.851690', '0.852780', '0.849193', '0.839247', '0.840925', '0.840704', '0.840839', '0.845508', '0.846860', '0.837948', '0.847239', '0.845005', '0.838421']
         : correct/total = [(3446, 4128), (3577, 4203), (3444, 4081), (3666, 4333), (3411, 4091), (3632, 4287), (3565, 4193), (3704, 4349), (3574, 4191), (3632, 4277), (3477, 4143), (3526, 4193), (3441, 4093), (3529, 4197), (3426, 4052), (3412, 4029), (3480, 4153), (3544, 4183), (3451, 4084), (3461, 4128)]
         : compromised: 0.8457, honest: 0.8419
Round 010: test acc mean=0.8492 ± 0.0049 | min=0.8406 max=0.8577
         : test loss mean=0.4593 ± 0.0185
         : individual accs = ['0.841328', '0.857721', '0.848567', '0.850912', '0.840626', '0.845113', '0.854996', '0.853530', '0.853018', '0.850129', '0.842143', '0.844503', '0.846567', '0.852514', '0.854146', '0.853562', '0.849747', '0.851303', '0.850147', '0.842781']
         : correct/total = [(3473, 4128), (3605, 4203), (3463, 4081), (3687, 4333), (3439, 4091), (3623, 4287), (3585, 4193), (3712, 4349), (3575, 4191), (3636, 4277), (3489, 4143), (3541, 4193), (3465, 4093), (3578, 4197), (3461, 4052), (3439, 4029), (3529, 4153), (3561, 4183), (3472, 4084), (3479, 4128)]
         : compromised: 0.8507, honest: 0.8469

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: balance
Attack: directed_deviation, 60.0% compromised
Final accuracy - Compromised: 0.8507, Honest: 0.8469
Overall test accuracy: mean=0.8492 ± 0.0049

=== BALANCE SUMMARY ===
Node 0: acceptance=0.368
Node 1: acceptance=0.421
Node 2: acceptance=0.421
Node 3: acceptance=0.421
Node 4: acceptance=0.368
Node 5: acceptance=0.421
Node 6: acceptance=0.368
Node 7: acceptance=0.368
Node 8: acceptance=0.421
Node 9: acceptance=0.368
Node 10: acceptance=0.368
Node 11: acceptance=0.421
Node 12: acceptance=0.421
Node 13: acceptance=0.421
Node 14: acceptance=0.421
Node 15: acceptance=0.421
Node 16: acceptance=0.368
Node 17: acceptance=0.421
Node 18: acceptance=0.421
Node 19: acceptance=0.368

Performance Summary:
  - Distance computation time: 1.560s (46.0%)
  - Filtering time: 1.664s (49.1%)
  - Aggregation time: 0.165s (4.9%)
  - Total time: 3.390s
  - Mean acceptance rate: 0.400

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
