Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: gaussian, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.5051 ± 0.0332 | min=0.4496 max=0.5581
         : test loss mean=3.7426 ± 0.0233
         : individual accs = ['0.558140', '0.504640', '0.524381', '0.511193', '0.482278', '0.553301', '0.492010', '0.507013', '0.538296', '0.460837', '0.474535', '0.546148', '0.471781', '0.469383', '0.508391', '0.536361', '0.462798', '0.548171', '0.503183', '0.449612']
         : correct/total = [(2304, 4128), (2121, 4203), (2140, 4081), (2215, 4333), (1973, 4091), (2372, 4287), (2063, 4193), (2205, 4349), (2256, 4191), (1971, 4277), (1966, 4143), (2290, 4193), (1931, 4093), (1970, 4197), (2060, 4052), (2161, 4029), (1922, 4153), (2293, 4183), (2055, 4084), (1856, 4128)]
         : compromised: 0.5090, honest: 0.5034
Round 002: test acc mean=0.6780 ± 0.0203 | min=0.6163 max=0.7052
         : test loss mean=3.4300 ± 0.0575
         : individual accs = ['0.686047', '0.684511', '0.668709', '0.698361', '0.683451', '0.691393', '0.616265', '0.693263', '0.663088', '0.705167', '0.665943', '0.696637', '0.690203', '0.660472', '0.699408', '0.686523', '0.653503', '0.661965', '0.682909', '0.671512']
         : correct/total = [(2832, 4128), (2877, 4203), (2729, 4081), (3026, 4333), (2796, 4091), (2964, 4287), (2584, 4193), (3015, 4349), (2779, 4191), (3016, 4277), (2759, 4143), (2921, 4193), (2825, 4093), (2772, 4197), (2834, 4052), (2766, 4029), (2714, 4153), (2769, 4183), (2789, 4084), (2772, 4128)]
         : compromised: 0.6811, honest: 0.6766
Round 003: test acc mean=0.6954 ± 0.0242 | min=0.6191 max=0.7311
         : test loss mean=3.1325 ± 0.1176
         : individual accs = ['0.725775', '0.699738', '0.681451', '0.731133', '0.687118', '0.619081', '0.702838', '0.717866', '0.712479', '0.678513', '0.685976', '0.711424', '0.714146', '0.688111', '0.718657', '0.680069', '0.690344', '0.674635', '0.682174', '0.706638']
         : correct/total = [(2996, 4128), (2941, 4203), (2781, 4081), (3168, 4333), (2811, 4091), (2654, 4287), (2947, 4193), (3122, 4349), (2986, 4191), (2902, 4277), (2842, 4143), (2983, 4193), (2923, 4093), (2888, 4197), (2912, 4052), (2740, 4029), (2867, 4153), (2822, 4183), (2786, 4084), (2917, 4128)]
         : compromised: 0.6828, honest: 0.7008
Round 004: test acc mean=0.6708 ± 0.0378 | min=0.5810 max=0.7226
         : test loss mean=2.5835 ± 0.1705
         : individual accs = ['0.676841', '0.694504', '0.645430', '0.694207', '0.722562', '0.611383', '0.709754', '0.699241', '0.717251', '0.673135', '0.624427', '0.702600', '0.580992', '0.675244', '0.680405', '0.680318', '0.692993', '0.609371', '0.651567', '0.673934']
         : correct/total = [(2794, 4128), (2919, 4203), (2634, 4081), (3008, 4333), (2956, 4091), (2621, 4287), (2976, 4193), (3041, 4349), (3006, 4191), (2879, 4277), (2587, 4143), (2946, 4193), (2378, 4093), (2834, 4197), (2757, 4052), (2741, 4029), (2878, 4153), (2549, 4183), (2661, 4084), (2782, 4128)]
         : compromised: 0.6348, honest: 0.6862
Round 005: test acc mean=0.6519 ± 0.0374 | min=0.5683 max=0.7086
         : test loss mean=1.8663 ± 0.1593
         : individual accs = ['0.687016', '0.646919', '0.604754', '0.655897', '0.676363', '0.628645', '0.676604', '0.685215', '0.689812', '0.682488', '0.639874', '0.686621', '0.592475', '0.608053', '0.617720', '0.636883', '0.708644', '0.568252', '0.667483', '0.677326']
         : correct/total = [(2836, 4128), (2719, 4203), (2468, 4081), (2842, 4333), (2767, 4091), (2695, 4287), (2837, 4193), (2980, 4349), (2891, 4191), (2919, 4277), (2651, 4143), (2879, 4193), (2425, 4093), (2552, 4197), (2503, 4052), (2566, 4029), (2943, 4153), (2377, 4183), (2726, 4084), (2796, 4128)]
         : compromised: 0.6138, honest: 0.6682
Round 006: test acc mean=0.7478 ± 0.0144 | min=0.7145 max=0.7635
         : test loss mean=1.0673 ± 0.0735
         : individual accs = ['0.724806', '0.742803', '0.753492', '0.757904', '0.754094', '0.714486', '0.761030', '0.759715', '0.762825', '0.755904', '0.761767', '0.757453', '0.724896', '0.746247', '0.748519', '0.744105', '0.763544', '0.724361', '0.741920', '0.756056']
         : correct/total = [(2992, 4128), (3122, 4203), (3075, 4081), (3284, 4333), (3085, 4091), (3063, 4287), (3191, 4193), (3304, 4349), (3197, 4191), (3233, 4277), (3156, 4143), (3176, 4193), (2967, 4093), (3132, 4197), (3033, 4052), (2998, 4029), (3171, 4153), (3030, 4183), (3030, 4084), (3121, 4128)]
         : compromised: 0.7334, honest: 0.7540
Round 007: test acc mean=0.8061 ± 0.0072 | min=0.7926 max=0.8189
         : test loss mean=0.6613 ± 0.0274
         : individual accs = ['0.799903', '0.808946', '0.794413', '0.810062', '0.794182', '0.808957', '0.814930', '0.813980', '0.818898', '0.811784', '0.798938', '0.808729', '0.792573', '0.805337', '0.810464', '0.806155', '0.810739', '0.805642', '0.808521', '0.798450']
         : correct/total = [(3302, 4128), (3400, 4203), (3242, 4081), (3510, 4333), (3249, 4091), (3468, 4287), (3417, 4193), (3540, 4349), (3432, 4191), (3472, 4277), (3310, 4143), (3391, 4193), (3244, 4093), (3380, 4197), (3284, 4052), (3248, 4029), (3367, 4153), (3370, 4183), (3302, 4084), (3296, 4128)]
         : compromised: 0.8052, honest: 0.8064
Round 008: test acc mean=0.8246 ± 0.0067 | min=0.8067 max=0.8334
         : test loss mean=0.5492 ± 0.0192
         : individual accs = ['0.815407', '0.827028', '0.823328', '0.833372', '0.819360', '0.830184', '0.829478', '0.830076', '0.831067', '0.825345', '0.820661', '0.829239', '0.817738', '0.827496', '0.832428', '0.827997', '0.815073', '0.825006', '0.825906', '0.806686']
         : correct/total = [(3366, 4128), (3476, 4203), (3360, 4081), (3611, 4333), (3352, 4091), (3559, 4287), (3478, 4193), (3610, 4349), (3483, 4191), (3530, 4277), (3400, 4143), (3477, 4193), (3347, 4093), (3473, 4197), (3373, 4052), (3336, 4029), (3385, 4153), (3451, 4183), (3373, 4084), (3330, 4128)]
         : compromised: 0.8265, honest: 0.8239
Round 009: test acc mean=0.8368 ± 0.0051 | min=0.8296 max=0.8485
         : test loss mean=0.5025 ± 0.0183
         : individual accs = ['0.829942', '0.840114', '0.834599', '0.839603', '0.829626', '0.836016', '0.844741', '0.841113', '0.848485', '0.841478', '0.830558', '0.833294', '0.835084', '0.836312', '0.842300', '0.839662', '0.830725', '0.836720', '0.835455', '0.830911']
         : correct/total = [(3426, 4128), (3531, 4203), (3406, 4081), (3638, 4333), (3394, 4091), (3584, 4287), (3542, 4193), (3658, 4349), (3556, 4191), (3599, 4277), (3441, 4143), (3494, 4193), (3418, 4093), (3510, 4197), (3413, 4052), (3383, 4029), (3450, 4153), (3500, 4183), (3412, 4084), (3430, 4128)]
         : compromised: 0.8370, honest: 0.8368
Round 010: test acc mean=0.8437 ± 0.0054 | min=0.8327 max=0.8515
         : test loss mean=0.4795 ± 0.0190
         : individual accs = ['0.836240', '0.851535', '0.841215', '0.846757', '0.833293', '0.842780', '0.845934', '0.849161', '0.848008', '0.846388', '0.832730', '0.837586', '0.841437', '0.847748', '0.846002', '0.848846', '0.845172', '0.847478', '0.847698', '0.837694']
         : correct/total = [(3452, 4128), (3579, 4203), (3433, 4081), (3669, 4333), (3409, 4091), (3613, 4287), (3547, 4193), (3693, 4349), (3554, 4191), (3620, 4277), (3450, 4143), (3512, 4193), (3444, 4093), (3558, 4197), (3428, 4052), (3420, 4029), (3510, 4153), (3545, 4183), (3462, 4084), (3458, 4128)]
         : compromised: 0.8455, honest: 0.8429

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: balance
Attack: gaussian, 30.0% compromised
Final accuracy - Compromised: 0.8455, Honest: 0.8429
Overall test accuracy: mean=0.8437 ± 0.0054

=== BALANCE SUMMARY ===
Node 0: acceptance=0.684
Node 1: acceptance=0.684
Node 2: acceptance=0.684
Node 3: acceptance=0.684
Node 4: acceptance=0.684
Node 5: acceptance=0.737
Node 6: acceptance=0.684
Node 7: acceptance=0.684
Node 8: acceptance=0.684
Node 9: acceptance=0.684
Node 10: acceptance=0.684
Node 11: acceptance=0.684
Node 12: acceptance=0.737
Node 13: acceptance=0.737
Node 14: acceptance=0.737
Node 15: acceptance=0.684
Node 16: acceptance=0.684
Node 17: acceptance=0.737
Node 18: acceptance=0.737
Node 19: acceptance=0.684

Performance Summary:
  - Distance computation time: 1.704s (45.3%)
  - Filtering time: 1.811s (48.1%)
  - Aggregation time: 0.249s (6.6%)
  - Total time: 3.763s
  - Mean acceptance rate: 0.700

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
