Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Degree statistics: avg=19.00, min=19, max=19
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: backdoor, lambda: 1.0
Backdoor target label: 0, trigger size: 4
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Backdoor attack: Created poisoned datasets for 8 compromised nodes
Round 001: test acc mean=0.5292 ± 0.0102 | min=0.5121 max=0.5531
         : test loss mean=1.7711 ± 0.0384
         : individual accs = ['0.533672', '0.533191', '0.531732', '0.514193', '0.531899', '0.553067', '0.512521', '0.544033', '0.523026', '0.526070', '0.522085', '0.540663', '0.534816', '0.519419', '0.532083', '0.524696', '0.533349', '0.525221', '0.535994', '0.512112']
         : correct/total = [(2203, 4128), (2241, 4203), (2170, 4081), (2228, 4333), (2176, 4091), (2371, 4287), (2149, 4193), (2366, 4349), (2192, 4191), (2250, 4277), (2163, 4143), (2267, 4193), (2189, 4093), (2180, 4197), (2156, 4052), (2114, 4029), (2215, 4153), (2197, 4183), (2189, 4084), (2114, 4128)]
         : compromised: 0.5343, honest: 0.5258
Round 002: test acc mean=0.7140 ± 0.0077 | min=0.7005 max=0.7334
         : test loss mean=0.9300 ± 0.0239
         : individual accs = ['0.714874', '0.722817', '0.716001', '0.710362', '0.715229', '0.733380', '0.705700', '0.719246', '0.720115', '0.714052', '0.705286', '0.700453', '0.713657', '0.707887', '0.712488', '0.708861', '0.721165', '0.714081', '0.721352', '0.702035']
         : correct/total = [(2951, 4128), (3038, 4203), (2922, 4081), (3078, 4333), (2926, 4091), (3144, 4287), (2959, 4193), (3128, 4349), (3018, 4191), (3054, 4277), (2922, 4143), (2937, 4193), (2921, 4093), (2971, 4197), (2887, 4052), (2856, 4029), (2995, 4153), (2987, 4183), (2946, 4084), (2898, 4128)]
         : compromised: 0.7158, honest: 0.7127
Round 003: test acc mean=0.7761 ± 0.0083 | min=0.7590 max=0.7910
         : test loss mean=0.7194 ± 0.0259
         : individual accs = ['0.773014', '0.772781', '0.776525', '0.772213', '0.783427', '0.790996', '0.763177', '0.775121', '0.781675', '0.782558', '0.768042', '0.762461', '0.787198', '0.779128', '0.775420', '0.775379', '0.777992', '0.777432', '0.787708', '0.758963']
         : correct/total = [(3191, 4128), (3248, 4203), (3169, 4081), (3346, 4333), (3205, 4091), (3391, 4287), (3200, 4193), (3371, 4349), (3276, 4191), (3347, 4277), (3182, 4143), (3197, 4193), (3222, 4093), (3270, 4197), (3142, 4052), (3124, 4029), (3231, 4153), (3252, 4183), (3217, 4084), (3133, 4128)]
         : compromised: 0.7791, honest: 0.7740
Round 004: test acc mean=0.7962 ± 0.0072 | min=0.7842 max=0.8066
         : test loss mean=0.6366 ± 0.0249
         : individual accs = ['0.795543', '0.803474', '0.804460', '0.796677', '0.804938', '0.800560', '0.787503', '0.798804', '0.803627', '0.806640', '0.784214', '0.787026', '0.798192', '0.789850', '0.790721', '0.793249', '0.803756', '0.786756', '0.800196', '0.786822']
         : correct/total = [(3284, 4128), (3377, 4203), (3283, 4081), (3452, 4333), (3293, 4091), (3432, 4287), (3302, 4193), (3474, 4349), (3368, 4191), (3450, 4277), (3249, 4143), (3300, 4193), (3267, 4093), (3315, 4197), (3204, 4052), (3196, 4029), (3338, 4153), (3291, 4183), (3268, 4084), (3248, 4128)]
         : compromised: 0.7946, honest: 0.7972
Round 005: test acc mean=0.8090 ± 0.0072 | min=0.7976 max=0.8234
         : test loss mean=0.5882 ± 0.0263
         : individual accs = ['0.823401', '0.810849', '0.813526', '0.797600', '0.811538', '0.811290', '0.798712', '0.812601', '0.809115', '0.816460', '0.799179', '0.803244', '0.816027', '0.802954', '0.811945', '0.804418', '0.815796', '0.800861', '0.817581', '0.802326']
         : correct/total = [(3399, 4128), (3408, 4203), (3320, 4081), (3456, 4333), (3320, 4091), (3478, 4287), (3349, 4193), (3534, 4349), (3391, 4191), (3492, 4277), (3311, 4143), (3368, 4193), (3340, 4093), (3370, 4197), (3290, 4052), (3241, 4029), (3388, 4153), (3350, 4183), (3339, 4084), (3312, 4128)]
         : compromised: 0.8093, honest: 0.8087
Round 006: test acc mean=0.8185 ± 0.0069 | min=0.8057 max=0.8280
         : test loss mean=0.5600 ± 0.0277
         : individual accs = ['0.828004', '0.827980', '0.827493', '0.812601', '0.821560', '0.820154', '0.815884', '0.825477', '0.811739', '0.822773', '0.805696', '0.816361', '0.822868', '0.814868', '0.814659', '0.812857', '0.825909', '0.811379', '0.824682', '0.807413']
         : correct/total = [(3418, 4128), (3480, 4203), (3377, 4081), (3521, 4333), (3361, 4091), (3516, 4287), (3421, 4193), (3590, 4349), (3402, 4191), (3519, 4277), (3338, 4143), (3423, 4193), (3368, 4093), (3420, 4197), (3301, 4052), (3275, 4029), (3430, 4153), (3394, 4183), (3368, 4084), (3333, 4128)]
         : compromised: 0.8191, honest: 0.8181
Round 007: test acc mean=0.8213 ± 0.0076 | min=0.8064 max=0.8350
         : test loss mean=0.5515 ± 0.0283
         : individual accs = ['0.835029', '0.827742', '0.827248', '0.819294', '0.829626', '0.818988', '0.816361', '0.823868', '0.818659', '0.829320', '0.806420', '0.818984', '0.818959', '0.815583', '0.822804', '0.812112', '0.830484', '0.811858', '0.830558', '0.811531']
         : correct/total = [(3447, 4128), (3479, 4203), (3376, 4081), (3550, 4333), (3394, 4091), (3511, 4287), (3423, 4193), (3583, 4349), (3431, 4191), (3547, 4277), (3341, 4143), (3434, 4193), (3352, 4093), (3423, 4197), (3334, 4052), (3272, 4029), (3449, 4153), (3396, 4183), (3392, 4084), (3350, 4128)]
         : compromised: 0.8207, honest: 0.8217
Round 008: test acc mean=0.8181 ± 0.0071 | min=0.8047 max=0.8355
         : test loss mean=0.5456 ± 0.0277
         : individual accs = ['0.827277', '0.824887', '0.818672', '0.812832', '0.835493', '0.820854', '0.811829', '0.819039', '0.819852', '0.824176', '0.811489', '0.813976', '0.823846', '0.809864', '0.812685', '0.804666', '0.823020', '0.819747', '0.817091', '0.809835']
         : correct/total = [(3415, 4128), (3467, 4203), (3341, 4081), (3522, 4333), (3418, 4091), (3519, 4287), (3404, 4193), (3562, 4349), (3436, 4191), (3525, 4277), (3362, 4143), (3413, 4193), (3372, 4093), (3399, 4197), (3293, 4052), (3242, 4029), (3418, 4153), (3429, 4183), (3337, 4084), (3343, 4128)]
         : compromised: 0.8179, honest: 0.8182
Round 009: test acc mean=0.8225 ± 0.0070 | min=0.8098 max=0.8310
         : test loss mean=0.5351 ± 0.0261
         : individual accs = ['0.830426', '0.830121', '0.829209', '0.815370', '0.826937', '0.828785', '0.812306', '0.825707', '0.822238', '0.830956', '0.809800', '0.815884', '0.827999', '0.818918', '0.819102', '0.815339', '0.829280', '0.815922', '0.831048', '0.815165']
         : correct/total = [(3428, 4128), (3489, 4203), (3384, 4081), (3533, 4333), (3383, 4091), (3553, 4287), (3406, 4193), (3591, 4349), (3446, 4191), (3554, 4277), (3355, 4143), (3421, 4193), (3389, 4093), (3437, 4197), (3319, 4052), (3285, 4029), (3444, 4153), (3413, 4183), (3394, 4084), (3365, 4128)]
         : compromised: 0.8235, honest: 0.8219
Round 010: test acc mean=0.8251 ± 0.0075 | min=0.8149 max=0.8382
         : test loss mean=0.5287 ± 0.0269
         : individual accs = ['0.837694', '0.828218', '0.830434', '0.815832', '0.838181', '0.830418', '0.817553', '0.833985', '0.820806', '0.831892', '0.821868', '0.816599', '0.828976', '0.819157', '0.820829', '0.815587', '0.825187', '0.819986', '0.833986', '0.814922']
         : correct/total = [(3458, 4128), (3481, 4203), (3389, 4081), (3535, 4333), (3429, 4091), (3560, 4287), (3428, 4193), (3627, 4349), (3440, 4191), (3558, 4277), (3405, 4143), (3424, 4193), (3393, 4093), (3438, 4197), (3326, 4052), (3286, 4029), (3427, 4153), (3430, 4183), (3406, 4084), (3364, 4128)]
         : compromised: 0.8248, honest: 0.8253

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: krum
Attack: backdoor, 40.0% compromised
Final accuracy - Compromised: 0.8248, Honest: 0.8253
Overall test accuracy: mean=0.8251 ± 0.0075

=== BACKDOOR ATTACK SUCCESS RATE (ASR) ===
Target label: 0
Trigger size: 4x4
Overall ASR: 0.0443 ± 0.0028
Honest nodes ASR: 0.0432 ± 0.0031
Compromised nodes ASR: 0.0458 ± 0.0012
Note: Higher ASR indicates more successful backdoor attack
