Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5101 ± 0.0173 | min=0.4882 max=0.5652
         : test loss mean=2.5652 ± 3.0103
         : individual accs = ['0.534992', '0.565227', '0.488224', '0.512415', '0.510395', '0.505183', '0.506483', '0.524766', '0.502169', '0.533779', '0.502022', '0.508880', '0.503623', '0.500836', '0.495321', '0.507815', '0.493363', '0.496668', '0.500246', '0.510035']
         : correct/total = [(7614, 14232), (8046, 14235), (6965, 14266), (7285, 14217), (7267, 14238), (7261, 14373), (7266, 14346), (7522, 14334), (7178, 14294), (7672, 14373), (7201, 14344), (7278, 14302), (7229, 14354), (7193, 14362), (7093, 14320), (7310, 14395), (7099, 14389), (7081, 14257), (7129, 14251), (7344, 14399)]
         : compromised: 0.5016, honest: 0.5123
Round 002: test acc mean=0.5262 ± 0.0522 | min=0.4703 max=0.6388
         : test loss mean=2.0853 ± 2.5856
         : individual accs = ['0.626616', '0.638848', '0.626104', '0.498769', '0.498946', '0.495860', '0.509898', '0.507255', '0.511613', '0.622904', '0.470301', '0.496504', '0.494636', '0.512533', '0.504679', '0.505245', '0.493571', '0.485305', '0.509719', '0.515661']
         : correct/total = [(8918, 14232), (9094, 14235), (8932, 14266), (7091, 14217), (7104, 14238), (7127, 14373), (7315, 14346), (7271, 14334), (7313, 14294), (8953, 14373), (6746, 14344), (7101, 14302), (7100, 14354), (7361, 14362), (7227, 14320), (7273, 14395), (7102, 14389), (6919, 14257), (7264, 14251), (7425, 14399)]
         : compromised: 0.4971, honest: 0.5335
Round 003: test acc mean=0.5147 ± 0.0342 | min=0.4700 max=0.6242
         : test loss mean=1.0761 ± 0.8395
         : individual accs = ['0.574691', '0.624236', '0.514300', '0.493775', '0.496418', '0.484102', '0.499512', '0.535301', '0.538688', '0.495304', '0.512897', '0.494057', '0.491710', '0.515527', '0.496159', '0.514206', '0.499965', '0.470015', '0.501298', '0.542607']
         : correct/total = [(8179, 14232), (8886, 14235), (7337, 14266), (7020, 14217), (7068, 14238), (6958, 14373), (7166, 14346), (7673, 14334), (7700, 14294), (7119, 14373), (7357, 14344), (7066, 14302), (7058, 14354), (7404, 14362), (7105, 14320), (7402, 14395), (7194, 14389), (6701, 14257), (7144, 14251), (7813, 14399)]
         : compromised: 0.4903, honest: 0.5208
Round 004: test acc mean=0.5214 ± 0.0415 | min=0.4858 max=0.6361
         : test loss mean=1.0574 ± 0.7161
         : individual accs = ['0.592889', '0.636108', '0.614959', '0.485756', '0.485883', '0.506505', '0.537014', '0.507325', '0.514342', '0.513671', '0.499373', '0.506992', '0.496168', '0.502298', '0.498743', '0.493783', '0.496212', '0.498211', '0.517508', '0.524134']
         : correct/total = [(8438, 14232), (9055, 14235), (8773, 14266), (6906, 14217), (6918, 14238), (7280, 14373), (7704, 14346), (7272, 14334), (7352, 14294), (7383, 14373), (7163, 14344), (7251, 14302), (7122, 14354), (7214, 14362), (7142, 14320), (7108, 14395), (7140, 14389), (7103, 14257), (7375, 14251), (7547, 14399)]
         : compromised: 0.5008, honest: 0.5265
Round 005: test acc mean=0.5382 ± 0.0537 | min=0.4804 max=0.6410
         : test loss mean=0.8747 ± 0.4051
         : individual accs = ['0.635118', '0.641026', '0.614468', '0.522543', '0.508428', '0.485146', '0.525024', '0.550160', '0.621659', '0.621165', '0.506484', '0.485736', '0.480354', '0.512603', '0.522975', '0.503230', '0.502815', '0.489654', '0.515332', '0.519272']
         : correct/total = [(9039, 14232), (9125, 14235), (8766, 14266), (7429, 14217), (7239, 14238), (6973, 14373), (7532, 14346), (7886, 14334), (8886, 14294), (8928, 14373), (7265, 14344), (6947, 14302), (6895, 14354), (7362, 14362), (7489, 14320), (7244, 14395), (7235, 14389), (6981, 14257), (7344, 14251), (7477, 14399)]
         : compromised: 0.4919, honest: 0.5497
Round 006: test acc mean=0.5538 ± 0.0515 | min=0.4925 max=0.6476
         : test loss mean=0.9228 ± 0.5078
         : individual accs = ['0.591484', '0.647559', '0.638721', '0.618415', '0.514468', '0.513532', '0.542799', '0.606600', '0.629635', '0.606415', '0.562326', '0.522374', '0.513794', '0.520540', '0.504818', '0.514693', '0.492529', '0.520095', '0.505929', '0.509480']
         : correct/total = [(8418, 14232), (9218, 14235), (9112, 14266), (8792, 14217), (7325, 14238), (7381, 14373), (7787, 14346), (8695, 14334), (9000, 14294), (8716, 14373), (8066, 14344), (7471, 14302), (7375, 14354), (7476, 14362), (7229, 14320), (7409, 14395), (7087, 14389), (7415, 14257), (7210, 14251), (7336, 14399)]
         : compromised: 0.5170, honest: 0.5630
Round 007: test acc mean=0.5560 ± 0.0547 | min=0.4878 max=0.6515
         : test loss mean=0.8214 ± 0.3663
         : individual accs = ['0.642496', '0.651493', '0.648044', '0.540339', '0.516997', '0.506992', '0.531159', '0.572973', '0.620750', '0.635775', '0.539877', '0.499580', '0.487808', '0.516363', '0.531285', '0.524001', '0.549031', '0.495055', '0.509929', '0.599694']
         : correct/total = [(9144, 14232), (9274, 14235), (9245, 14266), (7682, 14217), (7361, 14238), (7287, 14373), (7620, 14346), (8213, 14334), (8873, 14294), (9138, 14373), (7744, 14344), (7145, 14302), (7002, 14354), (7416, 14362), (7608, 14320), (7543, 14395), (7900, 14389), (7058, 14257), (7267, 14251), (8635, 14399)]
         : compromised: 0.5016, honest: 0.5696
Round 008: test acc mean=0.5653 ± 0.0532 | min=0.5033 max=0.6490
         : test loss mean=0.8140 ± 0.3425
         : individual accs = ['0.639264', '0.634422', '0.649026', '0.641275', '0.536662', '0.536214', '0.548655', '0.569067', '0.641458', '0.631740', '0.599554', '0.531184', '0.517765', '0.512185', '0.507891', '0.551164', '0.521648', '0.503332', '0.512946', '0.520314']
         : correct/total = [(9098, 14232), (9031, 14235), (9259, 14266), (9117, 14217), (7641, 14238), (7707, 14373), (7871, 14346), (8157, 14334), (9169, 14294), (9080, 14373), (8600, 14344), (7597, 14302), (7432, 14354), (7356, 14362), (7273, 14320), (7934, 14395), (7506, 14389), (7176, 14257), (7310, 14251), (7492, 14399)]
         : compromised: 0.5174, honest: 0.5773
Round 009: test acc mean=0.5694 ± 0.0527 | min=0.4953 max=0.6511
         : test loss mean=0.7839 ± 0.3222
         : individual accs = ['0.639404', '0.649456', '0.651058', '0.621580', '0.557522', '0.519307', '0.557926', '0.570741', '0.629495', '0.646420', '0.593489', '0.506782', '0.501324', '0.502924', '0.569763', '0.534838', '0.569393', '0.495265', '0.532524', '0.538579']
         : correct/total = [(9100, 14232), (9245, 14235), (9288, 14266), (8837, 14217), (7938, 14238), (7464, 14373), (8004, 14346), (8181, 14334), (8998, 14294), (9291, 14373), (8513, 14344), (7248, 14302), (7196, 14354), (7223, 14362), (8159, 14320), (7699, 14395), (8193, 14389), (7061, 14257), (7589, 14251), (7755, 14399)]
         : compromised: 0.5047, honest: 0.5856
Round 010: test acc mean=0.5765 ± 0.0610 | min=0.4918 max=0.6582
         : test loss mean=0.7821 ± 0.3112
         : individual accs = ['0.652192', '0.658166', '0.657367', '0.654568', '0.539121', '0.529395', '0.576607', '0.645179', '0.648734', '0.647951', '0.603737', '0.556915', '0.514351', '0.513369', '0.516690', '0.574575', '0.510320', '0.491758', '0.510280', '0.528023']
         : correct/total = [(9282, 14232), (9369, 14235), (9378, 14266), (9306, 14217), (7676, 14238), (7609, 14373), (8272, 14346), (9248, 14334), (9273, 14294), (9313, 14373), (8660, 14344), (7965, 14302), (7383, 14354), (7373, 14362), (7399, 14320), (8271, 14395), (7343, 14389), (7011, 14257), (7272, 14251), (7603, 14399)]
         : compromised: 0.5122, honest: 0.5925

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: d-fedavg
Attack: krum, 20.0% compromised
Final accuracy - Compromised: 0.5122, Honest: 0.5925
Overall test accuracy: mean=0.5765 ± 0.0610
