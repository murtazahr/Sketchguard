Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.4983 ± 0.0064 | min=0.4847 max=0.5122
         : test loss mean=17.3470 ± 8.4892
         : individual accs = ['0.505832', '0.504320', '0.499439', '0.512204', '0.501826', '0.494956', '0.497072', '0.495256', '0.503848', '0.485424', '0.501603', '0.494127', '0.504041', '0.494569', '0.498464', '0.501563', '0.496977', '0.484744', '0.493579', '0.496840']
         : correct/total = [(7199, 14232), (7179, 14235), (7125, 14266), (7282, 14217), (7145, 14238), (7114, 14373), (7131, 14346), (7099, 14334), (7202, 14294), (6977, 14373), (7195, 14344), (7067, 14302), (7235, 14354), (7103, 14362), (7138, 14320), (7220, 14395), (7151, 14389), (6911, 14257), (7034, 14251), (7154, 14399)]
         : compromised: 0.4961, honest: 0.4998
Round 002: test acc mean=0.5062 ± 0.0123 | min=0.4851 max=0.5334
         : test loss mean=15.4642 ± 12.5547
         : individual accs = ['0.507237', '0.533404', '0.512898', '0.509531', '0.505900', '0.490016', '0.504043', '0.499442', '0.495243', '0.527378', '0.513385', '0.500629', '0.507245', '0.493037', '0.508799', '0.485099', '0.506568', '0.502771', '0.528033', '0.494132']
         : correct/total = [(7219, 14232), (7593, 14235), (7317, 14266), (7244, 14217), (7203, 14238), (7043, 14373), (7231, 14346), (7159, 14334), (7079, 14294), (7580, 14373), (7364, 14344), (7160, 14302), (7281, 14354), (7081, 14362), (7286, 14320), (6983, 14395), (7289, 14389), (7168, 14257), (7525, 14251), (7115, 14399)]
         : compromised: 0.5080, honest: 0.5051
Round 003: test acc mean=0.4970 ± 0.0065 | min=0.4839 max=0.5095
         : test loss mean=3.9231 ± 1.7883
         : individual accs = ['0.492482', '0.483948', '0.493831', '0.484912', '0.494381', '0.493773', '0.500418', '0.490791', '0.499230', '0.509497', '0.498187', '0.505104', '0.502787', '0.507032', '0.494483', '0.497881', '0.492946', '0.498282', '0.495474', '0.503785']
         : correct/total = [(7009, 14232), (6889, 14235), (7045, 14266), (6894, 14217), (7039, 14238), (7097, 14373), (7179, 14346), (7035, 14334), (7136, 14294), (7323, 14373), (7146, 14344), (7224, 14302), (7217, 14354), (7282, 14362), (7081, 14320), (7167, 14395), (7093, 14389), (7104, 14257), (7061, 14251), (7254, 14399)]
         : compromised: 0.4976, honest: 0.4965
Round 004: test acc mean=0.5056 ± 0.0053 | min=0.4914 max=0.5132
         : test loss mean=8.3173 ± 6.2144
         : individual accs = ['0.506816', '0.512680', '0.513178', '0.507843', '0.491431', '0.507618', '0.500906', '0.504744', '0.508185', '0.505253', '0.501464', '0.506642', '0.506409', '0.496588', '0.506983', '0.512261', '0.512822', '0.503332', '0.505368', '0.502118']
         : correct/total = [(7213, 14232), (7298, 14235), (7321, 14266), (7220, 14217), (6997, 14238), (7296, 14373), (7186, 14346), (7235, 14334), (7264, 14294), (7262, 14373), (7193, 14344), (7246, 14302), (7269, 14354), (7132, 14362), (7260, 14320), (7374, 14395), (7379, 14389), (7176, 14257), (7202, 14251), (7230, 14399)]
         : compromised: 0.5057, honest: 0.5056
Round 005: test acc mean=0.4984 ± 0.0076 | min=0.4828 max=0.5120
         : test loss mean=1.4413 ± 0.5605
         : individual accs = ['0.511804', '0.482754', '0.496635', '0.486179', '0.498455', '0.502957', '0.502231', '0.506488', '0.504337', '0.489181', '0.498187', '0.493148', '0.493033', '0.503481', '0.497765', '0.496144', '0.490861', '0.501999', '0.511964', '0.500104']
         : correct/total = [(7284, 14232), (6872, 14235), (7085, 14266), (6912, 14217), (7097, 14238), (7229, 14373), (7205, 14346), (7260, 14334), (7209, 14294), (7031, 14373), (7146, 14344), (7053, 14302), (7077, 14354), (7231, 14362), (7128, 14320), (7142, 14395), (7063, 14389), (7157, 14257), (7296, 14251), (7201, 14399)]
         : compromised: 0.4984, honest: 0.4984
Round 006: test acc mean=0.5070 ± 0.0099 | min=0.4914 max=0.5286
         : test loss mean=2.6709 ± 2.0589
         : individual accs = ['0.514755', '0.524412', '0.528599', '0.491384', '0.493047', '0.506644', '0.499861', '0.500349', '0.498741', '0.512837', '0.501255', '0.504475', '0.522293', '0.498120', '0.507123', '0.508024', '0.507054', '0.515256', '0.506631', '0.498646']
         : correct/total = [(7326, 14232), (7465, 14235), (7541, 14266), (6986, 14217), (7020, 14238), (7282, 14373), (7171, 14346), (7172, 14334), (7129, 14294), (7371, 14373), (7190, 14344), (7215, 14302), (7497, 14354), (7154, 14362), (7262, 14320), (7313, 14395), (7296, 14389), (7346, 14257), (7220, 14251), (7180, 14399)]
         : compromised: 0.5106, honest: 0.5045
Round 007: test acc mean=0.4992 ± 0.0105 | min=0.4778 max=0.5272
         : test loss mean=3.4686 ± 2.9925
         : individual accs = ['0.493957', '0.477836', '0.488224', '0.484842', '0.498033', '0.501078', '0.506692', '0.496930', '0.506576', '0.527169', '0.503277', '0.500000', '0.500000', '0.513020', '0.498534', '0.497603', '0.509764', '0.494494', '0.486492', '0.498993']
         : correct/total = [(7030, 14232), (6802, 14235), (6965, 14266), (6893, 14217), (7091, 14238), (7202, 14373), (7269, 14346), (7123, 14334), (7241, 14294), (7577, 14373), (7219, 14344), (7151, 14302), (7177, 14354), (7368, 14362), (7139, 14320), (7163, 14395), (7335, 14389), (7050, 14257), (6933, 14251), (7185, 14399)]
         : compromised: 0.4964, honest: 0.5010
Round 008: test acc mean=0.5017 ± 0.0073 | min=0.4849 max=0.5159
         : test loss mean=1.0105 ± 0.4752
         : individual accs = ['0.507659', '0.495750', '0.498808', '0.484912', '0.494592', '0.498156', '0.502997', '0.510255', '0.499510', '0.515898', '0.502510', '0.507831', '0.497771', '0.506824', '0.499232', '0.497673', '0.493015', '0.498632', '0.508736', '0.512397']
         : correct/total = [(7225, 14232), (7057, 14235), (7116, 14266), (6894, 14217), (7042, 14238), (7160, 14373), (7216, 14346), (7314, 14334), (7140, 14294), (7415, 14373), (7208, 14344), (7263, 14302), (7145, 14354), (7279, 14362), (7149, 14320), (7164, 14395), (7094, 14389), (7109, 14257), (7250, 14251), (7378, 14399)]
         : compromised: 0.5016, honest: 0.5017
Round 009: test acc mean=0.5012 ± 0.0086 | min=0.4849 max=0.5235
         : test loss mean=1.3024 ± 0.6695
         : individual accs = ['0.493325', '0.504180', '0.511566', '0.484912', '0.498666', '0.504557', '0.496863', '0.515557', '0.493774', '0.507410', '0.502510', '0.500839', '0.491570', '0.494430', '0.505447', '0.502327', '0.523455', '0.498492', '0.498351', '0.495729']
         : correct/total = [(7021, 14232), (7177, 14235), (7298, 14266), (6894, 14217), (7100, 14238), (7252, 14373), (7128, 14346), (7390, 14334), (7058, 14294), (7293, 14373), (7208, 14344), (7163, 14302), (7056, 14354), (7101, 14362), (7238, 14320), (7231, 14395), (7532, 14389), (7107, 14257), (7102, 14251), (7138, 14399)]
         : compromised: 0.4997, honest: 0.5022
Round 010: test acc mean=0.4950 ± 0.0055 | min=0.4831 max=0.5068
         : test loss mean=0.9008 ± 0.1578
         : individual accs = ['0.492833', '0.483105', '0.486962', '0.484912', '0.494311', '0.495860', '0.499791', '0.492814', '0.497831', '0.497391', '0.498048', '0.493917', '0.502926', '0.506824', '0.492668', '0.497742', '0.492529', '0.495476', '0.495895', '0.498090']
         : correct/total = [(7014, 14232), (6877, 14235), (6947, 14266), (6894, 14217), (7038, 14238), (7127, 14373), (7170, 14346), (7064, 14334), (7116, 14294), (7149, 14373), (7144, 14344), (7064, 14302), (7219, 14354), (7279, 14362), (7055, 14320), (7165, 14395), (7087, 14389), (7064, 14257), (7067, 14251), (7172, 14399)]
         : compromised: 0.4958, honest: 0.4944

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 40.0% compromised
Final accuracy - Compromised: 0.4958, Honest: 0.4944
Overall test accuracy: mean=0.4950 ± 0.0055
