Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Degree statistics: avg=19.00, min=19, max=19
Model variant: baseline
Model parameters: 6,603,710
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.5233 ± 0.0311 | min=0.4669 max=0.5932
         : test loss mean=3.7209 ± 0.0278
         : individual accs = ['0.566376', '0.522246', '0.562362', '0.528271', '0.530677', '0.593189', '0.522061', '0.511612', '0.525889', '0.468787', '0.545740', '0.527784', '0.466895', '0.475816', '0.539240', '0.540333', '0.492656', '0.528568', '0.511508', '0.506541']
         : correct/total = [(2338, 4128), (2195, 4203), (2295, 4081), (2289, 4333), (2171, 4091), (2543, 4287), (2189, 4193), (2225, 4349), (2204, 4191), (2005, 4277), (2261, 4143), (2213, 4193), (1911, 4093), (1997, 4197), (2185, 4052), (2177, 4029), (2046, 4153), (2211, 4183), (2089, 4084), (2091, 4128)]
Round 002: test acc mean=0.6877 ± 0.0146 | min=0.6615 max=0.7162
         : test loss mean=3.4467 ± 0.0275
         : individual accs = ['0.699370', '0.691173', '0.685616', '0.696054', '0.699584', '0.715652', '0.662771', '0.688204', '0.679790', '0.669394', '0.706010', '0.680420', '0.678964', '0.686919', '0.691017', '0.661454', '0.679750', '0.716232', '0.687316', '0.679021']
         : correct/total = [(2887, 4128), (2905, 4203), (2798, 4081), (3016, 4333), (2862, 4091), (3068, 4287), (2779, 4193), (2993, 4349), (2849, 4191), (2863, 4277), (2925, 4143), (2853, 4193), (2779, 4093), (2883, 4197), (2800, 4052), (2665, 4029), (2823, 4153), (2996, 4183), (2807, 4084), (2803, 4128)]
Round 003: test acc mean=0.7109 ± 0.0222 | min=0.6369 max=0.7411
         : test loss mean=3.1976 ± 0.0371
         : individual accs = ['0.722626', '0.706638', '0.704239', '0.717286', '0.725739', '0.707721', '0.705938', '0.741090', '0.712479', '0.736030', '0.734009', '0.680181', '0.723919', '0.708125', '0.714709', '0.704890', '0.691789', '0.636863', '0.726249', '0.716812']
         : correct/total = [(2983, 4128), (2970, 4203), (2874, 4081), (3108, 4333), (2969, 4091), (3034, 4287), (2960, 4193), (3223, 4349), (2986, 4191), (3148, 4277), (3041, 4143), (2852, 4193), (2963, 4093), (2972, 4197), (2896, 4052), (2840, 4029), (2873, 4153), (2664, 4183), (2966, 4084), (2959, 4128)]
Round 004: test acc mean=0.6967 ± 0.0214 | min=0.6483 max=0.7380
         : test loss mean=2.8111 ± 0.0456
         : individual accs = ['0.704457', '0.738044', '0.686106', '0.687976', '0.714495', '0.680196', '0.704746', '0.715797', '0.709854', '0.681552', '0.676563', '0.707608', '0.665771', '0.693114', '0.703356', '0.692231', '0.733205', '0.679417', '0.711557', '0.648256']
         : correct/total = [(2908, 4128), (3102, 4203), (2800, 4081), (2981, 4333), (2923, 4091), (2916, 4287), (2955, 4193), (3113, 4349), (2975, 4191), (2915, 4277), (2803, 4143), (2967, 4193), (2725, 4093), (2909, 4197), (2850, 4052), (2789, 4029), (3045, 4153), (2842, 4183), (2906, 4084), (2676, 4128)]
Round 005: test acc mean=0.6494 ± 0.0272 | min=0.6074 max=0.7071
         : test loss mean=2.2506 ± 0.0708
         : individual accs = ['0.658430', '0.661908', '0.607449', '0.607893', '0.679052', '0.650805', '0.653709', '0.707059', '0.646385', '0.677110', '0.629737', '0.651801', '0.612998', '0.653562', '0.648569', '0.610822', '0.663857', '0.646665', '0.694662', '0.625969']
         : correct/total = [(2718, 4128), (2782, 4203), (2479, 4081), (2634, 4333), (2778, 4091), (2790, 4287), (2741, 4193), (3075, 4349), (2709, 4191), (2896, 4277), (2609, 4143), (2733, 4193), (2509, 4093), (2743, 4197), (2628, 4052), (2461, 4029), (2757, 4153), (2705, 4183), (2837, 4084), (2584, 4128)]
Round 006: test acc mean=0.6796 ± 0.0259 | min=0.6240 max=0.7266
         : test loss mean=1.5494 ± 0.0654
         : individual accs = ['0.675145', '0.700214', '0.645920', '0.624048', '0.711073', '0.686961', '0.706654', '0.677397', '0.677643', '0.655366', '0.675839', '0.714047', '0.644759', '0.655468', '0.726555', '0.662447', '0.695882', '0.681090', '0.702987', '0.671996']
         : correct/total = [(2787, 4128), (2943, 4203), (2636, 4081), (2704, 4333), (2909, 4091), (2945, 4287), (2963, 4193), (2946, 4349), (2840, 4191), (2803, 4277), (2800, 4143), (2994, 4193), (2639, 4093), (2751, 4197), (2944, 4052), (2669, 4029), (2890, 4153), (2849, 4183), (2871, 4084), (2774, 4128)]
Round 007: test acc mean=0.7743 ± 0.0147 | min=0.7478 max=0.7974
         : test loss mean=0.8978 ± 0.0454
         : individual accs = ['0.780523', '0.777302', '0.750306', '0.751904', '0.797360', '0.781666', '0.772955', '0.787767', '0.772608', '0.776479', '0.747767', '0.774147', '0.782800', '0.797236', '0.782330', '0.749814', '0.784734', '0.760220', '0.785749', '0.771560']
         : correct/total = [(3222, 4128), (3267, 4203), (3062, 4081), (3258, 4333), (3262, 4091), (3351, 4287), (3241, 4193), (3426, 4349), (3238, 4191), (3321, 4277), (3098, 4143), (3246, 4193), (3204, 4093), (3346, 4197), (3170, 4052), (3021, 4029), (3259, 4153), (3180, 4183), (3209, 4084), (3185, 4128)]
Round 008: test acc mean=0.8175 ± 0.0073 | min=0.8032 max=0.8326
         : test loss mean=0.6007 ± 0.0242
         : individual accs = ['0.815649', '0.825363', '0.822102', '0.814447', '0.821560', '0.818521', '0.813976', '0.832605', '0.815796', '0.826748', '0.808834', '0.817315', '0.822868', '0.819871', '0.806515', '0.803177', '0.816037', '0.810901', '0.827130', '0.811531']
         : correct/total = [(3367, 4128), (3469, 4203), (3355, 4081), (3529, 4333), (3361, 4091), (3509, 4287), (3413, 4193), (3621, 4349), (3419, 4191), (3536, 4277), (3351, 4143), (3427, 4193), (3368, 4093), (3441, 4197), (3268, 4052), (3236, 4029), (3389, 4153), (3392, 4183), (3378, 4084), (3350, 4128)]
Round 009: test acc mean=0.8308 ± 0.0071 | min=0.8221 max=0.8459
         : test loss mean=0.5261 ± 0.0211
         : individual accs = ['0.825581', '0.836783', '0.840725', '0.831295', '0.839648', '0.834150', '0.824946', '0.845942', '0.827010', '0.839140', '0.822351', '0.822084', '0.833130', '0.827496', '0.823791', '0.822537', '0.836985', '0.825245', '0.833497', '0.824612']
         : correct/total = [(3408, 4128), (3517, 4203), (3431, 4081), (3602, 4333), (3435, 4091), (3576, 4287), (3459, 4193), (3679, 4349), (3466, 4191), (3589, 4277), (3407, 4143), (3447, 4193), (3410, 4093), (3473, 4197), (3338, 4052), (3314, 4029), (3476, 4153), (3452, 4183), (3404, 4084), (3404, 4128)]
Round 010: test acc mean=0.8389 ± 0.0067 | min=0.8258 max=0.8480
         : test loss mean=0.4949 ± 0.0212
         : individual accs = ['0.838178', '0.841304', '0.843911', '0.839603', '0.846981', '0.839282', '0.835679', '0.848011', '0.836316', '0.846388', '0.834178', '0.826139', '0.843635', '0.844651', '0.830701', '0.830479', '0.844450', '0.836003', '0.845984', '0.825824']
         : correct/total = [(3460, 4128), (3536, 4203), (3444, 4081), (3638, 4333), (3465, 4091), (3598, 4287), (3504, 4193), (3688, 4349), (3505, 4191), (3620, 4277), (3456, 4143), (3464, 4193), (3453, 4093), (3545, 4197), (3366, 4052), (3346, 4029), (3507, 4153), (3497, 4183), (3455, 4084), (3409, 4128)]

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: balance
Overall test accuracy: mean=0.8389 ± 0.0067

=== BALANCE SUMMARY ===
Node 0: acceptance=1.000
Node 1: acceptance=1.000
Node 2: acceptance=1.000
Node 3: acceptance=1.000
Node 4: acceptance=1.000
Node 5: acceptance=1.000
Node 6: acceptance=1.000
Node 7: acceptance=1.000
Node 8: acceptance=1.000
Node 9: acceptance=1.000
Node 10: acceptance=1.000
Node 11: acceptance=1.000
Node 12: acceptance=1.000
Node 13: acceptance=1.000
Node 14: acceptance=1.000
Node 15: acceptance=1.000
Node 16: acceptance=1.000
Node 17: acceptance=1.000
Node 18: acceptance=1.000
Node 19: acceptance=1.000

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.236s (84.1%)
    - Aggregation: 0.045s (15.9%)
  TOTALS:
    - Total computation: 0.281s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.281s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.148s
  - Aggregation: 0.015s
  - Model transfer: 0.000s
  - Total per node: 0.163s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 2.954s
  - Total aggregation: 0.303s
  - Total model transfer: 0.000s
  - Grand total: 3.257s
  - Mean acceptance rate: 1.000

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
