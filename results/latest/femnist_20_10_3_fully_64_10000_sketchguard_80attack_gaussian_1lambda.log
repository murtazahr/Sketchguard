Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Degree statistics: avg=19.00, min=19, max=19
Attack: Compromised 16/20 nodes: [1, 2, 3, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19]
Attack type: gaussian, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Sketchguard Node 0:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 1:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 2:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 3:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 4:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 5:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 6:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 7:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 8:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 9:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 10:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 11:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 12:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 13:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 14:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 15:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 16:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 17:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 18:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 19:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard ALGORITHM (Sketch-based Filtering + State Aggregation)
  - Model dimension: 6,603,710 parameters
  - Config: SketchguardConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1, sketch_size=1000, network_seed=987654321, attack_detection_window=5)
  - Sketch size: 1000
  - Compression ratio: 6603.7x
  - Complexity: O(d + N×k) = O(6,603,710 + 20×1000)
  - Theoretical speedup vs BALANCE: 19.9x
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.4694 ± 0.0452 | min=0.3713 max=0.5668
         : test loss mean=3.7621 ± 0.0300
         : individual accs = ['0.435320', '0.466096', '0.545210', '0.505654', '0.443901', '0.566830', '0.480563', '0.475742', '0.463135', '0.371288', '0.479363', '0.490580', '0.417054', '0.440076', '0.486180', '0.530901', '0.424031', '0.469041', '0.420666', '0.476017']
         : correct/total = [(1797, 4128), (1959, 4203), (2225, 4081), (2191, 4333), (1816, 4091), (2430, 4287), (2015, 4193), (2069, 4349), (1941, 4191), (1588, 4277), (1986, 4143), (2057, 4193), (1707, 4093), (1847, 4197), (1970, 4052), (2139, 4029), (1761, 4153), (1962, 4183), (1718, 4084), (1965, 4128)]
         : compromised: 0.4755, honest: 0.4447
         : sketchguard stats = ['Node 0: acc_rate=0.158', 'Node 1: acc_rate=0.211', 'Node 2: acc_rate=0.211']...
Round 002: test acc mean=0.6326 ± 0.0423 | min=0.4847 max=0.6905
         : test loss mean=3.1773 ± 0.2453
         : individual accs = ['0.628391', '0.672139', '0.638079', '0.656358', '0.690540', '0.661768', '0.623897', '0.649115', '0.646862', '0.597381', '0.610669', '0.592654', '0.627413', '0.651894', '0.656466', '0.484736', '0.670359', '0.628257', '0.656954', '0.608527']
         : correct/total = [(2594, 4128), (2825, 4203), (2604, 4081), (2844, 4333), (2825, 4091), (2837, 4287), (2616, 4193), (2823, 4349), (2711, 4191), (2555, 4277), (2530, 4143), (2485, 4193), (2568, 4093), (2736, 4197), (2660, 4052), (1953, 4029), (2784, 4153), (2628, 4183), (2683, 4084), (2512, 4128)]
         : compromised: 0.6259, honest: 0.6596
         : sketchguard stats = ['Node 0: acc_rate=0.158', 'Node 1: acc_rate=0.211', 'Node 2: acc_rate=0.211']...
Round 003: test acc mean=0.6888 ± 0.0372 | min=0.6257 max=0.7602
         : test loss mean=1.8087 ± 0.3472
         : individual accs = ['0.747335', '0.709255', '0.679490', '0.684053', '0.760205', '0.690226', '0.697591', '0.737641', '0.698163', '0.684124', '0.638909', '0.670642', '0.709015', '0.680963', '0.680652', '0.625714', '0.740910', '0.628257', '0.666014', '0.646318']
         : correct/total = [(3085, 4128), (2981, 4203), (2773, 4081), (2964, 4333), (3110, 4091), (2959, 4287), (2925, 4193), (3208, 4349), (2926, 4191), (2926, 4277), (2647, 4143), (2812, 4193), (2902, 4093), (2858, 4197), (2758, 4052), (2521, 4029), (3077, 4153), (2628, 4183), (2720, 4084), (2668, 4128)]
         : compromised: 0.6743, honest: 0.7465
         : sketchguard stats = ['Node 0: acc_rate=0.158', 'Node 1: acc_rate=0.211', 'Node 2: acc_rate=0.211']...
Round 004: test acc mean=0.7901 ± 0.0115 | min=0.7611 max=0.8130
         : test loss mean=0.7571 ± 0.0629
         : individual accs = ['0.792878', '0.795384', '0.792208', '0.783522', '0.813004', '0.791229', '0.785118', '0.805013', '0.784538', '0.798457', '0.776008', '0.780110', '0.800147', '0.789612', '0.785044', '0.780839', '0.808331', '0.787712', '0.791381', '0.761143']
         : correct/total = [(3273, 4128), (3343, 4203), (3233, 4081), (3395, 4333), (3326, 4091), (3392, 4287), (3292, 4193), (3501, 4349), (3288, 4191), (3415, 4277), (3215, 4143), (3271, 4193), (3275, 4093), (3314, 4197), (3181, 4052), (3146, 4029), (3357, 4153), (3295, 4183), (3232, 4084), (3142, 4128)]
         : compromised: 0.7864, honest: 0.8048
         : sketchguard stats = ['Node 0: acc_rate=0.158', 'Node 1: acc_rate=0.211', 'Node 2: acc_rate=0.211']...
Round 005: test acc mean=0.8178 ± 0.0074 | min=0.8044 max=0.8294
         : test loss mean=0.5774 ± 0.0274
         : individual accs = ['0.819283', '0.826790', '0.821612', '0.811909', '0.829382', '0.821787', '0.813260', '0.826167', '0.811024', '0.824877', '0.812213', '0.809921', '0.824823', '0.822969', '0.816634', '0.804418', '0.824946', '0.809467', '0.819540', '0.805475']
         : correct/total = [(3382, 4128), (3475, 4203), (3353, 4081), (3518, 4333), (3393, 4091), (3523, 4287), (3410, 4193), (3593, 4349), (3399, 4191), (3528, 4277), (3365, 4143), (3396, 4193), (3376, 4093), (3454, 4197), (3309, 4052), (3241, 4029), (3426, 4153), (3386, 4183), (3347, 4084), (3325, 4128)]
         : compromised: 0.8160, honest: 0.8249
         : sketchguard stats = ['Node 0: acc_rate=0.158', 'Node 1: acc_rate=0.211', 'Node 2: acc_rate=0.211']...
Round 006: test acc mean=0.8296 ± 0.0068 | min=0.8171 max=0.8418
         : test loss mean=0.5257 ± 0.0227
         : individual accs = ['0.827277', '0.838211', '0.838275', '0.829910', '0.833781', '0.835083', '0.821369', '0.841803', '0.824624', '0.836100', '0.822834', '0.823277', '0.830687', '0.830355', '0.828727', '0.817076', '0.832410', '0.826201', '0.835700', '0.818314']
         : correct/total = [(3415, 4128), (3523, 4203), (3421, 4081), (3596, 4333), (3411, 4091), (3580, 4287), (3444, 4193), (3661, 4349), (3456, 4191), (3576, 4277), (3409, 4143), (3452, 4193), (3400, 4093), (3485, 4197), (3358, 4052), (3292, 4029), (3457, 4153), (3456, 4183), (3413, 4084), (3378, 4128)]
         : compromised: 0.8285, honest: 0.8338
         : sketchguard stats = ['Node 0: acc_rate=0.158', 'Node 1: acc_rate=0.211', 'Node 2: acc_rate=0.211']...
Round 007: test acc mean=0.8394 ± 0.0072 | min=0.8272 max=0.8511
         : test loss mean=0.4909 ± 0.0227
         : individual accs = ['0.838905', '0.843207', '0.849057', '0.836372', '0.851137', '0.837882', '0.836155', '0.849851', '0.835600', '0.848960', '0.827178', '0.830193', '0.841925', '0.839171', '0.837611', '0.828493', '0.843246', '0.832895', '0.847943', '0.831395']
         : correct/total = [(3463, 4128), (3544, 4203), (3465, 4081), (3624, 4333), (3482, 4091), (3592, 4287), (3506, 4193), (3696, 4349), (3502, 4191), (3631, 4277), (3427, 4143), (3481, 4193), (3446, 4093), (3522, 4197), (3394, 4052), (3338, 4029), (3502, 4153), (3484, 4183), (3463, 4084), (3432, 4128)]
         : compromised: 0.8378, honest: 0.8458
         : sketchguard stats = ['Node 0: acc_rate=0.158', 'Node 1: acc_rate=0.211', 'Node 2: acc_rate=0.211']...
Round 008: test acc mean=0.8451 ± 0.0072 | min=0.8307 max=0.8568
         : test loss mean=0.4703 ± 0.0241
         : individual accs = ['0.846657', '0.854152', '0.849547', '0.846296', '0.856759', '0.850711', '0.833771', '0.853759', '0.842281', '0.853636', '0.838764', '0.835202', '0.848278', '0.843936', '0.838105', '0.830727', '0.847821', '0.841501', '0.850147', '0.839874']
         : correct/total = [(3495, 4128), (3590, 4203), (3467, 4081), (3667, 4333), (3505, 4091), (3647, 4287), (3496, 4193), (3713, 4349), (3530, 4191), (3651, 4277), (3475, 4143), (3502, 4193), (3472, 4093), (3542, 4197), (3396, 4052), (3347, 4029), (3521, 4153), (3520, 4183), (3472, 4084), (3467, 4128)]
         : compromised: 0.8436, honest: 0.8512
         : sketchguard stats = ['Node 0: acc_rate=0.158', 'Node 1: acc_rate=0.211', 'Node 2: acc_rate=0.211']...
Round 009: test acc mean=0.8480 ± 0.0068 | min=0.8387 max=0.8609
         : test loss mean=0.4554 ± 0.0208
         : individual accs = ['0.842539', '0.853676', '0.854938', '0.851142', '0.856514', '0.853511', '0.839256', '0.860888', '0.846337', '0.853402', '0.839971', '0.839971', '0.846079', '0.847748', '0.843040', '0.838670', '0.855285', '0.842697', '0.854065', '0.840116']
         : correct/total = [(3478, 4128), (3588, 4203), (3489, 4081), (3688, 4333), (3504, 4091), (3659, 4287), (3519, 4193), (3744, 4349), (3547, 4191), (3650, 4277), (3480, 4143), (3522, 4193), (3463, 4093), (3558, 4197), (3416, 4052), (3379, 4029), (3552, 4153), (3525, 4183), (3488, 4084), (3468, 4128)]
         : compromised: 0.8465, honest: 0.8538
         : sketchguard stats = ['Node 0: acc_rate=0.158', 'Node 1: acc_rate=0.211', 'Node 2: acc_rate=0.211']...
Round 010: test acc mean=0.8525 ± 0.0066 | min=0.8396 max=0.8609
         : test loss mean=0.4441 ± 0.0218
         : individual accs = ['0.853682', '0.857245', '0.857878', '0.856450', '0.860914', '0.855143', '0.845934', '0.860428', '0.853018', '0.856441', '0.846729', '0.840687', '0.854630', '0.853228', '0.848223', '0.841648', '0.859860', '0.847717', '0.859696', '0.839632']
         : correct/total = [(3524, 4128), (3603, 4203), (3501, 4081), (3711, 4333), (3522, 4091), (3666, 4287), (3547, 4193), (3742, 4349), (3575, 4191), (3663, 4277), (3508, 4143), (3525, 4193), (3498, 4093), (3581, 4197), (3437, 4052), (3391, 4029), (3571, 4153), (3546, 4183), (3511, 4084), (3466, 4128)]
         : compromised: 0.8509, honest: 0.8587
         : sketchguard stats = ['Node 0: acc_rate=0.158', 'Node 1: acc_rate=0.211', 'Node 2: acc_rate=0.211']...

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: sketchguard
Attack: gaussian, 80.0% compromised
Final accuracy - Compromised: 0.8509, Honest: 0.8587
Overall test accuracy: mean=0.8525 ± 0.0066

=== Sketchguard SUMMARY ===
Node 0: acceptance=0.158
Node 1: acceptance=0.211
Node 2: acceptance=0.211
Node 3: acceptance=0.211
Node 4: acceptance=0.158
Node 5: acceptance=0.211
Node 6: acceptance=0.211
Node 7: acceptance=0.158
Node 8: acceptance=0.211
Node 9: acceptance=0.211
Node 10: acceptance=0.211
Node 11: acceptance=0.211
Node 12: acceptance=0.211
Node 13: acceptance=0.211
Node 14: acceptance=0.211
Node 15: acceptance=0.211
Node 16: acceptance=0.158
Node 17: acceptance=0.211
Node 18: acceptance=0.211
Node 19: acceptance=0.211

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Sketch transfer: 0.000s (0.0%)
    - Model fetch (accepted): 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Sketching: 2.279s (99.3%)
    - Filtering: 0.002s (0.1%)
    - Aggregation: 0.014s (0.6%)
  TOTALS:
    - Total computation: 2.295s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 2.295s

=== PER-NODE AVERAGE TIME ===
  - Sketching: 2.094s
  - Filtering: 0.001s
  - Aggregation: 0.010s
  - Sketch transfer: 0.000s
  - Model fetch: 0.000s
  - Total per node: 2.106s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total sketching: 41.886s
  - Total filtering: 0.027s
  - Total aggregation: 0.197s
  - Total sketch transfer: 0.000s
  - Total model fetch: 0.000s
  - Grand total: 42.110s
  - Mean acceptance rate: 0.200

Sketchguard Algorithm Properties:
  - Original dimension: 6,603,710
  - Sketch size: 1000
  - Compression ratio: 19.9x
  - Single repetition: No repetitions needed
  - Theoretical complexity: O(d + N×k)
  - Approach: Sketch filtering + state aggregation
