Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Degree statistics: avg=19.00, min=19, max=19
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: gaussian, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
UBAR ALGORITHM (Two-Stage Byzantine-resilient)
  - Model dimension: 6,603,710 parameters
  - Rho parameter: 0.6
  - Stage 1: Distance-based filtering (select 60% closest neighbors)
  - Stage 2: Performance-based selection (loss comparison)
  - Complexity: O(deg(i)×d + deg(i)×inference)
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.4585 ± 0.0570 | min=0.3435 max=0.5489
         : test loss mean=3.7127 ± 0.0736
         : individual accs = ['0.516231', '0.442303', '0.548885', '0.392569', '0.426791', '0.540471', '0.405676', '0.520579', '0.515867', '0.343465', '0.429882', '0.463868', '0.467139', '0.451036', '0.516782', '0.451229', '0.444016', '0.354530', '0.503428', '0.435078']
         : correct/total = [(2131, 4128), (1859, 4203), (2240, 4081), (1701, 4333), (1746, 4091), (2317, 4287), (1701, 4193), (2264, 4349), (2162, 4191), (1469, 4277), (1781, 4143), (1945, 4193), (1912, 4093), (1893, 4197), (2094, 4052), (1818, 4029), (1844, 4153), (1483, 4183), (2056, 4084), (1796, 4128)]
         : compromised: 0.4674, honest: 0.4525
         : ubar stats = ['Node 0: s1=0.579, s2=0.364', 'Node 1: s1=0.579, s2=0.182', 'Node 2: s1=0.579, s2=0.545']...
Round 002: test acc mean=0.6599 ± 0.0304 | min=0.6022 max=0.7103
         : test loss mean=3.2337 ± 0.3929
         : individual accs = ['0.710271', '0.633595', '0.670179', '0.602816', '0.648252', '0.657336', '0.655855', '0.674638', '0.648771', '0.671031', '0.707700', '0.602194', '0.634987', '0.680724', '0.658934', '0.696203', '0.646280', '0.708821', '0.655730', '0.633721']
         : correct/total = [(2932, 4128), (2663, 4203), (2735, 4081), (2612, 4333), (2652, 4091), (2818, 4287), (2750, 4193), (2934, 4349), (2719, 4191), (2870, 4277), (2932, 4143), (2525, 4193), (2599, 4093), (2857, 4197), (2670, 4052), (2805, 4029), (2684, 4153), (2965, 4183), (2678, 4084), (2616, 4128)]
         : compromised: 0.6540, honest: 0.6638
         : ubar stats = ['Node 0: s1=0.579, s2=0.682', 'Node 1: s1=0.579, s2=0.136', 'Node 2: s1=0.579, s2=0.545']...
Round 003: test acc mean=0.6892 ± 0.0496 | min=0.5815 max=0.7650
         : test loss mean=2.5935 ± 0.4901
         : individual accs = ['0.765019', '0.758030', '0.581475', '0.697900', '0.743583', '0.678796', '0.694014', '0.679467', '0.688141', '0.659341', '0.749940', '0.641068', '0.700464', '0.668811', '0.613524', '0.747084', '0.708163', '0.681090', '0.611166', '0.717781']
         : correct/total = [(3158, 4128), (3186, 4203), (2373, 4081), (3024, 4333), (3042, 4091), (2910, 4287), (2910, 4193), (2955, 4349), (2884, 4191), (2820, 4277), (3107, 4143), (2688, 4193), (2867, 4093), (2807, 4197), (2486, 4052), (3010, 4029), (2941, 4153), (2849, 4183), (2496, 4084), (2963, 4128)]
         : compromised: 0.6691, honest: 0.7027
         : ubar stats = ['Node 0: s1=0.579, s2=0.636', 'Node 1: s1=0.579, s2=0.152', 'Node 2: s1=0.579, s2=0.394']...
Round 004: test acc mean=0.7291 ± 0.0388 | min=0.6381 max=0.7791
         : test loss mean=1.6795 ± 0.5112
         : individual accs = ['0.708333', '0.772543', '0.642735', '0.772444', '0.748472', '0.696758', '0.726449', '0.733732', '0.712241', '0.723638', '0.776732', '0.697591', '0.737356', '0.715511', '0.760118', '0.779102', '0.766434', '0.737031', '0.638100', '0.735950']
         : correct/total = [(2924, 4128), (3247, 4203), (2623, 4081), (3347, 4333), (3062, 4091), (2987, 4287), (3046, 4193), (3191, 4349), (2985, 4191), (3095, 4277), (3218, 4143), (2925, 4193), (3018, 4093), (3003, 4197), (3080, 4052), (3139, 4029), (3183, 4153), (3083, 4183), (2606, 4084), (3038, 4128)]
         : compromised: 0.7194, honest: 0.7355
         : ubar stats = ['Node 0: s1=0.579, s2=0.500', 'Node 1: s1=0.579, s2=0.136', 'Node 2: s1=0.579, s2=0.409']...
Round 005: test acc mean=0.7773 ± 0.0304 | min=0.6735 max=0.8092
         : test loss mean=0.9943 ± 0.3131
         : individual accs = ['0.808624', '0.805377', '0.747611', '0.792523', '0.791982', '0.771402', '0.789411', '0.791446', '0.772847', '0.809212', '0.795317', '0.747913', '0.784999', '0.779604', '0.673495', '0.778853', '0.806887', '0.745159', '0.772772', '0.781492']
         : correct/total = [(3338, 4128), (3385, 4203), (3051, 4081), (3434, 4333), (3240, 4091), (3307, 4287), (3310, 4193), (3442, 4349), (3239, 4191), (3461, 4277), (3295, 4143), (3136, 4193), (3213, 4093), (3272, 4197), (2729, 4052), (3138, 4029), (3351, 4153), (3117, 4183), (3156, 4084), (3226, 4128)]
         : compromised: 0.7601, honest: 0.7889
         : ubar stats = ['Node 0: s1=0.579, s2=0.418', 'Node 1: s1=0.579, s2=0.218', 'Node 2: s1=0.579, s2=0.491']...
Round 006: test acc mean=0.8112 ± 0.0092 | min=0.7887 max=0.8294
         : test loss mean=0.6563 ± 0.0601
         : individual accs = ['0.816376', '0.829408', '0.812791', '0.813293', '0.823515', '0.817122', '0.809921', '0.819269', '0.808399', '0.817162', '0.811731', '0.788695', '0.800391', '0.814868', '0.804047', '0.801191', '0.817963', '0.809228', '0.811459', '0.796996']
         : correct/total = [(3370, 4128), (3486, 4203), (3317, 4081), (3524, 4333), (3369, 4091), (3503, 4287), (3396, 4193), (3563, 4349), (3388, 4191), (3495, 4277), (3363, 4143), (3307, 4193), (3276, 4093), (3420, 4197), (3258, 4052), (3228, 4029), (3397, 4153), (3385, 4183), (3314, 4084), (3290, 4128)]
         : compromised: 0.8094, honest: 0.8124
         : ubar stats = ['Node 0: s1=0.579, s2=0.424', 'Node 1: s1=0.579, s2=0.227', 'Node 2: s1=0.579, s2=0.455']...
Round 007: test acc mean=0.8257 ± 0.0062 | min=0.8137 max=0.8345
         : test loss mean=0.5623 ± 0.0263
         : individual accs = ['0.830426', '0.833214', '0.820632', '0.826679', '0.834026', '0.830184', '0.825662', '0.830076', '0.821284', '0.834463', '0.815593', '0.813737', '0.827266', '0.823207', '0.824778', '0.818069', '0.831688', '0.819029', '0.832272', '0.821948']
         : correct/total = [(3428, 4128), (3502, 4203), (3349, 4081), (3582, 4333), (3412, 4091), (3559, 4287), (3462, 4193), (3610, 4349), (3442, 4191), (3569, 4277), (3379, 4143), (3412, 4193), (3386, 4093), (3455, 4197), (3342, 4052), (3296, 4029), (3454, 4153), (3426, 4183), (3399, 4084), (3393, 4128)]
         : compromised: 0.8255, honest: 0.8259
         : ubar stats = ['Node 0: s1=0.579, s2=0.442', 'Node 1: s1=0.579, s2=0.234', 'Node 2: s1=0.579, s2=0.403']...
Round 008: test acc mean=0.8335 ± 0.0082 | min=0.8192 max=0.8459
         : test loss mean=0.5131 ± 0.0248
         : individual accs = ['0.836725', '0.844635', '0.838765', '0.837757', '0.841604', '0.839748', '0.825662', '0.845942', '0.832975', '0.838438', '0.819937', '0.819223', '0.837039', '0.837503', '0.820829', '0.824770', '0.836263', '0.824050', '0.840597', '0.828488']
         : correct/total = [(3454, 4128), (3550, 4203), (3423, 4081), (3630, 4333), (3443, 4091), (3600, 4287), (3462, 4193), (3679, 4349), (3491, 4191), (3586, 4277), (3397, 4143), (3435, 4193), (3426, 4093), (3515, 4197), (3326, 4052), (3323, 4029), (3473, 4153), (3447, 4183), (3433, 4084), (3420, 4128)]
         : compromised: 0.8330, honest: 0.8339
         : ubar stats = ['Node 0: s1=0.579, s2=0.420', 'Node 1: s1=0.579, s2=0.216', 'Node 2: s1=0.579, s2=0.364']...
Round 009: test acc mean=0.8389 ± 0.0078 | min=0.8253 max=0.8534
         : test loss mean=0.4900 ± 0.0194
         : individual accs = ['0.825339', '0.853438', '0.849792', '0.837295', '0.848692', '0.846746', '0.836632', '0.841343', '0.834646', '0.843348', '0.830558', '0.832817', '0.835573', '0.838456', '0.835390', '0.827997', '0.848543', '0.837676', '0.845250', '0.828488']
         : correct/total = [(3407, 4128), (3587, 4203), (3468, 4081), (3628, 4333), (3472, 4091), (3630, 4287), (3508, 4193), (3659, 4349), (3498, 4191), (3607, 4277), (3441, 4143), (3492, 4193), (3420, 4093), (3519, 4197), (3385, 4052), (3336, 4029), (3524, 4153), (3504, 4183), (3452, 4084), (3420, 4128)]
         : compromised: 0.8407, honest: 0.8377
         : ubar stats = ['Node 0: s1=0.579, s2=0.384', 'Node 1: s1=0.579, s2=0.253', 'Node 2: s1=0.579, s2=0.333']...
Round 010: test acc mean=0.8439 ± 0.0085 | min=0.8285 max=0.8549
         : test loss mean=0.4699 ± 0.0235
         : individual accs = ['0.846899', '0.854866', '0.853712', '0.852296', '0.847470', '0.850245', '0.841641', '0.853070', '0.837748', '0.853636', '0.836350', '0.830670', '0.853653', '0.832023', '0.834650', '0.828493', '0.845895', '0.841501', '0.847943', '0.835514']
         : correct/total = [(3496, 4128), (3593, 4203), (3484, 4081), (3693, 4333), (3467, 4091), (3645, 4287), (3529, 4193), (3710, 4349), (3511, 4191), (3651, 4277), (3465, 4143), (3483, 4193), (3494, 4093), (3492, 4197), (3382, 4052), (3338, 4029), (3513, 4153), (3520, 4183), (3463, 4084), (3449, 4128)]
         : compromised: 0.8432, honest: 0.8444
         : ubar stats = ['Node 0: s1=0.579, s2=0.364', 'Node 1: s1=0.579, s2=0.309', 'Node 2: s1=0.579, s2=0.327']...

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: ubar
Attack: gaussian, 40.0% compromised
Final accuracy - Compromised: 0.8432, Honest: 0.8444
Overall test accuracy: mean=0.8439 ± 0.0085

=== UBAR SUMMARY ===
Node 0: stage1=0.579, stage2=0.364, overall=0.211
Node 1: stage1=0.579, stage2=0.309, overall=0.179
Node 2: stage1=0.579, stage2=0.327, overall=0.189
Node 3: stage1=0.579, stage2=0.173, overall=0.100
Node 4: stage1=0.579, stage2=0.245, overall=0.142
Node 5: stage1=0.579, stage2=0.518, overall=0.300
Node 6: stage1=0.579, stage2=0.382, overall=0.221
Node 7: stage1=0.579, stage2=0.400, overall=0.232
Node 8: stage1=0.579, stage2=0.436, overall=0.253
Node 9: stage1=0.579, stage2=0.327, overall=0.189
Node 10: stage1=0.579, stage2=0.300, overall=0.174
Node 11: stage1=0.579, stage2=0.336, overall=0.195
Node 12: stage1=0.579, stage2=0.391, overall=0.226
Node 13: stage1=0.579, stage2=0.355, overall=0.205
Node 14: stage1=0.579, stage2=0.245, overall=0.142
Node 15: stage1=0.579, stage2=0.255, overall=0.147
Node 16: stage1=0.579, stage2=0.245, overall=0.142
Node 17: stage1=0.579, stage2=0.355, overall=0.205
Node 18: stage1=0.579, stage2=0.327, overall=0.189
Node 19: stage1=0.579, stage2=0.264, overall=0.153

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Distance computation: 0.197s (4.6%)
    - Loss computation: 4.107s (95.1%)
    - Aggregation: 0.013s (0.3%)
  TOTALS:
    - Total computation: 4.317s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 4.317s

=== PER-NODE AVERAGE TIME ===
  - Distance computation: 0.119s
  - Loss computation: 3.848s
  - Aggregation: 0.007s
  - Model transfer: 0.000s
  - Total per node: 3.974s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total distance computation: 2.379s
  - Total loss computation: 76.953s
  - Total aggregation: 0.142s
  - Total model transfer: 0.000s
  - Grand total: 79.474s
  - Mean Stage 1 acceptance rate: 0.579
  - Mean Stage 2 acceptance rate: 0.328
  - Overall acceptance rate: 0.190

UBAR Algorithm Properties:
  - Model dimension: 6,603,710
  - Rho parameter: 0.6
  - Two-stage approach: Distance filtering + loss evaluation
  - Stage 1 selects: 60% of neighbors
  - Stage 2 uses: Training sample loss comparison
  - Theoretical complexity: O(deg(i)×d + deg(i)×inference)
  - Approach: UBAR paper implementation
