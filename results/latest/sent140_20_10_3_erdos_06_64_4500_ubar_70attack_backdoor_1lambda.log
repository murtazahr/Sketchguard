Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 14/20 nodes: [1, 2, 3, 5, 6, 8, 11, 12, 13, 14, 15, 17, 18, 19]
Attack type: backdoor, lambda: 1.0
Backdoor target label: 1, trigger size: 3
Model variant: baseline
Model parameters: 1,174,986
UBAR ALGORITHM (Two-Stage Byzantine-resilient)
  - Model dimension: 1,174,986 parameters
  - Rho parameter: 0.30000000000000004
  - Stage 1: Distance-based filtering (select 30% closest neighbors)
  - Stage 2: Performance-based selection (loss comparison)
  - Complexity: O(deg(i)×d + deg(i)×inference)
Initial test acc across nodes: mean=0.4953 ± 0.0174
Backdoor attack: Created poisoned datasets for 14 compromised nodes
Round 001: test acc mean=0.5319 ± 0.0336 | min=0.5013 max=0.6189
         : test loss mean=28.2551 ± 18.4457
         : individual accs = ['0.536959', '0.521953', '0.519487', '0.513962', '0.614342', '0.527934', '0.533319', '0.618948', '0.519868', '0.591526', '0.509133', '0.523214', '0.518949', '0.516920', '0.514735', '0.501424', '0.521787', '0.523743', '0.501298', '0.508369']
         : correct/total = [(7642, 14232), (7430, 14235), (7411, 14266), (7307, 14217), (8747, 14238), (7588, 14373), (7651, 14346), (8872, 14334), (7431, 14294), (8502, 14373), (7303, 14344), (7483, 14302), (7449, 14354), (7424, 14362), (7371, 14320), (7218, 14395), (7508, 14389), (7467, 14257), (7144, 14251), (7320, 14399)]
         : compromised: 0.5175, honest: 0.5654
         : ubar stats = ['Node 0: s1=0.250, s2=0.500', 'Node 1: s1=0.273, s2=1.000', 'Node 2: s1=0.250, s2=1.000']...
Round 002: test acc mean=0.5370 ± 0.0517 | min=0.4930 max=0.6383
         : test loss mean=485.3623 ± 337.5945
         : individual accs = ['0.638280', '0.516754', '0.512267', '0.514103', '0.633516', '0.505879', '0.499861', '0.608972', '0.500420', '0.601892', '0.617680', '0.503566', '0.495611', '0.493037', '0.507193', '0.500382', '0.583084', '0.504805', '0.502070', '0.499757']
         : correct/total = [(9084, 14232), (7356, 14235), (7308, 14266), (7309, 14217), (9020, 14238), (7271, 14373), (7171, 14346), (8729, 14334), (7153, 14294), (8651, 14373), (8860, 14344), (7202, 14302), (7114, 14354), (7081, 14362), (7263, 14320), (7203, 14395), (8390, 14389), (7197, 14257), (7155, 14251), (7196, 14399)]
         : compromised: 0.5040, honest: 0.6139
         : ubar stats = ['Node 0: s1=0.250, s2=0.500', 'Node 1: s1=0.273, s2=1.000', 'Node 2: s1=0.250, s2=1.000']...
Round 003: test acc mean=0.5383 ± 0.0619 | min=0.4851 max=0.6484
         : test loss mean=16554.2917 ± 12562.1378
         : individual accs = ['0.634907', '0.500246', '0.493831', '0.485053', '0.632322', '0.505183', '0.499164', '0.620273', '0.500490', '0.648368', '0.621933', '0.496084', '0.498955', '0.508146', '0.489385', '0.492046', '0.634651', '0.490776', '0.509508', '0.505313']
         : correct/total = [(9036, 14232), (7121, 14235), (7045, 14266), (6896, 14217), (9003, 14238), (7261, 14373), (7161, 14346), (8891, 14334), (7154, 14294), (9319, 14373), (8921, 14344), (7095, 14302), (7162, 14354), (7298, 14362), (7008, 14320), (7083, 14395), (9132, 14389), (6997, 14257), (7261, 14251), (7276, 14399)]
         : compromised: 0.4982, honest: 0.6321
         : ubar stats = ['Node 0: s1=0.250, s2=0.583', 'Node 1: s1=0.273, s2=1.000', 'Node 2: s1=0.250, s2=1.000']...
Round 004: test acc mean=0.5447 ± 0.0651 | min=0.4924 max=0.6511
         : test loss mean=4417205.5224 ± 3737856.0405
         : individual accs = ['0.642285', '0.495258', '0.505257', '0.510094', '0.645667', '0.520629', '0.500418', '0.643644', '0.500770', '0.651082', '0.636503', '0.502657', '0.492406', '0.504874', '0.498184', '0.492879', '0.642088', '0.500245', '0.499614', '0.508924']
         : correct/total = [(9141, 14232), (7050, 14235), (7208, 14266), (7252, 14217), (9193, 14238), (7483, 14373), (7179, 14346), (9226, 14334), (7158, 14294), (9358, 14373), (9130, 14344), (7189, 14302), (7068, 14354), (7251, 14362), (7134, 14320), (7095, 14395), (9239, 14389), (7132, 14257), (7120, 14251), (7328, 14399)]
         : compromised: 0.5023, honest: 0.6435
         : ubar stats = ['Node 0: s1=0.250, s2=0.562', 'Node 1: s1=0.273, s2=1.000', 'Node 2: s1=0.250, s2=1.000']...
Round 005: test acc mean=0.5437 ± 0.0680 | min=0.4829 max=0.6504
         : test loss mean=85615190.3318 ± 72185743.6638
         : individual accs = ['0.645868', '0.513593', '0.492710', '0.487374', '0.647282', '0.503166', '0.495260', '0.647621', '0.503568', '0.650386', '0.643265', '0.511747', '0.494775', '0.501393', '0.509777', '0.482945', '0.646953', '0.496668', '0.506771', '0.493437']
         : correct/total = [(9192, 14232), (7311, 14235), (7029, 14266), (6929, 14217), (9216, 14238), (7232, 14373), (7105, 14346), (9283, 14334), (7198, 14294), (9348, 14373), (9227, 14344), (7319, 14302), (7102, 14354), (7201, 14362), (7300, 14320), (6952, 14395), (9309, 14389), (7081, 14257), (7222, 14251), (7105, 14399)]
         : compromised: 0.4995, honest: 0.6469
         : ubar stats = ['Node 0: s1=0.250, s2=0.500', 'Node 1: s1=0.273, s2=1.000', 'Node 2: s1=0.250, s2=1.000']...
Round 006: test acc mean=0.5489 ± 0.0653 | min=0.4918 max=0.6522
         : test loss mean=10139882308.7070 ± 8455037174.1795
         : individual accs = ['0.645517', '0.518581', '0.511916', '0.510516', '0.651356', '0.504766', '0.500070', '0.652225', '0.501049', '0.652126', '0.649540', '0.515382', '0.507315', '0.491784', '0.502304', '0.513581', '0.638543', '0.505997', '0.504737', '0.501354']
         : correct/total = [(9187, 14232), (7382, 14235), (7303, 14266), (7258, 14217), (9274, 14238), (7255, 14373), (7174, 14346), (9349, 14334), (7162, 14294), (9373, 14373), (9317, 14344), (7371, 14302), (7282, 14354), (7063, 14362), (7193, 14320), (7393, 14395), (9188, 14389), (7214, 14257), (7193, 14251), (7219, 14399)]
         : compromised: 0.5064, honest: 0.6482
         : ubar stats = ['Node 0: s1=0.250, s2=0.458', 'Node 1: s1=0.273, s2=1.000', 'Node 2: s1=0.250, s2=1.000']...
Round 007: test acc mean=0.5477 ± 0.0688 | min=0.4930 max=0.6570
         : test loss mean=643350590395.3455 ± 509056786262.8317
         : individual accs = ['0.653668', '0.493923', '0.515211', '0.512626', '0.653322', '0.500939', '0.500418', '0.654318', '0.501049', '0.656996', '0.642011', '0.519787', '0.495123', '0.506824', '0.499721', '0.501771', '0.653068', '0.502069', '0.497930', '0.493020']
         : correct/total = [(9303, 14232), (7031, 14235), (7350, 14266), (7288, 14217), (9302, 14238), (7200, 14373), (7179, 14346), (9379, 14334), (7162, 14294), (9443, 14373), (9209, 14344), (7434, 14302), (7107, 14354), (7279, 14362), (7156, 14320), (7223, 14395), (9397, 14389), (7158, 14257), (7096, 14251), (7099, 14399)]
         : compromised: 0.5029, honest: 0.6522
         : ubar stats = ['Node 0: s1=0.250, s2=0.536', 'Node 1: s1=0.273, s2=1.000', 'Node 2: s1=0.250, s2=1.000']...
Round 008: test acc mean=0.5504 ± 0.0663 | min=0.4949 max=0.6577
         : test loss mean=70835999595409.0938 ± 63755756301115.6172
         : individual accs = ['0.656057', '0.515841', '0.512688', '0.508194', '0.636957', '0.503027', '0.498676', '0.657667', '0.511403', '0.651638', '0.654350', '0.506013', '0.508290', '0.503203', '0.494902', '0.500452', '0.649732', '0.522129', '0.504386', '0.512605']
         : correct/total = [(9337, 14232), (7343, 14235), (7314, 14266), (7225, 14217), (9069, 14238), (7230, 14373), (7154, 14346), (9427, 14334), (7310, 14294), (9366, 14373), (9386, 14344), (7237, 14302), (7296, 14354), (7227, 14362), (7087, 14320), (7204, 14395), (9349, 14389), (7444, 14257), (7188, 14251), (7381, 14399)]
         : compromised: 0.5073, honest: 0.6511
         : ubar stats = ['Node 0: s1=0.250, s2=0.562', 'Node 1: s1=0.273, s2=1.000', 'Node 2: s1=0.250, s2=1.000']...
Round 009: test acc mean=0.5483 ± 0.0683 | min=0.4852 max=0.6590
         : test loss mean=4844205466907896.0000 ± 3911381030718355.0000
         : individual accs = ['0.645025', '0.518230', '0.510234', '0.519941', '0.653954', '0.501218', '0.500070', '0.657039', '0.493983', '0.639741', '0.656093', '0.502797', '0.491083', '0.509539', '0.508869', '0.500382', '0.659045', '0.506839', '0.485229', '0.507396']
         : correct/total = [(9180, 14232), (7377, 14235), (7279, 14266), (7392, 14217), (9311, 14238), (7204, 14373), (7174, 14346), (9418, 14334), (7061, 14294), (9195, 14373), (9411, 14344), (7191, 14302), (7049, 14354), (7318, 14362), (7287, 14320), (7203, 14395), (9483, 14389), (7226, 14257), (6915, 14251), (7306, 14399)]
         : compromised: 0.5040, honest: 0.6518
         : ubar stats = ['Node 0: s1=0.250, s2=0.611', 'Node 1: s1=0.273, s2=1.000', 'Node 2: s1=0.250, s2=1.000']...
Round 010: test acc mean=0.5514 ± 0.0721 | min=0.4938 max=0.6641
         : test loss mean=494324499322058560.0000 ± 380939654251870528.0000
         : individual accs = ['0.661748', '0.509449', '0.510094', '0.513681', '0.664138', '0.501565', '0.500976', '0.663876', '0.493774', '0.661657', '0.663274', '0.506503', '0.500488', '0.496101', '0.507123', '0.501077', '0.653346', '0.510206', '0.507894', '0.501493']
         : correct/total = [(9418, 14232), (7252, 14235), (7277, 14266), (7303, 14217), (9456, 14238), (7209, 14373), (7187, 14346), (9516, 14334), (7058, 14294), (9510, 14373), (9514, 14344), (7244, 14302), (7184, 14354), (7125, 14362), (7262, 14320), (7213, 14395), (9401, 14389), (7274, 14257), (7238, 14251), (7221, 14399)]
         : compromised: 0.5043, honest: 0.6613
         : ubar stats = ['Node 0: s1=0.250, s2=0.575', 'Node 1: s1=0.273, s2=1.000', 'Node 2: s1=0.250, s2=1.000']...

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: ubar
Attack: backdoor, 70.0% compromised
Final accuracy - Compromised: 0.5043, Honest: 0.6613
Overall test accuracy: mean=0.5514 ± 0.0721

=== BACKDOOR ATTACK SUCCESS RATE (ASR) ===
Target label: 1
Trigger size: 3x3
Overall ASR: 0.6933 ± 0.2132
Honest nodes ASR: 0.4957 ± 0.0535
Compromised nodes ASR: 0.7779 ± 0.1995
Note: Higher ASR indicates more successful backdoor attack

=== UBAR SUMMARY ===
Node 0: stage1=0.250, stage2=0.575, overall=0.144
Node 1: stage1=0.273, stage2=1.000, overall=0.273
Node 2: stage1=0.250, stage2=1.000, overall=0.250
Node 3: stage1=0.250, stage2=1.000, overall=0.250
Node 4: stage1=0.273, stage2=0.600, overall=0.164
Node 5: stage1=0.267, stage2=1.000, overall=0.267
Node 6: stage1=0.286, stage2=1.000, overall=0.286
Node 7: stage1=0.286, stage2=0.575, overall=0.164
Node 8: stage1=0.300, stage2=1.000, overall=0.300
Node 9: stage1=0.231, stage2=0.633, overall=0.146
Node 10: stage1=0.222, stage2=0.600, overall=0.133
Node 11: stage1=0.286, stage2=1.000, overall=0.286
Node 12: stage1=0.250, stage2=1.000, overall=0.250
Node 13: stage1=0.231, stage2=1.000, overall=0.231
Node 14: stage1=0.267, stage2=1.000, overall=0.267
Node 15: stage1=0.273, stage2=1.000, overall=0.273
Node 16: stage1=0.231, stage2=0.600, overall=0.138
Node 17: stage1=0.222, stage2=1.000, overall=0.222
Node 18: stage1=0.250, stage2=1.000, overall=0.250
Node 19: stage1=0.250, stage2=1.000, overall=0.250

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Distance computation: 0.060s (70.3%)
    - Loss computation: 0.018s (20.9%)
    - Aggregation: 0.007s (8.7%)
  TOTALS:
    - Total computation: 0.086s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.086s

=== PER-NODE AVERAGE TIME ===
  - Distance computation: 0.047s
  - Loss computation: 0.014s
  - Aggregation: 0.006s
  - Model transfer: 0.000s
  - Total per node: 0.067s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total distance computation: 0.943s
  - Total loss computation: 0.285s
  - Total aggregation: 0.116s
  - Total model transfer: 0.000s
  - Grand total: 1.344s
  - Mean Stage 1 acceptance rate: 0.257
  - Mean Stage 2 acceptance rate: 0.879
  - Overall acceptance rate: 0.226

UBAR Algorithm Properties:
  - Model dimension: 1,174,986
  - Rho parameter: 0.30000000000000004
  - Two-stage approach: Distance filtering + loss evaluation
  - Stage 1 selects: 30% of neighbors
  - Stage 2 uses: Training sample loss comparison
  - Theoretical complexity: O(deg(i)×d + deg(i)×inference)
  - Approach: UBAR paper implementation
