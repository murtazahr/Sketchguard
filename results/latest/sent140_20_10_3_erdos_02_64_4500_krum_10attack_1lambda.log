Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
Degree statistics: avg=4.80, min=2, max=7
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.6101 ± 0.0554 | min=0.4904 max=0.6506
         : test loss mean=4.9044 ± 8.7170
         : individual accs = ['0.612493', '0.647489', '0.624912', '0.512063', '0.643138', '0.637167', '0.650634', '0.648737', '0.630125', '0.641272', '0.643196', '0.490351', '0.632576', '0.503830', '0.496578', '0.636332', '0.639238', '0.639195', '0.641429', '0.630738']
         : correct/total = [(8717, 14232), (9217, 14235), (8915, 14266), (7280, 14217), (9157, 14238), (9158, 14373), (9334, 14346), (9299, 14334), (9007, 14294), (9217, 14373), (9226, 14344), (7013, 14302), (9080, 14354), (7236, 14362), (7111, 14320), (9160, 14395), (9198, 14389), (9113, 14257), (9141, 14251), (9082, 14399)]
         : compromised: 0.5705, honest: 0.6145
Round 002: test acc mean=0.6466 ± 0.0388 | min=0.4888 max=0.6676
         : test loss mean=2.0235 ± 6.1321
         : individual accs = ['0.661959', '0.667580', '0.652671', '0.664134', '0.656764', '0.661866', '0.664575', '0.666667', '0.658738', '0.660196', '0.652677', '0.661865', '0.617459', '0.488790', '0.623184', '0.655714', '0.666064', '0.630357', '0.659182', '0.661852']
         : correct/total = [(9421, 14232), (9503, 14235), (9311, 14266), (9442, 14217), (9351, 14238), (9513, 14373), (9534, 14346), (9556, 14334), (9416, 14294), (9489, 14373), (9362, 14344), (9466, 14302), (8863, 14354), (7020, 14362), (8924, 14320), (9439, 14395), (9584, 14389), (8987, 14257), (9394, 14251), (9530, 14399)]
         : compromised: 0.5753, honest: 0.6545
Round 003: test acc mean=0.6592 ± 0.0169 | min=0.6230 max=0.6825
         : test loss mean=0.6146 ± 0.0168
         : individual accs = ['0.657813', '0.670530', '0.623020', '0.659844', '0.646018', '0.680373', '0.653562', '0.651528', '0.653071', '0.664927', '0.633436', '0.653265', '0.674098', '0.682217', '0.677863', '0.672386', '0.670165', '0.682542', '0.640587', '0.636780']
         : correct/total = [(9362, 14232), (9545, 14235), (8888, 14266), (9381, 14217), (9198, 14238), (9779, 14373), (9376, 14346), (9339, 14334), (9335, 14294), (9557, 14373), (9086, 14344), (9343, 14302), (9676, 14354), (9798, 14362), (9707, 14320), (9679, 14395), (9643, 14389), (9731, 14257), (9129, 14251), (9169, 14399)]
         : compromised: 0.6813, honest: 0.6567
Round 004: test acc mean=0.6829 ± 0.0080 | min=0.6654 max=0.6967
         : test loss mean=0.5922 ± 0.0096
         : individual accs = ['0.685427', '0.689708', '0.691785', '0.665401', '0.675165', '0.684060', '0.687718', '0.687945', '0.692179', '0.682599', '0.674149', '0.685638', '0.679323', '0.666899', '0.674441', '0.685724', '0.683230', '0.683875', '0.686759', '0.696715']
         : correct/total = [(9755, 14232), (9818, 14235), (9869, 14266), (9460, 14217), (9613, 14238), (9832, 14373), (9866, 14346), (9861, 14334), (9894, 14294), (9811, 14373), (9670, 14344), (9806, 14302), (9751, 14354), (9578, 14362), (9658, 14320), (9871, 14395), (9831, 14389), (9750, 14257), (9787, 14251), (10032, 14399)]
         : compromised: 0.6755, honest: 0.6838
Round 005: test acc mean=0.6893 ± 0.0089 | min=0.6644 max=0.6990
         : test loss mean=0.5829 ± 0.0088
         : individual accs = ['0.693016', '0.696452', '0.692626', '0.687416', '0.699045', '0.690531', '0.664366', '0.688015', '0.698825', '0.681834', '0.691997', '0.696616', '0.667340', '0.689528', '0.689385', '0.687878', '0.686983', '0.695939', '0.694057', '0.693173']
         : correct/total = [(9863, 14232), (9914, 14235), (9881, 14266), (9773, 14217), (9953, 14238), (9925, 14373), (9531, 14346), (9862, 14334), (9989, 14294), (9800, 14373), (9926, 14344), (9963, 14302), (9579, 14354), (9903, 14362), (9872, 14320), (9902, 14395), (9885, 14389), (9922, 14257), (9891, 14251), (9981, 14399)]
         : compromised: 0.6900, honest: 0.6892
Round 006: test acc mean=0.6947 ± 0.0099 | min=0.6737 max=0.7061
         : test loss mean=0.5763 ± 0.0112
         : individual accs = ['0.690205', '0.686407', '0.695219', '0.703524', '0.694409', '0.690670', '0.705563', '0.705735', '0.699944', '0.680999', '0.673731', '0.674731', '0.701825', '0.703245', '0.690642', '0.702952', '0.702481', '0.699867', '0.685987', '0.706091']
         : correct/total = [(9823, 14232), (9771, 14235), (9918, 14266), (10002, 14217), (9887, 14238), (9927, 14373), (10122, 14346), (10116, 14334), (10005, 14294), (9788, 14373), (9664, 14344), (9650, 14302), (10074, 14354), (10100, 14362), (9890, 14320), (10119, 14395), (10108, 14389), (9978, 14257), (9776, 14251), (10167, 14399)]
         : compromised: 0.6970, honest: 0.6945
Round 007: test acc mean=0.7022 ± 0.0082 | min=0.6890 max=0.7192
         : test loss mean=0.5677 ± 0.0089
         : individual accs = ['0.704258', '0.711556', '0.703000', '0.689878', '0.719202', '0.700202', '0.699638', '0.704479', '0.712397', '0.690253', '0.700641', '0.710320', '0.696600', '0.710904', '0.689036', '0.702258', '0.694489', '0.708564', '0.704722', '0.692479']
         : correct/total = [(10023, 14232), (10129, 14235), (10029, 14266), (9808, 14217), (10240, 14238), (10064, 14373), (10037, 14346), (10098, 14334), (10183, 14294), (9921, 14373), (10050, 14344), (10159, 14302), (9999, 14354), (10210, 14362), (9867, 14320), (10109, 14395), (9993, 14389), (10102, 14257), (10043, 14251), (9971, 14399)]
         : compromised: 0.7056, honest: 0.7019
Round 008: test acc mean=0.7041 ± 0.0135 | min=0.6665 max=0.7185
         : test loss mean=0.5646 ± 0.0129
         : individual accs = ['0.705453', '0.674183', '0.666480', '0.709925', '0.718500', '0.698462', '0.703959', '0.704339', '0.709179', '0.708829', '0.715351', '0.708712', '0.705657', '0.717658', '0.697556', '0.699687', '0.711933', '0.717542', '0.689987', '0.718175']
         : correct/total = [(10040, 14232), (9597, 14235), (9508, 14266), (10093, 14217), (10230, 14238), (10039, 14373), (10099, 14346), (10096, 14334), (10137, 14294), (10188, 14373), (10261, 14344), (10136, 14302), (10129, 14354), (10307, 14362), (9989, 14320), (10072, 14395), (10244, 14389), (10230, 14257), (9833, 14251), (10341, 14399)]
         : compromised: 0.7081, honest: 0.7036
Round 009: test acc mean=0.7117 ± 0.0108 | min=0.6886 max=0.7316
         : test loss mean=0.5568 ± 0.0106
         : individual accs = ['0.688589', '0.716684', '0.713585', '0.719983', '0.731563', '0.713351', '0.710024', '0.707618', '0.690779', '0.718430', '0.703291', '0.721158', '0.709698', '0.720443', '0.714804', '0.710177', '0.691083', '0.719156', '0.718546', '0.715327']
         : correct/total = [(9800, 14232), (10202, 14235), (10180, 14266), (10236, 14217), (10416, 14238), (10253, 14373), (10186, 14346), (10143, 14334), (9874, 14294), (10326, 14373), (10088, 14344), (10314, 14302), (10187, 14354), (10347, 14362), (10236, 14320), (10223, 14395), (9944, 14389), (10253, 14257), (10240, 14251), (10300, 14399)]
         : compromised: 0.7169, honest: 0.7111
Round 010: test acc mean=0.7120 ± 0.0130 | min=0.6737 max=0.7242
         : test loss mean=0.5547 ± 0.0131
         : individual accs = ['0.720840', '0.720829', '0.673700', '0.722164', '0.702767', '0.722257', '0.712463', '0.711874', '0.719393', '0.717248', '0.721695', '0.724234', '0.714156', '0.717797', '0.712151', '0.716151', '0.713740', '0.716701', '0.697916', '0.682547']
         : correct/total = [(10259, 14232), (10261, 14235), (9611, 14266), (10267, 14217), (10006, 14238), (10381, 14373), (10221, 14346), (10204, 14334), (10283, 14294), (10309, 14373), (10352, 14344), (10358, 14302), (10251, 14354), (10309, 14362), (10198, 14320), (10309, 14395), (10270, 14389), (10218, 14257), (9946, 14251), (9828, 14399)]
         : compromised: 0.7200, honest: 0.7111

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 10.0% compromised
Final accuracy - Compromised: 0.7200, Honest: 0.7111
Overall test accuracy: mean=0.7120 ± 0.0130
