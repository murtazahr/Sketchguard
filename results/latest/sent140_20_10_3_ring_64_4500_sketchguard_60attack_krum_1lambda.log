Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 12/20 nodes: [1, 2, 3, 5, 8, 11, 12, 13, 14, 15, 17, 18]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Sketchguard Node 0:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 1:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 2:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 3:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 4:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 5:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 6:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 7:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 8:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 9:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 10:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 11:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 12:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 13:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 14:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 15:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 16:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 17:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 18:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 19:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard ALGORITHM (Sketch-based Filtering + State Aggregation)
  - Model dimension: 1,174,986 parameters
  - Config: SketchguardConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1, sketch_size=180, network_seed=987654321, attack_detection_window=5)
  - Sketch size: 180
  - Compression ratio: 6527.7x
  - Complexity: O(d + N×k) = O(1,174,986 + 20×180)
  - Theoretical speedup vs BALANCE: 19.9x
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5069 ± 0.0198 | min=0.4749 max=0.5614
         : test loss mean=2.4894 ± 2.9057
         : individual accs = ['0.474916', '0.512680', '0.505468', '0.510938', '0.499649', '0.508592', '0.490241', '0.500907', '0.501189', '0.494469', '0.479573', '0.516291', '0.497631', '0.492480', '0.507821', '0.546440', '0.507957', '0.561408', '0.528594', '0.499896']
         : correct/total = [(6759, 14232), (7298, 14235), (7211, 14266), (7264, 14217), (7114, 14238), (7310, 14373), (7033, 14346), (7180, 14334), (7164, 14294), (7107, 14373), (6879, 14344), (7384, 14302), (7143, 14354), (7073, 14362), (7272, 14320), (7866, 14395), (7309, 14389), (8004, 14257), (7533, 14251), (7198, 14399)]
         : compromised: 0.5158, honest: 0.4935
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...
Round 002: test acc mean=0.5076 ± 0.0112 | min=0.4932 max=0.5398
         : test loss mean=1.7393 ± 1.2906
         : individual accs = ['0.493184', '0.506428', '0.515211', '0.536189', '0.503371', '0.497948', '0.498954', '0.499512', '0.503288', '0.500731', '0.505717', '0.539785', '0.509335', '0.505431', '0.507751', '0.509621', '0.508513', '0.505576', '0.502702', '0.502327']
         : correct/total = [(7019, 14232), (7209, 14235), (7350, 14266), (7623, 14217), (7167, 14238), (7157, 14373), (7158, 14346), (7160, 14334), (7194, 14294), (7197, 14373), (7254, 14344), (7720, 14302), (7311, 14354), (7259, 14362), (7271, 14320), (7336, 14395), (7317, 14389), (7208, 14257), (7164, 14251), (7233, 14399)]
         : compromised: 0.5116, honest: 0.5015
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=0.500']...
Round 003: test acc mean=0.5112 ± 0.0147 | min=0.4936 max=0.5461
         : test loss mean=0.9011 ± 0.2819
         : individual accs = ['0.498524', '0.518932', '0.506379', '0.502497', '0.494803', '0.495373', '0.510177', '0.513883', '0.535399', '0.518055', '0.511921', '0.546077', '0.505573', '0.514692', '0.501257', '0.493574', '0.519216', '0.498702', '0.539611', '0.499965']
         : correct/total = [(7095, 14232), (7387, 14235), (7224, 14266), (7144, 14217), (7045, 14238), (7120, 14373), (7319, 14346), (7366, 14334), (7653, 14294), (7446, 14373), (7343, 14344), (7810, 14302), (7257, 14354), (7392, 14362), (7178, 14320), (7105, 14395), (7471, 14389), (7110, 14257), (7690, 14251), (7199, 14399)]
         : compromised: 0.5132, honest: 0.5083
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=0.833', 'Node 2: acc_rate=0.500']...
Round 004: test acc mean=0.5214 ± 0.0338 | min=0.4834 max=0.6023
         : test loss mean=1.0148 ± 0.5949
         : individual accs = ['0.555017', '0.483386', '0.499229', '0.499050', '0.504003', '0.541710', '0.596891', '0.602344', '0.535749', '0.497391', '0.503765', '0.540274', '0.493451', '0.499513', '0.493506', '0.505731', '0.496143', '0.511538', '0.507754', '0.561428']
         : correct/total = [(7899, 14232), (6881, 14235), (7122, 14266), (7095, 14217), (7176, 14238), (7786, 14373), (8563, 14346), (8634, 14334), (7658, 14294), (7149, 14373), (7226, 14344), (7727, 14302), (7083, 14354), (7174, 14362), (7067, 14320), (7280, 14395), (7139, 14389), (7293, 14257), (7236, 14251), (8084, 14399)]
         : compromised: 0.5092, honest: 0.5396
         : sketchguard stats = ['Node 0: acc_rate=0.875', 'Node 1: acc_rate=0.750', 'Node 2: acc_rate=0.375']...
Round 005: test acc mean=0.5483 ± 0.0465 | min=0.4891 max=0.6217
         : test loss mean=0.7753 ± 0.2124
         : individual accs = ['0.601391', '0.570987', '0.491448', '0.518112', '0.498806', '0.517985', '0.618709', '0.621739', '0.555128', '0.582829', '0.581149', '0.577821', '0.518949', '0.489068', '0.504190', '0.497673', '0.500104', '0.512029', '0.596520', '0.611223']
         : correct/total = [(8559, 14232), (8128, 14235), (7011, 14266), (7366, 14217), (7102, 14238), (7445, 14373), (8876, 14346), (8912, 14334), (7935, 14294), (8377, 14373), (8336, 14344), (8264, 14302), (7449, 14354), (7024, 14362), (7220, 14320), (7164, 14395), (7196, 14389), (7300, 14257), (8501, 14251), (8801, 14399)]
         : compromised: 0.5292, honest: 0.5770
         : sketchguard stats = ['Node 0: acc_rate=0.800', 'Node 1: acc_rate=0.700', 'Node 2: acc_rate=0.300']...
Round 006: test acc mean=0.5613 ± 0.0550 | min=0.4899 max=0.6305
         : test loss mean=0.8002 ± 0.2424
         : individual accs = ['0.618606', '0.627819', '0.512758', '0.515369', '0.505127', '0.554164', '0.623310', '0.630459', '0.584931', '0.612329', '0.601645', '0.591176', '0.489898', '0.491645', '0.500349', '0.503439', '0.500313', '0.514695', '0.622342', '0.626571']
         : correct/total = [(8804, 14232), (8937, 14235), (7315, 14266), (7327, 14217), (7192, 14238), (7965, 14373), (8942, 14346), (9037, 14334), (8361, 14294), (8801, 14373), (8630, 14344), (8455, 14302), (7032, 14354), (7061, 14362), (7165, 14320), (7247, 14395), (7199, 14389), (7338, 14257), (8869, 14251), (9022, 14399)]
         : compromised: 0.5424, honest: 0.5898
         : sketchguard stats = ['Node 0: acc_rate=0.750', 'Node 1: acc_rate=0.667', 'Node 2: acc_rate=0.250']...
Round 007: test acc mean=0.5733 ± 0.0611 | min=0.4869 max=0.6503
         : test loss mean=0.8118 ± 0.3442
         : individual accs = ['0.641512', '0.643555', '0.486892', '0.532672', '0.494522', '0.570932', '0.643385', '0.646365', '0.581853', '0.619843', '0.613915', '0.623060', '0.518113', '0.505640', '0.498464', '0.527336', '0.494405', '0.534544', '0.637850', '0.650253']
         : correct/total = [(9130, 14232), (9161, 14235), (6946, 14266), (7573, 14217), (7041, 14238), (8206, 14373), (9230, 14346), (9265, 14334), (8317, 14294), (8909, 14373), (8806, 14344), (8911, 14302), (7437, 14354), (7262, 14362), (7138, 14320), (7591, 14395), (7114, 14389), (7621, 14257), (9090, 14251), (9363, 14399)]
         : compromised: 0.5551, honest: 0.6005
         : sketchguard stats = ['Node 0: acc_rate=0.714', 'Node 1: acc_rate=0.643', 'Node 2: acc_rate=0.214']...
Round 008: test acc mean=0.5775 ± 0.0679 | min=0.4908 max=0.6668
         : test loss mean=0.7590 ± 0.2333
         : individual accs = ['0.662591', '0.662311', '0.511916', '0.527186', '0.509130', '0.529395', '0.649519', '0.652295', '0.594935', '0.635010', '0.624233', '0.635785', '0.507803', '0.490809', '0.502723', '0.511150', '0.503162', '0.524234', '0.649989', '0.666782']
         : correct/total = [(9430, 14232), (9428, 14235), (7303, 14266), (7495, 14217), (7249, 14238), (7609, 14373), (9318, 14346), (9350, 14334), (8504, 14294), (9127, 14373), (8954, 14344), (9093, 14302), (7289, 14354), (7049, 14362), (7199, 14320), (7358, 14395), (7240, 14389), (7474, 14257), (9263, 14251), (9601, 14399)]
         : compromised: 0.5540, honest: 0.6128
         : sketchguard stats = ['Node 0: acc_rate=0.688', 'Node 1: acc_rate=0.625', 'Node 2: acc_rate=0.188']...
Round 009: test acc mean=0.5874 ± 0.0716 | min=0.4874 max=0.6699
         : test loss mean=0.7942 ± 0.3427
         : individual accs = ['0.659640', '0.669898', '0.487383', '0.522895', '0.494381', '0.641828', '0.653632', '0.659481', '0.634042', '0.637097', '0.629183', '0.643407', '0.523896', '0.505292', '0.504469', '0.528586', '0.492599', '0.529214', '0.664585', '0.666644']
         : correct/total = [(9388, 14232), (9536, 14235), (6953, 14266), (7434, 14217), (7039, 14238), (9225, 14373), (9377, 14346), (9453, 14334), (9063, 14294), (9157, 14373), (9025, 14344), (9202, 14302), (7520, 14354), (7257, 14362), (7224, 14320), (7609, 14395), (7088, 14389), (7545, 14257), (9471, 14251), (9599, 14399)]
         : compromised: 0.5713, honest: 0.6116
         : sketchguard stats = ['Node 0: acc_rate=0.667', 'Node 1: acc_rate=0.611', 'Node 2: acc_rate=0.167']...
Round 010: test acc mean=0.5978 ± 0.0768 | min=0.4891 max=0.6871
         : test loss mean=0.7303 ± 0.1988
         : individual accs = ['0.678963', '0.684229', '0.512828', '0.525427', '0.504916', '0.663814', '0.661578', '0.665899', '0.655520', '0.653587', '0.643893', '0.653475', '0.503832', '0.489138', '0.498953', '0.545745', '0.510181', '0.540927', '0.676374', '0.687131']
         : correct/total = [(9663, 14232), (9740, 14235), (7316, 14266), (7470, 14217), (7189, 14238), (9541, 14373), (9491, 14346), (9545, 14334), (9370, 14294), (9394, 14373), (9236, 14344), (9346, 14302), (7232, 14354), (7025, 14362), (7145, 14320), (7856, 14395), (7341, 14389), (7712, 14257), (9639, 14251), (9894, 14399)]
         : compromised: 0.5792, honest: 0.6258
         : sketchguard stats = ['Node 0: acc_rate=0.650', 'Node 1: acc_rate=0.600', 'Node 2: acc_rate=0.150']...

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: sketchguard
Attack: krum, 60.0% compromised
Final accuracy - Compromised: 0.5792, Honest: 0.6258
Overall test accuracy: mean=0.5978 ± 0.0768

=== Sketchguard SUMMARY ===
Node 0: acceptance=0.650
Node 1: acceptance=0.600
Node 2: acceptance=0.150
Node 3: acceptance=0.600
Node 4: acceptance=0.300
Node 5: acceptance=0.850
Node 6: acceptance=0.600
Node 7: acceptance=0.550
Node 8: acceptance=0.850
Node 9: acceptance=0.600
Node 10: acceptance=0.650
Node 11: acceptance=0.500
Node 12: acceptance=0.150
Node 13: acceptance=0.100
Node 14: acceptance=0.050
Node 15: acceptance=0.500
Node 16: acceptance=0.500
Node 17: acceptance=0.500
Node 18: acceptance=0.500
Node 19: acceptance=0.650

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Sketch transfer: 0.000s (0.0%)
    - Model fetch (accepted): 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Sketching: 0.199s (93.5%)
    - Filtering: 0.001s (0.4%)
    - Aggregation: 0.013s (6.1%)
  TOTALS:
    - Total computation: 0.212s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.212s

=== PER-NODE AVERAGE TIME ===
  - Sketching: 0.163s
  - Filtering: 0.000s
  - Aggregation: 0.006s
  - Sketch transfer: 0.000s
  - Model fetch: 0.000s
  - Total per node: 0.169s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total sketching: 3.259s
  - Total filtering: 0.006s
  - Total aggregation: 0.123s
  - Total sketch transfer: 0.000s
  - Total model fetch: 0.000s
  - Grand total: 3.388s
  - Mean acceptance rate: 0.493

Sketchguard Algorithm Properties:
  - Original dimension: 1,174,986
  - Sketch size: 180
  - Compression ratio: 19.9x
  - Single repetition: No repetitions needed
  - Theoretical complexity: O(d + N×k)
  - Approach: Sketch filtering + state aggregation
