Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5266 ± 0.0483 | min=0.4925 max=0.6423
         : test loss mean=17.9281 ± 9.8776
         : individual accs = ['0.509837', '0.506568', '0.610402', '0.614968', '0.503863', '0.501078', '0.499651', '0.512837', '0.502449', '0.619286', '0.512549', '0.497972', '0.513655', '0.642250', '0.494763', '0.495172', '0.505386', '0.494564', '0.492527', '0.502049']
         : correct/total = [(7256, 14232), (7211, 14235), (8708, 14266), (8743, 14217), (7174, 14238), (7202, 14373), (7168, 14346), (7351, 14334), (7182, 14294), (8901, 14373), (7352, 14344), (7122, 14302), (7373, 14354), (9224, 14362), (7085, 14320), (7128, 14395), (7272, 14389), (7051, 14257), (7019, 14251), (7229, 14399)]
         : compromised: 0.5379, honest: 0.5238
Round 002: test acc mean=0.6188 ± 0.0633 | min=0.4880 max=0.6606
         : test loss mean=1.9280 ± 5.3568
         : individual accs = ['0.645658', '0.660625', '0.643208', '0.650137', '0.647422', '0.487998', '0.648334', '0.656830', '0.493634', '0.648299', '0.658324', '0.649000', '0.490874', '0.659031', '0.646369', '0.642654', '0.647509', '0.498071', '0.656866', '0.645045']
         : correct/total = [(9189, 14232), (9404, 14235), (9176, 14266), (9243, 14217), (9218, 14238), (7014, 14373), (9301, 14346), (9415, 14334), (7056, 14294), (9318, 14373), (9443, 14344), (9282, 14302), (7046, 14354), (9465, 14362), (9256, 14320), (9251, 14395), (9317, 14389), (7101, 14257), (9361, 14251), (9288, 14399)]
         : compromised: 0.5340, honest: 0.6400
Round 003: test acc mean=0.6604 ± 0.0107 | min=0.6290 max=0.6738
         : test loss mean=0.6136 ± 0.0127
         : individual accs = ['0.666807', '0.649526', '0.629048', '0.659422', '0.673760', '0.669241', '0.664506', '0.661016', '0.669512', '0.664301', '0.661670', '0.659628', '0.643723', '0.670728', '0.659148', '0.669121', '0.669053', '0.645507', '0.656796', '0.665046']
         : correct/total = [(9490, 14232), (9246, 14235), (8974, 14266), (9375, 14217), (9593, 14238), (9619, 14373), (9533, 14346), (9475, 14334), (9570, 14294), (9548, 14373), (9491, 14344), (9434, 14302), (9240, 14354), (9633, 14362), (9439, 14320), (9632, 14395), (9627, 14389), (9203, 14257), (9360, 14251), (9576, 14399)]
         : compromised: 0.6573, honest: 0.6611
Round 004: test acc mean=0.6702 ± 0.0091 | min=0.6475 max=0.6840
         : test loss mean=0.6025 ± 0.0085
         : individual accs = ['0.666386', '0.654092', '0.668793', '0.677991', '0.684015', '0.657761', '0.675868', '0.680689', '0.676787', '0.667223', '0.674219', '0.673962', '0.678417', '0.676856', '0.670601', '0.671205', '0.669678', '0.659536', '0.672163', '0.647545']
         : correct/total = [(9484, 14232), (9311, 14235), (9541, 14266), (9639, 14217), (9739, 14238), (9454, 14373), (9696, 14346), (9757, 14334), (9674, 14294), (9590, 14373), (9671, 14344), (9639, 14302), (9738, 14354), (9721, 14362), (9603, 14320), (9662, 14395), (9636, 14389), (9403, 14257), (9579, 14251), (9324, 14399)]
         : compromised: 0.6681, honest: 0.6707
Round 005: test acc mean=0.6830 ± 0.0056 | min=0.6761 max=0.6965
         : test loss mean=0.5893 ± 0.0051
         : individual accs = ['0.681563', '0.682051', '0.682111', '0.682422', '0.692232', '0.678773', '0.680120', '0.679643', '0.689310', '0.690392', '0.682097', '0.679765', '0.680298', '0.690642', '0.677514', '0.676068', '0.677184', '0.683103', '0.677637', '0.696507']
         : correct/total = [(9700, 14232), (9709, 14235), (9731, 14266), (9702, 14217), (9856, 14238), (9756, 14373), (9757, 14346), (9742, 14334), (9853, 14294), (9923, 14373), (9784, 14344), (9722, 14302), (9765, 14354), (9919, 14362), (9702, 14320), (9732, 14395), (9744, 14389), (9739, 14257), (9657, 14251), (10029, 14399)]
         : compromised: 0.6832, honest: 0.6829
Round 006: test acc mean=0.6979 ± 0.0048 | min=0.6890 max=0.7078
         : test loss mean=0.5739 ± 0.0033
         : individual accs = ['0.689011', '0.701862', '0.694238', '0.695576', '0.701854', '0.692479', '0.703750', '0.701898', '0.697425', '0.704655', '0.707752', '0.692910', '0.697576', '0.703523', '0.691760', '0.697881', '0.696365', '0.697482', '0.696372', '0.694354']
         : correct/total = [(9806, 14232), (9991, 14235), (9904, 14266), (9889, 14217), (9993, 14238), (9953, 14373), (10096, 14346), (10061, 14334), (9969, 14294), (10128, 14373), (10152, 14344), (9910, 14302), (10013, 14354), (10104, 14362), (9906, 14320), (10046, 14395), (10020, 14389), (9944, 14257), (9924, 14251), (9998, 14399)]
         : compromised: 0.6978, honest: 0.6980
Round 007: test acc mean=0.7016 ± 0.0068 | min=0.6804 max=0.7106
         : test loss mean=0.5678 ± 0.0084
         : individual accs = ['0.698918', '0.697998', '0.691224', '0.703102', '0.704031', '0.701524', '0.710581', '0.705316', '0.708129', '0.695749', '0.706149', '0.707174', '0.708374', '0.706308', '0.698254', '0.702188', '0.700813', '0.706530', '0.699390', '0.680394']
         : correct/total = [(9947, 14232), (9936, 14235), (9861, 14266), (9996, 14217), (10024, 14238), (10083, 14373), (10194, 14346), (10110, 14334), (10122, 14294), (10000, 14373), (10129, 14344), (10114, 14302), (10168, 14354), (10144, 14362), (9999, 14320), (10108, 14395), (10084, 14389), (10073, 14257), (9967, 14251), (9797, 14399)]
         : compromised: 0.7057, honest: 0.7006
Round 008: test acc mean=0.7005 ± 0.0098 | min=0.6840 max=0.7160
         : test loss mean=0.5695 ± 0.0121
         : individual accs = ['0.706085', '0.707622', '0.700547', '0.703946', '0.715971', '0.704446', '0.696989', '0.696665', '0.715055', '0.707438', '0.684537', '0.704377', '0.691236', '0.694402', '0.687430', '0.688156', '0.709639', '0.714877', '0.684022', '0.696784']
         : correct/total = [(10049, 14232), (10073, 14235), (9994, 14266), (10008, 14217), (10194, 14238), (10125, 14373), (9999, 14346), (9986, 14334), (10221, 14294), (10168, 14373), (9819, 14344), (10074, 14302), (9922, 14354), (9973, 14362), (9844, 14320), (9906, 14395), (10211, 14389), (10192, 14257), (9748, 14251), (10033, 14399)]
         : compromised: 0.7012, honest: 0.7003
Round 009: test acc mean=0.6997 ± 0.0145 | min=0.6629 max=0.7193
         : test loss mean=0.5707 ± 0.0158
         : individual accs = ['0.662872', '0.695258', '0.705804', '0.693888', '0.715971', '0.698880', '0.666876', '0.701130', '0.715615', '0.692827', '0.700363', '0.716543', '0.700920', '0.719329', '0.694344', '0.694408', '0.714643', '0.695237', '0.697635', '0.711786']
         : correct/total = [(9434, 14232), (9897, 14235), (10069, 14266), (9865, 14217), (10194, 14238), (10045, 14373), (9567, 14346), (10050, 14334), (10229, 14294), (9958, 14373), (10046, 14344), (10248, 14302), (10061, 14354), (10331, 14362), (9943, 14320), (9996, 14395), (10283, 14389), (9912, 14257), (9942, 14251), (10249, 14399)]
         : compromised: 0.7036, honest: 0.6987
Round 010: test acc mean=0.7005 ± 0.0113 | min=0.6882 max=0.7220
         : test loss mean=0.5679 ± 0.0119
         : individual accs = ['0.690486', '0.698911', '0.692486', '0.719631', '0.691670', '0.688235', '0.692806', '0.695410', '0.707849', '0.691087', '0.719883', '0.692351', '0.722029', '0.718633', '0.690433', '0.693852', '0.695879', '0.693835', '0.703670', '0.710813']
         : correct/total = [(9827, 14232), (9949, 14235), (9879, 14266), (10231, 14217), (9848, 14238), (9892, 14373), (9939, 14346), (9968, 14334), (10118, 14294), (9933, 14373), (10326, 14344), (9902, 14302), (10364, 14354), (10321, 14362), (9887, 14320), (9988, 14395), (10013, 14389), (9892, 14257), (10028, 14251), (10235, 14399)]
         : compromised: 0.7057, honest: 0.6992

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 20.0% compromised
Final accuracy - Compromised: 0.7057, Honest: 0.6992
Overall test accuracy: mean=0.7005 ± 0.0113
