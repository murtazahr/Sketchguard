Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Model variant: baseline
Model parameters: 1,174,986
Sketchguard Node 0:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 1:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 2:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 3:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 4:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 5:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 6:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 7:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 8:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 9:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 10:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 11:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 12:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 13:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 14:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 15:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 16:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 17:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 18:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard Node 19:
  Model dim: 1,174,986 → Sketch size: 180
  Compression ratio: 6527.7x
  Using model parameters for aggregation, sketches for filtering
Sketchguard ALGORITHM (Sketch-based Filtering + State Aggregation)
  - Model dimension: 1,174,986 parameters
  - Config: SketchguardConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1, sketch_size=180, network_seed=987654321, attack_detection_window=5)
  - Sketch size: 180
  - Compression ratio: 6527.7x
  - Complexity: O(d + N×k) = O(1,174,986 + 20×180)
  - Theoretical speedup vs BALANCE: 19.9x
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5641 ± 0.0400 | min=0.5062 max=0.6260
         : test loss mean=0.6897 ± 0.0007
         : individual accs = ['0.557055', '0.588409', '0.514931', '0.506155', '0.611673', '0.543102', '0.625680', '0.620971', '0.537568', '0.562235', '0.518475', '0.552580', '0.612791', '0.564893', '0.522626', '0.569712', '0.508305', '0.599705', '0.538839', '0.626016']
         : correct/total = [(7928, 14232), (8376, 14235), (7346, 14266), (7196, 14217), (8709, 14238), (7806, 14373), (8976, 14346), (8901, 14334), (7684, 14294), (8081, 14373), (7437, 14344), (7903, 14302), (8796, 14354), (8113, 14362), (7484, 14320), (8201, 14395), (7314, 14389), (8550, 14257), (7679, 14251), (9014, 14399)]
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...
Round 002: test acc mean=0.5683 ± 0.0506 | min=0.4925 max=0.6307
         : test loss mean=0.6904 ± 0.0006
         : individual accs = ['0.603148', '0.609413', '0.609071', '0.620595', '0.495997', '0.510958', '0.508504', '0.629064', '0.617182', '0.575871', '0.555075', '0.598028', '0.502856', '0.630692', '0.492528', '0.558875', '0.516923', '0.602651', '0.622833', '0.506285']
         : correct/total = [(8584, 14232), (8675, 14235), (8689, 14266), (8823, 14217), (7062, 14238), (7344, 14373), (7295, 14346), (9017, 14334), (8822, 14294), (8277, 14373), (7962, 14344), (8553, 14302), (7218, 14354), (9058, 14362), (7053, 14320), (8045, 14395), (7438, 14389), (8592, 14257), (8876, 14251), (7290, 14399)]
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...
Round 003: test acc mean=0.5215 ± 0.0329 | min=0.4920 max=0.6096
         : test loss mean=0.6904 ± 0.0007
         : individual accs = ['0.519885', '0.500808', '0.532455', '0.492017', '0.524301', '0.554025', '0.499791', '0.492884', '0.511054', '0.497669', '0.498466', '0.592015', '0.502856', '0.545955', '0.493994', '0.498159', '0.509417', '0.554114', '0.609571', '0.500313']
         : correct/total = [(7399, 14232), (7129, 14235), (7596, 14266), (6995, 14217), (7465, 14238), (7963, 14373), (7170, 14346), (7065, 14334), (7305, 14294), (7153, 14373), (7150, 14344), (8467, 14302), (7218, 14354), (7841, 14362), (7074, 14320), (7171, 14395), (7330, 14389), (7900, 14257), (8687, 14251), (7204, 14399)]
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...
Round 004: test acc mean=0.5383 ± 0.0474 | min=0.4865 max=0.6230
         : test loss mean=0.6890 ± 0.0012
         : individual accs = ['0.498454', '0.621145', '0.539955', '0.486460', '0.495856', '0.515689', '0.504601', '0.510813', '0.535469', '0.598344', '0.498466', '0.553559', '0.502996', '0.622128', '0.496089', '0.506217', '0.597470', '0.496458', '0.623044', '0.563095']
         : correct/total = [(7094, 14232), (8842, 14235), (7703, 14266), (6916, 14217), (7060, 14238), (7412, 14373), (7239, 14346), (7322, 14334), (7654, 14294), (8600, 14373), (7150, 14344), (7917, 14302), (7220, 14354), (8935, 14362), (7104, 14320), (7287, 14395), (8597, 14389), (7078, 14257), (8879, 14251), (8108, 14399)]
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...
Round 005: test acc mean=0.5995 ± 0.0357 | min=0.5194 max=0.6433
         : test loss mean=0.6831 ± 0.0026
         : individual accs = ['0.630551', '0.624798', '0.590986', '0.561089', '0.626633', '0.632645', '0.519378', '0.635761', '0.643347', '0.580672', '0.587075', '0.536219', '0.535182', '0.603537', '0.606774', '0.628899', '0.614011', '0.608192', '0.594485', '0.629835']
         : correct/total = [(8974, 14232), (8894, 14235), (8431, 14266), (7977, 14217), (8922, 14238), (9093, 14373), (7451, 14346), (9113, 14334), (9196, 14294), (8346, 14373), (8421, 14344), (7669, 14302), (7682, 14354), (8668, 14362), (8689, 14320), (9053, 14395), (8835, 14389), (8671, 14257), (8472, 14251), (9069, 14399)]
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...
Round 006: test acc mean=0.6302 ± 0.0115 | min=0.5959 max=0.6431
         : test loss mean=0.6659 ± 0.0038
         : individual accs = ['0.635048', '0.640604', '0.631852', '0.629528', '0.625579', '0.640646', '0.633278', '0.625506', '0.643137', '0.635845', '0.604852', '0.595931', '0.633621', '0.627141', '0.638128', '0.622230', '0.639655', '0.636249', '0.627535', '0.637266']
         : correct/total = [(9038, 14232), (9119, 14235), (9014, 14266), (8950, 14217), (8907, 14238), (9208, 14373), (9085, 14346), (8966, 14334), (9193, 14294), (9139, 14373), (8676, 14344), (8523, 14302), (9095, 14354), (9007, 14362), (9138, 14320), (8957, 14395), (9204, 14389), (9071, 14257), (8943, 14251), (9176, 14399)]
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...
Round 007: test acc mean=0.6363 ± 0.0115 | min=0.6101 max=0.6488
         : test loss mean=0.6455 ± 0.0055
         : individual accs = ['0.640247', '0.648823', '0.638091', '0.632693', '0.647774', '0.646351', '0.640666', '0.637854', '0.644676', '0.643637', '0.625558', '0.613620', '0.643793', '0.610082', '0.644763', '0.620354', '0.644381', '0.641018', '0.620027', '0.640878']
         : correct/total = [(9112, 14232), (9236, 14235), (9103, 14266), (8995, 14217), (9223, 14238), (9290, 14373), (9191, 14346), (9143, 14334), (9215, 14294), (9251, 14373), (8973, 14344), (8776, 14302), (9241, 14354), (8762, 14362), (9233, 14320), (8930, 14395), (9272, 14389), (9139, 14257), (8836, 14251), (9228, 14399)]
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...
Round 008: test acc mean=0.6477 ± 0.0047 | min=0.6395 max=0.6554
         : test loss mean=0.6326 ± 0.0034
         : individual accs = ['0.648749', '0.642571', '0.641455', '0.655413', '0.650864', '0.647673', '0.649937', '0.641621', '0.654610', '0.652334', '0.649261', '0.654873', '0.646231', '0.639535', '0.646648', '0.646822', '0.649246', '0.644876', '0.640587', '0.651504']
         : correct/total = [(9233, 14232), (9147, 14235), (9151, 14266), (9318, 14217), (9267, 14238), (9309, 14373), (9324, 14346), (9197, 14334), (9357, 14294), (9376, 14373), (9313, 14344), (9366, 14302), (9276, 14354), (9185, 14362), (9260, 14320), (9311, 14395), (9342, 14389), (9194, 14257), (9129, 14251), (9381, 14399)]
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...
Round 009: test acc mean=0.6553 ± 0.0092 | min=0.6197 max=0.6662
         : test loss mean=0.6258 ± 0.0067
         : individual accs = ['0.619660', '0.659080', '0.651619', '0.661251', '0.658098', '0.658248', '0.655583', '0.666178', '0.658318', '0.655326', '0.648146', '0.650958', '0.660095', '0.655132', '0.659288', '0.652796', '0.663979', '0.656590', '0.654761', '0.660115']
         : correct/total = [(8819, 14232), (9382, 14235), (9296, 14266), (9401, 14217), (9370, 14238), (9461, 14373), (9405, 14346), (9549, 14334), (9410, 14294), (9419, 14373), (9297, 14344), (9310, 14302), (9475, 14354), (9409, 14362), (9441, 14320), (9397, 14395), (9554, 14389), (9361, 14257), (9331, 14251), (9505, 14399)]
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...
Round 010: test acc mean=0.6639 ± 0.0075 | min=0.6403 max=0.6750
         : test loss mean=0.6176 ± 0.0059
         : individual accs = ['0.661959', '0.668493', '0.640334', '0.668636', '0.672145', '0.668615', '0.666248', '0.675038', '0.670141', '0.655952', '0.662925', '0.665571', '0.671311', '0.660841', '0.666760', '0.658284', '0.667593', '0.660097', '0.656024', '0.661296']
         : correct/total = [(9421, 14232), (9516, 14235), (9135, 14266), (9506, 14217), (9570, 14238), (9610, 14373), (9558, 14346), (9676, 14334), (9579, 14294), (9428, 14373), (9509, 14344), (9519, 14302), (9636, 14354), (9491, 14362), (9548, 14320), (9476, 14395), (9606, 14389), (9411, 14257), (9349, 14251), (9522, 14399)]
         : sketchguard stats = ['Node 0: acc_rate=1.000', 'Node 1: acc_rate=1.000', 'Node 2: acc_rate=1.000']...

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: sketchguard
Overall test accuracy: mean=0.6639 ± 0.0075

=== Sketchguard SUMMARY ===
Node 0: acceptance=1.000
Node 1: acceptance=1.000
Node 2: acceptance=1.000
Node 3: acceptance=1.000
Node 4: acceptance=1.000
Node 5: acceptance=1.000
Node 6: acceptance=1.000
Node 7: acceptance=1.000
Node 8: acceptance=1.000
Node 9: acceptance=1.000
Node 10: acceptance=1.000
Node 11: acceptance=1.000
Node 12: acceptance=1.000
Node 13: acceptance=1.000
Node 14: acceptance=1.000
Node 15: acceptance=1.000
Node 16: acceptance=1.000
Node 17: acceptance=1.000
Node 18: acceptance=1.000
Node 19: acceptance=1.000

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Sketch transfer: 0.000s (0.0%)
    - Model fetch (accepted): 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Sketching: 0.588s (93.5%)
    - Filtering: 0.002s (0.4%)
    - Aggregation: 0.038s (6.1%)
  TOTALS:
    - Total computation: 0.628s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.628s

=== PER-NODE AVERAGE TIME ===
  - Sketching: 0.478s
  - Filtering: 0.001s
  - Aggregation: 0.022s
  - Sketch transfer: 0.000s
  - Model fetch: 0.000s
  - Total per node: 0.501s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total sketching: 9.558s
  - Total filtering: 0.014s
  - Total aggregation: 0.447s
  - Total sketch transfer: 0.000s
  - Total model fetch: 0.000s
  - Grand total: 10.020s
  - Mean acceptance rate: 1.000

Sketchguard Algorithm Properties:
  - Original dimension: 1,174,986
  - Sketch size: 180
  - Compression ratio: 19.9x
  - Single repetition: No repetitions needed
  - Theoretical complexity: O(d + N×k)
  - Approach: Sketch filtering + state aggregation
