Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5063 ± 0.0318 | min=0.4855 max=0.6413
         : test loss mean=22.2974 ± 9.3919
         : individual accs = ['0.511804', '0.485494', '0.486331', '0.488218', '0.501896', '0.511515', '0.504879', '0.508441', '0.498181', '0.641272', '0.495329', '0.497203', '0.495054', '0.498259', '0.505517', '0.499618', '0.502120', '0.500807', '0.491895', '0.501771']
         : correct/total = [(7284, 14232), (6911, 14235), (6938, 14266), (6941, 14217), (7146, 14238), (7352, 14373), (7243, 14346), (7288, 14334), (7121, 14294), (9217, 14373), (7105, 14344), (7111, 14302), (7106, 14354), (7156, 14362), (7239, 14320), (7192, 14395), (7225, 14389), (7140, 14257), (7010, 14251), (7225, 14399)]
         : compromised: 0.5005, honest: 0.5088
Round 002: test acc mean=0.5436 ± 0.0680 | min=0.4940 max=0.6644
         : test loss mean=10.7933 ± 14.4965
         : individual accs = ['0.499016', '0.498068', '0.658068', '0.663361', '0.664419', '0.505531', '0.494005', '0.523162', '0.499580', '0.660683', '0.498745', '0.500489', '0.504319', '0.507311', '0.509427', '0.657798', '0.507401', '0.508382', '0.509789', '0.501840']
         : correct/total = [(7102, 14232), (7090, 14235), (9388, 14266), (9431, 14217), (9460, 14238), (7266, 14373), (7087, 14346), (7499, 14334), (7141, 14294), (9496, 14373), (7154, 14344), (7158, 14302), (7239, 14354), (7286, 14362), (7295, 14320), (9469, 14395), (7301, 14389), (7248, 14257), (7265, 14251), (7226, 14399)]
         : compromised: 0.5075, honest: 0.5590
Round 003: test acc mean=0.5997 ± 0.0774 | min=0.4878 max=0.6770
         : test loss mean=4.8613 ± 6.2857
         : individual accs = ['0.669547', '0.676993', '0.666269', '0.657593', '0.673971', '0.496139', '0.649868', '0.658714', '0.498531', '0.639115', '0.655814', '0.491889', '0.646440', '0.650675', '0.487849', '0.501424', '0.492738', '0.645507', '0.637289', '0.496701']
         : correct/total = [(9529, 14232), (9637, 14235), (9505, 14266), (9349, 14217), (9596, 14238), (7131, 14373), (9323, 14346), (9442, 14334), (7126, 14294), (9186, 14373), (9407, 14344), (7035, 14302), (9279, 14354), (9345, 14362), (6986, 14320), (7218, 14395), (7090, 14389), (9203, 14257), (9082, 14251), (7152, 14399)]
         : compromised: 0.5940, honest: 0.6021
Round 004: test acc mean=0.6625 ± 0.0378 | min=0.5036 max=0.6891
         : test loss mean=1.1424 ± 2.3500
         : individual accs = ['0.662662', '0.684089', '0.673840', '0.682844', '0.678045', '0.661379', '0.680190', '0.663876', '0.503568', '0.677590', '0.677635', '0.664732', '0.668246', '0.681242', '0.660824', '0.656686', '0.654528', '0.667041', '0.661568', '0.689145']
         : correct/total = [(9431, 14232), (9738, 14235), (9613, 14266), (9708, 14217), (9654, 14238), (9506, 14373), (9758, 14346), (9516, 14334), (7198, 14294), (9739, 14373), (9720, 14344), (9507, 14302), (9592, 14354), (9784, 14362), (9463, 14320), (9453, 14395), (9418, 14389), (9510, 14257), (9428, 14251), (9923, 14399)]
         : compromised: 0.6667, honest: 0.6607
Round 005: test acc mean=0.6815 ± 0.0423 | min=0.4978 max=0.6958
         : test loss mean=1.6040 ± 4.4567
         : individual accs = ['0.692173', '0.695539', '0.688560', '0.688612', '0.690476', '0.694845', '0.689948', '0.695758', '0.497761', '0.692549', '0.690045', '0.692770', '0.691166', '0.693149', '0.687709', '0.686905', '0.691639', '0.693133', '0.683882', '0.693798']
         : correct/total = [(9851, 14232), (9901, 14235), (9823, 14266), (9790, 14217), (9831, 14238), (9987, 14373), (9898, 14346), (9973, 14334), (7115, 14294), (9954, 14373), (9898, 14344), (9908, 14302), (9921, 14354), (9955, 14362), (9848, 14320), (9888, 14395), (9952, 14389), (9882, 14257), (9746, 14251), (9990, 14399)]
         : compromised: 0.6906, honest: 0.6776
Round 006: test acc mean=0.6852 ± 0.0479 | min=0.4853 max=0.7106
         : test loss mean=1.5066 ± 4.0687
         : individual accs = ['0.700112', '0.710573', '0.694168', '0.662939', '0.698553', '0.707368', '0.675171', '0.680829', '0.485309', '0.703889', '0.669827', '0.679136', '0.708095', '0.710207', '0.701816', '0.701077', '0.707763', '0.701901', '0.699179', '0.705882']
         : correct/total = [(9964, 14232), (10115, 14235), (9903, 14266), (9425, 14217), (9946, 14238), (10167, 14373), (9686, 14346), (9759, 14334), (6937, 14294), (10117, 14373), (9608, 14344), (9713, 14302), (10164, 14354), (10200, 14362), (10050, 14320), (10092, 14395), (10184, 14389), (10007, 14257), (9964, 14251), (10164, 14399)]
         : compromised: 0.7048, honest: 0.6768
Round 007: test acc mean=0.6842 ± 0.0467 | min=0.4978 max=0.7141
         : test loss mean=3.5942 ± 13.1560
         : individual accs = ['0.697232', '0.713453', '0.707697', '0.656257', '0.702416', '0.711334', '0.706538', '0.656132', '0.497761', '0.698115', '0.706776', '0.708642', '0.681552', '0.710973', '0.674791', '0.674609', '0.679130', '0.714035', '0.671883', '0.714147']
         : correct/total = [(9923, 14232), (10156, 14235), (10096, 14266), (9330, 14217), (10001, 14238), (10224, 14373), (10136, 14346), (9405, 14334), (7115, 14294), (10034, 14373), (10138, 14344), (10135, 14302), (9783, 14354), (10211, 14362), (9663, 14320), (9711, 14395), (9772, 14389), (10180, 14257), (9575, 14251), (10283, 14399)]
         : compromised: 0.6941, honest: 0.6799
Round 008: test acc mean=0.6982 ± 0.0468 | min=0.4981 max=0.7210
         : test loss mean=6.6202 ± 26.4142
         : individual accs = ['0.708966', '0.720969', '0.710851', '0.717943', '0.716463', '0.696445', '0.702286', '0.706293', '0.498111', '0.712238', '0.714236', '0.700881', '0.716246', '0.719747', '0.706285', '0.705175', '0.712002', '0.719787', '0.685566', '0.693381']
         : correct/total = [(10090, 14232), (10263, 14235), (10141, 14266), (10207, 14217), (10201, 14238), (10010, 14373), (10075, 14346), (10124, 14334), (7120, 14294), (10237, 14373), (10245, 14344), (10024, 14302), (10281, 14354), (10337, 14362), (10114, 14320), (10151, 14395), (10245, 14389), (10262, 14257), (9770, 14251), (9984, 14399)]
         : compromised: 0.7073, honest: 0.6943
Round 009: test acc mean=0.6819 ± 0.0462 | min=0.5017 max=0.7191
         : test loss mean=4.1241 ± 15.4569
         : individual accs = ['0.666807', '0.671373', '0.706645', '0.704931', '0.719132', '0.674946', '0.706957', '0.717315', '0.501749', '0.667919', '0.708101', '0.711019', '0.674934', '0.713898', '0.664455', '0.704133', '0.667246', '0.717051', '0.661568', '0.678311']
         : correct/total = [(9490, 14232), (9557, 14235), (10081, 14266), (10022, 14217), (10239, 14238), (9701, 14373), (10142, 14346), (10282, 14334), (7172, 14294), (9600, 14373), (10157, 14344), (10169, 14302), (9688, 14354), (10253, 14362), (9515, 14320), (10136, 14395), (9601, 14389), (10223, 14257), (9428, 14251), (9767, 14399)]
         : compromised: 0.6845, honest: 0.6808
Round 010: test acc mean=0.7073 ± 0.0464 | min=0.5090 max=0.7288
         : test loss mean=1.3197 ± 3.3658
         : individual accs = ['0.715641', '0.725395', '0.718071', '0.718295', '0.725804', '0.722048', '0.719922', '0.726106', '0.509025', '0.709177', '0.717164', '0.722696', '0.721123', '0.726013', '0.692039', '0.717124', '0.722635', '0.728835', '0.709143', '0.698799']
         : correct/total = [(10185, 14232), (10326, 14235), (10244, 14266), (10212, 14217), (10334, 14238), (10378, 14373), (10328, 14346), (10408, 14334), (7276, 14294), (10193, 14373), (10287, 14344), (10336, 14302), (10351, 14354), (10427, 14362), (9910, 14320), (10323, 14395), (10398, 14389), (10391, 14257), (10106, 14251), (10062, 14399)]
         : compromised: 0.7165, honest: 0.7033

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 30.0% compromised
Final accuracy - Compromised: 0.7165, Honest: 0.7033
Overall test accuracy: mean=0.7073 ± 0.0464
