Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
Degree statistics: avg=4.80, min=2, max=7
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5012 ± 0.0066 | min=0.4925 max=0.5143
         : test loss mean=5.1370 ± 4.0585
         : individual accs = ['0.508010', '0.510854', '0.493761', '0.492509', '0.495575', '0.499269', '0.505019', '0.498395', '0.498321', '0.508871', '0.501743', '0.496924', '0.496377', '0.502158', '0.495042', '0.498298', '0.501633', '0.513222', '0.493509', '0.514272']
         : correct/total = [(7230, 14232), (7272, 14235), (7044, 14266), (7002, 14217), (7056, 14238), (7176, 14373), (7245, 14346), (7144, 14334), (7123, 14294), (7314, 14373), (7197, 14344), (7107, 14302), (7125, 14354), (7212, 14362), (7089, 14320), (7173, 14395), (7218, 14389), (7317, 14257), (7033, 14251), (7405, 14399)]
         : compromised: 0.5009, honest: 0.5014
Round 002: test acc mean=0.4979 ± 0.0082 | min=0.4836 max=0.5141
         : test loss mean=3.9752 ± 2.7956
         : individual accs = ['0.492622', '0.488655', '0.487312', '0.494408', '0.492134', '0.494260', '0.505855', '0.514092', '0.503008', '0.513254', '0.503416', '0.500070', '0.483628', '0.498677', '0.494972', '0.498645', '0.504135', '0.504735', '0.486352', '0.498715']
         : correct/total = [(7011, 14232), (6956, 14235), (6952, 14266), (7029, 14217), (7007, 14238), (7104, 14373), (7257, 14346), (7369, 14334), (7190, 14294), (7377, 14373), (7221, 14344), (7152, 14302), (6942, 14354), (7162, 14362), (7088, 14320), (7178, 14395), (7254, 14389), (7196, 14257), (6931, 14251), (7181, 14399)]
         : compromised: 0.4939, honest: 0.5006
Round 003: test acc mean=0.4989 ± 0.0114 | min=0.4747 max=0.5228
         : test loss mean=1.3897 ± 1.0968
         : individual accs = ['0.508642', '0.512118', '0.504206', '0.489695', '0.506813', '0.497252', '0.486198', '0.474745', '0.505737', '0.495165', '0.502091', '0.501119', '0.482235', '0.522838', '0.511592', '0.498298', '0.507401', '0.491338', '0.494492', '0.485173']
         : correct/total = [(7239, 14232), (7290, 14235), (7193, 14266), (6962, 14217), (7216, 14238), (7147, 14373), (6975, 14346), (6805, 14334), (7229, 14294), (7117, 14373), (7202, 14344), (7167, 14302), (6922, 14354), (7509, 14362), (7326, 14320), (7173, 14395), (7301, 14389), (7005, 14257), (7047, 14251), (6986, 14399)]
         : compromised: 0.5016, honest: 0.4970
Round 004: test acc mean=0.5012 ± 0.0105 | min=0.4854 max=0.5265
         : test loss mean=2.0052 ± 2.0219
         : individual accs = ['0.508502', '0.519705', '0.496986', '0.497433', '0.492625', '0.489181', '0.511780', '0.500140', '0.485448', '0.503166', '0.502579', '0.492099', '0.515118', '0.497772', '0.487151', '0.503578', '0.501077', '0.493231', '0.500596', '0.526495']
         : correct/total = [(7237, 14232), (7398, 14235), (7090, 14266), (7072, 14217), (7014, 14238), (7031, 14373), (7342, 14346), (7169, 14334), (6939, 14294), (7232, 14373), (7209, 14344), (7038, 14302), (7394, 14354), (7149, 14362), (6976, 14320), (7249, 14395), (7210, 14389), (7032, 14257), (7134, 14251), (7581, 14399)]
         : compromised: 0.4994, honest: 0.5025
Round 005: test acc mean=0.5035 ± 0.0082 | min=0.4883 max=0.5277
         : test loss mean=1.2165 ± 1.2829
         : individual accs = ['0.503724', '0.508254', '0.500140', '0.527678', '0.488341', '0.505810', '0.493308', '0.502512', '0.498881', '0.504488', '0.503904', '0.504265', '0.505364', '0.505779', '0.492528', '0.503994', '0.516019', '0.498071', '0.508456', '0.499479']
         : correct/total = [(7169, 14232), (7235, 14235), (7135, 14266), (7502, 14217), (6953, 14238), (7270, 14373), (7077, 14346), (7203, 14334), (7131, 14294), (7251, 14373), (7228, 14344), (7212, 14302), (7254, 14354), (7264, 14362), (7053, 14320), (7255, 14395), (7425, 14389), (7101, 14257), (7246, 14251), (7192, 14399)]
         : compromised: 0.5036, honest: 0.5035
Round 006: test acc mean=0.5047 ± 0.0118 | min=0.4817 max=0.5373
         : test loss mean=1.7447 ± 2.2972
         : individual accs = ['0.498665', '0.518370', '0.509603', '0.515580', '0.502599', '0.498852', '0.508156', '0.498047', '0.503148', '0.537327', '0.501115', '0.499860', '0.493521', '0.509052', '0.523045', '0.503439', '0.496004', '0.495546', '0.481650', '0.499549']
         : correct/total = [(7097, 14232), (7379, 14235), (7270, 14266), (7330, 14217), (7156, 14238), (7170, 14373), (7290, 14346), (7139, 14334), (7192, 14294), (7723, 14373), (7188, 14344), (7149, 14302), (7084, 14354), (7311, 14362), (7490, 14320), (7247, 14395), (7137, 14389), (7065, 14257), (6864, 14251), (7193, 14399)]
         : compromised: 0.5025, honest: 0.5061
Round 007: test acc mean=0.5018 ± 0.0081 | min=0.4828 max=0.5205
         : test loss mean=1.2690 ± 1.7519
         : individual accs = ['0.493184', '0.507692', '0.504066', '0.482802', '0.499579', '0.507201', '0.496933', '0.500767', '0.498531', '0.495721', '0.498954', '0.505314', '0.507524', '0.505570', '0.509008', '0.495936', '0.520467', '0.512029', '0.504105', '0.490729']
         : correct/total = [(7019, 14232), (7227, 14235), (7191, 14266), (6864, 14217), (7113, 14238), (7290, 14373), (7129, 14346), (7178, 14334), (7126, 14294), (7125, 14373), (7157, 14344), (7227, 14302), (7285, 14354), (7261, 14362), (7289, 14320), (7139, 14395), (7489, 14389), (7300, 14257), (7184, 14251), (7066, 14399)]
         : compromised: 0.5073, honest: 0.4981
Round 008: test acc mean=0.5034 ± 0.0153 | min=0.4742 max=0.5320
         : test loss mean=1.2235 ± 1.5047
         : individual accs = ['0.506324', '0.505585', '0.516543', '0.513048', '0.497752', '0.496626', '0.513035', '0.515278', '0.519519', '0.532039', '0.504741', '0.516291', '0.482514', '0.518800', '0.487221', '0.478430', '0.497741', '0.474153', '0.484106', '0.508924']
         : correct/total = [(7206, 14232), (7197, 14235), (7369, 14266), (7294, 14217), (7087, 14238), (7138, 14373), (7360, 14346), (7386, 14334), (7426, 14294), (7647, 14373), (7240, 14344), (7384, 14302), (6926, 14354), (7451, 14362), (6977, 14320), (6887, 14395), (7162, 14389), (6760, 14257), (6899, 14251), (7328, 14399)]
         : compromised: 0.4957, honest: 0.5086
Round 009: test acc mean=0.5045 ± 0.0096 | min=0.4867 max=0.5284
         : test loss mean=1.0265 ± 1.1743
         : individual accs = ['0.503302', '0.513804', '0.498808', '0.508687', '0.519174', '0.507897', '0.528370', '0.486745', '0.515321', '0.496278', '0.509551', '0.506992', '0.506131', '0.503830', '0.495810', '0.499965', '0.493571', '0.496949', '0.503544', '0.495104']
         : correct/total = [(7163, 14232), (7314, 14235), (7116, 14266), (7232, 14217), (7392, 14238), (7300, 14373), (7580, 14346), (6977, 14334), (7366, 14294), (7133, 14373), (7309, 14344), (7251, 14302), (7265, 14354), (7236, 14362), (7100, 14320), (7197, 14395), (7102, 14389), (7085, 14257), (7176, 14251), (7129, 14399)]
         : compromised: 0.5044, honest: 0.5046
Round 010: test acc mean=0.5062 ± 0.0151 | min=0.4803 max=0.5317
         : test loss mean=1.1654 ± 1.6970
         : individual accs = ['0.501265', '0.521812', '0.531684', '0.520855', '0.487990', '0.496417', '0.502928', '0.514790', '0.501889', '0.522786', '0.516383', '0.530485', '0.480284', '0.520192', '0.487849', '0.500313', '0.506290', '0.482360', '0.499895', '0.498160']
         : correct/total = [(7134, 14232), (7428, 14235), (7585, 14266), (7405, 14217), (6948, 14238), (7135, 14373), (7215, 14346), (7379, 14334), (7174, 14294), (7514, 14373), (7407, 14344), (7587, 14302), (6894, 14354), (7471, 14362), (6986, 14320), (7202, 14395), (7285, 14389), (6877, 14257), (7124, 14251), (7173, 14399)]
         : compromised: 0.5024, honest: 0.5088

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: d-fedavg
Attack: directed_deviation, 40.0% compromised
Final accuracy - Compromised: 0.5024, Honest: 0.5088
Overall test accuracy: mean=0.5062 ± 0.0151
