Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4955 ± 0.0336 | min=0.4445 max=0.5528
         : test loss mean=3.7452 ± 0.0246
         : individual accs = ['0.552326', '0.493457', '0.514090', '0.490192', '0.464190', '0.552834', '0.483186', '0.510692', '0.522548', '0.454290', '0.449916', '0.538517', '0.461520', '0.468668', '0.501728', '0.530901', '0.464243', '0.527851', '0.485064', '0.444525']
         : correct/total = [(2280, 4128), (2074, 4203), (2098, 4081), (2124, 4333), (1899, 4091), (2370, 4287), (2026, 4193), (2221, 4349), (2190, 4191), (1943, 4277), (1864, 4143), (2258, 4193), (1889, 4093), (1967, 4197), (2033, 4052), (2139, 4029), (1928, 4153), (2208, 4183), (1981, 4084), (1835, 4128)]
         : compromised: 0.4996, honest: 0.4938
Round 002: test acc mean=0.6794 ± 0.0187 | min=0.6384 max=0.7088
         : test loss mean=3.3704 ± 0.0825
         : individual accs = ['0.689922', '0.694980', '0.660867', '0.700669', '0.675141', '0.689526', '0.638445', '0.687054', '0.682176', '0.700491', '0.677046', '0.708800', '0.692646', '0.651656', '0.689783', '0.689501', '0.652300', '0.652642', '0.682419', '0.671269']
         : correct/total = [(2848, 4128), (2921, 4203), (2697, 4081), (3036, 4333), (2762, 4091), (2956, 4287), (2677, 4193), (2988, 4349), (2859, 4191), (2996, 4277), (2805, 4143), (2972, 4193), (2835, 4093), (2735, 4197), (2795, 4052), (2778, 4029), (2709, 4153), (2730, 4183), (2787, 4084), (2771, 4128)]
         : compromised: 0.6764, honest: 0.6806
Round 003: test acc mean=0.6985 ± 0.0254 | min=0.6338 max=0.7427
         : test loss mean=3.0147 ± 0.1643
         : individual accs = ['0.730378', '0.719724', '0.670424', '0.742673', '0.693473', '0.633777', '0.716432', '0.712348', '0.712479', '0.696516', '0.684769', '0.725256', '0.704862', '0.685251', '0.712488', '0.678828', '0.700698', '0.657901', '0.682419', '0.709302']
         : correct/total = [(3015, 4128), (3025, 4203), (2736, 4081), (3218, 4333), (2837, 4091), (2717, 4287), (3004, 4193), (3098, 4349), (2986, 4191), (2979, 4277), (2837, 4143), (3041, 4193), (2885, 4093), (2876, 4197), (2887, 4052), (2735, 4029), (2910, 4153), (2752, 4183), (2787, 4084), (2928, 4128)]
         : compromised: 0.6794, honest: 0.7067
Round 004: test acc mean=0.6885 ± 0.0351 | min=0.6066 max=0.7416
         : test loss mean=2.4398 ± 0.2185
         : individual accs = ['0.708333', '0.724720', '0.666993', '0.726979', '0.741628', '0.623513', '0.726210', '0.701541', '0.719399', '0.687865', '0.649288', '0.720487', '0.606645', '0.668811', '0.670039', '0.692231', '0.699976', '0.688740', '0.652791', '0.694041']
         : correct/total = [(2924, 4128), (3046, 4203), (2722, 4081), (3150, 4333), (3034, 4091), (2673, 4287), (3045, 4193), (3051, 4349), (3015, 4191), (2942, 4277), (2690, 4143), (3021, 4193), (2483, 4093), (2807, 4197), (2715, 4052), (2789, 4029), (2907, 4153), (2881, 4183), (2666, 4084), (2865, 4128)]
         : compromised: 0.6518, honest: 0.7043
Round 005: test acc mean=0.6836 ± 0.0327 | min=0.6054 max=0.7342
         : test loss mean=1.7678 ± 0.1971
         : individual accs = ['0.715601', '0.691649', '0.666993', '0.704362', '0.707895', '0.660135', '0.681135', '0.690274', '0.714388', '0.705635', '0.692735', '0.718102', '0.649401', '0.621635', '0.605380', '0.658228', '0.734168', '0.671049', '0.668707', '0.714632']
         : correct/total = [(2954, 4128), (2907, 4203), (2722, 4081), (3052, 4333), (2896, 4091), (2830, 4287), (2856, 4193), (3002, 4349), (2994, 4191), (3018, 4277), (2870, 4143), (3011, 4193), (2658, 4093), (2609, 4197), (2453, 4052), (2652, 4029), (3049, 4153), (2807, 4183), (2731, 4084), (2950, 4128)]
         : compromised: 0.6461, honest: 0.6997
Round 006: test acc mean=0.7521 ± 0.0168 | min=0.7218 max=0.7760
         : test loss mean=1.0781 ± 0.1016
         : individual accs = ['0.744671', '0.760409', '0.770644', '0.773367', '0.763627', '0.733380', '0.758168', '0.758565', '0.746838', '0.748889', '0.776008', '0.763654', '0.727584', '0.741482', '0.723346', '0.732936', '0.771490', '0.760220', '0.721841', '0.765262']
         : correct/total = [(3074, 4128), (3196, 4203), (3145, 4081), (3351, 4333), (3124, 4091), (3144, 4287), (3179, 4193), (3299, 4349), (3130, 4191), (3203, 4277), (3215, 4143), (3202, 4193), (2978, 4093), (3112, 4197), (2931, 4052), (2953, 4029), (3204, 4153), (3180, 4183), (2948, 4084), (3159, 4128)]
         : compromised: 0.7346, honest: 0.7596
Round 007: test acc mean=0.8025 ± 0.0070 | min=0.7826 max=0.8117
         : test loss mean=0.7034 ± 0.0394
         : individual accs = ['0.801357', '0.807994', '0.793923', '0.810985', '0.798827', '0.805458', '0.807059', '0.811681', '0.802672', '0.807809', '0.801110', '0.809444', '0.782556', '0.799381', '0.802073', '0.792504', '0.811702', '0.799665', '0.802644', '0.800630']
         : correct/total = [(3308, 4128), (3396, 4203), (3240, 4081), (3514, 4333), (3268, 4091), (3453, 4287), (3384, 4193), (3530, 4349), (3364, 4191), (3455, 4277), (3319, 4143), (3394, 4193), (3203, 4093), (3355, 4197), (3250, 4052), (3193, 4029), (3371, 4153), (3345, 4183), (3278, 4084), (3305, 4128)]
         : compromised: 0.7986, honest: 0.8041
Round 008: test acc mean=0.8218 ± 0.0068 | min=0.8031 max=0.8307
         : test loss mean=0.5686 ± 0.0186
         : individual accs = ['0.814196', '0.822508', '0.824553', '0.826448', '0.814960', '0.830184', '0.826139', '0.828696', '0.822477', '0.825579', '0.813179', '0.830670', '0.814561', '0.821301', '0.829961', '0.820799', '0.821816', '0.823572', '0.821499', '0.803052']
         : correct/total = [(3361, 4128), (3457, 4203), (3365, 4081), (3581, 4333), (3334, 4091), (3559, 4287), (3464, 4193), (3604, 4349), (3447, 4191), (3531, 4277), (3369, 4143), (3483, 4193), (3334, 4093), (3447, 4197), (3363, 4052), (3307, 4029), (3413, 4153), (3445, 4183), (3355, 4084), (3315, 4128)]
         : compromised: 0.8235, honest: 0.8211
Round 009: test acc mean=0.8359 ± 0.0049 | min=0.8282 max=0.8482
         : test loss mean=0.5111 ± 0.0168
         : individual accs = ['0.828246', '0.838449', '0.835089', '0.840295', '0.829870', '0.835316', '0.841402', '0.840653', '0.848246', '0.841945', '0.831282', '0.834486', '0.833374', '0.834406', '0.838105', '0.837925', '0.832410', '0.833612', '0.833007', '0.829215']
         : correct/total = [(3419, 4128), (3524, 4203), (3408, 4081), (3641, 4333), (3395, 4091), (3581, 4287), (3528, 4193), (3656, 4349), (3555, 4191), (3601, 4277), (3444, 4143), (3499, 4193), (3411, 4093), (3502, 4197), (3396, 4052), (3376, 4029), (3457, 4153), (3487, 4183), (3402, 4084), (3423, 4128)]
         : compromised: 0.8346, honest: 0.8364
Round 010: test acc mean=0.8430 ± 0.0057 | min=0.8306 max=0.8494
         : test loss mean=0.4846 ± 0.0181
         : individual accs = ['0.835029', '0.849393', '0.842686', '0.846296', '0.830604', '0.840914', '0.848080', '0.846861', '0.845860', '0.847791', '0.832006', '0.838302', '0.840215', '0.847272', '0.847236', '0.848846', '0.844209', '0.847000', '0.845495', '0.835271']
         : correct/total = [(3447, 4128), (3570, 4203), (3439, 4081), (3667, 4333), (3398, 4091), (3605, 4287), (3556, 4193), (3683, 4349), (3545, 4191), (3626, 4277), (3447, 4143), (3515, 4193), (3439, 4093), (3556, 4197), (3433, 4052), (3420, 4029), (3506, 4153), (3543, 4183), (3453, 4084), (3448, 4128)]
         : compromised: 0.8447, honest: 0.8422

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: directed_deviation, 30.0% compromised
Final accuracy - Compromised: 0.8447, Honest: 0.8422
Overall test accuracy: mean=0.8430 ± 0.0057

=== BALANCE SUMMARY ===
Node 0: acceptance=0.688
Node 1: acceptance=0.818
Node 2: acceptance=0.667
Node 3: acceptance=0.750
Node 4: acceptance=0.727
Node 5: acceptance=0.667
Node 6: acceptance=0.571
Node 7: acceptance=0.643
Node 8: acceptance=0.500
Node 9: acceptance=0.769
Node 10: acceptance=0.667
Node 11: acceptance=0.643
Node 12: acceptance=0.750
Node 13: acceptance=0.769
Node 14: acceptance=0.667
Node 15: acceptance=0.636
Node 16: acceptance=0.615
Node 17: acceptance=0.778
Node 18: acceptance=0.750
Node 19: acceptance=0.625

Performance Summary:
  - Distance computation time: 1.064s (44.3%)
  - Filtering time: 1.158s (48.2%)
  - Aggregation time: 0.182s (7.6%)
  - Total time: 2.404s
  - Mean acceptance rate: 0.685

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
