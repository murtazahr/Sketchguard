Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4886 ± 0.0374 | min=0.4193 max=0.5493
         : test loss mean=3.7470 ± 0.0252
         : individual accs = ['0.548692', '0.476564', '0.508209', '0.492730', '0.432901', '0.549335', '0.467684', '0.501954', '0.522548', '0.448913', '0.419261', '0.528738', '0.457855', '0.474148', '0.501234', '0.521966', '0.458945', '0.530481', '0.488002', '0.442103']
         : correct/total = [(2265, 4128), (2003, 4203), (2074, 4081), (2135, 4333), (1771, 4091), (2355, 4287), (1961, 4193), (2183, 4349), (2190, 4191), (1920, 4277), (1737, 4143), (2217, 4193), (1874, 4093), (1990, 4197), (2031, 4052), (2103, 4029), (1906, 4153), (2219, 4183), (1993, 4084), (1825, 4128)]
         : compromised: 0.5008, honest: 0.4805
Round 002: test acc mean=0.6772 ± 0.0183 | min=0.6332 max=0.7021
         : test loss mean=3.3490 ± 0.1032
         : individual accs = ['0.688953', '0.678325', '0.663563', '0.702054', '0.678807', '0.701190', '0.633198', '0.687514', '0.687903', '0.695347', '0.673425', '0.671596', '0.689470', '0.659757', '0.688796', '0.689749', '0.648928', '0.644514', '0.683154', '0.678537']
         : correct/total = [(2844, 4128), (2851, 4203), (2708, 4081), (3042, 4333), (2777, 4091), (3006, 4287), (2655, 4193), (2990, 4349), (2883, 4191), (2974, 4277), (2790, 4143), (2816, 4193), (2822, 4093), (2769, 4197), (2791, 4052), (2779, 4029), (2695, 4153), (2696, 4183), (2790, 4084), (2801, 4128)]
         : compromised: 0.6771, honest: 0.6773
Round 003: test acc mean=0.6900 ± 0.0265 | min=0.6300 max=0.7447
         : test loss mean=2.9449 ± 0.2102
         : individual accs = ['0.718266', '0.679277', '0.647880', '0.744750', '0.690785', '0.630044', '0.721440', '0.716257', '0.713672', '0.689034', '0.693700', '0.677319', '0.690936', '0.676436', '0.706811', '0.685530', '0.685288', '0.648099', '0.684868', '0.698643']
         : correct/total = [(2965, 4128), (2855, 4203), (2644, 4081), (3227, 4333), (2826, 4091), (2701, 4287), (3025, 4193), (3115, 4349), (2991, 4191), (2947, 4277), (2874, 4143), (2840, 4193), (2828, 4093), (2839, 4197), (2864, 4052), (2762, 4029), (2846, 4153), (2711, 4183), (2797, 4084), (2884, 4128)]
         : compromised: 0.6742, honest: 0.7004
Round 004: test acc mean=0.6791 ± 0.0379 | min=0.5942 max=0.7355
         : test loss mean=2.2946 ± 0.2684
         : individual accs = ['0.697917', '0.637402', '0.664298', '0.735518', '0.733317', '0.619547', '0.725495', '0.714647', '0.725125', '0.691139', '0.663770', '0.646792', '0.594185', '0.672623', '0.660908', '0.719285', '0.680954', '0.673201', '0.657933', '0.667636']
         : correct/total = [(2881, 4128), (2679, 4203), (2711, 4081), (3187, 4333), (3000, 4091), (2656, 4287), (3042, 4193), (3108, 4349), (3039, 4191), (2956, 4277), (2750, 4143), (2712, 4193), (2432, 4093), (2823, 4197), (2678, 4052), (2898, 4029), (2828, 4153), (2816, 4183), (2687, 4084), (2756, 4128)]
         : compromised: 0.6453, honest: 0.7016
Round 005: test acc mean=0.6936 ± 0.0369 | min=0.6050 max=0.7422
         : test loss mean=1.5813 ± 0.2093
         : individual accs = ['0.704457', '0.605044', '0.695418', '0.742211', '0.711318', '0.693025', '0.697353', '0.726834', '0.726796', '0.729483', '0.717837', '0.656570', '0.673833', '0.641172', '0.622162', '0.705634', '0.737058', '0.675592', '0.694907', '0.715116']
         : correct/total = [(2908, 4128), (2543, 4203), (2838, 4081), (3216, 4333), (2910, 4091), (2971, 4287), (2924, 4193), (3161, 4349), (3046, 4191), (3120, 4277), (2974, 4143), (2753, 4193), (2758, 4093), (2691, 4197), (2521, 4052), (2843, 4029), (3061, 4153), (2826, 4183), (2838, 4084), (2952, 4128)]
         : compromised: 0.6578, honest: 0.7175
Round 006: test acc mean=0.7732 ± 0.0127 | min=0.7454 max=0.7924
         : test loss mean=0.9256 ± 0.0769
         : individual accs = ['0.761143', '0.745420', '0.789512', '0.791599', '0.770472', '0.770702', '0.768185', '0.791906', '0.773801', '0.785831', '0.787352', '0.766277', '0.760078', '0.761020', '0.761846', '0.772152', '0.792439', '0.773847', '0.764447', '0.775921']
         : correct/total = [(3142, 4128), (3133, 4203), (3222, 4081), (3430, 4333), (3152, 4091), (3304, 4287), (3221, 4193), (3444, 4349), (3243, 4191), (3361, 4277), (3262, 4143), (3213, 4193), (3111, 4093), (3194, 4197), (3087, 4052), (3111, 4029), (3291, 4153), (3237, 4183), (3122, 4084), (3203, 4128)]
         : compromised: 0.7630, honest: 0.7800
Round 007: test acc mean=0.8129 ± 0.0055 | min=0.8036 max=0.8229
         : test loss mean=0.6393 ± 0.0256
         : individual accs = ['0.805717', '0.812753', '0.813036', '0.821832', '0.803960', '0.812923', '0.815407', '0.822948', '0.817466', '0.819032', '0.809076', '0.814214', '0.803567', '0.813915', '0.811451', '0.813105', '0.819648', '0.811379', '0.812684', '0.804506']
         : correct/total = [(3326, 4128), (3416, 4203), (3318, 4081), (3561, 4333), (3289, 4091), (3485, 4287), (3419, 4193), (3579, 4349), (3426, 4191), (3503, 4277), (3352, 4143), (3414, 4193), (3289, 4093), (3416, 4197), (3288, 4052), (3276, 4029), (3404, 4153), (3394, 4183), (3319, 4084), (3321, 4128)]
         : compromised: 0.8116, honest: 0.8138
Round 008: test acc mean=0.8249 ± 0.0070 | min=0.8062 max=0.8374
         : test loss mean=0.5478 ± 0.0197
         : individual accs = ['0.816618', '0.827742', '0.826023', '0.830833', '0.816671', '0.830184', '0.828285', '0.833295', '0.827487', '0.826748', '0.816075', '0.828047', '0.820425', '0.825351', '0.837364', '0.825763', '0.818926', '0.830504', '0.825906', '0.806202']
         : correct/total = [(3371, 4128), (3479, 4203), (3371, 4081), (3600, 4333), (3341, 4091), (3559, 4287), (3473, 4193), (3624, 4349), (3468, 4191), (3536, 4277), (3381, 4143), (3472, 4193), (3358, 4093), (3464, 4197), (3393, 4052), (3327, 4029), (3401, 4153), (3474, 4183), (3373, 4084), (3328, 4128)]
         : compromised: 0.8282, honest: 0.8227
Round 009: test acc mean=0.8374 ± 0.0054 | min=0.8290 max=0.8482
         : test loss mean=0.5008 ± 0.0169
         : individual accs = ['0.828973', '0.843445', '0.834109', '0.839372', '0.829137', '0.839981', '0.839733', '0.843412', '0.848246', '0.844985', '0.829351', '0.835440', '0.834596', '0.834644', '0.843534', '0.840903', '0.834337', '0.834090', '0.835700', '0.834787']
         : correct/total = [(3422, 4128), (3545, 4203), (3404, 4081), (3637, 4333), (3392, 4091), (3601, 4287), (3521, 4193), (3668, 4349), (3555, 4191), (3614, 4277), (3436, 4143), (3503, 4193), (3416, 4093), (3503, 4197), (3418, 4052), (3388, 4029), (3465, 4153), (3489, 4183), (3413, 4084), (3446, 4128)]
         : compromised: 0.8377, honest: 0.8373
Round 010: test acc mean=0.8434 ± 0.0054 | min=0.8318 max=0.8499
         : test loss mean=0.4786 ± 0.0183
         : individual accs = ['0.836725', '0.849869', '0.839010', '0.845834', '0.833781', '0.841847', '0.845934', '0.846172', '0.848485', '0.845920', '0.831764', '0.839256', '0.841437', '0.847510', '0.848717', '0.848598', '0.843968', '0.849869', '0.846964', '0.836483']
         : correct/total = [(3454, 4128), (3572, 4203), (3424, 4081), (3665, 4333), (3411, 4091), (3609, 4287), (3547, 4193), (3680, 4349), (3556, 4191), (3618, 4277), (3446, 4143), (3519, 4193), (3444, 4093), (3557, 4197), (3439, 4052), (3419, 4029), (3505, 4153), (3555, 4183), (3459, 4084), (3453, 4128)]
         : compromised: 0.8457, honest: 0.8419

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: directed_deviation, 40.0% compromised
Final accuracy - Compromised: 0.8457, Honest: 0.8419
Overall test accuracy: mean=0.8434 ± 0.0054

=== BALANCE SUMMARY ===
Node 0: acceptance=0.562
Node 1: acceptance=0.727
Node 2: acceptance=0.500
Node 3: acceptance=0.625
Node 4: acceptance=0.545
Node 5: acceptance=0.533
Node 6: acceptance=0.500
Node 7: acceptance=0.500
Node 8: acceptance=0.500
Node 9: acceptance=0.692
Node 10: acceptance=0.556
Node 11: acceptance=0.571
Node 12: acceptance=0.667
Node 13: acceptance=0.692
Node 14: acceptance=0.600
Node 15: acceptance=0.545
Node 16: acceptance=0.538
Node 17: acceptance=0.667
Node 18: acceptance=0.688
Node 19: acceptance=0.500

Performance Summary:
  - Distance computation time: 1.014s (44.5%)
  - Filtering time: 1.107s (48.5%)
  - Aggregation time: 0.160s (7.0%)
  - Total time: 2.281s
  - Mean acceptance rate: 0.585

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
