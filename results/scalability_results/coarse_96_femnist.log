(edgedrift) mrangwala@rs-l-rhatop:~/Projects/Trust-Monitor$ python decentralized_fl_sim.py --dataset femnist --rounds 3 --local-epochs 1 --seed 987654321 --batch-size 64 --lr 0.01 --max-samples 10000 --agg coarse --attack-percentage 0.5 --attack-type directed_deviation --verbose --graph k-regular --k 96 --num-nodes 100
Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 100 clients
Users per client: 35 (with 97 clients getting +1 user)
Train partition sizes: [8056, 7245, 7634, 7059, 7480, 6831, 7408, 8154, 7361, 7470, 6246, 6823, 7701, 6799, 7175, 7379, 7191, 7366, 6829, 7248, 6921, 6718, 7193, 8029, 7759, 7612, 7427, 7763, 6890, 8166, 7757, 7698, 8091, 7672, 7300, 6646, 7186, 7943, 8164, 7471, 7696, 7796, 7032, 8059, 7171, 8263, 7313, 6952, 7895, 7620, 7505, 7410, 6969, 7307, 7020, 7166, 7229, 7423, 7740, 7298, 6666, 7173, 6919, 7659, 6658, 7010, 7176, 8216, 7331, 7127, 7472, 7191, 6756, 6957, 6837, 7074, 7606, 7168, 6604, 6586, 7021, 8138, 7179, 7456, 6956, 8016, 7597, 7243, 7390, 7300, 7527, 7793, 6490, 8266, 7349, 7188, 7373, 6901, 6627, 7742]
Test partition sizes: [913, 824, 868, 802, 850, 776, 844, 924, 837, 847, 711, 776, 872, 774, 814, 835, 818, 836, 778, 822, 787, 762, 818, 909, 881, 866, 845, 879, 785, 929, 880, 873, 918, 869, 827, 755, 811, 900, 921, 849, 874, 883, 796, 909, 813, 936, 828, 790, 896, 863, 849, 843, 791, 829, 799, 816, 823, 843, 875, 830, 754, 813, 787, 869, 757, 799, 814, 934, 831, 809, 849, 818, 771, 792, 777, 806, 865, 816, 752, 747, 800, 921, 812, 844, 790, 910, 862, 822, 842, 829, 854, 883, 741, 933, 835, 817, 836, 788, 758, 880]
  Client 0: 8056 train samples, 62 unique classes
  Client 1: 7245 train samples, 62 unique classes
  Client 2: 7634 train samples, 62 unique classes
  Client 3: 7059 train samples, 62 unique classes
  Client 4: 7480 train samples, 62 unique classes
  Client 5: 6831 train samples, 62 unique classes
  Client 6: 7408 train samples, 62 unique classes
  Client 7: 8154 train samples, 62 unique classes
  Client 8: 7361 train samples, 62 unique classes
  Client 9: 7470 train samples, 62 unique classes
  Client 10: 6246 train samples, 62 unique classes
  Client 11: 6823 train samples, 62 unique classes
  Client 12: 7701 train samples, 62 unique classes
  Client 13: 6799 train samples, 62 unique classes
  Client 14: 7175 train samples, 62 unique classes
  Client 15: 7379 train samples, 62 unique classes
  Client 16: 7191 train samples, 62 unique classes
  Client 17: 7366 train samples, 62 unique classes
  Client 18: 6829 train samples, 62 unique classes
  Client 19: 7248 train samples, 62 unique classes
  Client 20: 6921 train samples, 62 unique classes
  Client 21: 6718 train samples, 62 unique classes
  Client 22: 7193 train samples, 62 unique classes
  Client 23: 8029 train samples, 62 unique classes
  Client 24: 7759 train samples, 62 unique classes
  Client 25: 7612 train samples, 62 unique classes
  Client 26: 7427 train samples, 62 unique classes
  Client 27: 7763 train samples, 62 unique classes
  Client 28: 6890 train samples, 62 unique classes
  Client 29: 8166 train samples, 62 unique classes
  Client 30: 7757 train samples, 62 unique classes
  Client 31: 7698 train samples, 62 unique classes
  Client 32: 8091 train samples, 62 unique classes
  Client 33: 7672 train samples, 62 unique classes
  Client 34: 7300 train samples, 62 unique classes
  Client 35: 6646 train samples, 62 unique classes
  Client 36: 7186 train samples, 62 unique classes
  Client 37: 7943 train samples, 62 unique classes
  Client 38: 8164 train samples, 62 unique classes
  Client 39: 7471 train samples, 62 unique classes
  Client 40: 7696 train samples, 62 unique classes
  Client 41: 7796 train samples, 62 unique classes
  Client 42: 7032 train samples, 62 unique classes
  Client 43: 8059 train samples, 62 unique classes
  Client 44: 7171 train samples, 62 unique classes
  Client 45: 8263 train samples, 62 unique classes
  Client 46: 7313 train samples, 62 unique classes
  Client 47: 6952 train samples, 62 unique classes
  Client 48: 7895 train samples, 62 unique classes
  Client 49: 7620 train samples, 62 unique classes
  Client 50: 7505 train samples, 62 unique classes
  Client 51: 7410 train samples, 62 unique classes
  Client 52: 6969 train samples, 62 unique classes
  Client 53: 7307 train samples, 62 unique classes
  Client 54: 7020 train samples, 62 unique classes
  Client 55: 7166 train samples, 62 unique classes
  Client 56: 7229 train samples, 62 unique classes
  Client 57: 7423 train samples, 62 unique classes
  Client 58: 7740 train samples, 62 unique classes
  Client 59: 7298 train samples, 62 unique classes
  Client 60: 6666 train samples, 62 unique classes
  Client 61: 7173 train samples, 62 unique classes
  Client 62: 6919 train samples, 62 unique classes
  Client 63: 7659 train samples, 62 unique classes
  Client 64: 6658 train samples, 62 unique classes
  Client 65: 7010 train samples, 62 unique classes
  Client 66: 7176 train samples, 62 unique classes
  Client 67: 8216 train samples, 62 unique classes
  Client 68: 7331 train samples, 62 unique classes
  Client 69: 7127 train samples, 62 unique classes
  Client 70: 7472 train samples, 62 unique classes
  Client 71: 7191 train samples, 62 unique classes
  Client 72: 6756 train samples, 62 unique classes
  Client 73: 6957 train samples, 62 unique classes
  Client 74: 6837 train samples, 62 unique classes
  Client 75: 7074 train samples, 62 unique classes
  Client 76: 7606 train samples, 62 unique classes
  Client 77: 7168 train samples, 62 unique classes
  Client 78: 6604 train samples, 62 unique classes
  Client 79: 6586 train samples, 62 unique classes
  Client 80: 7021 train samples, 62 unique classes
  Client 81: 8138 train samples, 62 unique classes
  Client 82: 7179 train samples, 62 unique classes
  Client 83: 7456 train samples, 62 unique classes
  Client 84: 6956 train samples, 62 unique classes
  Client 85: 8016 train samples, 62 unique classes
  Client 86: 7597 train samples, 62 unique classes
  Client 87: 7243 train samples, 62 unique classes
  Client 88: 7390 train samples, 62 unique classes
  Client 89: 7300 train samples, 62 unique classes
  Client 90: 7527 train samples, 62 unique classes
  Client 91: 7793 train samples, 62 unique classes
  Client 92: 6490 train samples, 62 unique classes
  Client 93: 8266 train samples, 62 unique classes
  Client 94: 7349 train samples, 62 unique classes
  Client 95: 7188 train samples, 62 unique classes
  Client 96: 7373 train samples, 62 unique classes
  Client 97: 6901 train samples, 62 unique classes
  Client 98: 6627 train samples, 62 unique classes
  Client 99: 7742 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: k-regular, nodes: 100, edges: 4800
Degree statistics: avg=96.00, min=96, max=96
k-regular with k=96 (each node has exactly 96 neighbors)
Attack: Compromised 50/100 nodes: [0, 4, 6, 10, 13, 14, 15, 16, 18, 19, 22, 23, 24, 25, 27, 29, 30, 31, 32, 33, 35, 38, 40, 41, 45, 46, 47, 48, 49, 50, 52, 53, 55, 56, 57, 59, 61, 62, 66, 68, 73, 76, 77, 84, 85, 87, 88, 90, 92, 99]
Attack type: directed_deviation, lambda: 1.0
COARSE Node 0:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 1:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 2:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 3:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 4:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 5:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 6:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 7:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 8:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 9:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 10:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 11:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 12:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 13:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 14:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 15:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 16:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 17:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 18:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 19:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 20:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 21:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 22:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 23:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 24:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 25:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 26:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 27:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 28:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 29:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 30:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 31:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 32:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 33:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 34:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 35:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 36:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 37:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 38:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 39:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 40:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 41:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 42:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 43:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 44:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 45:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 46:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 47:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 48:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 49:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 50:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 51:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 52:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 53:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 54:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 55:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 56:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 57:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 58:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 59:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 60:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 61:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 62:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 63:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 64:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 65:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 66:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 67:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 68:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 69:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 70:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 71:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 72:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 73:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 74:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 75:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 76:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 77:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 78:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 79:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 80:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 81:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 82:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 83:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 84:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 85:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 86:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 87:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 88:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 89:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 90:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 91:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 92:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 93:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 94:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 95:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 96:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 97:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 98:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE Node 99:
  Model dim: 6,603,710 → Sketch size: 1000
  Compression ratio: 6603.7x
  Using model parameters for aggregation, sketches for filtering
COARSE ALGORITHM (Sketch-based Filtering + State Aggregation)
  - Model dimension: 6,603,710 parameters
  - Sketch size: 1000
  - Compression ratio: 6603.7x
  - Complexity: O(d + N×k) = O(6,603,710 + 100×1000)
  - Theoretical speedup vs BALANCE: 98.5x
CUDAGraph supports dynamic shapes by recording a new graph for each distinct input size. Recording too many CUDAGraphs may lead to extra overhead. We have observed 51 distinct sizes. Please consider the following options for better performance: a) padding inputs to a few fixed number of shapes; or b) set torch._inductor.config.triton.cudagraph_skip_dynamic_graphs=True. Set torch._inductor.config.triton.cudagraph_dynamic_shape_warn_limit=None to silence this warning.
Initial test acc across nodes: mean=0.0186 ± 0.0179
/home/student.unimelb.edu.au/mrangwala/miniconda3/envs/edgedrift/lib/python3.12/site-packages/torch/_inductor/compile_fx.py:282: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
  CUDAGraph supports dynamic shapes by recording a new graph for each distinct input size. Recording too many CUDAGraphs may lead to extra overhead. We have observed 51 distinct sizes. Please consider the following options for better performance: a) padding inputs to a few fixed number of shapes; or b) set torch._inductor.config.triton.cudagraph_skip_dynamic_graphs=True. Set torch._inductor.config.triton.cudagraph_dynamic_shape_warn_limit=None to silence this warning.
  CUDAGraph supports dynamic shapes by recording a new graph for each distinct input size. Recording too many CUDAGraphs may lead to extra overhead. We have observed 51 distinct sizes. Please consider the following options for better performance: a) padding inputs to a few fixed number of shapes; or b) set torch._inductor.config.triton.cudagraph_skip_dynamic_graphs=True. Set torch._inductor.config.triton.cudagraph_dynamic_shape_warn_limit=None to silence this warning.
  Round 001: test acc mean=0.0587 ± 0.0188 | min=0.0342 max=0.1272
           : test loss mean=4.0393 ± 0.0104
           : individual accs = ['0.050383', '0.041262', '0.096774', '0.081047', '0.057647', '0.063144', '0.049763', '0.037879', '0.077658', '0.044864', '0.099859', '0.064433', '0.037844', '0.047804', '0.067568', '0.034731', '0.050122', '0.065789', '0.065553', '0.053528', '0.052097', '0.051181', '0.069682', '0.035204', '0.048808', '0.058891', '0.056805', '0.055745', '0.047134', '0.051668', '0.043182', '0.036655', '0.044662', '0.101266', '0.050786', '0.100662', '0.097411', '0.045556', '0.059718', '0.064782', '0.045767', '0.043035', '0.070352', '0.088009', '0.045510', '0.034188', '0.053140', '0.054430', '0.049107', '0.048667', '0.061249', '0.052195', '0.067004', '0.060314', '0.100125', '0.122549', '0.070474', '0.051008', '0.060571', '0.046988', '0.053050', '0.050431', '0.048285', '0.058688', '0.070013', '0.045056', '0.047912', '0.052463', '0.055355', '0.044499', '0.057715', '0.050122', '0.058366', '0.044192', '0.043758', '0.044665', '0.045087', '0.050245', '0.062500', '0.127175', '0.057500', '0.051031', '0.061576', '0.050948', '0.051899', '0.041758', '0.047564', '0.092457', '0.078385', '0.051870', '0.039813', '0.046433', '0.103914', '0.039657', '0.069461', '0.047736', '0.041866', '0.064721', '0.080475', '0.060227']
           : correct/total = [(46, 913), (34, 824), (84, 868), (65, 802), (49, 850), (49, 776), (42, 844), (35, 924), (65, 837), (38, 847), (71, 711), (50, 776), (33, 872), (37, 774), (55, 814), (29, 835), (41, 818), (55, 836), (51, 778), (44, 822), (41, 787), (39, 762), (57, 818), (32, 909), (43, 881), (51, 866), (48, 845), (49, 879), (37, 785), (48, 929), (38, 880), (32, 873), (41, 918), (88, 869), (42, 827), (76, 755), (79, 811), (41, 900), (55, 921), (55, 849), (40, 874), (38, 883), (56, 796), (80, 909), (37, 813), (32, 936), (44, 828), (43, 790), (44, 896), (42, 863), (52, 849), (44, 843), (53, 791), (50, 829), (80, 799), (100, 816), (58, 823), (43, 843), (53, 875), (39, 830), (40, 754), (41, 813), (38, 787), (51, 869), (53, 757), (36, 799), (39, 814), (49, 934), (46, 831), (36, 809), (49, 849), (41, 818), (45, 771), (35, 792), (34, 777), (36, 806), (39, 865), (41, 816), (47, 752), (95, 747), (46, 800), (47, 921), (50, 812), (43, 844), (41, 790), (38, 910), (41, 862), (76, 822), (66, 842), (43, 829), (34, 854), (41, 883), (77, 741), (37, 933), (58, 835), (39, 817), (35, 836), (51, 788), (61, 758), (53, 880)]
           : compromised: 0.0580, honest: 0.0594
           : coarse stats = ['Node 0: acc_rate=0.115', 'Node 1: acc_rate=0.406', 'Node 2: acc_rate=0.469']...
  Round 002: test acc mean=0.0516 ± 0.0092 | min=0.0283 max=0.0892
           : test loss mean=3.9098 ± 0.0270
           : individual accs = ['0.043812', '0.041262', '0.049539', '0.054863', '0.057647', '0.063144', '0.055687', '0.033550', '0.066906', '0.054309', '0.047820', '0.055412', '0.041284', '0.045220', '0.057740', '0.052695', '0.050122', '0.065789', '0.028278', '0.053528', '0.052097', '0.076115', '0.068460', '0.050605', '0.048808', '0.045035', '0.063905', '0.046644', '0.047134', '0.051668', '0.045455', '0.036655', '0.037037', '0.044879', '0.050786', '0.063576', '0.049322', '0.040000', '0.056460', '0.055359', '0.036613', '0.057758', '0.042714', '0.044004', '0.045510', '0.043803', '0.059179', '0.059494', '0.040179', '0.038239', '0.051826', '0.052195', '0.055626', '0.044632', '0.063830', '0.055147', '0.047388', '0.051008', '0.060571', '0.089157', '0.053050', '0.061501', '0.059720', '0.046030', '0.048877', '0.052566', '0.057740', '0.046039', '0.050542', '0.056860', '0.057715', '0.061125', '0.063554', '0.044192', '0.046332', '0.050868', '0.035838', '0.058824', '0.053191', '0.050870', '0.057500', '0.048860', '0.055419', '0.043839', '0.049367', '0.041758', '0.046404', '0.059611', '0.055819', '0.048251', '0.066745', '0.038505', '0.052632', '0.038585', '0.055090', '0.053856', '0.046651', '0.045685', '0.056728', '0.053409']
           : correct/total = [(40, 913), (34, 824), (43, 868), (44, 802), (49, 850), (49, 776), (47, 844), (31, 924), (56, 837), (46, 847), (34, 711), (43, 776), (36, 872), (35, 774), (47, 814), (44, 835), (41, 818), (55, 836), (22, 778), (44, 822), (41, 787), (58, 762), (56, 818), (46, 909), (43, 881), (39, 866), (54, 845), (41, 879), (37, 785), (48, 929), (40, 880), (32, 873), (34, 918), (39, 869), (42, 827), (48, 755), (40, 811), (36, 900), (52, 921), (47, 849), (32, 874), (51, 883), (34, 796), (40, 909), (37, 813), (41, 936), (49, 828), (47, 790), (36, 896), (33, 863), (44, 849), (44, 843), (44, 791), (37, 829), (51, 799), (45, 816), (39, 823), (43, 843), (53, 875), (74, 830), (40, 754), (50, 813), (47, 787), (40, 869), (37, 757), (42, 799), (47, 814), (43, 934), (42, 831), (46, 809), (49, 849), (50, 818), (49, 771), (35, 792), (36, 777), (41, 806), (31, 865), (48, 816), (40, 752), (38, 747), (46, 800), (45, 921), (45, 812), (37, 844), (39, 790), (38, 910), (40, 862), (49, 822), (47, 842), (40, 829), (57, 854), (34, 883), (39, 741), (36, 933), (46, 835), (44, 817), (39, 836), (36, 788), (43, 758), (47, 880)]
           : compromised: 0.0513, honest: 0.0518
           : coarse stats = ['Node 0: acc_rate=0.057', 'Node 1: acc_rate=0.203', 'Node 2: acc_rate=0.234']...
Round 003: test acc mean=0.0511 ± 0.0082 | min=0.0283 max=0.0696
         : test loss mean=3.7328 ± 0.0339
         : individual accs = ['0.044907', '0.058252', '0.064516', '0.058603', '0.057647', '0.039948', '0.049763', '0.033550', '0.051374', '0.044864', '0.047820', '0.056701', '0.064220', '0.040052', '0.057740', '0.034731', '0.053790', '0.065789', '0.028278', '0.055961', '0.054638', '0.055118', '0.068460', '0.050605', '0.048808', '0.035797', '0.049704', '0.039818', '0.059873', '0.051668', '0.051136', '0.053837', '0.041394', '0.047181', '0.055623', '0.060927', '0.043157', '0.051111', '0.056460', '0.055359', '0.056064', '0.046433', '0.042714', '0.044004', '0.059041', '0.043803', '0.053140', '0.055696', '0.043527', '0.038239', '0.051826', '0.054567', '0.055626', '0.063932', '0.053817', '0.051471', '0.055893', '0.046263', '0.056000', '0.057831', '0.054377', '0.059041', '0.055909', '0.056387', '0.054161', '0.058824', '0.057740', '0.050321', '0.054152', '0.056860', '0.045936', '0.048900', '0.058366', '0.039141', '0.037323', '0.049628', '0.045087', '0.042892', '0.062500', '0.069612', '0.045000', '0.044517', '0.057882', '0.054502', '0.041772', '0.051648', '0.059165', '0.049878', '0.047506', '0.060314', '0.039813', '0.038505', '0.060729', '0.041801', '0.046707', '0.046512', '0.041866', '0.063452', '0.047493', '0.043182']
         : correct/total = [(41, 913), (48, 824), (56, 868), (47, 802), (49, 850), (31, 776), (42, 844), (31, 924), (43, 837), (38, 847), (34, 711), (44, 776), (56, 872), (31, 774), (47, 814), (29, 835), (44, 818), (55, 836), (22, 778), (46, 822), (43, 787), (42, 762), (56, 818), (46, 909), (43, 881), (31, 866), (42, 845), (35, 879), (47, 785), (48, 929), (45, 880), (47, 873), (38, 918), (41, 869), (46, 827), (46, 755), (35, 811), (46, 900), (52, 921), (47, 849), (49, 874), (41, 883), (34, 796), (40, 909), (48, 813), (41, 936), (44, 828), (44, 790), (39, 896), (33, 863), (44, 849), (46, 843), (44, 791), (53, 829), (43, 799), (42, 816), (46, 823), (39, 843), (49, 875), (48, 830), (41, 754), (48, 813), (44, 787), (49, 869), (41, 757), (47, 799), (47, 814), (47, 934), (45, 831), (46, 809), (39, 849), (40, 818), (45, 771), (31, 792), (29, 777), (40, 806), (39, 865), (35, 816), (47, 752), (52, 747), (36, 800), (41, 921), (47, 812), (46, 844), (33, 790), (47, 910), (51, 862), (41, 822), (40, 842), (50, 829), (34, 854), (34, 883), (45, 741), (39, 933), (39, 835), (38, 817), (35, 836), (50, 788), (36, 758), (38, 880)]
         : compromised: 0.0497, honest: 0.0525
         : coarse stats = ['Node 0: acc_rate=0.038', 'Node 1: acc_rate=0.135', 'Node 2: acc_rate=0.156']...

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 100, Graph: k-regular, Aggregation: coarse
Attack: directed_deviation, 50.0% compromised
Final accuracy - Compromised: 0.0497, Honest: 0.0525
Overall test accuracy: mean=0.0511 ± 0.0082

=== COARSE SUMMARY ===
Node 0: acceptance=0.038
Node 1: acceptance=0.135
Node 2: acceptance=0.156
Node 3: acceptance=0.167
Node 4: acceptance=0.108
Node 5: acceptance=0.128
Node 6: acceptance=0.125
Node 7: acceptance=0.139
Node 8: acceptance=0.090
Node 9: acceptance=0.094
Node 10: acceptance=0.128
Node 11: acceptance=0.156
Node 12: acceptance=0.139
Node 13: acceptance=0.146
Node 14: acceptance=0.122
Node 15: acceptance=0.021
Node 16: acceptance=0.111
Node 17: acceptance=0.073
Node 18: acceptance=0.115
Node 19: acceptance=0.059
Node 20: acceptance=0.149
Node 21: acceptance=0.052
Node 22: acceptance=0.142
Node 23: acceptance=0.142
Node 24: acceptance=0.108
Node 25: acceptance=0.083
Node 26: acceptance=0.125
Node 27: acceptance=0.076
Node 28: acceptance=0.149
Node 29: acceptance=0.135
Node 30: acceptance=0.135
Node 31: acceptance=0.122
Node 32: acceptance=0.149
Node 33: acceptance=0.083
Node 34: acceptance=0.146
Node 35: acceptance=0.142
Node 36: acceptance=0.115
Node 37: acceptance=0.115
Node 38: acceptance=0.083
Node 39: acceptance=0.118
Node 40: acceptance=0.135
Node 41: acceptance=0.139
Node 42: acceptance=0.076
Node 43: acceptance=0.132
Node 44: acceptance=0.135
Node 45: acceptance=0.139
Node 46: acceptance=0.087
Node 47: acceptance=0.062
Node 48: acceptance=0.149
Node 49: acceptance=0.101
Node 50: acceptance=0.135
Node 51: acceptance=0.080
Node 52: acceptance=0.149
Node 53: acceptance=0.059
Node 54: acceptance=0.139
Node 55: acceptance=0.132
Node 56: acceptance=0.163
Node 57: acceptance=0.052
Node 58: acceptance=0.115
Node 59: acceptance=0.111
Node 60: acceptance=0.115
Node 61: acceptance=0.153
Node 62: acceptance=0.104
Node 63: acceptance=0.122
Node 64: acceptance=0.153
Node 65: acceptance=0.132
Node 66: acceptance=0.122
Node 67: acceptance=0.142
Node 68: acceptance=0.142
Node 69: acceptance=0.142
Node 70: acceptance=0.111
Node 71: acceptance=0.104
Node 72: acceptance=0.049
Node 73: acceptance=0.115
Node 74: acceptance=0.076
Node 75: acceptance=0.115
Node 76: acceptance=0.097
Node 77: acceptance=0.149
Node 78: acceptance=0.153
Node 79: acceptance=0.097
Node 80: acceptance=0.149
Node 81: acceptance=0.104
Node 82: acceptance=0.135
Node 83: acceptance=0.111
Node 84: acceptance=0.076
Node 85: acceptance=0.083
Node 86: acceptance=0.149
Node 87: acceptance=0.104
Node 88: acceptance=0.111
Node 89: acceptance=0.090
Node 90: acceptance=0.038
Node 91: acceptance=0.135
Node 92: acceptance=0.128
Node 93: acceptance=0.049
Node 94: acceptance=0.160
Node 95: acceptance=0.087
Node 96: acceptance=0.153
Node 97: acceptance=0.163
Node 98: acceptance=0.104
Node 99: acceptance=0.056

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Sketch transfer: 0.000s (0.0%)
    - Model fetch (accepted): 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Sketching: 0.313s (95.8%)
    - Filtering: 0.003s (0.8%)
    - Aggregation: 0.011s (3.4%)
  TOTALS:
    - Total computation: 0.327s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.327s

=== PER-NODE AVERAGE TIME ===
  - Sketching: 0.223s
  - Filtering: 0.001s
  - Aggregation: 0.007s
  - Sketch transfer: 0.000s
  - Model fetch: 0.000s
  - Total per node: 0.232s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total sketching: 22.342s
  - Total filtering: 0.145s
  - Total aggregation: 0.712s
  - Total sketch transfer: 0.000s
  - Total model fetch: 0.000s
  - Grand total: 23.198s
  - Mean acceptance rate: 0.115

COARSE Algorithm Properties:
  - Original dimension: 6,603,710
  - Sketch size: 1000
  - Compression ratio: 98.5x
  - Single repetition: No repetitions needed
  - Theoretical complexity: O(d + N×k)
  - Approach: Sketch filtering + state aggregation