Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: gaussian, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.5038 ± 0.0333 | min=0.4520 max=0.5584
         : test loss mean=3.7402 ± 0.0231
         : individual accs = ['0.558382', '0.505591', '0.527812', '0.506347', '0.458323', '0.546769', '0.494157', '0.493447', '0.539728', '0.467150', '0.476466', '0.530169', '0.472270', '0.463188', '0.520237', '0.542070', '0.465928', '0.546737', '0.509060', '0.452035']
         : correct/total = [(2305, 4128), (2125, 4203), (2154, 4081), (2194, 4333), (1875, 4091), (2344, 4287), (2072, 4193), (2146, 4349), (2262, 4191), (1998, 4277), (1974, 4143), (2223, 4193), (1933, 4093), (1944, 4197), (2108, 4052), (2184, 4029), (1935, 4153), (2287, 4183), (2079, 4084), (1866, 4128)]
         : compromised: 0.5050, honest: 0.5037
Round 002: test acc mean=0.6813 ± 0.0189 | min=0.6299 max=0.7084
         : test loss mean=3.4446 ± 0.0328
         : individual accs = ['0.677568', '0.679753', '0.670424', '0.697207', '0.677341', '0.700490', '0.629859', '0.690734', '0.669769', '0.708440', '0.688631', '0.694014', '0.691424', '0.670717', '0.704097', '0.692728', '0.650132', '0.665073', '0.698825', '0.669089']
         : correct/total = [(2797, 4128), (2857, 4203), (2736, 4081), (3021, 4333), (2771, 4091), (3003, 4287), (2641, 4193), (3004, 4349), (2807, 4191), (3030, 4277), (2853, 4143), (2910, 4193), (2830, 4093), (2815, 4197), (2853, 4052), (2791, 4029), (2700, 4153), (2782, 4183), (2854, 4084), (2762, 4128)]
         : compromised: 0.6856, honest: 0.6808
Round 003: test acc mean=0.7050 ± 0.0234 | min=0.6314 max=0.7335
         : test loss mean=3.1998 ± 0.0619
         : individual accs = ['0.733527', '0.701642', '0.691742', '0.723286', '0.692740', '0.631444', '0.709754', '0.724074', '0.726318', '0.676175', '0.702390', '0.731457', '0.732226', '0.696926', '0.727542', '0.708861', '0.687696', '0.701650', '0.696866', '0.704215']
         : correct/total = [(3028, 4128), (2949, 4203), (2823, 4081), (3134, 4333), (2834, 4091), (2707, 4287), (2976, 4193), (3149, 4349), (3044, 4191), (2892, 4277), (2910, 4143), (3067, 4193), (2997, 4093), (2925, 4197), (2948, 4052), (2856, 4029), (2856, 4153), (2935, 4183), (2846, 4084), (2907, 4128)]
         : compromised: 0.6642, honest: 0.7096
Round 004: test acc mean=0.6941 ± 0.0254 | min=0.6480 max=0.7268
         : test loss mean=2.7672 ± 0.0924
         : individual accs = ['0.698886', '0.724720', '0.655967', '0.698823', '0.717184', '0.648006', '0.720248', '0.710738', '0.723216', '0.670330', '0.653391', '0.707131', '0.654043', '0.701930', '0.726802', '0.713080', '0.705755', '0.677504', '0.692948', '0.682171']
         : correct/total = [(2885, 4128), (3046, 4203), (2677, 4081), (3028, 4333), (2934, 4091), (2778, 4287), (3020, 4193), (3091, 4349), (3031, 4191), (2867, 4277), (2707, 4143), (2965, 4193), (2677, 4093), (2946, 4197), (2945, 4052), (2873, 4029), (2931, 4153), (2834, 4183), (2830, 4084), (2816, 4128)]
         : compromised: 0.6750, honest: 0.6963
Round 005: test acc mean=0.6504 ± 0.0357 | min=0.5727 max=0.7037
         : test loss mean=2.1632 ± 0.1179
         : individual accs = ['0.681928', '0.648822', '0.572654', '0.616663', '0.687118', '0.592722', '0.675888', '0.681996', '0.672155', '0.673603', '0.640357', '0.667780', '0.648668', '0.600191', '0.657206', '0.631174', '0.695882', '0.609132', '0.703722', '0.649952']
         : correct/total = [(2815, 4128), (2727, 4203), (2337, 4081), (2672, 4333), (2811, 4091), (2541, 4287), (2834, 4193), (2966, 4349), (2817, 4191), (2881, 4277), (2653, 4143), (2800, 4193), (2655, 4093), (2519, 4197), (2663, 4052), (2543, 4029), (2890, 4153), (2548, 4183), (2874, 4084), (2683, 4128)]
         : compromised: 0.5965, honest: 0.6564
Round 006: test acc mean=0.7041 ± 0.0224 | min=0.6324 max=0.7307
         : test loss mean=1.4036 ± 0.0902
         : individual accs = ['0.670300', '0.706400', '0.699828', '0.691669', '0.730384', '0.632377', '0.724541', '0.721775', '0.691482', '0.702361', '0.721941', '0.724302', '0.701197', '0.702645', '0.722359', '0.699429', '0.713460', '0.695912', '0.730656', '0.699370']
         : correct/total = [(2767, 4128), (2969, 4203), (2856, 4081), (2997, 4333), (2988, 4091), (2711, 4287), (3038, 4193), (3139, 4349), (2898, 4191), (3004, 4277), (2991, 4143), (3037, 4193), (2870, 4093), (2949, 4197), (2927, 4052), (2818, 4029), (2963, 4153), (2911, 4183), (2984, 4084), (2887, 4128)]
         : compromised: 0.6675, honest: 0.7082
Round 007: test acc mean=0.7846 ± 0.0088 | min=0.7672 max=0.8001
         : test loss mean=0.8274 ± 0.0432
         : individual accs = ['0.780766', '0.789912', '0.767214', '0.782599', '0.778294', '0.780033', '0.800143', '0.795585', '0.788595', '0.790741', '0.783490', '0.780587', '0.773027', '0.778651', '0.797384', '0.779102', '0.788827', '0.781736', '0.799461', '0.775678']
         : correct/total = [(3223, 4128), (3320, 4203), (3131, 4081), (3391, 4333), (3184, 4091), (3344, 4287), (3355, 4193), (3460, 4349), (3305, 4191), (3382, 4277), (3246, 4143), (3273, 4193), (3164, 4093), (3268, 4197), (3231, 4052), (3139, 4029), (3276, 4153), (3270, 4183), (3265, 4084), (3202, 4128)]
         : compromised: 0.7793, honest: 0.7852
Round 008: test acc mean=0.8170 ± 0.0070 | min=0.7977 max=0.8245
         : test loss mean=0.5928 ± 0.0226
         : individual accs = ['0.808382', '0.823697', '0.814261', '0.822986', '0.805182', '0.822253', '0.820653', '0.818349', '0.823670', '0.820903', '0.809076', '0.821846', '0.815294', '0.817727', '0.824531', '0.822537', '0.815555', '0.815922', '0.820274', '0.797723']
         : correct/total = [(3337, 4128), (3462, 4203), (3323, 4081), (3566, 4333), (3294, 4091), (3525, 4287), (3441, 4193), (3559, 4349), (3452, 4191), (3511, 4277), (3352, 4143), (3446, 4193), (3337, 4093), (3432, 4197), (3341, 4052), (3314, 4029), (3387, 4153), (3413, 4183), (3350, 4084), (3293, 4128)]
         : compromised: 0.8200, honest: 0.8167
Round 009: test acc mean=0.8324 ± 0.0055 | min=0.8227 max=0.8463
         : test loss mean=0.5228 ± 0.0188
         : individual accs = ['0.822674', '0.833928', '0.830434', '0.838449', '0.827182', '0.832517', '0.837586', '0.835135', '0.846337', '0.838672', '0.827661', '0.828762', '0.830198', '0.832738', '0.837364', '0.834947', '0.830725', '0.829070', '0.831048', '0.822674']
         : correct/total = [(3396, 4128), (3505, 4203), (3389, 4081), (3633, 4333), (3384, 4091), (3569, 4287), (3512, 4193), (3632, 4349), (3547, 4191), (3587, 4277), (3429, 4143), (3475, 4193), (3398, 4093), (3495, 4197), (3393, 4052), (3364, 4029), (3450, 4153), (3468, 4183), (3394, 4084), (3396, 4128)]
         : compromised: 0.8326, honest: 0.8324
Round 010: test acc mean=0.8408 ± 0.0056 | min=0.8310 max=0.8481
         : test loss mean=0.4915 ± 0.0194
         : individual accs = ['0.833333', '0.844873', '0.835580', '0.843526', '0.832315', '0.837649', '0.844741', '0.845252', '0.847530', '0.844751', '0.831040', '0.832340', '0.842658', '0.842507', '0.845015', '0.848101', '0.843487', '0.847239', '0.840353', '0.834060']
         : correct/total = [(3440, 4128), (3551, 4203), (3410, 4081), (3655, 4333), (3405, 4091), (3591, 4287), (3542, 4193), (3676, 4349), (3552, 4191), (3613, 4277), (3443, 4143), (3490, 4193), (3449, 4093), (3536, 4197), (3424, 4052), (3417, 4029), (3503, 4153), (3544, 4183), (3432, 4084), (3443, 4128)]
         : compromised: 0.8401, honest: 0.8409

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: balance
Attack: gaussian, 10.0% compromised
Final accuracy - Compromised: 0.8401, Honest: 0.8409
Overall test accuracy: mean=0.8408 ± 0.0056

=== BALANCE SUMMARY ===
Node 0: acceptance=0.895
Node 1: acceptance=0.895
Node 2: acceptance=0.895
Node 3: acceptance=0.895
Node 4: acceptance=0.895
Node 5: acceptance=0.947
Node 6: acceptance=0.895
Node 7: acceptance=0.895
Node 8: acceptance=0.895
Node 9: acceptance=0.895
Node 10: acceptance=0.895
Node 11: acceptance=0.895
Node 12: acceptance=0.895
Node 13: acceptance=0.947
Node 14: acceptance=0.895
Node 15: acceptance=0.895
Node 16: acceptance=0.895
Node 17: acceptance=0.895
Node 18: acceptance=0.895
Node 19: acceptance=0.895

Performance Summary:
  - Distance computation time: 1.695s (44.4%)
  - Filtering time: 1.799s (47.1%)
  - Aggregation time: 0.325s (8.5%)
  - Total time: 3.819s
  - Mean acceptance rate: 0.900

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
