Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4722 ± 0.1923 | min=0.0055 max=0.5860
         : test loss mean=21643.8729 ± 90338.9127
         : individual accs = ['0.562016', '0.564121', '0.531977', '0.555504', '0.553899', '0.015629', '0.534701', '0.556450', '0.586018', '0.540566', '0.026551', '0.563081', '0.553872', '0.524422', '0.566140', '0.554480', '0.525644', '0.005498', '0.573213', '0.550145']
         : correct/total = [(2320, 4128), (2371, 4203), (2171, 4081), (2407, 4333), (2266, 4091), (67, 4287), (2242, 4193), (2420, 4349), (2456, 4191), (2312, 4277), (110, 4143), (2361, 4193), (2267, 4093), (2201, 4197), (2294, 4052), (2234, 4029), (2183, 4153), (23, 4183), (2341, 4084), (2271, 4128)]
         : compromised: 0.4207, honest: 0.5065
Round 002: test acc mean=0.5898 ± 0.2679 | min=0.0519 max=0.7491
         : test loss mean=1287155843647676075737088.0000 ± 3861895854789872270180352.0000
         : individual accs = ['0.710271', '0.718059', '0.715266', '0.723748', '0.711806', '0.052018', '0.749106', '0.734882', '0.736578', '0.714987', '0.051895', '0.054853', '0.726851', '0.724565', '0.717177', '0.720526', '0.722369', '0.057853', '0.720127', '0.732074']
         : correct/total = [(2932, 4128), (3018, 4203), (2919, 4081), (3136, 4333), (2912, 4091), (223, 4287), (3141, 4193), (3196, 4349), (3087, 4191), (3058, 4277), (215, 4143), (230, 4193), (2975, 4093), (3041, 4197), (2906, 4052), (2903, 4029), (3000, 4153), (242, 4183), (2941, 4084), (3022, 4128)]
         : compromised: 0.4714, honest: 0.6686
Round 003: test acc mean=0.6329 ± 0.2899 | min=0.0498 max=0.7908
         : test loss mean=490249090897752722621910220800.0000 ± 1470977600421178118875006369792.0000
         : individual accs = ['0.769380', '0.787771', '0.770644', '0.767136', '0.771694', '0.052951', '0.786072', '0.787767', '0.780005', '0.775076', '0.051895', '0.049845', '0.776936', '0.777222', '0.777641', '0.790767', '0.772935', '0.057853', '0.781587', '0.772287']
         : correct/total = [(3176, 4128), (3311, 4203), (3145, 4081), (3324, 4333), (3157, 4091), (227, 4287), (3296, 4193), (3426, 4349), (3269, 4191), (3315, 4277), (215, 4143), (209, 4193), (3180, 4093), (3262, 4197), (3151, 4052), (3186, 4029), (3210, 4153), (242, 4183), (3192, 4084), (3188, 4128)]
         : compromised: 0.5077, honest: 0.7163
Round 004: test acc mean=0.6135 ± 0.3259 | min=0.0474 max=0.8145
         : test loss mean=nan ± nan
         : individual accs = ['0.790213', '0.808946', '0.783141', '0.802446', '0.784894', '0.052484', '0.814453', '0.812141', '0.802195', '0.802899', '0.048033', '0.048891', '0.047398', '0.801763', '0.800099', '0.809134', '0.798459', '0.049247', '0.807786', '0.804990']
         : correct/total = [(3262, 4128), (3400, 4203), (3196, 4081), (3477, 4333), (3211, 4091), (225, 4287), (3415, 4193), (3532, 4349), (3362, 4191), (3434, 4277), (199, 4143), (205, 4193), (194, 4093), (3365, 4197), (3242, 4052), (3260, 4029), (3316, 4153), (206, 4183), (3299, 4084), (3323, 4128)]
         : compromised: 0.4271, honest: 0.7377
Round 005: test acc mean=0.6237 ± 0.3317 | min=0.0474 max=0.8284
         : test loss mean=nan ± nan
         : individual accs = ['0.811289', '0.823222', '0.819162', '0.811216', '0.804204', '0.052484', '0.807775', '0.822258', '0.828442', '0.818331', '0.048033', '0.048891', '0.047398', '0.817012', '0.806515', '0.814842', '0.804719', '0.049247', '0.823947', '0.814438']
         : correct/total = [(3349, 4128), (3460, 4203), (3343, 4081), (3515, 4333), (3290, 4091), (225, 4287), (3387, 4193), (3576, 4349), (3472, 4191), (3500, 4277), (199, 4143), (205, 4193), (194, 4093), (3429, 4197), (3268, 4052), (3283, 4029), (3342, 4153), (206, 4183), (3365, 4084), (3362, 4128)]
         : compromised: 0.4336, honest: 0.7504
Round 006: test acc mean=0.6278 ± 0.3342 | min=0.0474 max=0.8343
         : test loss mean=nan ± nan
         : individual accs = ['0.815649', '0.808470', '0.831169', '0.822525', '0.819115', '0.052484', '0.816838', '0.822718', '0.833691', '0.816694', '0.048033', '0.048891', '0.047398', '0.831308', '0.827246', '0.821296', '0.834337', '0.049247', '0.800930', '0.808382']
         : correct/total = [(3367, 4128), (3398, 4203), (3392, 4081), (3564, 4333), (3351, 4091), (225, 4287), (3425, 4193), (3578, 4349), (3494, 4191), (3493, 4277), (199, 4143), (205, 4193), (194, 4093), (3489, 4197), (3352, 4052), (3309, 4029), (3465, 4153), (206, 4183), (3271, 4084), (3337, 4128)]
         : compromised: 0.4332, honest: 0.7575
Round 007: test acc mean=0.6334 ± 0.3373 | min=0.0474 max=0.8368
         : test loss mean=nan ± nan
         : individual accs = ['0.826308', '0.826315', '0.829944', '0.826448', '0.820582', '0.052484', '0.824708', '0.833065', '0.836793', '0.828852', '0.048033', '0.048891', '0.047398', '0.828449', '0.827986', '0.834202', '0.827835', '0.049247', '0.827130', '0.822674']
         : correct/total = [(3411, 4128), (3473, 4203), (3387, 4081), (3581, 4333), (3357, 4091), (225, 4287), (3458, 4193), (3623, 4349), (3507, 4191), (3545, 4277), (199, 4143), (205, 4193), (194, 4093), (3477, 4197), (3355, 4052), (3361, 4029), (3438, 4153), (206, 4183), (3378, 4084), (3396, 4128)]
         : compromised: 0.4385, honest: 0.7633
Round 008: test acc mean=0.6346 ± 0.3380 | min=0.0474 max=0.8413
         : test loss mean=nan ± nan
         : individual accs = ['0.825824', '0.824887', '0.825533', '0.832679', '0.823271', '0.052484', '0.833532', '0.833065', '0.841327', '0.837737', '0.048033', '0.048891', '0.047398', '0.837503', '0.832922', '0.831472', '0.834096', '0.049247', '0.827130', '0.804748']
         : correct/total = [(3409, 4128), (3467, 4203), (3369, 4081), (3608, 4333), (3368, 4091), (225, 4287), (3495, 4193), (3623, 4349), (3526, 4191), (3583, 4277), (199, 4143), (205, 4193), (194, 4093), (3515, 4197), (3375, 4052), (3350, 4029), (3464, 4153), (206, 4183), (3378, 4084), (3322, 4128)]
         : compromised: 0.4401, honest: 0.7643
Round 009: test acc mean=0.6374 ± 0.3396 | min=0.0474 max=0.8412
         : test loss mean=nan ± nan
         : individual accs = ['0.825581', '0.839400', '0.836315', '0.834295', '0.824248', '0.052484', '0.829955', '0.841113', '0.841088', '0.841244', '0.048033', '0.048891', '0.047398', '0.837503', '0.826999', '0.827997', '0.834577', '0.049247', '0.833007', '0.828004']
         : correct/total = [(3408, 4128), (3528, 4203), (3413, 4081), (3615, 4333), (3372, 4091), (225, 4287), (3480, 4193), (3658, 4349), (3525, 4191), (3598, 4277), (199, 4143), (205, 4193), (194, 4093), (3515, 4197), (3351, 4052), (3336, 4029), (3466, 4153), (206, 4183), (3402, 4084), (3418, 4128)]
         : compromised: 0.4419, honest: 0.7677
Round 010: test acc mean=0.6404 ± 0.3414 | min=0.0474 max=0.8473
         : test loss mean=nan ± nan
         : individual accs = ['0.835756', '0.847252', '0.829454', '0.833603', '0.834515', '0.052484', '0.846411', '0.830076', '0.839179', '0.837035', '0.048033', '0.048891', '0.047398', '0.842030', '0.840326', '0.840655', '0.842523', '0.049247', '0.836435', '0.826550']
         : correct/total = [(3450, 4128), (3561, 4203), (3385, 4081), (3612, 4333), (3414, 4091), (225, 4287), (3549, 4193), (3610, 4349), (3517, 4191), (3580, 4277), (199, 4143), (205, 4193), (194, 4093), (3534, 4197), (3405, 4052), (3387, 4029), (3499, 4153), (206, 4183), (3416, 4084), (3412, 4128)]
         : compromised: 0.4455, honest: 0.7703

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 40.0% compromised
Final accuracy - Compromised: 0.4455, Honest: 0.7703
Overall test accuracy: mean=0.6404 ± 0.3414
