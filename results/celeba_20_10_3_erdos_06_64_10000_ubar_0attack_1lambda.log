Device: cuda
Seed: 987654321
Looking for images in: /home/student.unimelb.edu.au/mrangwala/Trust-Monitor/leaf/data/celeba/data/raw/img_align_celeba
Loading 1 LEAF CelebA train files...
LEAF CelebA train: 9343 users (celebrities), 177457 samples
Looking for images in: /home/student.unimelb.edu.au/mrangwala/Trust-Monitor/leaf/data/celeba/data/raw/img_align_celeba
Loading 1 LEAF CelebA test files...
LEAF CelebA test: 9343 users (celebrities), 22831 samples
Found 9343 train users, 9343 test users, 9343 common users
User sample counts range: 31 (max) to 4 (min)
Distributed ALL 9343 users across 20 clients
Users per client: 467 (with 3 clients getting +1 user)
Train partition sizes: [8843, 8998, 8728, 9034, 8866, 8946, 8873, 8776, 8816, 8801, 8913, 8656, 9115, 8921, 8699, 8823, 8912, 8766, 9102, 8869]
Test partition sizes: [1140, 1158, 1127, 1158, 1134, 1145, 1145, 1127, 1136, 1128, 1144, 1125, 1152, 1160, 1124, 1145, 1154, 1131, 1157, 1141]
  Client 0: 8843 train samples, 2 unique classes
  Client 1: 8998 train samples, 2 unique classes
  Client 2: 8728 train samples, 2 unique classes
  Client 3: 9034 train samples, 2 unique classes
  Client 4: 8866 train samples, 2 unique classes
  Client 5: 8946 train samples, 2 unique classes
  Client 6: 8873 train samples, 2 unique classes
  Client 7: 8776 train samples, 2 unique classes
  Client 8: 8816 train samples, 2 unique classes
  Client 9: 8801 train samples, 2 unique classes
  Client 10: 8913 train samples, 2 unique classes
  Client 11: 8656 train samples, 2 unique classes
  Client 12: 9115 train samples, 2 unique classes
  Client 13: 8921 train samples, 2 unique classes
  Client 14: 8699 train samples, 2 unique classes
  Client 15: 8823 train samples, 2 unique classes
  Client 16: 8912 train samples, 2 unique classes
  Client 17: 8766 train samples, 2 unique classes
  Client 18: 9102 train samples, 2 unique classes
  Client 19: 8869 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Model variant: baseline
Model parameters: 2,219,692
UBAR ALGORITHM (Two-Stage Byzantine-resilient)
  - Model dimension: 2,219,692 parameters
  - Rho parameter: 1.0
  - Stage 1: Distance-based filtering (select 100% closest neighbors)
  - Stage 2: Performance-based selection (loss comparison)
  - Complexity: O(deg(i)×d + deg(i)×inference)
Initial test acc across nodes: mean=0.4978 ± 0.0208
Round 001: test acc mean=0.6544 ± 0.0507 | min=0.5469 max=0.7121
         : test loss mean=0.6770 ± 0.0057
         : individual accs = ['0.675439', '0.675302', '0.608696', '0.698618', '0.604056', '0.703057', '0.693450', '0.607808', '0.632042', '0.699468', '0.604021', '0.551111', '0.700521', '0.712069', '0.631673', '0.707424', '0.671577', '0.678161', '0.686258', '0.546889']
         : correct/total = [(770, 1140), (782, 1158), (686, 1127), (809, 1158), (685, 1134), (805, 1145), (794, 1145), (685, 1127), (718, 1136), (789, 1128), (691, 1144), (620, 1125), (807, 1152), (826, 1160), (710, 1124), (810, 1145), (775, 1154), (767, 1131), (794, 1157), (624, 1141)]
         : ubar stats = ['Node 0: s1=1.000, s2=0.125', 'Node 1: s1=1.000, s2=0.636', 'Node 2: s1=1.000, s2=0.083']...
Round 002: test acc mean=0.6772 ± 0.0680 | min=0.5231 max=0.7633
         : test loss mean=0.6477 ± 0.0419
         : individual accs = ['0.708772', '0.676166', '0.760426', '0.762522', '0.548501', '0.523144', '0.608734', '0.647737', '0.607394', '0.673759', '0.656469', '0.634667', '0.722222', '0.646552', '0.720641', '0.763319', '0.754766', '0.736516', '0.725151', '0.666082']
         : correct/total = [(808, 1140), (783, 1158), (857, 1127), (883, 1158), (622, 1134), (599, 1145), (697, 1145), (730, 1127), (690, 1136), (760, 1128), (751, 1144), (714, 1125), (832, 1152), (750, 1160), (810, 1124), (874, 1145), (871, 1154), (833, 1131), (839, 1157), (760, 1141)]
         : ubar stats = ['Node 0: s1=1.000, s2=0.156', 'Node 1: s1=1.000, s2=0.636', 'Node 2: s1=1.000, s2=0.083']...
Round 003: test acc mean=0.7076 ± 0.0854 | min=0.5266 max=0.8292
         : test loss mean=0.5848 ± 0.0917
         : individual accs = ['0.705263', '0.695164', '0.802130', '0.816062', '0.663139', '0.526638', '0.573799', '0.641526', '0.725352', '0.660461', '0.708042', '0.786667', '0.594618', '0.702586', '0.829181', '0.786026', '0.786828', '0.819629', '0.702679', '0.626643']
         : correct/total = [(804, 1140), (805, 1158), (904, 1127), (945, 1158), (752, 1134), (603, 1145), (657, 1145), (723, 1127), (824, 1136), (745, 1128), (810, 1144), (885, 1125), (685, 1152), (815, 1160), (932, 1124), (900, 1145), (908, 1154), (927, 1131), (813, 1157), (715, 1141)]
         : ubar stats = ['Node 0: s1=1.000, s2=0.167', 'Node 1: s1=1.000, s2=0.667', 'Node 2: s1=1.000, s2=0.083']...
Round 004: test acc mean=0.7813 ± 0.0628 | min=0.6459 max=0.8653
         : test loss mean=0.5011 ± 0.0893
         : individual accs = ['0.818421', '0.740933', '0.780834', '0.865285', '0.757496', '0.691703', '0.695197', '0.684117', '0.814261', '0.826241', '0.848776', '0.828444', '0.722222', '0.768966', '0.816726', '0.841921', '0.843154', '0.816976', '0.819360', '0.645925']
         : correct/total = [(933, 1140), (858, 1158), (880, 1127), (1002, 1158), (859, 1134), (792, 1145), (796, 1145), (771, 1127), (925, 1136), (932, 1128), (971, 1144), (932, 1125), (832, 1152), (892, 1160), (918, 1124), (964, 1145), (973, 1154), (924, 1131), (948, 1157), (737, 1141)]
         : ubar stats = ['Node 0: s1=1.000, s2=0.188', 'Node 1: s1=1.000, s2=0.705', 'Node 2: s1=1.000, s2=0.083']...
Round 005: test acc mean=0.8424 ± 0.0190 | min=0.8064 max=0.8774
         : test loss mean=0.3953 ± 0.0361
         : individual accs = ['0.858772', '0.857513', '0.830524', '0.877375', '0.825397', '0.816594', '0.852402', '0.835847', '0.829225', '0.819149', '0.868881', '0.868444', '0.806424', '0.850000', '0.846975', '0.848035', '0.837088', '0.857648', '0.819360', '0.841367']
         : correct/total = [(979, 1140), (993, 1158), (936, 1127), (1016, 1158), (936, 1134), (935, 1145), (976, 1145), (942, 1127), (942, 1136), (924, 1128), (994, 1144), (977, 1125), (929, 1152), (986, 1160), (952, 1124), (971, 1145), (966, 1154), (970, 1131), (948, 1157), (960, 1141)]
         : ubar stats = ['Node 0: s1=1.000, s2=0.237', 'Node 1: s1=1.000, s2=0.727', 'Node 2: s1=1.000, s2=0.117']...
Round 006: test acc mean=0.8667 ± 0.0103 | min=0.8489 max=0.8899
         : test loss mean=0.3274 ± 0.0163
         : individual accs = ['0.872807', '0.860104', '0.859805', '0.870466', '0.855379', '0.872489', '0.869869', '0.866016', '0.879401', '0.869681', '0.889860', '0.877333', '0.848958', '0.864655', '0.863879', '0.848908', '0.880416', '0.860301', '0.856525', '0.866784']
         : correct/total = [(995, 1140), (996, 1158), (969, 1127), (1008, 1158), (970, 1134), (999, 1145), (996, 1145), (976, 1127), (999, 1136), (981, 1128), (1018, 1144), (987, 1125), (978, 1152), (1003, 1160), (971, 1124), (972, 1145), (1016, 1154), (973, 1131), (991, 1157), (989, 1141)]
         : ubar stats = ['Node 0: s1=1.000, s2=0.229', 'Node 1: s1=1.000, s2=0.682', 'Node 2: s1=1.000, s2=0.153']...
Round 007: test acc mean=0.8734 ± 0.0111 | min=0.8524 max=0.8862
         : test loss mean=0.3044 ± 0.0165
         : individual accs = ['0.876316', '0.885147', '0.853594', '0.885147', '0.858907', '0.882969', '0.879476', '0.872227', '0.878521', '0.883865', '0.878497', '0.886222', '0.852431', '0.877586', '0.862100', '0.856769', '0.884749', '0.876216', '0.862576', '0.873795']
         : correct/total = [(999, 1140), (1025, 1158), (962, 1127), (1025, 1158), (974, 1134), (1011, 1145), (1007, 1145), (983, 1127), (998, 1136), (997, 1128), (1005, 1144), (997, 1125), (982, 1152), (1018, 1160), (969, 1124), (981, 1145), (1021, 1154), (991, 1131), (998, 1157), (997, 1141)]
         : ubar stats = ['Node 0: s1=1.000, s2=0.214', 'Node 1: s1=1.000, s2=0.675', 'Node 2: s1=1.000, s2=0.155']...
Round 008: test acc mean=0.8794 ± 0.0077 | min=0.8634 max=0.8915
         : test loss mean=0.2877 ± 0.0139
         : individual accs = ['0.880702', '0.885147', '0.863354', '0.879965', '0.877425', '0.890830', '0.882096', '0.876664', '0.870599', '0.881206', '0.888986', '0.884444', '0.876736', '0.889655', '0.891459', '0.866376', '0.879549', '0.877984', '0.868626', '0.875548']
         : correct/total = [(1004, 1140), (1025, 1158), (973, 1127), (1019, 1158), (995, 1134), (1020, 1145), (1010, 1145), (988, 1127), (989, 1136), (994, 1128), (1017, 1144), (995, 1125), (1010, 1152), (1032, 1160), (1002, 1124), (992, 1145), (1015, 1154), (993, 1131), (1005, 1157), (999, 1141)]
         : ubar stats = ['Node 0: s1=1.000, s2=0.195', 'Node 1: s1=1.000, s2=0.614', 'Node 2: s1=1.000, s2=0.219']...
Round 009: test acc mean=0.8853 ± 0.0124 | min=0.8539 max=0.9013
         : test loss mean=0.2771 ± 0.0171
         : individual accs = ['0.899123', '0.887737', '0.869565', '0.891192', '0.883598', '0.901310', '0.891703', '0.884650', '0.882923', '0.883865', '0.897727', '0.899556', '0.868924', '0.890517', '0.895018', '0.872489', '0.888215', '0.868258', '0.853933', '0.894829']
         : correct/total = [(1025, 1140), (1028, 1158), (980, 1127), (1032, 1158), (1002, 1134), (1032, 1145), (1021, 1145), (997, 1127), (1003, 1136), (997, 1128), (1027, 1144), (1012, 1125), (1001, 1152), (1033, 1160), (1006, 1124), (999, 1145), (1025, 1154), (982, 1131), (988, 1157), (1021, 1141)]
         : ubar stats = ['Node 0: s1=1.000, s2=0.181', 'Node 1: s1=1.000, s2=0.556', 'Node 2: s1=1.000, s2=0.213']...
Round 010: test acc mean=0.8927 ± 0.0075 | min=0.8777 max=0.9101
         : test loss mean=0.2649 ± 0.0140
         : individual accs = ['0.898246', '0.903282', '0.879326', '0.895509', '0.897707', '0.896943', '0.892576', '0.890861', '0.895246', '0.894504', '0.895979', '0.884444', '0.892361', '0.895690', '0.910142', '0.877729', '0.892548', '0.886826', '0.883319', '0.890447']
         : correct/total = [(1024, 1140), (1046, 1158), (991, 1127), (1037, 1158), (1018, 1134), (1027, 1145), (1022, 1145), (1004, 1127), (1017, 1136), (1009, 1128), (1025, 1144), (995, 1125), (1028, 1152), (1039, 1160), (1023, 1124), (1005, 1145), (1030, 1154), (1003, 1131), (1022, 1157), (1016, 1141)]
         : ubar stats = ['Node 0: s1=1.000, s2=0.169', 'Node 1: s1=1.000, s2=0.555', 'Node 2: s1=1.000, s2=0.250']...

=== FINAL RESULTS ===
Dataset: celeba, Nodes: 20, Graph: erdos, Aggregation: ubar
Overall test accuracy: mean=0.8927 ± 0.0075

=== UBAR SUMMARY ===
Node 0: stage1=1.000, stage2=0.169, overall=0.169
Node 1: stage1=1.000, stage2=0.555, overall=0.555
Node 2: stage1=1.000, stage2=0.250, overall=0.250
Node 3: stage1=1.000, stage2=0.225, overall=0.225
Node 4: stage1=1.000, stage2=0.609, overall=0.609
Node 5: stage1=1.000, stage2=0.687, overall=0.687
Node 6: stage1=1.000, stage2=0.421, overall=0.421
Node 7: stage1=1.000, stage2=0.543, overall=0.543
Node 8: stage1=1.000, stage2=0.310, overall=0.310
Node 9: stage1=1.000, stage2=0.338, overall=0.338
Node 10: stage1=1.000, stage2=0.256, overall=0.256
Node 11: stage1=1.000, stage2=0.164, overall=0.164
Node 12: stage1=1.000, stage2=0.525, overall=0.525
Node 13: stage1=1.000, stage2=0.685, overall=0.685
Node 14: stage1=1.000, stage2=0.220, overall=0.220
Node 15: stage1=1.000, stage2=0.173, overall=0.173
Node 16: stage1=1.000, stage2=0.331, overall=0.331
Node 17: stage1=1.000, stage2=0.167, overall=0.167
Node 18: stage1=1.000, stage2=0.525, overall=0.525
Node 19: stage1=1.000, stage2=0.531, overall=0.531

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Distance computation: 0.049s (17.7%)
    - Loss computation: 0.215s (78.0%)
    - Aggregation: 0.012s (4.2%)
  TOTALS:
    - Total computation: 0.276s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.276s

=== PER-NODE AVERAGE TIME ===
  - Distance computation: 0.030s
  - Loss computation: 0.165s
  - Aggregation: 0.007s
  - Model transfer: 0.000s
  - Total per node: 0.202s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total distance computation: 0.594s
  - Total loss computation: 3.304s
  - Total aggregation: 0.133s
  - Total model transfer: 0.000s
  - Grand total: 4.031s
  - Mean Stage 1 acceptance rate: 1.000
  - Mean Stage 2 acceptance rate: 0.384
  - Overall acceptance rate: 0.384

UBAR Algorithm Properties:
  - Model dimension: 2,219,692
  - Rho parameter: 1.0
  - Two-stage approach: Distance filtering + loss evaluation
  - Stage 1 selects: 100% of neighbors
  - Stage 2 uses: Training sample loss comparison
  - Theoretical complexity: O(deg(i)×d + deg(i)×inference)
  - Approach: UBAR paper implementation
