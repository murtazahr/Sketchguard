Device: cuda
Seed: 987654321
Looking for images in: /home/student.unimelb.edu.au/mrangwala/Trust-Monitor/leaf/data/celeba/data/raw/img_align_celeba
Loading 1 LEAF CelebA train files...
LEAF CelebA train: 9343 users (celebrities), 177457 samples
Looking for images in: /home/student.unimelb.edu.au/mrangwala/Trust-Monitor/leaf/data/celeba/data/raw/img_align_celeba
Loading 1 LEAF CelebA test files...
LEAF CelebA test: 9343 users (celebrities), 22831 samples
Found 9343 train users, 9343 test users, 9343 common users
User sample counts range: 31 (max) to 4 (min)
Distributed ALL 9343 users across 20 clients
Users per client: 467 (with 3 clients getting +1 user)
Train partition sizes: [8843, 8998, 8728, 9034, 8866, 8946, 8873, 8776, 8816, 8801, 8913, 8656, 9115, 8921, 8699, 8823, 8912, 8766, 9102, 8869]
Test partition sizes: [1140, 1158, 1127, 1158, 1134, 1145, 1145, 1127, 1136, 1128, 1144, 1125, 1152, 1160, 1124, 1145, 1154, 1131, 1157, 1141]
  Client 0: 8843 train samples, 2 unique classes
  Client 1: 8998 train samples, 2 unique classes
  Client 2: 8728 train samples, 2 unique classes
  Client 3: 9034 train samples, 2 unique classes
  Client 4: 8866 train samples, 2 unique classes
  Client 5: 8946 train samples, 2 unique classes
  Client 6: 8873 train samples, 2 unique classes
  Client 7: 8776 train samples, 2 unique classes
  Client 8: 8816 train samples, 2 unique classes
  Client 9: 8801 train samples, 2 unique classes
  Client 10: 8913 train samples, 2 unique classes
  Client 11: 8656 train samples, 2 unique classes
  Client 12: 9115 train samples, 2 unique classes
  Client 13: 8921 train samples, 2 unique classes
  Client 14: 8699 train samples, 2 unique classes
  Client 15: 8823 train samples, 2 unique classes
  Client 16: 8912 train samples, 2 unique classes
  Client 17: 8766 train samples, 2 unique classes
  Client 18: 9102 train samples, 2 unique classes
  Client 19: 8869 train samples, 2 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: gaussian, lambda: 1.0
Initial test acc across nodes: mean=0.4969 ± 0.0214
Round 001: test acc mean=0.5164 ± 0.0150 | min=0.4911 max=0.5625
         : test loss mean=nan ± nan
         : individual accs = ['0.528947', '0.508636', '0.493345', '0.528497', '0.522046', '0.514410', '0.521397', '0.503993', '0.562500', '0.491135', '0.525350', '0.498667', '0.522569', '0.506897', '0.517794', '0.517031', '0.515598', '0.508400', '0.522040', '0.517967']
         : correct/total = [(603, 1140), (589, 1158), (556, 1127), (612, 1158), (592, 1134), (589, 1145), (597, 1145), (568, 1127), (639, 1136), (554, 1128), (601, 1144), (561, 1125), (602, 1152), (588, 1160), (582, 1124), (592, 1145), (595, 1154), (575, 1131), (604, 1157), (591, 1141)]
         : compromised: 0.5131, honest: 0.5172
Round 002: test acc mean=0.4962 ± 0.0214 | min=0.4375 max=0.5420
         : test loss mean=68.4607 ± 62.1101
         : individual accs = ['0.528947', '0.491364', '0.511979', '0.477547', '0.497354', '0.510044', '0.481223', '0.503106', '0.437500', '0.491135', '0.479021', '0.501333', '0.494792', '0.482759', '0.517794', '0.484716', '0.504333', '0.541998', '0.505618', '0.482033']
         : correct/total = [(603, 1140), (569, 1158), (577, 1127), (553, 1158), (564, 1134), (584, 1145), (551, 1145), (567, 1127), (497, 1136), (554, 1128), (548, 1144), (564, 1125), (570, 1152), (560, 1160), (582, 1124), (555, 1145), (582, 1154), (613, 1131), (585, 1157), (550, 1141)]
         : compromised: 0.5074, honest: 0.4934
Round 003: test acc mean=0.5041 ± 0.0251 | min=0.4463 max=0.5616
         : test loss mean=56.2004 ± 42.2886
         : individual accs = ['0.471053', '0.508636', '0.468500', '0.512090', '0.525573', '0.525764', '0.486463', '0.446318', '0.561620', '0.491135', '0.526224', '0.501333', '0.477431', '0.506897', '0.508007', '0.517031', '0.514731', '0.495137', '0.513397', '0.524102']
         : correct/total = [(537, 1140), (589, 1158), (528, 1127), (593, 1158), (596, 1134), (602, 1145), (557, 1145), (503, 1127), (638, 1136), (554, 1128), (602, 1144), (564, 1125), (550, 1152), (588, 1160), (571, 1124), (592, 1145), (594, 1154), (560, 1131), (594, 1157), (598, 1141)]
         : compromised: 0.5013, honest: 0.5048
Round 004: test acc mean=0.5049 ± 0.0225 | min=0.4632 max=0.5625
         : test loss mean=70.7450 ± 45.0710
         : individual accs = ['0.463158', '0.481865', '0.493345', '0.471503', '0.514109', '0.512664', '0.508297', '0.492458', '0.562500', '0.492021', '0.509615', '0.497778', '0.522569', '0.508621', '0.517794', '0.517031', '0.484402', '0.541114', '0.517718', '0.489921']
         : correct/total = [(528, 1140), (558, 1158), (556, 1127), (546, 1158), (583, 1134), (587, 1145), (582, 1145), (555, 1127), (639, 1136), (555, 1128), (583, 1144), (560, 1125), (602, 1152), (590, 1160), (582, 1124), (592, 1145), (559, 1154), (612, 1131), (599, 1157), (559, 1141)]
         : compromised: 0.5212, honest: 0.5008
Round 005: test acc mean=0.4972 ± 0.0220 | min=0.4357 max=0.5337
         : test loss mean=102.5839 ± 78.4805
         : individual accs = ['0.491228', '0.491364', '0.506655', '0.528497', '0.477954', '0.514410', '0.521397', '0.499556', '0.435739', '0.503546', '0.474650', '0.498667', '0.477431', '0.487931', '0.520463', '0.501310', '0.484402', '0.511936', '0.483146', '0.533742']
         : correct/total = [(560, 1140), (569, 1158), (571, 1127), (612, 1158), (542, 1134), (589, 1145), (597, 1145), (563, 1127), (495, 1136), (568, 1128), (543, 1144), (561, 1125), (550, 1152), (566, 1160), (585, 1124), (574, 1145), (559, 1154), (579, 1131), (559, 1157), (609, 1141)]
         : compromised: 0.4979, honest: 0.4970
Round 006: test acc mean=0.5052 ± 0.0221 | min=0.4702 max=0.5616
         : test loss mean=70.5618 ± 51.0711
         : individual accs = ['0.470175', '0.474957', '0.507542', '0.471503', '0.529982', '0.515284', '0.521397', '0.503993', '0.561620', '0.491135', '0.517483', '0.499556', '0.522569', '0.489655', '0.480427', '0.517031', '0.515598', '0.491600', '0.522904', '0.500438']
         : correct/total = [(536, 1140), (550, 1158), (572, 1127), (546, 1158), (601, 1134), (590, 1145), (597, 1145), (568, 1127), (638, 1136), (554, 1128), (592, 1144), (562, 1125), (602, 1152), (568, 1160), (540, 1124), (592, 1145), (595, 1154), (556, 1131), (605, 1157), (571, 1141)]
         : compromised: 0.5048, honest: 0.5054
Round 007: test acc mean=0.5104 ± 0.0224 | min=0.4741 max=0.5625
         : test loss mean=61.3032 ± 53.6809
         : individual accs = ['0.512281', '0.517271', '0.491571', '0.474093', '0.485009', '0.510917', '0.496070', '0.501331', '0.562500', '0.491135', '0.535839', '0.517333', '0.511285', '0.556034', '0.517794', '0.482096', '0.510399', '0.508400', '0.530683', '0.496056']
         : correct/total = [(584, 1140), (599, 1158), (554, 1127), (549, 1158), (550, 1134), (585, 1145), (568, 1145), (565, 1127), (639, 1136), (554, 1128), (613, 1144), (582, 1125), (589, 1152), (645, 1160), (582, 1124), (552, 1145), (589, 1154), (575, 1131), (614, 1157), (566, 1141)]
         : compromised: 0.5217, honest: 0.5076
Round 008: test acc mean=0.5030 ± 0.0267 | min=0.4275 max=0.5563
         : test loss mean=63.4187 ± 59.1754
         : individual accs = ['0.496491', '0.427461', '0.496894', '0.516408', '0.522046', '0.485590', '0.474236', '0.502218', '0.556338', '0.508865', '0.525350', '0.464000', '0.493924', '0.506897', '0.516014', '0.533624', '0.515598', '0.498674', '0.523768', '0.496056']
         : correct/total = [(566, 1140), (495, 1158), (560, 1127), (598, 1158), (592, 1134), (556, 1145), (543, 1145), (566, 1127), (632, 1136), (574, 1128), (601, 1144), (522, 1125), (569, 1152), (588, 1160), (580, 1124), (611, 1145), (595, 1154), (564, 1131), (606, 1157), (566, 1141)]
         : compromised: 0.4963, honest: 0.5047
Round 009: test acc mean=0.5057 ± 0.0258 | min=0.4376 max=0.5625
         : test loss mean=51.7507 ± 47.1082
         : individual accs = ['0.494737', '0.491364', '0.524401', '0.481002', '0.522046', '0.496070', '0.437555', '0.527950', '0.562500', '0.491135', '0.476399', '0.533333', '0.482639', '0.506897', '0.527580', '0.499563', '0.513865', '0.508400', '0.518583', '0.517090']
         : correct/total = [(564, 1140), (569, 1158), (591, 1127), (557, 1158), (592, 1134), (568, 1145), (501, 1145), (595, 1127), (639, 1136), (554, 1128), (545, 1144), (600, 1125), (556, 1152), (588, 1160), (593, 1124), (572, 1145), (593, 1154), (575, 1131), (600, 1157), (590, 1141)]
         : compromised: 0.4985, honest: 0.5074
Round 010: test acc mean=0.5000 ± 0.0203 | min=0.4375 max=0.5253
         : test loss mean=80.8508 ± 53.7131
         : individual accs = ['0.514035', '0.506045', '0.506655', '0.471503', '0.522046', '0.501310', '0.517031', '0.494232', '0.437500', '0.495567', '0.525350', '0.501333', '0.515625', '0.506897', '0.495552', '0.517031', '0.485269', '0.489832', '0.477960', '0.518843']
         : correct/total = [(586, 1140), (586, 1158), (571, 1127), (546, 1158), (592, 1134), (574, 1145), (592, 1145), (557, 1127), (497, 1136), (559, 1128), (601, 1144), (564, 1125), (594, 1152), (588, 1160), (557, 1124), (592, 1145), (560, 1154), (554, 1131), (553, 1157), (592, 1141)]
         : compromised: 0.5034, honest: 0.4991

=== FINAL RESULTS ===
Dataset: celeba, Nodes: 20, Graph: fully, Aggregation: d-fedavg
Attack: gaussian, 20.0% compromised
Final accuracy - Compromised: 0.5034, Honest: 0.4991
Overall test accuracy: mean=0.5000 ± 0.0203
