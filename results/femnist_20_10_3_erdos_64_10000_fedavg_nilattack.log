(edgedrift) mrangwala@rs-l-ggsm9z:~/Trust-Monitor$ python decentralized_fl_sim.py --dataset femnist --num-nodes 20 --rounds 10 --local-epochs 3 --seed 987654321 --graph erdos --p 0.45 --batch-size 64 --lr 0.01 --max-samples 10000
Device: cpu
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch (resampled each round)
Graph: erdos, nodes: 20, edges: 99
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.0545 ± 0.0043 | min=0.0486 max=0.0623
         : test loss mean=4.1016 ± 0.0014
         : individual accs = ['0.049661', '0.052819', '0.061505', '0.049850', '0.052066', '0.052018', '0.053422', '0.052656', '0.057266', '0.048632', '0.051895', '0.054853', '0.062301', '0.049083', '0.055281', '0.061554', '0.050566', '0.057853', '0.060235', '0.057413']
         : correct/total = [(205, 4128), (222, 4203), (251, 4081), (216, 4333), (213, 4091), (223, 4287), (224, 4193), (229, 4349), (240, 4191), (208, 4277), (215, 4143), (230, 4193), (255, 4093), (206, 4197), (224, 4052), (248, 4029), (210, 4153), (242, 4183), (246, 4084), (237, 4128)]
Round 002: test acc mean=0.5199 ± 0.0139 | min=0.4982 max=0.5428
         : test loss mean=2.9273 ± 0.0796
         : individual accs = ['0.521802', '0.530573', '0.512374', '0.520194', '0.532633', '0.524376', '0.502504', '0.507243', '0.542830', '0.498246', '0.498190', '0.508705', '0.527975', '0.539909', '0.531343', '0.506577', '0.502288', '0.526895', '0.536729', '0.526163']
         : correct/total = [(2154, 4128), (2230, 4203), (2091, 4081), (2254, 4333), (2179, 4091), (2248, 4287), (2107, 4193), (2206, 4349), (2275, 4191), (2131, 4277), (2064, 4143), (2133, 4193), (2161, 4093), (2266, 4197), (2153, 4052), (2041, 4029), (2086, 4153), (2204, 4183), (2192, 4084), (2172, 4128)]
Round 003: test acc mean=0.7256 ± 0.0079 | min=0.7031 max=0.7369
         : test loss mean=0.9908 ± 0.0294
         : individual accs = ['0.720446', '0.729003', '0.720657', '0.736903', '0.725251', '0.734546', '0.729549', '0.729133', '0.736101', '0.723404', '0.711320', '0.727641', '0.731737', '0.725756', '0.728529', '0.726979', '0.703106', '0.723643', '0.730167', '0.718023']
         : correct/total = [(2974, 4128), (3064, 4203), (2941, 4081), (3193, 4333), (2967, 4091), (3149, 4287), (3059, 4193), (3171, 4349), (3085, 4191), (3094, 4277), (2947, 4143), (3051, 4193), (2995, 4093), (3046, 4197), (2952, 4052), (2929, 4029), (2920, 4153), (3027, 4183), (2982, 4084), (2964, 4128)]
Round 004: test acc mean=0.7834 ± 0.0071 | min=0.7654 max=0.7927
         : test loss mean=0.6993 ± 0.0223
         : individual accs = ['0.777374', '0.783964', '0.778731', '0.784445', '0.768027', '0.790763', '0.789649', '0.787307', '0.792651', '0.787468', '0.765387', '0.785834', '0.786953', '0.783178', '0.792201', '0.788533', '0.780641', '0.782453', '0.784770', '0.777132']
         : correct/total = [(3209, 4128), (3295, 4203), (3178, 4081), (3399, 4333), (3142, 4091), (3390, 4287), (3311, 4193), (3424, 4349), (3322, 4191), (3368, 4277), (3171, 4143), (3295, 4193), (3221, 4093), (3287, 4197), (3210, 4052), (3177, 4029), (3242, 4153), (3273, 4183), (3205, 4084), (3208, 4128)]
Round 005: test acc mean=0.8113 ± 0.0075 | min=0.7924 max=0.8198
         : test loss mean=0.5993 ± 0.0203
         : individual accs = ['0.799903', '0.817987', '0.811076', '0.810524', '0.798338', '0.817122', '0.816361', '0.817429', '0.816512', '0.813654', '0.792421', '0.808729', '0.811630', '0.812009', '0.818855', '0.819806', '0.808331', '0.819268', '0.813173', '0.802810']
         : correct/total = [(3302, 4128), (3438, 4203), (3310, 4081), (3512, 4333), (3266, 4091), (3503, 4287), (3423, 4193), (3555, 4349), (3422, 4191), (3480, 4277), (3283, 4143), (3391, 4193), (3322, 4093), (3408, 4197), (3318, 4052), (3303, 4029), (3357, 4153), (3427, 4183), (3321, 4084), (3314, 4128)]
Round 006: test acc mean=0.8252 ± 0.0057 | min=0.8103 max=0.8324
         : test loss mean=0.5436 ± 0.0197
         : individual accs = ['0.817345', '0.829170', '0.824308', '0.825756', '0.815937', '0.828551', '0.829955', '0.832375', '0.832021', '0.829086', '0.810282', '0.822561', '0.821891', '0.827258', '0.830948', '0.826260', '0.824464', '0.830743', '0.824927', '0.820010']
         : correct/total = [(3374, 4128), (3485, 4203), (3364, 4081), (3578, 4333), (3338, 4091), (3552, 4287), (3480, 4193), (3620, 4349), (3487, 4191), (3546, 4277), (3357, 4143), (3449, 4193), (3364, 4093), (3472, 4197), (3367, 4052), (3329, 4029), (3424, 4153), (3475, 4183), (3369, 4084), (3385, 4128)]
Round 007: test acc mean=0.8351 ± 0.0063 | min=0.8199 max=0.8447
         : test loss mean=0.5091 ± 0.0195
         : individual accs = ['0.822674', '0.843445', '0.838520', '0.837064', '0.828404', '0.837649', '0.838779', '0.837664', '0.844667', '0.837737', '0.819937', '0.829716', '0.830687', '0.839886', '0.840819', '0.837925', '0.836263', '0.836481', '0.835455', '0.828731']
         : correct/total = [(3396, 4128), (3545, 4203), (3422, 4081), (3627, 4333), (3389, 4091), (3591, 4287), (3517, 4193), (3643, 4349), (3540, 4191), (3583, 4277), (3397, 4143), (3479, 4193), (3400, 4093), (3525, 4197), (3407, 4052), (3376, 4029), (3473, 4153), (3499, 4183), (3412, 4084), (3421, 4128)]
Round 008: test acc mean=0.8406 ± 0.0055 | min=0.8267 max=0.8464
         : test loss mean=0.4859 ± 0.0200
         : individual accs = ['0.830184', '0.843445', '0.844156', '0.843296', '0.832804', '0.841614', '0.846411', '0.846172', '0.843236', '0.843816', '0.826696', '0.838779', '0.840704', '0.842030', '0.842053', '0.845371', '0.842283', '0.841501', '0.845495', '0.832364']
         : correct/total = [(3427, 4128), (3545, 4203), (3445, 4081), (3654, 4333), (3407, 4091), (3608, 4287), (3549, 4193), (3680, 4349), (3534, 4191), (3609, 4277), (3425, 4143), (3517, 4193), (3441, 4093), (3534, 4197), (3412, 4052), (3406, 4029), (3498, 4153), (3520, 4183), (3453, 4084), (3436, 4128)]
Round 009: test acc mean=0.8469 ± 0.0057 | min=0.8350 max=0.8561
         : test loss mean=0.4661 ± 0.0200
         : individual accs = ['0.835029', '0.850821', '0.847831', '0.846988', '0.836470', '0.844880', '0.851896', '0.854219', '0.856120', '0.853402', '0.836350', '0.844026', '0.843880', '0.849416', '0.848963', '0.849342', '0.848784', '0.849390', '0.847453', '0.843023']
         : correct/total = [(3447, 4128), (3576, 4203), (3460, 4081), (3670, 4333), (3422, 4091), (3622, 4287), (3572, 4193), (3715, 4349), (3588, 4191), (3650, 4277), (3465, 4143), (3539, 4193), (3454, 4093), (3565, 4197), (3440, 4052), (3422, 4029), (3525, 4153), (3553, 4183), (3461, 4084), (3480, 4128)]
Round 010: test acc mean=0.8500 ± 0.0048 | min=0.8394 max=0.8576
         : test loss mean=0.4532 ± 0.0193
         : individual accs = ['0.839390', '0.856055', '0.851017', '0.851604', '0.844048', '0.848379', '0.853565', '0.853989', '0.857552', '0.854337', '0.840212', '0.846411', '0.847545', '0.853228', '0.851431', '0.852569', '0.850229', '0.851781', '0.850637', '0.845446']
         : correct/total = [(3465, 4128), (3598, 4203), (3473, 4081), (3690, 4333), (3453, 4091), (3637, 4287), (3579, 4193), (3714, 4349), (3594, 4191), (3654, 4277), (3481, 4143), (3549, 4193), (3469, 4093), (3581, 4197), (3450, 4052), (3435, 4029), (3531, 4153), (3563, 4183), (3474, 4084), (3490, 4128)]

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Agg: d-fedadj
No attack (clean run)
Test accuracy: mean=0.8500 ± 0.0048