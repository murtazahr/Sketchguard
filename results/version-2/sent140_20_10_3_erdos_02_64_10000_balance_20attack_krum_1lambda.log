Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
Degree statistics: avg=4.80, min=2, max=7
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5154 ± 0.0273 | min=0.4740 max=0.5686
         : test loss mean=0.9486 ± 0.6592
         : individual accs = ['0.488758', '0.568599', '0.526987', '0.507702', '0.508288', '0.505949', '0.494702', '0.500349', '0.565832', '0.547137', '0.473996', '0.500070', '0.499721', '0.559811', '0.503073', '0.498854', '0.487873', '0.494774', '0.535892', '0.540524']
         : correct/total = [(6956, 14232), (8094, 14235), (7518, 14266), (7218, 14217), (7237, 14238), (7272, 14373), (7097, 14346), (7172, 14334), (8088, 14294), (7864, 14373), (6799, 14344), (7152, 14302), (7173, 14354), (8040, 14362), (7204, 14320), (7181, 14395), (7020, 14389), (7054, 14257), (7637, 14251), (7783, 14399)]
         : compromised: 0.5151, honest: 0.5155
Round 002: test acc mean=0.5055 ± 0.0161 | min=0.4760 max=0.5393
         : test loss mean=0.7026 ± 0.0210
         : individual accs = ['0.517496', '0.499614', '0.486051', '0.528663', '0.539331', '0.497600', '0.517496', '0.515697', '0.537568', '0.492938', '0.501115', '0.508111', '0.499930', '0.511071', '0.475978', '0.493574', '0.500660', '0.498071', '0.489860', '0.499687']
         : correct/total = [(7365, 14232), (7112, 14235), (6934, 14266), (7516, 14217), (7679, 14238), (7152, 14373), (7424, 14346), (7392, 14334), (7684, 14294), (7085, 14373), (7188, 14344), (7267, 14302), (7176, 14354), (7340, 14362), (6816, 14320), (7105, 14395), (7204, 14389), (7101, 14257), (6981, 14251), (7195, 14399)]
         : compromised: 0.5017, honest: 0.5065
Round 003: test acc mean=0.5137 ± 0.0228 | min=0.4861 max=0.5582
         : test loss mean=0.6918 ± 0.0020
         : individual accs = ['0.489039', '0.486266', '0.486051', '0.492579', '0.558224', '0.545119', '0.499582', '0.525673', '0.489856', '0.492869', '0.526143', '0.548175', '0.499930', '0.521863', '0.518506', '0.528586', '0.526513', '0.506909', '0.488667', '0.542607']
         : correct/total = [(6960, 14232), (6922, 14235), (6934, 14266), (7003, 14217), (7948, 14238), (7835, 14373), (7167, 14346), (7535, 14334), (7002, 14294), (7084, 14373), (7547, 14344), (7840, 14302), (7176, 14354), (7495, 14362), (7425, 14320), (7609, 14395), (7576, 14389), (7227, 14257), (6964, 14251), (7813, 14399)]
         : compromised: 0.5185, honest: 0.5125
Round 004: test acc mean=0.5171 ± 0.0292 | min=0.4861 max=0.5911
         : test loss mean=0.6914 ± 0.0021
         : individual accs = ['0.488898', '0.486266', '0.486051', '0.492861', '0.548813', '0.557643', '0.497909', '0.512627', '0.488806', '0.493008', '0.591118', '0.533492', '0.500070', '0.541220', '0.530237', '0.555123', '0.515811', '0.505787', '0.488738', '0.527676']
         : correct/total = [(6958, 14232), (6922, 14235), (6934, 14266), (7007, 14217), (7814, 14238), (8015, 14373), (7143, 14346), (7348, 14334), (6987, 14294), (7086, 14373), (8479, 14344), (7630, 14302), (7178, 14354), (7773, 14362), (7593, 14320), (7991, 14395), (7422, 14389), (7211, 14257), (6965, 14251), (7598, 14399)]
         : compromised: 0.5262, honest: 0.5148
Round 005: test acc mean=0.5065 ± 0.0202 | min=0.4861 max=0.5706
         : test loss mean=0.6918 ± 0.0019
         : individual accs = ['0.489250', '0.486266', '0.486051', '0.494056', '0.515311', '0.515133', '0.497700', '0.517232', '0.488457', '0.493077', '0.570552', '0.492029', '0.501533', '0.516780', '0.531494', '0.526572', '0.519286', '0.503121', '0.488738', '0.496701']
         : correct/total = [(6963, 14232), (6922, 14235), (6934, 14266), (7024, 14217), (7337, 14238), (7404, 14373), (7140, 14346), (7414, 14334), (6982, 14294), (7087, 14373), (8184, 14344), (7037, 14302), (7199, 14354), (7422, 14362), (7611, 14320), (7580, 14395), (7472, 14389), (7173, 14257), (6965, 14251), (7152, 14399)]
         : compromised: 0.5091, honest: 0.5058
Round 006: test acc mean=0.5001 ± 0.0152 | min=0.4861 max=0.5577
         : test loss mean=0.6922 ± 0.0016
         : individual accs = ['0.489109', '0.486266', '0.486051', '0.493845', '0.495154', '0.493982', '0.497560', '0.508581', '0.488457', '0.493425', '0.557655', '0.492029', '0.508848', '0.508773', '0.508310', '0.503508', '0.501703', '0.503051', '0.488738', '0.496284']
         : correct/total = [(6961, 14232), (6922, 14235), (6934, 14266), (7021, 14217), (7050, 14238), (7100, 14373), (7138, 14346), (7290, 14334), (6982, 14294), (7092, 14373), (7999, 14344), (7037, 14302), (7304, 14354), (7307, 14362), (7279, 14320), (7248, 14395), (7219, 14389), (7172, 14257), (6965, 14251), (7146, 14399)]
         : compromised: 0.5037, honest: 0.4992
Round 007: test acc mean=0.4985 ± 0.0105 | min=0.4861 max=0.5226
         : test loss mean=0.6923 ± 0.0015
         : individual accs = ['0.489250', '0.486266', '0.486051', '0.492228', '0.494451', '0.493843', '0.497630', '0.506069', '0.488457', '0.493008', '0.522309', '0.492029', '0.500488', '0.508773', '0.522626', '0.498923', '0.509486', '0.503051', '0.488738', '0.496632']
         : correct/total = [(6963, 14232), (6922, 14235), (6934, 14266), (6998, 14217), (7040, 14238), (7098, 14373), (7139, 14346), (7254, 14334), (6982, 14294), (7086, 14373), (7492, 14344), (7037, 14302), (7184, 14354), (7307, 14362), (7484, 14320), (7182, 14395), (7331, 14389), (7172, 14257), (6965, 14251), (7151, 14399)]
         : compromised: 0.5015, honest: 0.4978
Round 008: test acc mean=0.4982 ± 0.0104 | min=0.4861 max=0.5287
         : test loss mean=0.6924 ± 0.0015
         : individual accs = ['0.489109', '0.486266', '0.486051', '0.492228', '0.494241', '0.493843', '0.497560', '0.509418', '0.488457', '0.493147', '0.528723', '0.492029', '0.499930', '0.508564', '0.514176', '0.498437', '0.503857', '0.503051', '0.488738', '0.496632']
         : correct/total = [(6961, 14232), (6922, 14235), (6934, 14266), (6998, 14217), (7037, 14238), (7098, 14373), (7138, 14346), (7302, 14334), (6982, 14294), (7088, 14373), (7584, 14344), (7037, 14302), (7176, 14354), (7304, 14362), (7363, 14320), (7175, 14395), (7250, 14389), (7172, 14257), (6965, 14251), (7151, 14399)]
         : compromised: 0.5013, honest: 0.4974
Round 009: test acc mean=0.4957 ± 0.0062 | min=0.4861 max=0.5087
         : test loss mean=0.6926 ± 0.0012
         : individual accs = ['0.489179', '0.486266', '0.486051', '0.492228', '0.494662', '0.493843', '0.497560', '0.503837', '0.488457', '0.493008', '0.502370', '0.492029', '0.499791', '0.508704', '0.497207', '0.498367', '0.502815', '0.503051', '0.488738', '0.496354']
         : correct/total = [(6962, 14232), (6922, 14235), (6934, 14266), (6998, 14217), (7043, 14238), (7098, 14373), (7138, 14346), (7222, 14334), (6982, 14294), (7086, 14373), (7206, 14344), (7037, 14302), (7174, 14354), (7306, 14362), (7120, 14320), (7174, 14395), (7235, 14389), (7172, 14257), (6965, 14251), (7147, 14399)]
         : compromised: 0.5013, honest: 0.4943
Round 010: test acc mean=0.4983 ± 0.0123 | min=0.4861 max=0.5419
         : test loss mean=0.6924 ± 0.0015
         : individual accs = ['0.489109', '0.486266', '0.486051', '0.492298', '0.495435', '0.493843', '0.497560', '0.541928', '0.488457', '0.493008', '0.514919', '0.492029', '0.499721', '0.508704', '0.497277', '0.498437', '0.503162', '0.503051', '0.488738', '0.496979']
         : correct/total = [(6961, 14232), (6922, 14235), (6934, 14266), (6999, 14217), (7054, 14238), (7098, 14373), (7138, 14346), (7768, 14334), (6982, 14294), (7086, 14373), (7386, 14344), (7037, 14302), (7173, 14354), (7306, 14362), (7121, 14320), (7175, 14395), (7240, 14389), (7172, 14257), (6965, 14251), (7156, 14399)]
         : compromised: 0.5013, honest: 0.4976

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: krum, 20.0% compromised
Final accuracy - Compromised: 0.5013, Honest: 0.4976
Overall test accuracy: mean=0.4983 ± 0.0123

=== BALANCE SUMMARY ===
Node 0: acceptance=0.850
Node 1: acceptance=1.000
Node 2: acceptance=1.000
Node 3: acceptance=0.775
Node 4: acceptance=0.775
Node 5: acceptance=0.640
Node 6: acceptance=0.820
Node 7: acceptance=0.640
Node 8: acceptance=1.000
Node 9: acceptance=1.000
Node 10: acceptance=0.775
Node 11: acceptance=0.743
Node 12: acceptance=0.871
Node 13: acceptance=1.000
Node 14: acceptance=0.486
Node 15: acceptance=0.700
Node 16: acceptance=0.640
Node 17: acceptance=0.820
Node 18: acceptance=1.000
Node 19: acceptance=1.000

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.032s (71.5%)
    - Aggregation: 0.013s (28.5%)
  TOTALS:
    - Total computation: 0.044s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.044s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.023s
  - Aggregation: 0.006s
  - Model transfer: 0.000s
  - Total per node: 0.030s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 0.465s
  - Total aggregation: 0.125s
  - Total model transfer: 0.000s
  - Grand total: 0.591s
  - Mean acceptance rate: 0.827

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
