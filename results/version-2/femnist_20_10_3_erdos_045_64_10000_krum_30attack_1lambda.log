Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.0533 ± 0.0136 | min=0.0036 max=0.0742
         : test loss mean=24617.5547 ± 107289.3552
         : individual accs = ['0.059593', '0.052344', '0.048272', '0.048465', '0.045710', '0.045253', '0.057000', '0.058174', '0.003579', '0.053776', '0.050447', '0.071309', '0.053750', '0.062426', '0.061204', '0.056590', '0.058271', '0.050203', '0.074192', '0.054506']
         : correct/total = [(246, 4128), (220, 4203), (197, 4081), (210, 4333), (187, 4091), (194, 4287), (239, 4193), (253, 4349), (15, 4191), (230, 4277), (209, 4143), (299, 4193), (220, 4093), (262, 4197), (248, 4052), (228, 4029), (242, 4153), (210, 4183), (303, 4084), (225, 4128)]
         : compromised: 0.0578, honest: 0.0513
Round 002: test acc mean=0.0595 ± 0.0157 | min=0.0434 max=0.0953
         : test loss mean=81717.1393 ± 356180.6994
         : individual accs = ['0.049176', '0.047109', '0.095320', '0.043388', '0.051088', '0.043387', '0.077272', '0.071741', '0.050585', '0.047463', '0.045619', '0.090389', '0.049841', '0.062426', '0.051579', '0.054852', '0.054418', '0.050203', '0.080558', '0.073643']
         : correct/total = [(203, 4128), (198, 4203), (389, 4081), (188, 4333), (209, 4091), (186, 4287), (324, 4193), (312, 4349), (212, 4191), (203, 4277), (189, 4143), (379, 4193), (204, 4093), (262, 4197), (209, 4052), (221, 4029), (226, 4153), (210, 4183), (329, 4084), (304, 4128)]
         : compromised: 0.0563, honest: 0.0609
Round 003: test acc mean=0.0550 ± 0.0098 | min=0.0456 max=0.0842
         : test loss mean=243060.0582 ± 1059458.2119
         : individual accs = ['0.049176', '0.052819', '0.056114', '0.058851', '0.054021', '0.074411', '0.046745', '0.047827', '0.049630', '0.069675', '0.045619', '0.049606', '0.049841', '0.047177', '0.084156', '0.056342', '0.055141', '0.050681', '0.050930', '0.050388']
         : correct/total = [(203, 4128), (222, 4203), (229, 4081), (255, 4333), (221, 4091), (319, 4287), (196, 4193), (208, 4349), (208, 4191), (298, 4277), (189, 4143), (208, 4193), (204, 4093), (198, 4197), (341, 4052), (227, 4029), (229, 4153), (212, 4183), (208, 4084), (208, 4128)]
         : compromised: 0.0595, honest: 0.0530
Round 004: test acc mean=0.0925 ± 0.0328 | min=0.0492 max=0.1536
         : test loss mean=3690769.7615 ± 16087676.4406
         : individual accs = ['0.153343', '0.096598', '0.108307', '0.071082', '0.101687', '0.050618', '0.073217', '0.090366', '0.049630', '0.097031', '0.055998', '0.107560', '0.058637', '0.069335', '0.109576', '0.153636', '0.152902', '0.094430', '0.106513', '0.049176']
         : correct/total = [(633, 4128), (406, 4203), (442, 4081), (308, 4333), (416, 4091), (217, 4287), (307, 4193), (393, 4349), (208, 4191), (415, 4277), (232, 4143), (451, 4193), (240, 4093), (291, 4197), (444, 4052), (619, 4029), (635, 4153), (395, 4183), (435, 4084), (203, 4128)]
         : compromised: 0.0815, honest: 0.0972
Round 005: test acc mean=0.1015 ± 0.0397 | min=0.0478 max=0.1663
         : test loss mean=46983.7550 ± 204781.5333
         : individual accs = ['0.065165', '0.073519', '0.075472', '0.125087', '0.067710', '0.143690', '0.136179', '0.047827', '0.051539', '0.065233', '0.134444', '0.137610', '0.153921', '0.142244', '0.088598', '0.070489', '0.083554', '0.051159', '0.166259', '0.150921']
         : correct/total = [(269, 4128), (309, 4203), (308, 4081), (542, 4333), (277, 4091), (616, 4287), (571, 4193), (208, 4349), (216, 4191), (279, 4277), (557, 4143), (577, 4193), (630, 4093), (597, 4197), (359, 4052), (284, 4029), (347, 4153), (214, 4183), (679, 4084), (623, 4128)]
         : compromised: 0.1243, honest: 0.0918
Round 006: test acc mean=0.1141 ± 0.0387 | min=0.0408 max=0.1801
         : test loss mean=3177496860.6133 ± 13850387693.0713
         : individual accs = ['0.050145', '0.115156', '0.140652', '0.100162', '0.126619', '0.180079', '0.129740', '0.129225', '0.040802', '0.121113', '0.141443', '0.123062', '0.051551', '0.145342', '0.058983', '0.132291', '0.128823', '0.148219', '0.154261', '0.064680']
         : correct/total = [(207, 4128), (484, 4203), (574, 4081), (434, 4333), (518, 4091), (772, 4287), (544, 4193), (562, 4349), (171, 4191), (518, 4277), (586, 4143), (516, 4193), (211, 4093), (610, 4197), (239, 4052), (533, 4029), (535, 4153), (620, 4183), (630, 4084), (267, 4128)]
         : compromised: 0.1231, honest: 0.1103
Round 007: test acc mean=0.2034 ± 0.0658 | min=0.0446 max=0.2931
         : test loss mean=9331568407.2417 ± 40675363656.4627
         : individual accs = ['0.293120', '0.200333', '0.222740', '0.127625', '0.200684', '0.277817', '0.161698', '0.159347', '0.044619', '0.185644', '0.165822', '0.151681', '0.290252', '0.228497', '0.291955', '0.244478', '0.240549', '0.152761', '0.290891', '0.137839']
         : correct/total = [(1210, 4128), (842, 4203), (909, 4081), (553, 4333), (821, 4091), (1191, 4287), (678, 4193), (693, 4349), (187, 4191), (794, 4277), (687, 4143), (636, 4193), (1188, 4093), (959, 4197), (1183, 4052), (985, 4029), (999, 4153), (639, 4183), (1188, 4084), (569, 4128)]
         : compromised: 0.2554, honest: 0.1812
Round 008: test acc mean=0.2167 ± 0.0406 | min=0.0573 max=0.2473
         : test loss mean=19793206395953.5781 ± 86276586448589.8594
         : individual accs = ['0.240068', '0.226029', '0.229356', '0.218555', '0.233684', '0.226732', '0.203434', '0.238446', '0.057266', '0.204115', '0.239681', '0.169568', '0.239922', '0.208482', '0.234946', '0.231571', '0.227787', '0.216591', '0.239716', '0.247335']
         : correct/total = [(991, 4128), (950, 4203), (936, 4081), (947, 4333), (956, 4091), (972, 4287), (853, 4193), (1037, 4349), (240, 4191), (873, 4277), (993, 4143), (711, 4193), (982, 4093), (875, 4197), (952, 4052), (933, 4029), (946, 4153), (906, 4183), (979, 4084), (1021, 4128)]
         : compromised: 0.2277, honest: 0.2119
Round 009: test acc mean=0.2282 ± 0.1175 | min=0.0453 max=0.3362
         : test loss mean=nan ± nan
         : individual accs = ['0.300388', '0.321675', '0.336192', '0.287561', '0.333170', '0.045253', '0.309325', '0.294780', '0.049630', '0.303250', '0.266232', '0.287384', '0.054239', '0.049083', '0.051826', '0.322164', '0.307007', '0.312933', '0.052889', '0.278585']
         : correct/total = [(1240, 4128), (1352, 4203), (1372, 4081), (1246, 4333), (1363, 4091), (194, 4287), (1297, 4193), (1282, 4349), (208, 4191), (1297, 4277), (1103, 4143), (1205, 4193), (222, 4093), (206, 4197), (210, 4052), (1298, 4029), (1275, 4153), (1309, 4183), (216, 4084), (1150, 4128)]
         : compromised: 0.0944, honest: 0.2855
Round 010: test acc mean=0.2571 ± 0.1357 | min=0.0453 max=0.3641
         : test loss mean=nan ± nan
         : individual accs = ['0.364099', '0.346181', '0.355795', '0.333718', '0.347103', '0.045253', '0.338183', '0.342148', '0.049630', '0.333879', '0.360850', '0.362032', '0.054239', '0.049083', '0.051826', '0.363366', '0.337106', '0.330863', '0.052889', '0.324128']
         : correct/total = [(1503, 4128), (1455, 4203), (1452, 4081), (1446, 4333), (1420, 4091), (194, 4287), (1418, 4193), (1488, 4349), (208, 4191), (1428, 4277), (1495, 4143), (1518, 4193), (222, 4093), (206, 4197), (210, 4052), (1464, 4029), (1400, 4153), (1384, 4183), (216, 4084), (1338, 4128)]
         : compromised: 0.0974, honest: 0.3256

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 30.0% compromised
Final accuracy - Compromised: 0.0974, Honest: 0.3256
Overall test accuracy: mean=0.2571 ± 0.1357
