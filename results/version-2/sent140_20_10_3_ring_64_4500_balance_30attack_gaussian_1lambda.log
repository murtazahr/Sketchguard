Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: gaussian, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5490 ± 0.0341 | min=0.4893 max=0.6236
         : test loss mean=73.2401 ± 316.2417
         : individual accs = ['0.583263', '0.623604', '0.535118', '0.566575', '0.566021', '0.508592', '0.590687', '0.576531', '0.501189', '0.572254', '0.509481', '0.516291', '0.532395', '0.489347', '0.529050', '0.546440', '0.558621', '0.561408', '0.528594', '0.584902']
         : correct/total = [(8301, 14232), (8877, 14235), (7634, 14266), (8055, 14217), (8059, 14238), (7310, 14373), (8474, 14346), (8264, 14334), (7164, 14294), (8225, 14373), (7308, 14344), (7384, 14302), (7642, 14354), (7028, 14362), (7576, 14320), (7866, 14395), (8038, 14389), (8004, 14257), (7533, 14251), (8422, 14399)]
         : compromised: 0.5249, honest: 0.5594
Round 002: test acc mean=0.6231 ± 0.0284 | min=0.5099 max=0.6426
         : test loss mean=21.6526 ± 91.5017
         : individual accs = ['0.640247', '0.642571', '0.632062', '0.624604', '0.639345', '0.595631', '0.633278', '0.627320', '0.623548', '0.609685', '0.624651', '0.637743', '0.640797', '0.509887', '0.619693', '0.633692', '0.637084', '0.618784', '0.630201', '0.640392']
         : correct/total = [(9112, 14232), (9147, 14235), (9017, 14266), (8880, 14217), (9103, 14238), (8561, 14373), (9085, 14346), (8992, 14334), (8913, 14294), (8763, 14373), (8960, 14344), (9121, 14302), (9198, 14354), (7323, 14362), (8874, 14320), (9122, 14395), (9167, 14389), (8822, 14257), (8981, 14251), (9221, 14399)]
         : compromised: 0.6025, honest: 0.6319
Round 003: test acc mean=0.6252 ± 0.0291 | min=0.5036 max=0.6456
         : test loss mean=42.5041 ± 182.4392
         : individual accs = ['0.636594', '0.634563', '0.635427', '0.639375', '0.640961', '0.621582', '0.616966', '0.619855', '0.616692', '0.635775', '0.636364', '0.645574', '0.635154', '0.503621', '0.628701', '0.639667', '0.639516', '0.619836', '0.625570', '0.632336']
         : correct/total = [(9060, 14232), (9033, 14235), (9065, 14266), (9090, 14217), (9126, 14238), (8934, 14373), (8851, 14346), (8885, 14334), (8815, 14294), (9138, 14373), (9128, 14344), (9233, 14302), (9117, 14354), (7233, 14362), (9003, 14320), (9208, 14395), (9202, 14389), (8837, 14257), (8915, 14251), (9105, 14399)]
         : compromised: 0.6057, honest: 0.6335
Round 004: test acc mean=0.6342 ± 0.0315 | min=0.5026 max=0.6516
         : test loss mean=31.0278 ± 132.4570
         : individual accs = ['0.649311', '0.641166', '0.645591', '0.646902', '0.649810', '0.639602', '0.641154', '0.633529', '0.619351', '0.622556', '0.639571', '0.649140', '0.647206', '0.502576', '0.628282', '0.645849', '0.647856', '0.645998', '0.636447', '0.651642']
         : correct/total = [(9241, 14232), (9127, 14235), (9210, 14266), (9197, 14217), (9252, 14238), (9193, 14373), (9198, 14346), (9081, 14334), (8853, 14294), (8948, 14373), (9174, 14344), (9284, 14302), (9290, 14354), (7218, 14362), (8997, 14320), (9297, 14395), (9322, 14389), (9210, 14257), (9070, 14251), (9383, 14399)]
         : compromised: 0.6167, honest: 0.6417
Round 005: test acc mean=0.6384 ± 0.0346 | min=0.4893 max=0.6558
         : test loss mean=26.1863 ± 111.3758
         : individual accs = ['0.645728', '0.648823', '0.645381', '0.648097', '0.653884', '0.640994', '0.641294', '0.644203', '0.640409', '0.646212', '0.636642', '0.642428', '0.652501', '0.489277', '0.649441', '0.651407', '0.655848', '0.648664', '0.639674', '0.646295']
         : correct/total = [(9190, 14232), (9236, 14235), (9207, 14266), (9214, 14217), (9310, 14238), (9213, 14373), (9200, 14346), (9234, 14334), (9154, 14294), (9288, 14373), (9132, 14344), (9188, 14302), (9366, 14354), (7027, 14362), (9300, 14320), (9377, 14395), (9437, 14389), (9248, 14257), (9116, 14251), (9306, 14399)]
         : compromised: 0.6201, honest: 0.6462
Round 006: test acc mean=0.6427 ± 0.0327 | min=0.5041 max=0.6645
         : test loss mean=25.6458 ± 109.0445
         : individual accs = ['0.653808', '0.650228', '0.645451', '0.653654', '0.657396', '0.639880', '0.647428', '0.650551', '0.640269', '0.639672', '0.641732', '0.641449', '0.643584', '0.504108', '0.658240', '0.658076', '0.664535', '0.659536', '0.645920', '0.659212']
         : correct/total = [(9305, 14232), (9256, 14235), (9208, 14266), (9293, 14217), (9360, 14238), (9197, 14373), (9288, 14346), (9325, 14334), (9152, 14294), (9194, 14373), (9205, 14344), (9174, 14302), (9238, 14354), (7240, 14362), (9426, 14320), (9473, 14395), (9562, 14389), (9403, 14257), (9205, 14251), (9492, 14399)]
         : compromised: 0.6252, honest: 0.6502
Round 007: test acc mean=0.6440 ± 0.0347 | min=0.4987 max=0.6663
         : test loss mean=34.7467 ± 148.7256
         : individual accs = ['0.658516', '0.658166', '0.629399', '0.657241', '0.661118', '0.635497', '0.651540', '0.646505', '0.645236', '0.651778', '0.641244', '0.642218', '0.653128', '0.498677', '0.652654', '0.661549', '0.666273', '0.665918', '0.644376', '0.659490']
         : correct/total = [(9372, 14232), (9369, 14235), (8979, 14266), (9344, 14217), (9413, 14238), (9134, 14373), (9347, 14346), (9267, 14334), (9223, 14294), (9368, 14373), (9198, 14344), (9185, 14302), (9375, 14354), (7162, 14362), (9346, 14320), (9523, 14395), (9587, 14389), (9494, 14257), (9183, 14251), (9496, 14399)]
         : compromised: 0.6250, honest: 0.6522
Round 008: test acc mean=0.6475 ± 0.0336 | min=0.5067 max=0.6720
         : test loss mean=63.4900 ± 274.0334
         : individual accs = ['0.660764', '0.650861', '0.654423', '0.651544', '0.649108', '0.656578', '0.639621', '0.636808', '0.647055', '0.649899', '0.647030', '0.653056', '0.659328', '0.506684', '0.666480', '0.668079', '0.671972', '0.668794', '0.649147', '0.661990']
         : correct/total = [(9404, 14232), (9265, 14235), (9336, 14266), (9263, 14217), (9242, 14238), (9437, 14373), (9176, 14346), (9128, 14334), (9249, 14294), (9341, 14373), (9281, 14344), (9340, 14302), (9464, 14354), (7277, 14362), (9544, 14320), (9617, 14395), (9669, 14389), (9535, 14257), (9251, 14251), (9532, 14399)]
         : compromised: 0.6345, honest: 0.6530
Round 009: test acc mean=0.6474 ± 0.0393 | min=0.4854 max=0.6749
         : test loss mean=59.8453 ± 258.1597
         : individual accs = ['0.648257', '0.660836', '0.662134', '0.661673', '0.662523', '0.654004', '0.620870', '0.640435', '0.641108', '0.647255', '0.652607', '0.656831', '0.656611', '0.485378', '0.671858', '0.670997', '0.674891', '0.673424', '0.658831', '0.648101']
         : correct/total = [(9226, 14232), (9407, 14235), (9446, 14266), (9407, 14217), (9433, 14238), (9400, 14373), (8907, 14346), (9180, 14334), (9164, 14294), (9303, 14373), (9361, 14344), (9394, 14302), (9425, 14354), (6971, 14362), (9621, 14320), (9659, 14395), (9711, 14389), (9601, 14257), (9389, 14251), (9332, 14399)]
         : compromised: 0.6334, honest: 0.6535
Round 010: test acc mean=0.6586 ± 0.0346 | min=0.5131 max=0.6843
         : test loss mean=46.1872 ± 198.6635
         : individual accs = ['0.665261', '0.664910', '0.666059', '0.668847', '0.671162', '0.665971', '0.657326', '0.658993', '0.653071', '0.650525', '0.658463', '0.659348', '0.663021', '0.513090', '0.678422', '0.683223', '0.684273', '0.679596', '0.661708', '0.668102']
         : correct/total = [(9468, 14232), (9465, 14235), (9502, 14266), (9509, 14217), (9556, 14238), (9572, 14373), (9430, 14346), (9446, 14334), (9335, 14294), (9350, 14373), (9445, 14344), (9430, 14302), (9517, 14354), (7369, 14362), (9715, 14320), (9835, 14395), (9846, 14389), (9689, 14257), (9430, 14251), (9620, 14399)]
         : compromised: 0.6436, honest: 0.6650

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: balance
Attack: gaussian, 30.0% compromised
Final accuracy - Compromised: 0.6436, Honest: 0.6650
Overall test accuracy: mean=0.6586 ± 0.0346

=== BALANCE SUMMARY ===
Node 0: acceptance=1.000
Node 1: acceptance=1.000
Node 2: acceptance=1.000
Node 3: acceptance=1.000
Node 4: acceptance=0.500
Node 5: acceptance=0.800
Node 6: acceptance=0.500
Node 7: acceptance=1.000
Node 8: acceptance=1.000
Node 9: acceptance=1.000
Node 10: acceptance=1.000
Node 11: acceptance=0.500
Node 12: acceptance=0.500
Node 13: acceptance=0.500
Node 14: acceptance=0.500
Node 15: acceptance=0.500
Node 16: acceptance=0.500
Node 17: acceptance=0.500
Node 18: acceptance=0.500
Node 19: acceptance=0.500

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.029s (69.2%)
    - Aggregation: 0.013s (30.7%)
  TOTALS:
    - Total computation: 0.041s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.041s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.012s
  - Aggregation: 0.006s
  - Model transfer: 0.000s
  - Total per node: 0.017s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 0.236s
  - Total aggregation: 0.111s
  - Total model transfer: 0.000s
  - Grand total: 0.347s
  - Mean acceptance rate: 0.715

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
