Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: backdoor, lambda: 1.0
Backdoor target label: 1, trigger size: 3
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4965 ± 0.0152
Backdoor attack: Created poisoned datasets for 4 compromised nodes
Round 001: test acc mean=0.5002 ± 0.0093 | min=0.4830 max=0.5225
         : test loss mean=1.2609 ± 0.7120
         : individual accs = ['0.501967', '0.508395', '0.522501', '0.508476', '0.492415', '0.494051', '0.503346', '0.510604', '0.487407', '0.493008', '0.505438', '0.493987', '0.496099', '0.483011', '0.499930', '0.495797', '0.500104', '0.495616', '0.514911', '0.496701']
         : correct/total = [(7144, 14232), (7237, 14235), (7454, 14266), (7229, 14217), (7011, 14238), (7101, 14373), (7221, 14346), (7319, 14334), (6967, 14294), (7086, 14373), (7250, 14344), (7065, 14302), (7121, 14354), (6937, 14362), (7159, 14320), (7137, 14395), (7196, 14389), (7066, 14257), (7338, 14251), (7152, 14399)]
         : compromised: 0.4922, honest: 0.5022
Round 002: test acc mean=0.5006 ± 0.0059 | min=0.4876 max=0.5099
         : test loss mean=1.1110 ± 0.2864
         : individual accs = ['0.502740', '0.501510', '0.509113', '0.505873', '0.505900', '0.495721', '0.499512', '0.509907', '0.498321', '0.490573', '0.506274', '0.499930', '0.487599', '0.497702', '0.501606', '0.497325', '0.505595', '0.491267', '0.505228', '0.499687']
         : correct/total = [(7155, 14232), (7139, 14235), (7263, 14266), (7192, 14217), (7203, 14238), (7125, 14373), (7166, 14346), (7309, 14334), (7123, 14294), (7051, 14373), (7262, 14344), (7150, 14302), (6999, 14354), (7148, 14362), (7183, 14320), (7159, 14395), (7275, 14389), (7004, 14257), (7200, 14251), (7195, 14399)]
         : compromised: 0.4931, honest: 0.5024
Round 003: test acc mean=0.4895 ± 0.0119 | min=0.4645 max=0.5077
         : test loss mean=0.8652 ± 0.0680
         : individual accs = ['0.488969', '0.486547', '0.485981', '0.503904', '0.493398', '0.472274', '0.493029', '0.481792', '0.495872', '0.499478', '0.500349', '0.471542', '0.502229', '0.507729', '0.475978', '0.499062', '0.477865', '0.499474', '0.489088', '0.464477']
         : correct/total = [(6959, 14232), (6926, 14235), (6933, 14266), (7164, 14217), (7025, 14238), (6788, 14373), (7073, 14346), (6906, 14334), (7088, 14294), (7179, 14373), (7177, 14344), (6744, 14302), (7209, 14354), (7292, 14362), (6816, 14320), (7184, 14395), (6876, 14389), (7121, 14257), (6970, 14251), (6688, 14399)]
         : compromised: 0.4954, honest: 0.4880
Round 004: test acc mean=0.5103 ± 0.0047 | min=0.4996 max=0.5189
         : test loss mean=1.0167 ± 0.2053
         : individual accs = ['0.513491', '0.508465', '0.506239', '0.505451', '0.513064', '0.509149', '0.512756', '0.511232', '0.501749', '0.504418', '0.499582', '0.514334', '0.511077', '0.518939', '0.514665', '0.515943', '0.511015', '0.509855', '0.513789', '0.509966']
         : correct/total = [(7308, 14232), (7238, 14235), (7222, 14266), (7186, 14217), (7305, 14238), (7318, 14373), (7356, 14346), (7328, 14334), (7172, 14294), (7250, 14373), (7166, 14344), (7356, 14302), (7336, 14354), (7453, 14362), (7370, 14320), (7427, 14395), (7353, 14389), (7269, 14257), (7322, 14251), (7343, 14399)]
         : compromised: 0.5123, honest: 0.5098
Round 005: test acc mean=0.5057 ± 0.0069 | min=0.4942 max=0.5165
         : test loss mean=0.7933 ± 0.0961
         : individual accs = ['0.514123', '0.516263', '0.511496', '0.495252', '0.507375', '0.503444', '0.508992', '0.509976', '0.505177', '0.496556', '0.513037', '0.504894', '0.496795', '0.494221', '0.502025', '0.499201', '0.509834', '0.499474', '0.516525', '0.509480']
         : correct/total = [(7317, 14232), (7349, 14235), (7297, 14266), (7041, 14217), (7224, 14238), (7236, 14373), (7302, 14346), (7310, 14334), (7221, 14294), (7137, 14373), (7359, 14344), (7221, 14302), (7131, 14354), (7098, 14362), (7189, 14320), (7186, 14395), (7336, 14389), (7121, 14257), (7361, 14251), (7336, 14399)]
         : compromised: 0.4985, honest: 0.5075
Round 006: test acc mean=0.4984 ± 0.0051 | min=0.4873 max=0.5091
         : test loss mean=1.1354 ± 0.1583
         : individual accs = ['0.492622', '0.489638', '0.487312', '0.501161', '0.499860', '0.499687', '0.498048', '0.500419', '0.494123', '0.494886', '0.503137', '0.497832', '0.500000', '0.509121', '0.497486', '0.500035', '0.502606', '0.505155', '0.492878', '0.501702']
         : correct/total = [(7011, 14232), (6970, 14235), (6952, 14266), (7125, 14217), (7117, 14238), (7182, 14373), (7145, 14346), (7173, 14334), (7063, 14294), (7113, 14373), (7217, 14344), (7120, 14302), (7177, 14354), (7312, 14362), (7124, 14320), (7198, 14395), (7232, 14389), (7202, 14257), (7024, 14251), (7224, 14399)]
         : compromised: 0.5035, honest: 0.4971
Round 007: test acc mean=0.4938 ± 0.0048 | min=0.4848 max=0.5036
         : test loss mean=0.7986 ± 0.0692
         : individual accs = ['0.487282', '0.490551', '0.484789', '0.492228', '0.498525', '0.489390', '0.497072', '0.495117', '0.487687', '0.498017', '0.491216', '0.492169', '0.499303', '0.495544', '0.492737', '0.499132', '0.497950', '0.503612', '0.489299', '0.494757']
         : correct/total = [(6935, 14232), (6983, 14235), (6916, 14266), (6998, 14217), (7098, 14238), (7034, 14373), (7131, 14346), (7097, 14334), (6971, 14294), (7158, 14373), (7046, 14344), (7039, 14302), (7167, 14354), (7117, 14362), (7056, 14320), (7185, 14395), (7165, 14389), (7180, 14257), (6973, 14251), (7124, 14399)]
         : compromised: 0.4970, honest: 0.4930
Round 008: test acc mean=0.5057 ± 0.0083 | min=0.4948 max=0.5227
         : test loss mean=0.9363 ± 0.2310
         : individual accs = ['0.512858', '0.516473', '0.505117', '0.496940', '0.514890', '0.499409', '0.496654', '0.514162', '0.503778', '0.503374', '0.496235', '0.522654', '0.501881', '0.494778', '0.495321', '0.510177', '0.512405', '0.504314', '0.515332', '0.497465']
         : correct/total = [(7299, 14232), (7352, 14235), (7206, 14266), (7065, 14217), (7331, 14238), (7178, 14373), (7125, 14346), (7370, 14334), (7201, 14294), (7235, 14373), (7118, 14344), (7475, 14302), (7204, 14354), (7106, 14362), (7093, 14320), (7344, 14395), (7373, 14389), (7190, 14257), (7344, 14251), (7163, 14399)]
         : compromised: 0.5001, honest: 0.5071
Round 009: test acc mean=0.4949 ± 0.0100 | min=0.4773 max=0.5197
         : test loss mean=0.7696 ± 0.0579
         : individual accs = ['0.504075', '0.498419', '0.503855', '0.498136', '0.504706', '0.477284', '0.493378', '0.485977', '0.488247', '0.519655', '0.491076', '0.496364', '0.495611', '0.493176', '0.477444', '0.498159', '0.487942', '0.503191', '0.499333', '0.481492']
         : correct/total = [(7174, 14232), (7095, 14235), (7188, 14266), (7082, 14217), (7186, 14238), (6860, 14373), (7078, 14346), (6966, 14334), (6979, 14294), (7469, 14373), (7044, 14344), (7099, 14302), (7114, 14354), (7083, 14362), (6837, 14320), (7171, 14395), (7021, 14389), (7174, 14257), (7116, 14251), (6933, 14399)]
         : compromised: 0.4923, honest: 0.4955
Round 010: test acc mean=0.5021 ± 0.0090 | min=0.4887 max=0.5244
         : test loss mean=1.2583 ± 0.6352
         : individual accs = ['0.499649', '0.497436', '0.510585', '0.519027', '0.506110', '0.491268', '0.494981', '0.497000', '0.488667', '0.507062', '0.500697', '0.495036', '0.512958', '0.524439', '0.494274', '0.506634', '0.498575', '0.504033', '0.497719', '0.495937']
         : correct/total = [(7111, 14232), (7081, 14235), (7284, 14266), (7379, 14217), (7206, 14238), (7061, 14373), (7101, 14346), (7124, 14334), (6985, 14294), (7288, 14373), (7182, 14344), (7080, 14302), (7363, 14354), (7532, 14362), (7078, 14320), (7293, 14395), (7174, 14389), (7186, 14257), (7093, 14251), (7141, 14399)]
         : compromised: 0.5082, honest: 0.5006

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: d-fedavg
Attack: backdoor, 20.0% compromised
Final accuracy - Compromised: 0.5082, Honest: 0.5006
Overall test accuracy: mean=0.5021 ± 0.0090

=== BACKDOOR ATTACK SUCCESS RATE (ASR) ===
Target label: 1
Trigger size: 3x3
Overall ASR: 0.8409 ± 0.2203
Honest nodes ASR: 0.8362 ± 0.2429
Compromised nodes ASR: 0.8601 ± 0.0792
Note: Higher ASR indicates more successful backdoor attack
