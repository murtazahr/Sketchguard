Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
Degree statistics: avg=4.80, min=2, max=7
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5109 ± 0.0212 | min=0.4888 max=0.5686
         : test loss mean=1.2756 ± 0.7034
         : individual accs = ['0.488758', '0.568599', '0.512898', '0.501020', '0.494943', '0.498156', '0.495121', '0.498674', '0.511893', '0.547137', '0.501394', '0.491400', '0.506688', '0.513995', '0.490712', '0.524488', '0.503232', '0.493372', '0.535892', '0.540524']
         : correct/total = [(6956, 14232), (8094, 14235), (7317, 14266), (7123, 14217), (7047, 14238), (7160, 14373), (7103, 14346), (7148, 14334), (7317, 14294), (7864, 14373), (7192, 14344), (7028, 14302), (7273, 14354), (7382, 14362), (7027, 14320), (7550, 14395), (7241, 14389), (7034, 14257), (7637, 14251), (7783, 14399)]
         : compromised: 0.5065, honest: 0.5129
Round 002: test acc mean=0.5072 ± 0.0153 | min=0.4853 max=0.5507
         : test loss mean=0.7410 ± 0.1289
         : individual accs = ['0.511945', '0.519073', '0.518085', '0.550749', '0.486936', '0.490155', '0.493866', '0.487163', '0.518469', '0.493286', '0.508924', '0.508390', '0.515257', '0.513995', '0.500698', '0.518722', '0.499062', '0.514975', '0.485299', '0.508924']
         : correct/total = [(7286, 14232), (7389, 14235), (7391, 14266), (7830, 14217), (6933, 14238), (7045, 14373), (7085, 14346), (6983, 14334), (7411, 14294), (7090, 14373), (7300, 14344), (7271, 14302), (7396, 14354), (7382, 14362), (7170, 14320), (7467, 14395), (7181, 14389), (7342, 14257), (6916, 14251), (7328, 14399)]
         : compromised: 0.5034, honest: 0.5088
Round 003: test acc mean=0.5203 ± 0.0199 | min=0.4895 max=0.5655
         : test loss mean=0.6937 ± 0.0078
         : individual accs = ['0.520939', '0.518019', '0.539885', '0.519871', '0.520860', '0.494608', '0.501185', '0.515697', '0.525395', '0.516107', '0.544409', '0.523144', '0.501115', '0.537669', '0.496788', '0.557068', '0.507401', '0.510907', '0.489510', '0.565456']
         : correct/total = [(7414, 14232), (7374, 14235), (7702, 14266), (7391, 14217), (7416, 14238), (7109, 14373), (7190, 14346), (7392, 14334), (7510, 14294), (7418, 14373), (7809, 14344), (7482, 14302), (7193, 14354), (7722, 14362), (7114, 14320), (8019, 14395), (7301, 14389), (7284, 14257), (6976, 14251), (8142, 14399)]
         : compromised: 0.5051, honest: 0.5268
Round 004: test acc mean=0.5413 ± 0.0306 | min=0.4901 max=0.5866
         : test loss mean=0.6891 ± 0.0043
         : individual accs = ['0.567313', '0.547172', '0.575915', '0.583738', '0.545442', '0.498017', '0.499233', '0.549742', '0.545544', '0.569262', '0.559398', '0.517130', '0.501951', '0.562665', '0.528003', '0.568809', '0.531031', '0.498352', '0.490071', '0.586638']
         : correct/total = [(8074, 14232), (7789, 14235), (8216, 14266), (8299, 14217), (7766, 14238), (7158, 14373), (7162, 14346), (7880, 14334), (7798, 14294), (8182, 14373), (8024, 14344), (7396, 14302), (7205, 14354), (8081, 14362), (7561, 14320), (8188, 14395), (7641, 14389), (7105, 14257), (6984, 14251), (8447, 14399)]
         : compromised: 0.5132, honest: 0.5533
Round 005: test acc mean=0.5590 ± 0.0303 | min=0.4892 max=0.6005
         : test loss mean=0.6864 ± 0.0046
         : individual accs = ['0.581085', '0.550474', '0.549628', '0.600478', '0.592920', '0.512837', '0.523282', '0.585391', '0.572688', '0.536840', '0.523703', '0.590896', '0.559287', '0.588358', '0.560894', '0.578256', '0.573077', '0.528162', '0.489159', '0.583374']
         : correct/total = [(8270, 14232), (7836, 14235), (7841, 14266), (8537, 14217), (8442, 14238), (7371, 14373), (7507, 14346), (8391, 14334), (8186, 14294), (7716, 14373), (7512, 14344), (8451, 14302), (8028, 14354), (8450, 14362), (8032, 14320), (8324, 14395), (8246, 14389), (7530, 14257), (6971, 14251), (8400, 14399)]
         : compromised: 0.5398, honest: 0.5673
Round 006: test acc mean=0.5672 ± 0.0311 | min=0.4922 max=0.6072
         : test loss mean=0.6839 ± 0.0058
         : individual accs = ['0.566540', '0.543098', '0.575004', '0.602377', '0.604579', '0.534544', '0.525024', '0.599833', '0.589828', '0.561469', '0.566230', '0.598308', '0.559914', '0.589403', '0.523254', '0.607155', '0.552227', '0.560286', '0.492246', '0.592263']
         : correct/total = [(8063, 14232), (7731, 14235), (8203, 14266), (8564, 14217), (8608, 14238), (7683, 14373), (7532, 14346), (8598, 14334), (8431, 14294), (8070, 14373), (8122, 14344), (8557, 14302), (8037, 14354), (8465, 14362), (7493, 14320), (8740, 14395), (7946, 14389), (7988, 14257), (7015, 14251), (8528, 14399)]
         : compromised: 0.5433, honest: 0.5774
Round 007: test acc mean=0.5849 ± 0.0219 | min=0.5372 max=0.6123
         : test loss mean=0.6797 ± 0.0070
         : individual accs = ['0.572583', '0.560309', '0.572480', '0.601533', '0.612305', '0.593335', '0.537153', '0.607088', '0.603820', '0.582064', '0.583101', '0.599007', '0.546677', '0.601727', '0.554399', '0.609726', '0.577594', '0.576699', '0.593362', '0.612056']
         : correct/total = [(8149, 14232), (7976, 14235), (8167, 14266), (8552, 14217), (8718, 14238), (8528, 14373), (7706, 14346), (8702, 14334), (8631, 14294), (8366, 14373), (8364, 14344), (8567, 14302), (7847, 14354), (8642, 14362), (7939, 14320), (8777, 14395), (8311, 14389), (8222, 14257), (8456, 14251), (8813, 14399)]
         : compromised: 0.5777, honest: 0.5879
Round 008: test acc mean=0.5993 ± 0.0157 | min=0.5653 max=0.6195
         : test loss mean=0.6737 ± 0.0075
         : individual accs = ['0.577220', '0.587215', '0.565330', '0.611170', '0.615325', '0.604954', '0.570751', '0.616018', '0.611935', '0.594030', '0.615867', '0.599007', '0.592169', '0.615652', '0.595112', '0.615908', '0.591424', '0.596268', '0.591257', '0.619487']
         : correct/total = [(8215, 14232), (8359, 14235), (8065, 14266), (8689, 14217), (8761, 14238), (8695, 14373), (8188, 14346), (8830, 14334), (8747, 14294), (8538, 14373), (8834, 14344), (8567, 14302), (8500, 14354), (8842, 14362), (8522, 14320), (8866, 14395), (8510, 14389), (8501, 14257), (8426, 14251), (8920, 14399)]
         : compromised: 0.5992, honest: 0.5993
Round 009: test acc mean=0.6138 ± 0.0072 | min=0.6004 max=0.6277
         : test loss mean=0.6649 ± 0.0064
         : individual accs = ['0.609401', '0.612013', '0.614398', '0.616023', '0.617924', '0.627705', '0.611320', '0.619087', '0.617322', '0.616503', '0.611963', '0.608936', '0.602898', '0.621014', '0.600419', '0.622855', '0.602474', '0.614435', '0.605431', '0.622960']
         : correct/total = [(8673, 14232), (8712, 14235), (8765, 14266), (8758, 14217), (8798, 14238), (9022, 14373), (8770, 14346), (8874, 14334), (8824, 14294), (8861, 14373), (8778, 14344), (8709, 14302), (8654, 14354), (8919, 14362), (8598, 14320), (8966, 14395), (8669, 14389), (8760, 14257), (8628, 14251), (8970, 14399)]
         : compromised: 0.6120, honest: 0.6145
Round 010: test acc mean=0.6210 ± 0.0053 | min=0.6072 max=0.6287
         : test loss mean=0.6561 ± 0.0047
         : individual accs = ['0.615585', '0.624658', '0.621968', '0.620806', '0.623753', '0.628748', '0.622822', '0.625924', '0.615923', '0.626661', '0.626673', '0.617047', '0.619827', '0.624495', '0.616550', '0.624175', '0.613316', '0.618223', '0.607185', '0.625530']
         : correct/total = [(8761, 14232), (8892, 14235), (8873, 14266), (8826, 14217), (8881, 14238), (9037, 14373), (8935, 14346), (8972, 14334), (8804, 14294), (9007, 14373), (8989, 14344), (8825, 14302), (8897, 14354), (8969, 14362), (8829, 14320), (8985, 14395), (8825, 14389), (8814, 14257), (8653, 14251), (9007, 14399)]
         : compromised: 0.6192, honest: 0.6218

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: krum, 30.0% compromised
Final accuracy - Compromised: 0.6192, Honest: 0.6218
Overall test accuracy: mean=0.6210 ± 0.0053

=== BALANCE SUMMARY ===
Node 0: acceptance=0.850
Node 1: acceptance=1.000
Node 2: acceptance=0.640
Node 3: acceptance=0.775
Node 4: acceptance=0.550
Node 5: acceptance=0.460
Node 6: acceptance=0.820
Node 7: acceptance=0.640
Node 8: acceptance=0.600
Node 9: acceptance=1.000
Node 10: acceptance=0.775
Node 11: acceptance=0.614
Node 12: acceptance=0.743
Node 13: acceptance=0.775
Node 14: acceptance=0.486
Node 15: acceptance=0.550
Node 16: acceptance=0.460
Node 17: acceptance=0.640
Node 18: acceptance=0.900
Node 19: acceptance=1.000

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.035s (73.5%)
    - Aggregation: 0.013s (26.5%)
  TOTALS:
    - Total computation: 0.048s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.048s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.023s
  - Aggregation: 0.006s
  - Model transfer: 0.000s
  - Total per node: 0.029s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 0.469s
  - Total aggregation: 0.120s
  - Total model transfer: 0.000s
  - Grand total: 0.589s
  - Mean acceptance rate: 0.714

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
