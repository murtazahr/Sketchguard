Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5174 ± 0.0206 | min=0.4901 max=0.5559
         : test loss mean=1.1345 ± 0.5924
         : individual accs = ['0.511031', '0.553495', '0.515211', '0.554407', '0.507796', '0.509288', '0.503206', '0.526441', '0.518679', '0.540110', '0.498048', '0.499371', '0.494845', '0.509957', '0.505447', '0.540396', '0.492182', '0.521218', '0.490071', '0.555941']
         : correct/total = [(7273, 14232), (7879, 14235), (7350, 14266), (7882, 14217), (7230, 14238), (7320, 14373), (7219, 14346), (7546, 14334), (7414, 14294), (7763, 14373), (7144, 14344), (7142, 14302), (7103, 14354), (7324, 14362), (7238, 14320), (7779, 14395), (7082, 14389), (7431, 14257), (6984, 14251), (8005, 14399)]
         : compromised: 0.5088, honest: 0.5195
Round 002: test acc mean=0.5014 ± 0.0158 | min=0.4858 max=0.5580
         : test loss mean=1.0248 ± 0.4826
         : individual accs = ['0.491849', '0.507903', '0.487312', '0.512696', '0.500632', '0.507479', '0.501534', '0.498674', '0.488737', '0.498852', '0.498466', '0.496084', '0.490247', '0.487954', '0.506634', '0.519278', '0.502120', '0.485796', '0.487404', '0.558025']
         : correct/total = [(7000, 14232), (7230, 14235), (6952, 14266), (7289, 14217), (7128, 14238), (7294, 14373), (7195, 14346), (7148, 14334), (6986, 14294), (7170, 14373), (7150, 14344), (7095, 14302), (7037, 14354), (7008, 14362), (7255, 14320), (7475, 14395), (7225, 14389), (6926, 14257), (6946, 14251), (8035, 14399)]
         : compromised: 0.4929, honest: 0.5035
Round 003: test acc mean=0.5121 ± 0.0149 | min=0.4861 max=0.5371
         : test loss mean=0.7111 ± 0.0217
         : individual accs = ['0.495363', '0.486336', '0.486121', '0.528241', '0.510605', '0.523482', '0.519587', '0.503070', '0.488317', '0.528908', '0.511712', '0.521675', '0.507454', '0.520123', '0.526327', '0.502952', '0.515324', '0.502069', '0.527963', '0.537121']
         : correct/total = [(7050, 14232), (6923, 14235), (6935, 14266), (7510, 14217), (7270, 14238), (7524, 14373), (7454, 14346), (7211, 14334), (6980, 14294), (7602, 14373), (7340, 14344), (7461, 14302), (7284, 14354), (7470, 14362), (7537, 14320), (7240, 14395), (7415, 14389), (7158, 14257), (7524, 14251), (7734, 14399)]
         : compromised: 0.5133, honest: 0.5119
Round 004: test acc mean=0.5508 ± 0.0224 | min=0.4869 max=0.5834
         : test loss mean=0.6871 ± 0.0064
         : individual accs = ['0.550660', '0.486898', '0.558110', '0.567701', '0.547689', '0.536770', '0.571867', '0.577717', '0.538058', '0.511097', '0.568182', '0.556566', '0.544587', '0.558140', '0.544972', '0.544772', '0.557648', '0.533983', '0.576240', '0.583443']
         : correct/total = [(7837, 14232), (6931, 14235), (7962, 14266), (8071, 14217), (7798, 14238), (7715, 14373), (8204, 14346), (8281, 14334), (7691, 14294), (7346, 14373), (8150, 14344), (7960, 14302), (7817, 14354), (8016, 14362), (7804, 14320), (7842, 14395), (8024, 14389), (7613, 14257), (8212, 14251), (8401, 14399)]
         : compromised: 0.5434, honest: 0.5526
Round 005: test acc mean=0.5668 ± 0.0258 | min=0.4863 max=0.6012
         : test loss mean=0.6804 ± 0.0083
         : individual accs = ['0.585441', '0.486266', '0.556568', '0.582472', '0.578101', '0.544980', '0.597867', '0.593065', '0.555828', '0.532665', '0.582822', '0.577472', '0.564233', '0.560577', '0.563547', '0.566169', '0.566961', '0.547380', '0.591888', '0.601222']
         : correct/total = [(8332, 14232), (6922, 14235), (7940, 14266), (8281, 14217), (8231, 14238), (7833, 14373), (8577, 14346), (8501, 14334), (7945, 14294), (7656, 14373), (8360, 14344), (8259, 14302), (8099, 14354), (8051, 14362), (8070, 14320), (8150, 14395), (8158, 14389), (7804, 14257), (8435, 14251), (8657, 14399)]
         : compromised: 0.5543, honest: 0.5699
Round 006: test acc mean=0.5821 ± 0.0255 | min=0.4896 max=0.6083
         : test loss mean=0.6745 ± 0.0098
         : individual accs = ['0.590852', '0.489638', '0.584326', '0.594148', '0.595027', '0.562096', '0.607277', '0.599763', '0.591857', '0.581090', '0.595092', '0.598518', '0.588965', '0.566356', '0.571439', '0.573255', '0.574953', '0.563092', '0.606414', '0.608306']
         : correct/total = [(8409, 14232), (6970, 14235), (8336, 14266), (8447, 14217), (8472, 14238), (8079, 14373), (8712, 14346), (8597, 14334), (8460, 14294), (8352, 14373), (8536, 14344), (8560, 14302), (8454, 14354), (8134, 14362), (8183, 14320), (8252, 14395), (8273, 14389), (8028, 14257), (8642, 14251), (8759, 14399)]
         : compromised: 0.5701, honest: 0.5851
Round 007: test acc mean=0.5930 ± 0.0200 | min=0.5300 max=0.6199
         : test loss mean=0.6686 ± 0.0103
         : individual accs = ['0.604694', '0.530032', '0.588953', '0.603995', '0.606686', '0.570236', '0.610553', '0.605972', '0.589828', '0.594448', '0.606316', '0.608866', '0.600808', '0.581256', '0.583659', '0.578117', '0.580165', '0.579435', '0.619886', '0.616362']
         : correct/total = [(8606, 14232), (7545, 14235), (8402, 14266), (8587, 14217), (8638, 14238), (8196, 14373), (8759, 14346), (8686, 14334), (8431, 14294), (8544, 14373), (8697, 14344), (8708, 14302), (8624, 14354), (8348, 14362), (8358, 14320), (8322, 14395), (8348, 14389), (8261, 14257), (8834, 14251), (8875, 14399)]
         : compromised: 0.5829, honest: 0.5955
Round 008: test acc mean=0.6033 ± 0.0175 | min=0.5460 max=0.6269
         : test loss mean=0.6615 ± 0.0101
         : individual accs = ['0.608488', '0.545978', '0.589654', '0.613491', '0.611603', '0.599179', '0.618848', '0.613716', '0.602071', '0.608711', '0.610987', '0.619284', '0.611676', '0.587732', '0.588617', '0.590622', '0.589965', '0.608964', '0.626903', '0.619349']
         : correct/total = [(8660, 14232), (7772, 14235), (8412, 14266), (8722, 14217), (8708, 14238), (8612, 14373), (8878, 14346), (8797, 14334), (8606, 14294), (8749, 14373), (8764, 14344), (8857, 14302), (8780, 14354), (8441, 14362), (8429, 14320), (8502, 14395), (8489, 14389), (8682, 14257), (8934, 14251), (8918, 14399)]
         : compromised: 0.6019, honest: 0.6036
Round 009: test acc mean=0.6141 ± 0.0115 | min=0.5925 max=0.6270
         : test loss mean=0.6554 ± 0.0096
         : individual accs = ['0.615725', '0.614050', '0.610262', '0.622776', '0.619258', '0.625409', '0.624983', '0.618250', '0.605849', '0.614625', '0.619283', '0.627045', '0.620594', '0.592745', '0.592458', '0.595346', '0.594829', '0.615487', '0.626974', '0.626432']
         : correct/total = [(8763, 14232), (8741, 14235), (8706, 14266), (8854, 14217), (8817, 14238), (8989, 14373), (8966, 14346), (8862, 14334), (8660, 14294), (8834, 14373), (8883, 14344), (8968, 14302), (8908, 14354), (8513, 14362), (8484, 14320), (8570, 14395), (8559, 14389), (8775, 14257), (8935, 14251), (9020, 14399)]
         : compromised: 0.6136, honest: 0.6143
Round 010: test acc mean=0.6205 ± 0.0115 | min=0.5971 max=0.6328
         : test loss mean=0.6501 ± 0.0090
         : individual accs = ['0.621908', '0.618265', '0.619515', '0.631216', '0.630496', '0.632784', '0.628259', '0.622506', '0.620050', '0.621791', '0.621933', '0.627605', '0.629581', '0.598036', '0.597067', '0.599931', '0.601988', '0.627060', '0.630482', '0.630113']
         : correct/total = [(8851, 14232), (8801, 14235), (8838, 14266), (8974, 14217), (8977, 14238), (9095, 14373), (9013, 14346), (8923, 14334), (8863, 14294), (8937, 14373), (8921, 14344), (8976, 14302), (9037, 14354), (8589, 14362), (8550, 14320), (8636, 14395), (8662, 14389), (8940, 14257), (8985, 14251), (9073, 14399)]
         : compromised: 0.6219, honest: 0.6202

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: balance
Attack: directed_deviation, 20.0% compromised
Final accuracy - Compromised: 0.6219, Honest: 0.6202
Overall test accuracy: mean=0.6205 ± 0.0115

=== BALANCE SUMMARY ===
Node 0: acceptance=1.000
Node 1: acceptance=1.000
Node 2: acceptance=1.000
Node 3: acceptance=1.000
Node 4: acceptance=0.600
Node 5: acceptance=0.800
Node 6: acceptance=0.600
Node 7: acceptance=1.000
Node 8: acceptance=1.000
Node 9: acceptance=1.000
Node 10: acceptance=1.000
Node 11: acceptance=0.600
Node 12: acceptance=0.550
Node 13: acceptance=0.550
Node 14: acceptance=0.600
Node 15: acceptance=1.000
Node 16: acceptance=0.600
Node 17: acceptance=0.800
Node 18: acceptance=0.600
Node 19: acceptance=1.000

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.026s (67.5%)
    - Aggregation: 0.012s (32.5%)
  TOTALS:
    - Total computation: 0.038s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.038s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.013s
  - Aggregation: 0.005s
  - Model transfer: 0.000s
  - Total per node: 0.018s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 0.251s
  - Total aggregation: 0.105s
  - Total model transfer: 0.000s
  - Grand total: 0.356s
  - Mean acceptance rate: 0.815

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
