Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Degree statistics: avg=19.00, min=19, max=19
Attack: Compromised 14/20 nodes: [1, 2, 3, 5, 6, 8, 11, 12, 13, 14, 15, 17, 18, 19]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5015 ± 0.0108 | min=0.4758 max=0.5172
         : test loss mean=2.8626 ± 0.9716
         : individual accs = ['0.503302', '0.517176', '0.509954', '0.499261', '0.509973', '0.511723', '0.494214', '0.504744', '0.512942', '0.492660', '0.512479', '0.500839', '0.475826', '0.479390', '0.503980', '0.496700', '0.513309', '0.492600', '0.502561', '0.496007']
         : correct/total = [(7163, 14232), (7362, 14235), (7275, 14266), (7098, 14217), (7261, 14238), (7355, 14373), (7090, 14346), (7235, 14334), (7332, 14294), (7081, 14373), (7351, 14344), (7163, 14302), (6830, 14354), (6885, 14362), (7217, 14320), (7150, 14395), (7386, 14389), (7023, 14257), (7162, 14251), (7142, 14399)]
         : compromised: 0.4995, honest: 0.5061
Round 002: test acc mean=0.5065 ± 0.0111 | min=0.4880 max=0.5328
         : test loss mean=0.7050 ± 0.0139
         : individual accs = ['0.508783', '0.487952', '0.519627', '0.530492', '0.498455', '0.505601', '0.500279', '0.506069', '0.499510', '0.516524', '0.500697', '0.505384', '0.503623', '0.491854', '0.514944', '0.501563', '0.498784', '0.504875', '0.532805', '0.501424']
         : correct/total = [(7241, 14232), (6946, 14235), (7413, 14266), (7542, 14217), (7097, 14238), (7267, 14373), (7177, 14346), (7254, 14334), (7140, 14294), (7424, 14373), (7182, 14344), (7228, 14302), (7229, 14354), (7064, 14362), (7374, 14320), (7220, 14395), (7177, 14389), (7198, 14257), (7593, 14251), (7220, 14399)]
         : compromised: 0.5071, honest: 0.5049
Round 003: test acc mean=0.5083 ± 0.0102 | min=0.4832 max=0.5310
         : test loss mean=0.7080 ± 0.0171
         : individual accs = ['0.516793', '0.522304', '0.510515', '0.512344', '0.517418', '0.500522', '0.501534', '0.505232', '0.502728', '0.502331', '0.502091', '0.508740', '0.499791', '0.530985', '0.520112', '0.516916', '0.507262', '0.501929', '0.503473', '0.483159']
         : correct/total = [(7355, 14232), (7435, 14235), (7283, 14266), (7284, 14217), (7367, 14238), (7194, 14373), (7195, 14346), (7242, 14334), (7186, 14294), (7220, 14373), (7202, 14344), (7276, 14302), (7174, 14354), (7626, 14362), (7448, 14320), (7441, 14395), (7299, 14389), (7156, 14257), (7175, 14251), (6957, 14399)]
         : compromised: 0.5082, honest: 0.5085
Round 004: test acc mean=0.5517 ± 0.0173 | min=0.5131 max=0.5779
         : test loss mean=0.6846 ± 0.0047
         : individual accs = ['0.568508', '0.534457', '0.541077', '0.577900', '0.575151', '0.566548', '0.536177', '0.562090', '0.536029', '0.563905', '0.565393', '0.513145', '0.567507', '0.541638', '0.542668', '0.553595', '0.567864', '0.550186', '0.526279', '0.544413']
         : correct/total = [(8091, 14232), (7608, 14235), (7719, 14266), (8216, 14217), (8189, 14238), (8143, 14373), (7692, 14346), (8057, 14334), (7662, 14294), (8105, 14373), (8110, 14344), (7339, 14302), (8146, 14354), (7779, 14362), (7771, 14320), (7969, 14395), (8171, 14389), (7844, 14257), (7500, 14251), (7839, 14399)]
         : compromised: 0.5451, honest: 0.5672
Round 005: test acc mean=0.6061 ± 0.0128 | min=0.5804 max=0.6230
         : test loss mean=0.6615 ± 0.0060
         : individual accs = ['0.614741', '0.608711', '0.580401', '0.606457', '0.616941', '0.611563', '0.613133', '0.613925', '0.610886', '0.608085', '0.612800', '0.615578', '0.589801', '0.618925', '0.582193', '0.592497', '0.604837', '0.614575', '0.582415', '0.622960']
         : correct/total = [(8749, 14232), (8665, 14235), (8280, 14266), (8622, 14217), (8784, 14238), (8790, 14373), (8796, 14346), (8800, 14334), (8732, 14294), (8740, 14373), (8790, 14344), (8804, 14302), (8466, 14354), (8889, 14362), (8337, 14320), (8529, 14395), (8703, 14389), (8762, 14257), (8300, 14251), (8970, 14399)]
         : compromised: 0.6036, honest: 0.6119
Round 006: test acc mean=0.6270 ± 0.0076 | min=0.6088 max=0.6380
         : test loss mean=0.6430 ± 0.0046
         : individual accs = ['0.623806', '0.636108', '0.619305', '0.608849', '0.629021', '0.630209', '0.622891', '0.629971', '0.620610', '0.630349', '0.630926', '0.638023', '0.633343', '0.631110', '0.632542', '0.617784', '0.615748', '0.633794', '0.621711', '0.634558']
         : correct/total = [(8878, 14232), (9055, 14235), (8835, 14266), (8656, 14217), (8956, 14238), (9058, 14373), (8936, 14346), (9030, 14334), (8871, 14294), (9060, 14373), (9050, 14344), (9125, 14302), (9091, 14354), (9064, 14362), (9058, 14320), (8893, 14395), (8860, 14389), (9036, 14257), (8860, 14251), (9137, 14399)]
         : compromised: 0.6272, honest: 0.6266
Round 007: test acc mean=0.6459 ± 0.0052 | min=0.6327 max=0.6534
         : test loss mean=0.6278 ± 0.0047
         : individual accs = ['0.644885', '0.651142', '0.636619', '0.643174', '0.645667', '0.651778', '0.643315', '0.642807', '0.647405', '0.651847', '0.641732', '0.644385', '0.650829', '0.643016', '0.646159', '0.648003', '0.652304', '0.646980', '0.632728', '0.653448']
         : correct/total = [(9178, 14232), (9269, 14235), (9082, 14266), (9144, 14217), (9193, 14238), (9368, 14373), (9229, 14346), (9214, 14334), (9254, 14294), (9369, 14373), (9205, 14344), (9216, 14302), (9342, 14354), (9235, 14362), (9253, 14320), (9328, 14395), (9386, 14389), (9224, 14257), (9017, 14251), (9409, 14399)]
         : compromised: 0.6456, honest: 0.6465
Round 008: test acc mean=0.6528 ± 0.0055 | min=0.6445 max=0.6621
         : test loss mean=0.6217 ± 0.0056
         : individual accs = ['0.650014', '0.652476', '0.645521', '0.649363', '0.645807', '0.655187', '0.654468', '0.655574', '0.658808', '0.659222', '0.653862', '0.644665', '0.644489', '0.658961', '0.657193', '0.658284', '0.649037', '0.655678', '0.644937', '0.662129']
         : correct/total = [(9251, 14232), (9288, 14235), (9209, 14266), (9232, 14217), (9195, 14238), (9417, 14373), (9389, 14346), (9397, 14334), (9417, 14294), (9475, 14373), (9379, 14344), (9220, 14302), (9251, 14354), (9464, 14362), (9411, 14320), (9476, 14395), (9339, 14389), (9348, 14257), (9191, 14251), (9534, 14399)]
         : compromised: 0.6530, honest: 0.6523
Round 009: test acc mean=0.6555 ± 0.0076 | min=0.6359 max=0.6663
         : test loss mean=0.6175 ± 0.0060
         : individual accs = ['0.641582', '0.664138', '0.653722', '0.651544', '0.655780', '0.665414', '0.635857', '0.647272', '0.658738', '0.660683', '0.650725', '0.654873', '0.651595', '0.666342', '0.655936', '0.661688', '0.662520', '0.656590', '0.653498', '0.661504']
         : correct/total = [(9131, 14232), (9454, 14235), (9326, 14266), (9263, 14217), (9337, 14238), (9564, 14373), (9122, 14346), (9278, 14334), (9416, 14294), (9496, 14373), (9334, 14344), (9366, 14302), (9353, 14354), (9570, 14362), (9393, 14320), (9525, 14395), (9533, 14389), (9361, 14257), (9313, 14251), (9525, 14399)]
         : compromised: 0.6565, honest: 0.6531
Round 010: test acc mean=0.6667 ± 0.0063 | min=0.6484 max=0.6747
         : test loss mean=0.6056 ± 0.0049
         : individual accs = ['0.665894', '0.670460', '0.657297', '0.659844', '0.669968', '0.674668', '0.669385', '0.671132', '0.668812', '0.668058', '0.664320', '0.668648', '0.673262', '0.672399', '0.667249', '0.657451', '0.670165', '0.671530', '0.648376', '0.665116']
         : correct/total = [(9477, 14232), (9544, 14235), (9377, 14266), (9381, 14217), (9539, 14238), (9697, 14373), (9603, 14346), (9620, 14334), (9560, 14294), (9602, 14373), (9529, 14344), (9563, 14302), (9664, 14354), (9657, 14362), (9555, 14320), (9464, 14395), (9643, 14389), (9574, 14257), (9240, 14251), (9577, 14399)]
         : compromised: 0.6660, honest: 0.6683

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: fully, Aggregation: balance
Attack: krum, 70.0% compromised
Final accuracy - Compromised: 0.6660, Honest: 0.6683
Overall test accuracy: mean=0.6667 ± 0.0063

=== BALANCE SUMMARY ===
Node 0: acceptance=0.337
Node 1: acceptance=0.384
Node 2: acceptance=0.384
Node 3: acceptance=0.384
Node 4: acceptance=0.337
Node 5: acceptance=0.384
Node 6: acceptance=0.384
Node 7: acceptance=0.337
Node 8: acceptance=0.384
Node 9: acceptance=0.337
Node 10: acceptance=0.337
Node 11: acceptance=0.384
Node 12: acceptance=0.384
Node 13: acceptance=0.384
Node 14: acceptance=0.384
Node 15: acceptance=0.384
Node 16: acceptance=0.337
Node 17: acceptance=0.384
Node 18: acceptance=0.384
Node 19: acceptance=0.384

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.076s (84.6%)
    - Aggregation: 0.014s (15.4%)
  TOTALS:
    - Total computation: 0.090s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.090s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.075s
  - Aggregation: 0.008s
  - Model transfer: 0.000s
  - Total per node: 0.083s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 1.495s
  - Total aggregation: 0.161s
  - Total model transfer: 0.000s
  - Grand total: 1.656s
  - Mean acceptance rate: 0.370

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
