Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: backdoor, lambda: 1.0
Backdoor target label: 1, trigger size: 3
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Backdoor attack: Created poisoned datasets for 2 compromised nodes
Round 001: test acc mean=0.6244 ± 0.0413 | min=0.4988 max=0.6506
         : test loss mean=3.5082 ± 8.6804
         : individual accs = ['0.650646', '0.644468', '0.649236', '0.630794', '0.635483', '0.498782', '0.649937', '0.639877', '0.636911', '0.619286', '0.613009', '0.643197', '0.641981', '0.509121', '0.632682', '0.636332', '0.637501', '0.632882', '0.636306', '0.649906']
         : correct/total = [(9260, 14232), (9174, 14235), (9262, 14266), (8968, 14217), (9048, 14238), (7169, 14373), (9324, 14346), (9172, 14334), (9104, 14294), (8901, 14373), (8793, 14344), (9199, 14302), (9215, 14354), (7312, 14362), (9060, 14320), (9160, 14395), (9173, 14389), (9023, 14257), (9068, 14251), (9358, 14399)]
         : compromised: 0.5040, honest: 0.6378
Round 002: test acc mean=0.6323 ± 0.0550 | min=0.4968 max=0.6743
         : test loss mean=3.4509 ± 6.7524
         : individual accs = ['0.654933', '0.635616', '0.630801', '0.674334', '0.669757', '0.512071', '0.503834', '0.659969', '0.633133', '0.641550', '0.663483', '0.656831', '0.663648', '0.496797', '0.653352', '0.658909', '0.658837', '0.660167', '0.654059', '0.664699']
         : correct/total = [(9321, 14232), (9048, 14235), (8999, 14266), (9587, 14217), (9536, 14238), (7360, 14373), (7228, 14346), (9460, 14334), (9050, 14294), (9221, 14373), (9517, 14344), (9394, 14302), (9526, 14354), (7135, 14362), (9356, 14320), (9485, 14395), (9480, 14389), (9412, 14257), (9321, 14251), (9571, 14399)]
         : compromised: 0.5044, honest: 0.6466
Round 003: test acc mean=0.6408 ± 0.0619 | min=0.4928 max=0.6797
         : test loss mean=1.9645 ± 3.9123
         : individual accs = ['0.649452', '0.679733', '0.677906', '0.662728', '0.667299', '0.498295', '0.492820', '0.654946', '0.671610', '0.666667', '0.667945', '0.679485', '0.672008', '0.493455', '0.674441', '0.666065', '0.672806', '0.660237', '0.661918', '0.645531']
         : correct/total = [(9243, 14232), (9676, 14235), (9671, 14266), (9422, 14217), (9501, 14238), (7162, 14373), (7070, 14346), (9388, 14334), (9600, 14294), (9582, 14373), (9581, 14344), (9718, 14302), (9646, 14354), (7087, 14362), (9658, 14320), (9588, 14395), (9681, 14389), (9413, 14257), (9433, 14251), (9295, 14399)]
         : compromised: 0.4959, honest: 0.6569
Round 004: test acc mean=0.6503 ± 0.0634 | min=0.5004 max=0.6890
         : test loss mean=1.9054 ± 3.3606
         : individual accs = ['0.688519', '0.678328', '0.684775', '0.689034', '0.684717', '0.501913', '0.500418', '0.655714', '0.684903', '0.661101', '0.664180', '0.660887', '0.685593', '0.501462', '0.679958', '0.669191', '0.680172', '0.678614', '0.667532', '0.688173']
         : correct/total = [(9799, 14232), (9656, 14235), (9769, 14266), (9796, 14217), (9749, 14238), (7214, 14373), (7179, 14346), (9399, 14334), (9790, 14294), (9502, 14373), (9527, 14344), (9452, 14302), (9841, 14354), (7202, 14362), (9737, 14320), (9633, 14395), (9787, 14389), (9675, 14257), (9513, 14251), (9909, 14399)]
         : compromised: 0.5017, honest: 0.6668
Round 005: test acc mean=0.6624 ± 0.0632 | min=0.4935 max=0.6989
         : test loss mean=1.3156 ± 2.6316
         : individual accs = ['0.696388', '0.694134', '0.694028', '0.684040', '0.698623', '0.493495', '0.540011', '0.669039', '0.697356', '0.650734', '0.679169', '0.695078', '0.697785', '0.512881', '0.683031', '0.683084', '0.697269', '0.698534', '0.683882', '0.698937']
         : correct/total = [(9911, 14232), (9881, 14235), (9901, 14266), (9725, 14217), (9947, 14238), (7093, 14373), (7747, 14346), (9590, 14334), (9968, 14294), (9353, 14373), (9742, 14344), (9941, 14302), (10016, 14354), (7366, 14362), (9781, 14320), (9833, 14395), (10033, 14389), (9959, 14257), (9746, 14251), (10064, 14399)]
         : compromised: 0.5032, honest: 0.6801
Round 006: test acc mean=0.6699 ± 0.0671 | min=0.4928 max=0.7106
         : test loss mean=2.9142 ± 6.9999
         : individual accs = ['0.695194', '0.706639', '0.692486', '0.707533', '0.710634', '0.492799', '0.536665', '0.691572', '0.702882', '0.698949', '0.686419', '0.690812', '0.699666', '0.506545', '0.700419', '0.707121', '0.700327', '0.693764', '0.678970', '0.698312']
         : correct/total = [(9894, 14232), (10059, 14235), (9879, 14266), (10059, 14217), (10118, 14238), (7083, 14373), (7699, 14346), (9913, 14334), (10047, 14294), (10046, 14373), (9846, 14344), (9880, 14302), (10043, 14354), (7275, 14362), (10030, 14320), (10179, 14395), (10077, 14389), (9891, 14257), (9676, 14251), (10055, 14399)]
         : compromised: 0.4997, honest: 0.6888
Round 007: test acc mean=0.6695 ± 0.0720 | min=0.4921 max=0.7082
         : test loss mean=1.8036 ± 3.3063
         : individual accs = ['0.706366', '0.708184', '0.689051', '0.706126', '0.705928', '0.506436', '0.499164', '0.683271', '0.703512', '0.701385', '0.707892', '0.706824', '0.703706', '0.492132', '0.702235', '0.686697', '0.701647', '0.693835', '0.684022', '0.701229']
         : correct/total = [(10053, 14232), (10081, 14235), (9830, 14266), (10039, 14217), (10051, 14238), (7279, 14373), (7161, 14346), (9794, 14334), (10056, 14294), (10081, 14373), (10154, 14344), (10109, 14302), (10101, 14354), (7068, 14362), (10056, 14320), (9885, 14395), (10096, 14389), (9892, 14257), (9748, 14251), (10097, 14399)]
         : compromised: 0.4993, honest: 0.6884
Round 008: test acc mean=0.6732 ± 0.0770 | min=0.4898 max=0.7180
         : test loss mean=1.6839 ± 3.4005
         : individual accs = ['0.709879', '0.712821', '0.674961', '0.716818', '0.696868', '0.493843', '0.492681', '0.703014', '0.712467', '0.713491', '0.699665', '0.704027', '0.676675', '0.489765', '0.712570', '0.709899', '0.717979', '0.717472', '0.691881', '0.716369']
         : correct/total = [(10103, 14232), (10147, 14235), (9629, 14266), (10191, 14217), (9922, 14238), (7098, 14373), (7068, 14346), (10077, 14334), (10184, 14294), (10255, 14373), (10036, 14344), (10069, 14302), (9713, 14354), (7034, 14362), (10204, 14320), (10219, 14395), (10331, 14389), (10229, 14257), (9860, 14251), (10315, 14399)]
         : compromised: 0.4918, honest: 0.6933
Round 009: test acc mean=0.6827 ± 0.0766 | min=0.4990 max=0.7292
         : test loss mean=1.4384 ± 2.3160
         : individual accs = ['0.703274', '0.729189', '0.720384', '0.714004', '0.724751', '0.501496', '0.502370', '0.723594', '0.714566', '0.702289', '0.709983', '0.712977', '0.712484', '0.499025', '0.711941', '0.705592', '0.719855', '0.715298', '0.709354', '0.720744']
         : correct/total = [(10009, 14232), (10380, 14235), (10277, 14266), (10151, 14217), (10319, 14238), (7208, 14373), (7207, 14346), (10372, 14334), (10214, 14294), (10094, 14373), (10184, 14344), (10197, 14302), (10227, 14354), (7167, 14362), (10195, 14320), (10157, 14395), (10358, 14389), (10198, 14257), (10109, 14251), (10378, 14399)]
         : compromised: 0.5003, honest: 0.7029
Round 010: test acc mean=0.6840 ± 0.0786 | min=0.4899 max=0.7326
         : test loss mean=1.4977 ± 2.5590
         : individual accs = ['0.713673', '0.720688', '0.710080', '0.722586', '0.732617', '0.489877', '0.500279', '0.724571', '0.718763', '0.701732', '0.719465', '0.707384', '0.721123', '0.502994', '0.712779', '0.724904', '0.704983', '0.715017', '0.719458', '0.716508']
         : correct/total = [(10157, 14232), (10259, 14235), (10130, 14266), (10273, 14217), (10431, 14238), (7041, 14373), (7177, 14346), (10386, 14334), (10274, 14294), (10086, 14373), (10320, 14344), (10117, 14302), (10351, 14354), (7224, 14362), (10207, 14320), (10435, 14395), (10144, 14389), (10194, 14257), (10253, 14251), (10317, 14399)]
         : compromised: 0.4964, honest: 0.7048

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: krum
Attack: backdoor, 10.0% compromised
Final accuracy - Compromised: 0.4964, Honest: 0.7048
Overall test accuracy: mean=0.6840 ± 0.0786

=== BACKDOOR ATTACK SUCCESS RATE (ASR) ===
Target label: 1
Trigger size: 3x3
Overall ASR: 0.5101 ± 0.1438
Honest nodes ASR: 0.4926 ± 0.1156
Compromised nodes ASR: 0.6676 ± 0.2429
Note: Higher ASR indicates more successful backdoor attack
