Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5071 ± 0.0108 | min=0.4860 max=0.5315
         : test loss mean=1.3227 ± 1.0358
         : individual accs = ['0.501897', '0.507130', '0.502383', '0.500035', '0.502669', '0.508384', '0.505716', '0.485977', '0.527564', '0.504905', '0.491007', '0.531534', '0.497492', '0.509121', '0.514316', '0.513720', '0.499409', '0.505646', '0.512736', '0.521217']
         : correct/total = [(7143, 14232), (7219, 14235), (7167, 14266), (7109, 14217), (7157, 14238), (7307, 14373), (7255, 14346), (6966, 14334), (7541, 14294), (7257, 14373), (7043, 14344), (7602, 14302), (7141, 14354), (7312, 14362), (7365, 14320), (7395, 14395), (7186, 14389), (7209, 14257), (7307, 14251), (7505, 14399)]
         : compromised: 0.5088, honest: 0.5070
Round 002: test acc mean=0.4983 ± 0.0077 | min=0.4860 max=0.5159
         : test loss mean=1.2361 ± 0.8743
         : individual accs = ['0.490655', '0.486196', '0.485981', '0.515861', '0.502599', '0.503305', '0.504670', '0.502232', '0.488457', '0.492938', '0.503277', '0.500769', '0.490107', '0.504944', '0.502304', '0.503300', '0.499757', '0.503542', '0.488808', '0.496284']
         : correct/total = [(6983, 14232), (6921, 14235), (6933, 14266), (7334, 14217), (7156, 14238), (7234, 14373), (7240, 14346), (7199, 14334), (6982, 14294), (7085, 14373), (7219, 14344), (7162, 14302), (7035, 14354), (7252, 14362), (7193, 14320), (7245, 14395), (7191, 14389), (7179, 14257), (6966, 14251), (7146, 14399)]
         : compromised: 0.5041, honest: 0.4977
Round 003: test acc mean=0.4984 ± 0.0087 | min=0.4815 max=0.5175
         : test loss mean=0.8144 ± 0.2036
         : individual accs = ['0.489109', '0.486266', '0.494673', '0.508054', '0.496629', '0.497113', '0.507389', '0.503767', '0.511473', '0.492938', '0.481456', '0.517480', '0.498816', '0.491366', '0.505098', '0.498993', '0.499618', '0.503051', '0.488738', '0.496354']
         : correct/total = [(6961, 14232), (6922, 14235), (7057, 14266), (7223, 14217), (7071, 14238), (7145, 14373), (7279, 14346), (7221, 14334), (7311, 14294), (7085, 14373), (6906, 14344), (7401, 14302), (7160, 14354), (7057, 14362), (7233, 14320), (7183, 14395), (7189, 14389), (7172, 14257), (6965, 14251), (7147, 14399)]
         : compromised: 0.4942, honest: 0.4989
Round 004: test acc mean=0.5032 ± 0.0104 | min=0.4863 max=0.5286
         : test loss mean=0.8076 ± 0.2145
         : individual accs = ['0.489109', '0.486266', '0.510865', '0.505803', '0.507445', '0.490503', '0.515266', '0.503000', '0.511473', '0.493008', '0.502440', '0.498392', '0.511913', '0.513786', '0.503911', '0.528586', '0.504830', '0.503051', '0.488738', '0.496354']
         : correct/total = [(6961, 14232), (6922, 14235), (7288, 14266), (7191, 14217), (7225, 14238), (7050, 14373), (7392, 14346), (7210, 14334), (7311, 14294), (7086, 14373), (7207, 14344), (7128, 14302), (7348, 14354), (7379, 14362), (7216, 14320), (7609, 14395), (7264, 14389), (7172, 14257), (6965, 14251), (7147, 14399)]
         : compromised: 0.5021, honest: 0.5034
Round 005: test acc mean=0.5096 ± 0.0178 | min=0.4863 max=0.5557
         : test loss mean=0.7501 ± 0.1133
         : individual accs = ['0.489109', '0.486266', '0.487032', '0.520222', '0.512291', '0.518472', '0.510944', '0.511162', '0.517210', '0.509010', '0.520078', '0.521186', '0.507106', '0.490461', '0.503142', '0.543730', '0.555702', '0.503051', '0.488738', '0.496354']
         : correct/total = [(6961, 14232), (6922, 14235), (6948, 14266), (7396, 14217), (7294, 14238), (7452, 14373), (7330, 14346), (7327, 14334), (7393, 14294), (7316, 14373), (7460, 14344), (7454, 14302), (7279, 14354), (7044, 14362), (7205, 14320), (7827, 14395), (7996, 14389), (7172, 14257), (6965, 14251), (7147, 14399)]
         : compromised: 0.5045, honest: 0.5101
Round 006: test acc mean=0.5140 ± 0.0203 | min=0.4863 max=0.5568
         : test loss mean=0.7665 ± 0.1467
         : individual accs = ['0.489109', '0.486266', '0.555026', '0.523739', '0.512853', '0.507827', '0.509201', '0.546742', '0.556807', '0.506018', '0.516244', '0.498462', '0.517138', '0.507798', '0.500140', '0.525669', '0.532629', '0.503472', '0.488738', '0.496354']
         : correct/total = [(6961, 14232), (6922, 14235), (7918, 14266), (7446, 14217), (7302, 14238), (7299, 14373), (7305, 14346), (7837, 14334), (7959, 14294), (7273, 14373), (7405, 14344), (7129, 14302), (7423, 14354), (7293, 14362), (7162, 14320), (7567, 14395), (7664, 14389), (7178, 14257), (6965, 14251), (7147, 14399)]
         : compromised: 0.5078, honest: 0.5147
Round 007: test acc mean=0.5163 ± 0.0250 | min=0.4841 max=0.5810
         : test loss mean=0.7340 ± 0.0855
         : individual accs = ['0.489109', '0.486266', '0.498598', '0.550960', '0.510676', '0.506784', '0.513174', '0.536487', '0.529103', '0.509080', '0.546012', '0.537827', '0.507385', '0.484125', '0.499092', '0.538104', '0.580999', '0.517781', '0.488738', '0.496354']
         : correct/total = [(6961, 14232), (6922, 14235), (7113, 14266), (7833, 14217), (7271, 14238), (7284, 14373), (7362, 14346), (7690, 14334), (7563, 14294), (7317, 14373), (7832, 14344), (7692, 14302), (7283, 14354), (6953, 14362), (7147, 14320), (7746, 14395), (8360, 14389), (7382, 14257), (6965, 14251), (7147, 14399)]
         : compromised: 0.4955, honest: 0.5187
Round 008: test acc mean=0.5278 ± 0.0318 | min=0.4863 max=0.5779
         : test loss mean=0.7546 ± 0.1319
         : individual accs = ['0.489109', '0.486266', '0.563297', '0.565379', '0.516435', '0.504835', '0.515196', '0.552184', '0.577935', '0.565713', '0.552217', '0.494197', '0.511843', '0.501601', '0.505028', '0.533866', '0.572521', '0.562671', '0.488738', '0.496354']
         : correct/total = [(6961, 14232), (6922, 14235), (8036, 14266), (8038, 14217), (7353, 14238), (7256, 14373), (7391, 14346), (7915, 14334), (8261, 14294), (8131, 14373), (7921, 14344), (7068, 14302), (7347, 14354), (7204, 14362), (7232, 14320), (7685, 14395), (8238, 14389), (8022, 14257), (6965, 14251), (7147, 14399)]
         : compromised: 0.5032, honest: 0.5305
Round 009: test acc mean=0.5321 ± 0.0327 | min=0.4887 max=0.5827
         : test loss mean=0.7196 ± 0.0620
         : individual accs = ['0.489109', '0.490130', '0.535609', '0.563973', '0.516084', '0.531691', '0.518751', '0.578066', '0.554498', '0.575732', '0.576478', '0.528807', '0.507245', '0.513717', '0.506983', '0.510663', '0.582667', '0.576699', '0.488667', '0.496354']
         : correct/total = [(6961, 14232), (6977, 14235), (7641, 14266), (8018, 14217), (7348, 14238), (7642, 14373), (7442, 14346), (8286, 14334), (7926, 14294), (8275, 14373), (8269, 14344), (7563, 14302), (7281, 14354), (7378, 14362), (7260, 14320), (7351, 14395), (8384, 14389), (8222, 14257), (6964, 14251), (7147, 14399)]
         : compromised: 0.5227, honest: 0.5331
Round 010: test acc mean=0.5362 ± 0.0386 | min=0.4887 max=0.5957
         : test loss mean=0.7344 ± 0.0962
         : individual accs = ['0.489109', '0.508957', '0.588813', '0.557502', '0.529779', '0.502052', '0.518263', '0.560904', '0.595704', '0.586169', '0.578709', '0.499930', '0.507245', '0.493455', '0.513059', '0.533449', '0.588783', '0.586729', '0.488667', '0.496354']
         : correct/total = [(6961, 14232), (7245, 14235), (8400, 14266), (7926, 14217), (7543, 14238), (7216, 14373), (7435, 14346), (8040, 14334), (8515, 14294), (8425, 14373), (8301, 14344), (7150, 14302), (7281, 14354), (7087, 14362), (7347, 14320), (7679, 14395), (8472, 14389), (8365, 14257), (6964, 14251), (7147, 14399)]
         : compromised: 0.4978, honest: 0.5405

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: d-fedavg
Attack: directed_deviation, 10.0% compromised
Final accuracy - Compromised: 0.4978, Honest: 0.5405
Overall test accuracy: mean=0.5362 ± 0.0386
