Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.0544 ± 0.0084 | min=0.0434 max=0.0857
         : test loss mean=3.6892 ± 0.0168
         : individual accs = ['0.051599', '0.052344', '0.057584', '0.048465', '0.057932', '0.043387', '0.057000', '0.051276', '0.085660', '0.053776', '0.050447', '0.061770', '0.053750', '0.046462', '0.051826', '0.051378', '0.058271', '0.050203', '0.055583', '0.048450']
         : correct/total = [(213, 4128), (220, 4203), (235, 4081), (210, 4333), (237, 4091), (186, 4287), (239, 4193), (223, 4349), (359, 4191), (230, 4277), (209, 4143), (259, 4193), (220, 4093), (195, 4197), (210, 4052), (207, 4029), (242, 4153), (210, 4183), (227, 4084), (200, 4128)]
         : compromised: 0.0502, honest: 0.0561
Round 002: test acc mean=0.0509 ± 0.0084 | min=0.0448 max=0.0842
         : test loss mean=3.6845 ± 0.0163
         : individual accs = ['0.047238', '0.048775', '0.055134', '0.044773', '0.044977', '0.048052', '0.049130', '0.045528', '0.051062', '0.047697', '0.055998', '0.045314', '0.049597', '0.045747', '0.084156', '0.054852', '0.054418', '0.048291', '0.048482', '0.048692']
         : correct/total = [(195, 4128), (205, 4203), (225, 4081), (194, 4333), (184, 4091), (206, 4287), (206, 4193), (198, 4349), (214, 4191), (204, 4277), (232, 4143), (190, 4193), (203, 4093), (192, 4197), (341, 4052), (221, 4029), (226, 4153), (202, 4183), (198, 4084), (201, 4128)]
         : compromised: 0.0541, honest: 0.0495
Round 003: test acc mean=0.0581 ± 0.0122 | min=0.0441 max=0.1036
         : test loss mean=3.6767 ± 0.0166
         : individual accs = ['0.058140', '0.059719', '0.067630', '0.044080', '0.059888', '0.048052', '0.049130', '0.062313', '0.103555', '0.044657', '0.050447', '0.063916', '0.055461', '0.062426', '0.048124', '0.056342', '0.058271', '0.059049', '0.053624', '0.056928']
         : correct/total = [(240, 4128), (251, 4203), (276, 4081), (191, 4333), (245, 4091), (206, 4287), (206, 4193), (271, 4349), (434, 4191), (191, 4277), (209, 4143), (268, 4193), (227, 4093), (262, 4197), (195, 4052), (227, 4029), (242, 4153), (247, 4183), (219, 4084), (235, 4128)]
         : compromised: 0.0545, honest: 0.0596
Round 004: test acc mean=0.0635 ± 0.0152 | min=0.0517 max=0.1210
         : test loss mean=3.6705 ± 0.0149
         : individual accs = ['0.059593', '0.052344', '0.057584', '0.057466', '0.057932', '0.074878', '0.062485', '0.058404', '0.060845', '0.053776', '0.051653', '0.063439', '0.058637', '0.062426', '0.086130', '0.062547', '0.058271', '0.120966', '0.055583', '0.055475']
         : correct/total = [(246, 4128), (220, 4203), (235, 4081), (249, 4333), (237, 4091), (321, 4287), (262, 4193), (254, 4349), (255, 4191), (230, 4277), (214, 4143), (266, 4193), (240, 4093), (262, 4197), (349, 4052), (252, 4029), (242, 4153), (506, 4183), (227, 4084), (229, 4128)]
         : compromised: 0.0764, honest: 0.0580
Round 005: test acc mean=0.1083 ± 0.0347 | min=0.0749 max=0.1630
         : test loss mean=3.6576 ± 0.0168
         : individual accs = ['0.082364', '0.154889', '0.091399', '0.075237', '0.077976', '0.123863', '0.162414', '0.079329', '0.150322', '0.076923', '0.148685', '0.075841', '0.156853', '0.162974', '0.134008', '0.081162', '0.081146', '0.092517', '0.082517', '0.074855']
         : correct/total = [(340, 4128), (651, 4203), (373, 4081), (326, 4333), (319, 4091), (531, 4287), (681, 4193), (345, 4349), (630, 4191), (329, 4277), (616, 4143), (318, 4193), (642, 4093), (684, 4197), (543, 4052), (327, 4029), (337, 4153), (387, 4183), (337, 4084), (309, 4128)]
         : compromised: 0.1255, honest: 0.1009
Round 006: test acc mean=0.1135 ± 0.0319 | min=0.0446 max=0.1596
         : test loss mean=3.6395 ± 0.0182
         : individual accs = ['0.044574', '0.085891', '0.088214', '0.119086', '0.141286', '0.130161', '0.128309', '0.091515', '0.159628', '0.132336', '0.134444', '0.145242', '0.091620', '0.132952', '0.137216', '0.114420', '0.049603', '0.070524', '0.143976', '0.128634']
         : correct/total = [(184, 4128), (361, 4203), (360, 4081), (516, 4333), (578, 4091), (558, 4287), (538, 4193), (398, 4349), (669, 4191), (566, 4277), (557, 4143), (609, 4193), (375, 4093), (558, 4197), (556, 4052), (461, 4029), (206, 4153), (295, 4183), (588, 4084), (531, 4128)]
         : compromised: 0.1177, honest: 0.1117
Round 007: test acc mean=0.1581 ± 0.0376 | min=0.1021 max=0.2149
         : test loss mean=3.5965 ± 0.0187
         : individual accs = ['0.130814', '0.190816', '0.214898', '0.134318', '0.107553', '0.124563', '0.124016', '0.195677', '0.138153', '0.188917', '0.141202', '0.145719', '0.195456', '0.191804', '0.130800', '0.201291', '0.203227', '0.102080', '0.195886', '0.104651']
         : correct/total = [(540, 4128), (802, 4203), (877, 4081), (582, 4333), (440, 4091), (534, 4287), (520, 4193), (851, 4349), (579, 4191), (808, 4277), (585, 4143), (611, 4193), (800, 4093), (805, 4197), (530, 4052), (811, 4029), (844, 4153), (427, 4183), (800, 4084), (432, 4128)]
         : compromised: 0.1568, honest: 0.1587
Round 008: test acc mean=0.2027 ± 0.0303 | min=0.1224 max=0.2589
         : test loss mean=3.4972 ± 0.0217
         : individual accs = ['0.206880', '0.210088', '0.217594', '0.163397', '0.213395', '0.244460', '0.239447', '0.214072', '0.122405', '0.202712', '0.161719', '0.206535', '0.166870', '0.190136', '0.258885', '0.214197', '0.207320', '0.212527', '0.210333', '0.191860']
         : correct/total = [(854, 4128), (883, 4203), (888, 4081), (708, 4333), (873, 4091), (1048, 4287), (1004, 4193), (931, 4349), (513, 4191), (867, 4277), (670, 4143), (866, 4193), (683, 4093), (798, 4197), (1049, 4052), (863, 4029), (861, 4153), (889, 4183), (859, 4084), (792, 4128)]
         : compromised: 0.2139, honest: 0.1980
Round 009: test acc mean=0.2795 ± 0.0158 | min=0.2453 max=0.3061
         : test loss mean=3.2272 ± 0.0285
         : individual accs = ['0.292151', '0.284083', '0.303357', '0.245327', '0.292838', '0.268719', '0.263057', '0.285813', '0.306132', '0.269815', '0.274439', '0.252802', '0.290740', '0.284251', '0.294669', '0.281956', '0.259331', '0.277074', '0.288688', '0.274467']
         : correct/total = [(1206, 4128), (1194, 4203), (1238, 4081), (1063, 4333), (1198, 4091), (1152, 4287), (1103, 4193), (1243, 4349), (1283, 4191), (1154, 4277), (1137, 4143), (1060, 4193), (1190, 4093), (1193, 4197), (1194, 4052), (1136, 4029), (1077, 4153), (1159, 4183), (1179, 4084), (1133, 4128)]
         : compromised: 0.2840, honest: 0.2775
Round 010: test acc mean=0.3414 ± 0.0183 | min=0.3058 max=0.3763
         : test loss mean=2.8346 ± 0.0349
         : individual accs = ['0.333091', '0.343088', '0.354080', '0.332102', '0.352970', '0.333100', '0.328404', '0.361922', '0.347888', '0.305822', '0.342023', '0.369187', '0.336917', '0.333572', '0.344274', '0.370315', '0.329400', '0.315324', '0.376347', '0.317587']
         : correct/total = [(1375, 4128), (1442, 4203), (1445, 4081), (1439, 4333), (1444, 4091), (1428, 4287), (1377, 4193), (1574, 4349), (1458, 4191), (1308, 4277), (1417, 4143), (1548, 4193), (1379, 4093), (1400, 4197), (1395, 4052), (1492, 4029), (1368, 4153), (1319, 4183), (1537, 4084), (1311, 4128)]
         : compromised: 0.3399, honest: 0.3420

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: krum, 30.0% compromised
Final accuracy - Compromised: 0.3399, Honest: 0.3420
Overall test accuracy: mean=0.3414 ± 0.0183
