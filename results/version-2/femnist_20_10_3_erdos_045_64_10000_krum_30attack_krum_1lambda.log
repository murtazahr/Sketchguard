Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.0533 ± 0.0136 | min=0.0036 max=0.0742
         : test loss mean=24617.5547 ± 107289.3552
         : individual accs = ['0.059593', '0.052344', '0.048272', '0.048465', '0.045710', '0.045253', '0.057000', '0.058174', '0.003579', '0.053776', '0.050447', '0.071309', '0.053750', '0.062426', '0.061204', '0.056590', '0.058271', '0.050203', '0.074192', '0.054506']
         : correct/total = [(246, 4128), (220, 4203), (197, 4081), (210, 4333), (187, 4091), (194, 4287), (239, 4193), (253, 4349), (15, 4191), (230, 4277), (209, 4143), (299, 4193), (220, 4093), (262, 4197), (248, 4052), (228, 4029), (242, 4153), (210, 4183), (303, 4084), (225, 4128)]
         : compromised: 0.0578, honest: 0.0513
Round 002: test acc mean=0.0595 ± 0.0157 | min=0.0434 max=0.0953
         : test loss mean=81717.1393 ± 356180.6994
         : individual accs = ['0.049176', '0.047109', '0.095320', '0.043388', '0.051088', '0.043387', '0.077272', '0.071741', '0.050585', '0.047463', '0.045619', '0.090389', '0.049841', '0.062426', '0.051579', '0.054852', '0.054418', '0.050203', '0.080558', '0.073643']
         : correct/total = [(203, 4128), (198, 4203), (389, 4081), (188, 4333), (209, 4091), (186, 4287), (324, 4193), (312, 4349), (212, 4191), (203, 4277), (189, 4143), (379, 4193), (204, 4093), (262, 4197), (209, 4052), (221, 4029), (226, 4153), (210, 4183), (329, 4084), (304, 4128)]
         : compromised: 0.0563, honest: 0.0609
Round 003: test acc mean=0.0550 ± 0.0098 | min=0.0456 max=0.0842
         : test loss mean=243060.0582 ± 1059458.2119
         : individual accs = ['0.049176', '0.052819', '0.056114', '0.058851', '0.054021', '0.074411', '0.046745', '0.047827', '0.049630', '0.069675', '0.045619', '0.049606', '0.049841', '0.047177', '0.084156', '0.056342', '0.055141', '0.050681', '0.050930', '0.050388']
         : correct/total = [(203, 4128), (222, 4203), (229, 4081), (255, 4333), (221, 4091), (319, 4287), (196, 4193), (208, 4349), (208, 4191), (298, 4277), (189, 4143), (208, 4193), (204, 4093), (198, 4197), (341, 4052), (227, 4029), (229, 4153), (212, 4183), (208, 4084), (208, 4128)]
         : compromised: 0.0595, honest: 0.0530
Round 004: test acc mean=0.0916 ± 0.0325 | min=0.0496 max=0.1536
         : test loss mean=3690769.7615 ± 16087676.4406
         : individual accs = ['0.153343', '0.096598', '0.108307', '0.071082', '0.101687', '0.050618', '0.059862', '0.069901', '0.049630', '0.097031', '0.055998', '0.070594', '0.058637', '0.069335', '0.109576', '0.153636', '0.152902', '0.094430', '0.106513', '0.102229']
         : correct/total = [(633, 4128), (406, 4203), (442, 4081), (308, 4333), (416, 4091), (217, 4287), (251, 4193), (304, 4349), (208, 4191), (415, 4277), (232, 4143), (296, 4193), (240, 4093), (291, 4197), (444, 4052), (619, 4029), (635, 4153), (395, 4183), (435, 4084), (422, 4128)]
         : compromised: 0.0815, honest: 0.0959
Round 005: test acc mean=0.0894 ± 0.0348 | min=0.0434 max=0.1663
         : test loss mean=47011.9937 ± 204904.6289
         : individual accs = ['0.064196', '0.073519', '0.075472', '0.122548', '0.067710', '0.043387', '0.067255', '0.047827', '0.051778', '0.065233', '0.129133', '0.146196', '0.061813', '0.122230', '0.088598', '0.070489', '0.083554', '0.104710', '0.166259', '0.135174']
         : correct/total = [(265, 4128), (309, 4203), (308, 4081), (531, 4333), (277, 4091), (186, 4287), (282, 4193), (208, 4349), (217, 4191), (279, 4277), (535, 4143), (613, 4193), (253, 4093), (513, 4197), (359, 4052), (284, 4029), (347, 4153), (438, 4183), (679, 4084), (558, 4128)]
         : compromised: 0.0978, honest: 0.0857
Round 006: test acc mean=0.1103 ± 0.0457 | min=0.0446 max=0.1801
         : test loss mean=296676.1231 ± 1293165.4491
         : individual accs = ['0.044574', '0.115156', '0.172262', '0.130625', '0.126619', '0.180079', '0.046745', '0.106691', '0.044619', '0.121113', '0.140961', '0.106129', '0.045932', '0.129378', '0.050346', '0.132291', '0.135565', '0.174516', '0.051175', '0.151647']
         : correct/total = [(184, 4128), (484, 4203), (703, 4081), (566, 4333), (518, 4091), (772, 4287), (196, 4193), (464, 4349), (187, 4191), (518, 4277), (584, 4143), (445, 4193), (188, 4093), (543, 4197), (204, 4052), (533, 4029), (563, 4153), (730, 4183), (209, 4084), (626, 4128)]
         : compromised: 0.1052, honest: 0.1125
Round 007: test acc mean=0.1334 ± 0.0602 | min=0.0453 max=0.2556
         : test loss mean=nan ± nan
         : individual accs = ['0.255572', '0.162503', '0.152414', '0.144934', '0.199218', '0.045253', '0.145958', '0.140032', '0.049630', '0.182137', '0.155684', '0.208920', '0.054239', '0.049083', '0.051826', '0.158352', '0.161088', '0.150610', '0.052889', '0.147045']
         : correct/total = [(1055, 4128), (683, 4203), (622, 4081), (628, 4333), (815, 4091), (194, 4287), (612, 4193), (609, 4349), (208, 4191), (779, 4277), (645, 4143), (876, 4193), (222, 4093), (206, 4197), (210, 4052), (638, 4029), (669, 4153), (630, 4183), (216, 4084), (607, 4128)]
         : compromised: 0.0673, honest: 0.1617
Round 008: test acc mean=0.1778 ± 0.0848 | min=0.0453 max=0.2576
         : test loss mean=nan ± nan
         : individual accs = ['0.242006', '0.225791', '0.231071', '0.226171', '0.234417', '0.045253', '0.251371', '0.188319', '0.049630', '0.206219', '0.251026', '0.257572', '0.054239', '0.049083', '0.051826', '0.236039', '0.235011', '0.216591', '0.052889', '0.251696']
         : correct/total = [(999, 4128), (949, 4203), (943, 4081), (980, 4333), (959, 4091), (194, 4287), (1054, 4193), (819, 4349), (208, 4191), (882, 4277), (1040, 4143), (1080, 4193), (222, 4093), (206, 4197), (210, 4052), (951, 4029), (976, 4153), (906, 4183), (216, 4084), (1039, 4128)]
         : compromised: 0.0783, honest: 0.2205
Round 009: test acc mean=0.2253 ± 0.1154 | min=0.0453 max=0.3356
         : test loss mean=nan ± nan
         : individual accs = ['0.291182', '0.299548', '0.334477', '0.269790', '0.335615', '0.045253', '0.303601', '0.310646', '0.049630', '0.281973', '0.293507', '0.301693', '0.054239', '0.049083', '0.051826', '0.300819', '0.296653', '0.298829', '0.052889', '0.284641']
         : correct/total = [(1202, 4128), (1259, 4203), (1365, 4081), (1169, 4333), (1373, 4091), (194, 4287), (1273, 4193), (1351, 4349), (208, 4191), (1206, 4277), (1216, 4143), (1265, 4193), (222, 4093), (206, 4197), (210, 4052), (1212, 4029), (1232, 4153), (1250, 4183), (216, 4084), (1175, 4128)]
         : compromised: 0.0920, honest: 0.2824
Round 010: test acc mean=0.2590 ± 0.1370 | min=0.0453 max=0.3683
         : test loss mean=nan ± nan
         : individual accs = ['0.341570', '0.338806', '0.363636', '0.326333', '0.359814', '0.045253', '0.341760', '0.346976', '0.049630', '0.337152', '0.368332', '0.364178', '0.054239', '0.049083', '0.051826', '0.347729', '0.352998', '0.360507', '0.052889', '0.327762']
         : correct/total = [(1410, 4128), (1424, 4203), (1484, 4081), (1414, 4333), (1472, 4091), (194, 4287), (1433, 4193), (1509, 4349), (208, 4191), (1442, 4277), (1526, 4143), (1527, 4193), (222, 4093), (206, 4197), (210, 4052), (1401, 4029), (1466, 4153), (1508, 4183), (216, 4084), (1353, 4128)]
         : compromised: 0.1023, honest: 0.3262

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: krum, 30.0% compromised
Final accuracy - Compromised: 0.1023, Honest: 0.3262
Overall test accuracy: mean=0.2590 ± 0.1370
