Device: cuda
Seed: 987654321
Looking for images in: /home/student.unimelb.edu.au/mrangwala/Projects/Sketchguard/leaf/data/celeba/data/raw/img_align_celeba
Loading 1 LEAF CelebA train files...
LEAF CelebA train: 9343 users (celebrities), 177457 samples
Looking for images in: /home/student.unimelb.edu.au/mrangwala/Projects/Sketchguard/leaf/data/celeba/data/raw/img_align_celeba
Loading 1 LEAF CelebA test files...
LEAF CelebA test: 9343 users (celebrities), 22831 samples
Found 9343 train users, 9343 test users, 9343 common users
User sample counts range: 31 (max) to 4 (min)
Distributed ALL 9343 users across 20 clients
Users per client: 467 (with 3 clients getting +1 user)
Train partition sizes: [8843, 8998, 8728, 9034, 8866, 8946, 8873, 8776, 8816, 8801, 8913, 8656, 9115, 8921, 8699, 8823, 8912, 8766, 9102, 8869]
Test partition sizes: [1140, 1158, 1127, 1158, 1134, 1145, 1145, 1127, 1136, 1128, 1144, 1125, 1152, 1160, 1124, 1145, 1154, 1131, 1157, 1141]
  Client 0: 8843 train samples, 2 unique classes
  Client 1: 8998 train samples, 2 unique classes
  Client 2: 8728 train samples, 2 unique classes
  Client 3: 9034 train samples, 2 unique classes
  Client 4: 8866 train samples, 2 unique classes
  Client 5: 8946 train samples, 2 unique classes
  Client 6: 8873 train samples, 2 unique classes
  Client 7: 8776 train samples, 2 unique classes
  Client 8: 8816 train samples, 2 unique classes
  Client 9: 8801 train samples, 2 unique classes
  Client 10: 8913 train samples, 2 unique classes
  Client 11: 8656 train samples, 2 unique classes
  Client 12: 9115 train samples, 2 unique classes
  Client 13: 8921 train samples, 2 unique classes
  Client 14: 8699 train samples, 2 unique classes
  Client 15: 8823 train samples, 2 unique classes
  Client 16: 8912 train samples, 2 unique classes
  Client 17: 8766 train samples, 2 unique classes
  Client 18: 9102 train samples, 2 unique classes
  Client 19: 8869 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Degree statistics: avg=19.00, min=19, max=19
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 2,219,692
Initial test acc across nodes: mean=0.4978 ± 0.0208
Round 001: test acc mean=0.5026 ± 0.0217 | min=0.4542 max=0.5386
         : test loss mean=4.1244 ± 2.0782
         : individual accs = ['0.481579', '0.510363', '0.538598', '0.493092', '0.534392', '0.517031', '0.521397', '0.503993', '0.454225', '0.521277', '0.471154', '0.488000', '0.489583', '0.507759', '0.515125', '0.487336', '0.477470', '0.519010', '0.525497', '0.494303']
         : correct/total = [(549, 1140), (591, 1158), (607, 1127), (571, 1158), (606, 1134), (592, 1145), (597, 1145), (568, 1127), (516, 1136), (588, 1128), (539, 1144), (549, 1125), (564, 1152), (589, 1160), (579, 1124), (558, 1145), (551, 1154), (587, 1131), (608, 1157), (564, 1141)]
         : compromised: 0.5124, honest: 0.5015
Round 002: test acc mean=0.5163 ± 0.0149 | min=0.4920 max=0.5625
         : test loss mean=9.9784 ± 0.3509
         : individual accs = ['0.528947', '0.508636', '0.494232', '0.528497', '0.522046', '0.514410', '0.521397', '0.503993', '0.562500', '0.492021', '0.525350', '0.498667', '0.521701', '0.506897', '0.517794', '0.516157', '0.514731', '0.507515', '0.522040', '0.517967']
         : correct/total = [(603, 1140), (589, 1158), (557, 1127), (612, 1158), (592, 1134), (589, 1145), (597, 1145), (568, 1127), (639, 1136), (555, 1128), (601, 1144), (561, 1125), (601, 1152), (588, 1160), (582, 1124), (591, 1145), (594, 1154), (574, 1131), (604, 1157), (591, 1141)]
         : compromised: 0.5107, honest: 0.5169
Round 003: test acc mean=0.4846 ± 0.0105 | min=0.4636 max=0.5009
         : test loss mean=0.6938 ± 0.0004
         : individual accs = ['0.486842', '0.488774', '0.500444', '0.474093', '0.491182', '0.496943', '0.474236', '0.479148', '0.486796', '0.495567', '0.500874', '0.480889', '0.473958', '0.469828', '0.483096', '0.487336', '0.463605', '0.475685', '0.482282', '0.499562']
         : correct/total = [(555, 1140), (566, 1158), (564, 1127), (549, 1158), (557, 1134), (569, 1145), (543, 1145), (540, 1127), (553, 1136), (559, 1128), (573, 1144), (541, 1125), (546, 1152), (545, 1160), (543, 1124), (558, 1145), (535, 1154), (538, 1131), (558, 1157), (570, 1141)]
         : compromised: 0.4834, honest: 0.4847
Round 004: test acc mean=0.7933 ± 0.0123 | min=0.7666 max=0.8098
         : test loss mean=0.4498 ± 0.0138
         : individual accs = ['0.783333', '0.794473', '0.787045', '0.800518', '0.807760', '0.806987', '0.789520', '0.788820', '0.799296', '0.796099', '0.783217', '0.808889', '0.807292', '0.791379', '0.790925', '0.783406', '0.802426', '0.766578', '0.768366', '0.809816']
         : correct/total = [(893, 1140), (920, 1158), (887, 1127), (927, 1158), (916, 1134), (924, 1145), (904, 1145), (889, 1127), (908, 1136), (898, 1128), (896, 1144), (910, 1125), (930, 1152), (918, 1160), (889, 1124), (897, 1145), (926, 1154), (867, 1131), (889, 1157), (924, 1141)]
         : compromised: 0.7992, honest: 0.7927
Round 005: test acc mean=0.5638 ± 0.0147 | min=0.5406 max=0.6004
         : test loss mean=0.6874 ± 0.0010
         : individual accs = ['0.541228', '0.540587', '0.561668', '0.576857', '0.579365', '0.572052', '0.571179', '0.556344', '0.600352', '0.555851', '0.590909', '0.557333', '0.568576', '0.555172', '0.554270', '0.552838', '0.563258', '0.558798', '0.552290', '0.567923']
         : correct/total = [(617, 1140), (626, 1158), (633, 1127), (668, 1158), (657, 1134), (655, 1145), (654, 1145), (627, 1127), (682, 1136), (627, 1128), (676, 1144), (627, 1125), (655, 1152), (644, 1160), (623, 1124), (633, 1145), (650, 1154), (632, 1131), (639, 1157), (648, 1141)]
         : compromised: 0.5636, honest: 0.5639
Round 006: test acc mean=0.8178 ± 0.0101 | min=0.7882 max=0.8301
         : test loss mean=0.4022 ± 0.0182
         : individual accs = ['0.810526', '0.820380', '0.814552', '0.826425', '0.817460', '0.827074', '0.806114', '0.822538', '0.818662', '0.820922', '0.826049', '0.824889', '0.804688', '0.820690', '0.830071', '0.814847', '0.806759', '0.826702', '0.788245', '0.828221']
         : correct/total = [(924, 1140), (950, 1158), (918, 1127), (957, 1158), (927, 1134), (947, 1145), (923, 1145), (927, 1127), (930, 1136), (926, 1128), (945, 1144), (928, 1125), (927, 1152), (952, 1160), (933, 1124), (933, 1145), (931, 1154), (935, 1131), (912, 1157), (945, 1141)]
         : compromised: 0.8239, honest: 0.8171
Round 007: test acc mean=0.6612 ± 0.0112 | min=0.6399 max=0.6812
         : test loss mean=0.6442 ± 0.0039
         : individual accs = ['0.650877', '0.639896', '0.670807', '0.668394', '0.649912', '0.681223', '0.670742', '0.661934', '0.673415', '0.657801', '0.667832', '0.665778', '0.672743', '0.670690', '0.657473', '0.653275', '0.665511', '0.657825', '0.644771', '0.642419']
         : correct/total = [(742, 1140), (741, 1158), (756, 1127), (774, 1158), (737, 1134), (780, 1145), (768, 1145), (746, 1127), (765, 1136), (742, 1128), (764, 1144), (749, 1125), (775, 1152), (778, 1160), (739, 1124), (748, 1145), (768, 1154), (744, 1131), (746, 1157), (733, 1141)]
         : compromised: 0.6760, honest: 0.6595
Round 008: test acc mean=0.7912 ± 0.0112 | min=0.7658 max=0.8078
         : test loss mean=0.4606 ± 0.0217
         : individual accs = ['0.765789', '0.797064', '0.784383', '0.806563', '0.778660', '0.786026', '0.791266', '0.787933', '0.786972', '0.804078', '0.798951', '0.800889', '0.789931', '0.807759', '0.787367', '0.801747', '0.786828', '0.797524', '0.768366', '0.794917']
         : correct/total = [(873, 1140), (923, 1158), (884, 1127), (934, 1158), (883, 1134), (900, 1145), (906, 1145), (888, 1127), (894, 1136), (907, 1128), (914, 1144), (901, 1125), (910, 1152), (937, 1160), (885, 1124), (918, 1145), (908, 1154), (902, 1131), (889, 1157), (907, 1141)]
         : compromised: 0.7969, honest: 0.7905
Round 009: test acc mean=0.7216 ± 0.0120 | min=0.6969 max=0.7386
         : test loss mean=0.5820 ± 0.0061
         : individual accs = ['0.721053', '0.708981', '0.732919', '0.716753', '0.717813', '0.730131', '0.736245', '0.713398', '0.738556', '0.723404', '0.723776', '0.737778', '0.734375', '0.718966', '0.721530', '0.696943', '0.735702', '0.701149', '0.707865', '0.715162']
         : correct/total = [(822, 1140), (821, 1158), (826, 1127), (830, 1158), (814, 1134), (836, 1145), (843, 1145), (804, 1127), (839, 1136), (816, 1128), (828, 1144), (830, 1125), (846, 1152), (834, 1160), (811, 1124), (798, 1145), (849, 1154), (793, 1131), (819, 1157), (816, 1141)]
         : compromised: 0.7245, honest: 0.7213
Round 010: test acc mean=0.8092 ± 0.0116 | min=0.7842 max=0.8262
         : test loss mean=0.4448 ± 0.0266
         : individual accs = ['0.784211', '0.797064', '0.801242', '0.822971', '0.802469', '0.813100', '0.813974', '0.803904', '0.807218', '0.826241', '0.823427', '0.824000', '0.798611', '0.818966', '0.802491', '0.821834', '0.808492', '0.807250', '0.789974', '0.815951']
         : correct/total = [(894, 1140), (923, 1158), (903, 1127), (953, 1158), (910, 1134), (931, 1145), (932, 1145), (906, 1127), (917, 1136), (932, 1128), (942, 1144), (927, 1125), (920, 1152), (950, 1160), (902, 1124), (941, 1145), (933, 1154), (913, 1131), (914, 1157), (931, 1141)]
         : compromised: 0.8160, honest: 0.8084

=== FINAL RESULTS ===
Dataset: celeba, Nodes: 20, Graph: fully, Aggregation: d-fedavg
Attack: directed_deviation, 10.0% compromised
Final accuracy - Compromised: 0.8160, Honest: 0.8084
Overall test accuracy: mean=0.8092 ± 0.0116
