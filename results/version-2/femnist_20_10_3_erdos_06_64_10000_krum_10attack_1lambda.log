Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.0534 ± 0.0042 | min=0.0469 max=0.0618
         : test loss mean=3.6895 ± 0.0184
         : individual accs = ['0.051599', '0.052344', '0.057584', '0.048465', '0.057932', '0.050618', '0.049130', '0.051276', '0.047960', '0.053075', '0.050447', '0.061770', '0.053750', '0.046938', '0.061204', '0.056342', '0.058271', '0.050203', '0.052889', '0.055475']
         : correct/total = [(213, 4128), (220, 4203), (235, 4081), (210, 4333), (237, 4091), (217, 4287), (206, 4193), (223, 4349), (201, 4191), (227, 4277), (209, 4143), (259, 4193), (220, 4093), (197, 4197), (248, 4052), (227, 4029), (242, 4153), (210, 4183), (216, 4084), (229, 4128)]
         : compromised: 0.0488, honest: 0.0539
Round 002: test acc mean=0.0852 ± 0.0148 | min=0.0536 max=0.0997
         : test loss mean=3.6829 ± 0.0158
         : individual accs = ['0.094234', '0.085891', '0.055379', '0.060928', '0.091909', '0.094005', '0.087765', '0.094504', '0.088523', '0.089783', '0.055998', '0.093489', '0.099682', '0.097212', '0.092053', '0.093075', '0.093426', '0.053550', '0.093536', '0.089632']
         : correct/total = [(389, 4128), (361, 4203), (226, 4081), (264, 4333), (376, 4091), (403, 4287), (368, 4193), (411, 4349), (371, 4191), (384, 4277), (232, 4143), (392, 4193), (408, 4093), (408, 4197), (373, 4052), (375, 4029), (388, 4153), (224, 4183), (382, 4084), (370, 4128)]
         : compromised: 0.0956, honest: 0.0841
Round 003: test acc mean=0.0599 ± 0.0118 | min=0.0480 max=0.0886
         : test loss mean=3.6766 ± 0.0168
         : individual accs = ['0.059593', '0.052344', '0.057584', '0.048927', '0.068932', '0.088640', '0.057000', '0.058174', '0.047960', '0.048398', '0.051171', '0.053899', '0.053750', '0.075054', '0.080454', '0.050633', '0.058271', '0.050920', '0.055583', '0.080669']
         : correct/total = [(246, 4128), (220, 4203), (235, 4081), (212, 4333), (282, 4091), (380, 4287), (239, 4193), (253, 4349), (201, 4191), (207, 4277), (212, 4143), (226, 4193), (220, 4093), (315, 4197), (326, 4052), (204, 4029), (242, 4153), (213, 4183), (227, 4084), (333, 4128)]
         : compromised: 0.0818, honest: 0.0575
Round 004: test acc mean=0.0897 ± 0.0259 | min=0.0469 max=0.1192
         : test loss mean=3.6672 ± 0.0172
         : individual accs = ['0.117248', '0.107780', '0.111247', '0.073852', '0.115375', '0.108467', '0.049368', '0.114739', '0.048914', '0.078326', '0.088342', '0.119246', '0.085023', '0.046938', '0.085390', '0.117895', '0.056345', '0.108056', '0.054114', '0.107074']
         : correct/total = [(484, 4128), (453, 4203), (454, 4081), (320, 4333), (472, 4091), (465, 4287), (207, 4193), (499, 4349), (205, 4191), (335, 4277), (366, 4143), (500, 4193), (348, 4093), (197, 4197), (346, 4052), (475, 4029), (234, 4153), (452, 4183), (221, 4084), (442, 4128)]
         : compromised: 0.0777, honest: 0.0910
Round 005: test acc mean=0.1035 ± 0.0446 | min=0.0554 max=0.1693
         : test loss mean=3.6584 ± 0.0173
         : individual accs = ['0.070979', '0.165834', '0.055379', '0.063928', '0.058176', '0.063681', '0.068209', '0.070131', '0.161537', '0.153145', '0.160029', '0.067493', '0.169313', '0.112461', '0.167818', '0.070985', '0.100409', '0.154196', '0.072478', '0.064438']
         : correct/total = [(293, 4128), (697, 4203), (226, 4081), (277, 4333), (238, 4091), (273, 4287), (286, 4193), (305, 4349), (677, 4191), (655, 4277), (663, 4143), (283, 4193), (693, 4093), (472, 4197), (680, 4052), (286, 4029), (417, 4153), (645, 4183), (296, 4084), (266, 4128)]
         : compromised: 0.0881, honest: 0.1052
Round 006: test acc mean=0.1122 ± 0.0264 | min=0.0601 max=0.1806
         : test loss mean=3.6397 ± 0.0183
         : individual accs = ['0.060078', '0.091125', '0.101201', '0.126471', '0.102909', '0.102869', '0.099928', '0.099563', '0.102601', '0.100070', '0.137340', '0.148819', '0.100171', '0.102931', '0.108342', '0.106230', '0.180592', '0.163758', '0.100637', '0.108769']
         : correct/total = [(248, 4128), (383, 4203), (413, 4081), (548, 4333), (421, 4091), (441, 4287), (419, 4193), (433, 4349), (430, 4191), (428, 4277), (569, 4143), (624, 4193), (410, 4093), (432, 4197), (439, 4052), (428, 4029), (750, 4153), (685, 4183), (411, 4084), (449, 4128)]
         : compromised: 0.1029, honest: 0.1133
Round 007: test acc mean=0.1542 ± 0.0482 | min=0.0898 max=0.2203
         : test loss mean=3.5961 ± 0.0182
         : individual accs = ['0.121124', '0.199857', '0.220289', '0.089776', '0.095331', '0.118731', '0.192464', '0.198666', '0.185397', '0.191723', '0.098962', '0.094443', '0.206694', '0.199190', '0.211007', '0.123852', '0.122321', '0.092278', '0.203967', '0.118459']
         : correct/total = [(500, 4128), (840, 4203), (899, 4081), (389, 4333), (390, 4091), (509, 4287), (807, 4193), (864, 4349), (777, 4191), (820, 4277), (410, 4143), (396, 4193), (846, 4093), (836, 4197), (855, 4052), (499, 4029), (508, 4153), (386, 4183), (833, 4084), (489, 4128)]
         : compromised: 0.1590, honest: 0.1537
Round 008: test acc mean=0.1904 ± 0.0110 | min=0.1688 max=0.2091
         : test loss mean=3.4996 ± 0.0201
         : individual accs = ['0.184109', '0.209136', '0.205342', '0.189015', '0.195307', '0.186144', '0.186024', '0.190619', '0.173944', '0.180033', '0.197441', '0.198187', '0.182018', '0.188468', '0.192991', '0.206255', '0.184445', '0.208702', '0.181929', '0.168847']
         : correct/total = [(760, 4128), (879, 4203), (838, 4081), (819, 4333), (799, 4091), (798, 4287), (780, 4193), (829, 4349), (729, 4191), (770, 4277), (818, 4143), (831, 4193), (745, 4093), (791, 4197), (782, 4052), (831, 4029), (766, 4153), (873, 4183), (743, 4084), (697, 4128)]
         : compromised: 0.1873, honest: 0.1908
Round 009: test acc mean=0.2848 ± 0.0176 | min=0.2504 max=0.3202
         : test loss mean=3.2442 ± 0.0276
         : individual accs = ['0.303779', '0.274566', '0.275178', '0.250404', '0.285260', '0.283648', '0.273313', '0.292021', '0.277977', '0.264438', '0.268405', '0.293346', '0.296115', '0.320229', '0.303307', '0.304294', '0.282928', '0.258427', '0.309256', '0.279312']
         : correct/total = [(1254, 4128), (1154, 4203), (1123, 4081), (1085, 4333), (1167, 4091), (1216, 4287), (1146, 4193), (1270, 4349), (1165, 4191), (1131, 4277), (1112, 4143), (1230, 4193), (1212, 4093), (1344, 4197), (1229, 4052), (1226, 4029), (1175, 4153), (1081, 4183), (1263, 4084), (1153, 4128)]
         : compromised: 0.3019, honest: 0.2829
Round 010: test acc mean=0.3413 ± 0.0119 | min=0.3139 max=0.3624
         : test loss mean=2.8408 ± 0.0282
         : individual accs = ['0.341812', '0.334285', '0.343788', '0.313870', '0.345881', '0.349195', '0.333174', '0.339158', '0.340014', '0.324059', '0.337919', '0.335798', '0.359638', '0.351680', '0.355380', '0.362373', '0.349868', '0.346163', '0.338639', '0.323159']
         : correct/total = [(1411, 4128), (1405, 4203), (1403, 4081), (1360, 4333), (1415, 4091), (1497, 4287), (1397, 4193), (1475, 4349), (1425, 4191), (1386, 4277), (1400, 4143), (1408, 4193), (1472, 4093), (1476, 4197), (1440, 4052), (1460, 4029), (1453, 4153), (1448, 4183), (1383, 4084), (1334, 4128)]
         : compromised: 0.3504, honest: 0.3403

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 10.0% compromised
Final accuracy - Compromised: 0.3504, Honest: 0.3403
Overall test accuracy: mean=0.3413 ± 0.0119
