Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: gaussian, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
UBAR ALGORITHM (Two-Stage Byzantine-resilient)
  - Model dimension: 1,174,986 parameters
  - Rho parameter: 0.8
  - Stage 1: Distance-based filtering (select 80% closest neighbors)
  - Stage 2: Performance-based selection (loss comparison)
  - Complexity: O(deg(i)×d + deg(i)×inference)
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5517 ± 0.0281 | min=0.5114 max=0.5940
         : test loss mean=0.6883 ± 0.0023
         : individual accs = ['0.583263', '0.593818', '0.580331', '0.565942', '0.566021', '0.511375', '0.590687', '0.593972', '0.550091', '0.547763', '0.513246', '0.516291', '0.532395', '0.535580', '0.529050', '0.526572', '0.558621', '0.526408', '0.528594', '0.584902']
         : correct/total = [(8301, 14232), (8453, 14235), (8279, 14266), (8046, 14217), (8059, 14238), (7350, 14373), (8474, 14346), (8514, 14334), (7863, 14294), (7873, 14373), (7362, 14344), (7384, 14302), (7642, 14354), (7692, 14362), (7576, 14320), (7580, 14395), (8038, 14389), (7505, 14257), (7533, 14251), (8422, 14399)]
         : compromised: 0.5264, honest: 0.5581
         : ubar stats = ['Node 0: s1=0.500, s2=1.000', 'Node 1: s1=0.500, s2=1.000', 'Node 2: s1=0.500, s2=1.000']...
Round 002: test acc mean=0.6343 ± 0.0090 | min=0.6101 max=0.6474
         : test loss mean=0.6499 ± 0.0144
         : individual accs = ['0.641161', '0.630980', '0.636408', '0.638742', '0.644964', '0.633479', '0.639063', '0.647412', '0.628515', '0.616573', '0.635388', '0.641938', '0.639195', '0.636193', '0.634637', '0.630427', '0.610119', '0.625587', '0.630272', '0.644003']
         : correct/total = [(9125, 14232), (8982, 14235), (9079, 14266), (9081, 14217), (9183, 14238), (9105, 14373), (9168, 14346), (9280, 14334), (8984, 14294), (8862, 14373), (9114, 14344), (9181, 14302), (9175, 14354), (9137, 14362), (9088, 14320), (9075, 14395), (8779, 14389), (8919, 14257), (8982, 14251), (9273, 14399)]
         : compromised: 0.6336, honest: 0.6344
         : ubar stats = ['Node 0: s1=0.500, s2=1.000', 'Node 1: s1=0.500, s2=1.000', 'Node 2: s1=0.500, s2=1.000']...
Round 003: test acc mean=0.6362 ± 0.0099 | min=0.6124 max=0.6545
         : test loss mean=0.6400 ± 0.0098
         : individual accs = ['0.631956', '0.612434', '0.632273', '0.648590', '0.650723', '0.643707', '0.620591', '0.631436', '0.633273', '0.642524', '0.645357', '0.654454', '0.639822', '0.641902', '0.628492', '0.631817', '0.635416', '0.632111', '0.629149', '0.638100']
         : correct/total = [(8994, 14232), (8718, 14235), (9020, 14266), (9221, 14217), (9265, 14238), (9252, 14373), (8903, 14346), (9051, 14334), (9052, 14294), (9235, 14373), (9257, 14344), (9360, 14302), (9184, 14354), (9219, 14362), (9000, 14320), (9095, 14395), (9143, 14389), (9012, 14257), (8966, 14251), (9188, 14399)]
         : compromised: 0.6394, honest: 0.6354
         : ubar stats = ['Node 0: s1=0.500, s2=1.000', 'Node 1: s1=0.500, s2=1.000', 'Node 2: s1=0.500, s2=1.000']...
Round 004: test acc mean=0.6480 ± 0.0063 | min=0.6392 max=0.6600
         : test loss mean=0.6276 ± 0.0068
         : individual accs = ['0.653808', '0.640183', '0.647063', '0.648097', '0.656412', '0.656578', '0.645685', '0.653760', '0.639219', '0.639811', '0.650934', '0.660048', '0.652292', '0.643364', '0.642179', '0.641125', '0.647022', '0.645297', '0.641780', '0.655462']
         : correct/total = [(9305, 14232), (9113, 14235), (9231, 14266), (9214, 14217), (9346, 14238), (9437, 14373), (9263, 14346), (9371, 14334), (9137, 14294), (9196, 14373), (9337, 14344), (9440, 14302), (9363, 14354), (9240, 14362), (9196, 14320), (9229, 14395), (9310, 14389), (9200, 14257), (9146, 14251), (9438, 14399)]
         : compromised: 0.6494, honest: 0.6477
         : ubar stats = ['Node 0: s1=0.500, s2=1.000', 'Node 1: s1=0.500, s2=1.000', 'Node 2: s1=0.500, s2=1.000']...
Round 005: test acc mean=0.6535 ± 0.0054 | min=0.6424 max=0.6642
         : test loss mean=0.6220 ± 0.0059
         : individual accs = ['0.650927', '0.655708', '0.644539', '0.661110', '0.664208', '0.649412', '0.650913', '0.659551', '0.655520', '0.657692', '0.652468', '0.658369', '0.657796', '0.651511', '0.651397', '0.655019', '0.642435', '0.646980', '0.649849', '0.654420']
         : correct/total = [(9264, 14232), (9334, 14235), (9195, 14266), (9399, 14217), (9457, 14238), (9334, 14373), (9338, 14346), (9454, 14334), (9370, 14294), (9453, 14373), (9359, 14344), (9416, 14302), (9442, 14354), (9357, 14362), (9328, 14320), (9429, 14395), (9244, 14389), (9224, 14257), (9261, 14251), (9423, 14399)]
         : compromised: 0.6514, honest: 0.6540
         : ubar stats = ['Node 0: s1=0.500, s2=1.000', 'Node 1: s1=0.500, s2=1.000', 'Node 2: s1=0.500, s2=1.000']...
Round 006: test acc mean=0.6583 ± 0.0053 | min=0.6426 max=0.6669
         : test loss mean=0.6158 ± 0.0050
         : individual accs = ['0.657392', '0.658869', '0.642577', '0.657312', '0.663787', '0.665901', '0.660184', '0.666876', '0.654330', '0.655952', '0.658115', '0.659069', '0.660443', '0.664323', '0.656913', '0.656617', '0.654250', '0.652942', '0.656375', '0.662893']
         : correct/total = [(9356, 14232), (9379, 14235), (9167, 14266), (9345, 14217), (9451, 14238), (9571, 14373), (9471, 14346), (9559, 14334), (9353, 14294), (9428, 14373), (9440, 14344), (9426, 14302), (9480, 14354), (9541, 14362), (9407, 14320), (9452, 14395), (9414, 14389), (9309, 14257), (9354, 14251), (9545, 14399)]
         : compromised: 0.6609, honest: 0.6576
         : ubar stats = ['Node 0: s1=0.500, s2=1.000', 'Node 1: s1=0.500, s2=1.000', 'Node 2: s1=0.500, s2=1.000']...
Round 007: test acc mean=0.6628 ± 0.0083 | min=0.6452 max=0.6767
         : test loss mean=0.6119 ± 0.0074
         : individual accs = ['0.659781', '0.661257', '0.645170', '0.667159', '0.674041', '0.672720', '0.668340', '0.676713', '0.664335', '0.668684', '0.656093', '0.660257', '0.666992', '0.669614', '0.652723', '0.657451', '0.664674', '0.650978', '0.651393', '0.668102']
         : correct/total = [(9390, 14232), (9413, 14235), (9204, 14266), (9485, 14217), (9597, 14238), (9669, 14373), (9588, 14346), (9700, 14334), (9496, 14294), (9611, 14373), (9411, 14344), (9443, 14302), (9574, 14354), (9617, 14362), (9347, 14320), (9464, 14395), (9564, 14389), (9281, 14257), (9283, 14251), (9620, 14399)]
         : compromised: 0.6651, honest: 0.6623
         : ubar stats = ['Node 0: s1=0.500, s2=1.000', 'Node 1: s1=0.500, s2=1.000', 'Node 2: s1=0.500, s2=1.000']...
Round 008: test acc mean=0.6654 ± 0.0079 | min=0.6498 max=0.6787
         : test loss mean=0.6081 ± 0.0068
         : individual accs = ['0.669618', '0.650790', '0.650638', '0.649785', '0.661680', '0.671398', '0.661718', '0.667364', '0.666154', '0.670980', '0.670943', '0.678716', '0.677860', '0.662234', '0.665363', '0.666273', '0.670582', '0.659115', '0.665988', '0.670741']
         : correct/total = [(9530, 14232), (9264, 14235), (9282, 14266), (9238, 14217), (9421, 14238), (9650, 14373), (9493, 14346), (9566, 14334), (9522, 14294), (9644, 14373), (9624, 14344), (9707, 14302), (9730, 14354), (9511, 14362), (9528, 14320), (9591, 14395), (9649, 14389), (9397, 14257), (9491, 14251), (9658, 14399)]
         : compromised: 0.6677, honest: 0.6648
         : ubar stats = ['Node 0: s1=0.500, s2=1.000', 'Node 1: s1=0.500, s2=1.000', 'Node 2: s1=0.500, s2=1.000']...
Round 009: test acc mean=0.6672 ± 0.0101 | min=0.6440 max=0.6782
         : test loss mean=0.6053 ± 0.0078
         : individual accs = ['0.644042', '0.649526', '0.659470', '0.670324', '0.678115', '0.673902', '0.654398', '0.666736', '0.665734', '0.665206', '0.674498', '0.677458', '0.677651', '0.678248', '0.665154', '0.668635', '0.674960', '0.676790', '0.670620', '0.652337']
         : correct/total = [(9166, 14232), (9246, 14235), (9408, 14266), (9530, 14217), (9655, 14238), (9686, 14373), (9388, 14346), (9557, 14334), (9516, 14294), (9561, 14373), (9675, 14344), (9689, 14302), (9727, 14354), (9741, 14362), (9525, 14320), (9625, 14395), (9712, 14389), (9649, 14257), (9557, 14251), (9393, 14399)]
         : compromised: 0.6766, honest: 0.6648
         : ubar stats = ['Node 0: s1=0.500, s2=1.000', 'Node 1: s1=0.500, s2=1.000', 'Node 2: s1=0.500, s2=1.000']...
Round 010: test acc mean=0.6807 ± 0.0074 | min=0.6627 max=0.6926
         : test loss mean=0.5921 ± 0.0068
         : individual accs = ['0.673201', '0.673902', '0.662695', '0.678624', '0.691179', '0.690948', '0.683048', '0.691014', '0.675388', '0.681417', '0.683770', '0.687456', '0.692560', '0.683261', '0.674721', '0.681973', '0.679338', '0.676790', '0.673005', '0.680603']
         : correct/total = [(9581, 14232), (9593, 14235), (9454, 14266), (9648, 14217), (9841, 14238), (9931, 14373), (9799, 14346), (9905, 14334), (9654, 14294), (9794, 14373), (9808, 14344), (9832, 14302), (9941, 14354), (9813, 14362), (9662, 14320), (9817, 14395), (9775, 14389), (9649, 14257), (9591, 14251), (9800, 14399)]
         : compromised: 0.6859, honest: 0.6795
         : ubar stats = ['Node 0: s1=0.500, s2=1.000', 'Node 1: s1=0.500, s2=1.000', 'Node 2: s1=0.500, s2=1.000']...

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: ubar
Attack: gaussian, 20.0% compromised
Final accuracy - Compromised: 0.6859, Honest: 0.6795
Overall test accuracy: mean=0.6807 ± 0.0074

=== UBAR SUMMARY ===
Node 0: stage1=0.500, stage2=1.000, overall=0.500
Node 1: stage1=0.500, stage2=1.000, overall=0.500
Node 2: stage1=0.500, stage2=1.000, overall=0.500
Node 3: stage1=0.500, stage2=1.000, overall=0.500
Node 4: stage1=0.500, stage2=1.000, overall=0.500
Node 5: stage1=0.500, stage2=1.000, overall=0.500
Node 6: stage1=0.500, stage2=1.000, overall=0.500
Node 7: stage1=0.500, stage2=1.000, overall=0.500
Node 8: stage1=0.500, stage2=1.000, overall=0.500
Node 9: stage1=0.500, stage2=1.000, overall=0.500
Node 10: stage1=0.500, stage2=1.000, overall=0.500
Node 11: stage1=0.500, stage2=1.000, overall=0.500
Node 12: stage1=0.500, stage2=1.000, overall=0.500
Node 13: stage1=0.500, stage2=1.000, overall=0.500
Node 14: stage1=0.500, stage2=1.000, overall=0.500
Node 15: stage1=0.500, stage2=1.000, overall=0.500
Node 16: stage1=0.500, stage2=1.000, overall=0.500
Node 17: stage1=0.500, stage2=1.000, overall=0.500
Node 18: stage1=0.500, stage2=1.000, overall=0.500
Node 19: stage1=0.500, stage2=1.000, overall=0.500

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Distance computation: 0.022s (57.6%)
    - Loss computation: 0.012s (33.0%)
    - Aggregation: 0.003s (9.3%)
  TOTALS:
    - Total computation: 0.037s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.037s

=== PER-NODE AVERAGE TIME ===
  - Distance computation: 0.009s
  - Loss computation: 0.008s
  - Aggregation: 0.003s
  - Model transfer: 0.000s
  - Total per node: 0.020s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total distance computation: 0.171s
  - Total loss computation: 0.165s
  - Total aggregation: 0.065s
  - Total model transfer: 0.000s
  - Grand total: 0.401s
  - Mean Stage 1 acceptance rate: 0.500
  - Mean Stage 2 acceptance rate: 1.000
  - Overall acceptance rate: 0.500

UBAR Algorithm Properties:
  - Model dimension: 1,174,986
  - Rho parameter: 0.8
  - Two-stage approach: Distance filtering + loss evaluation
  - Stage 1 selects: 80% of neighbors
  - Stage 2 uses: Training sample loss comparison
  - Theoretical complexity: O(deg(i)×d + deg(i)×inference)
  - Approach: UBAR paper implementation
