Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Degree statistics: avg=19.00, min=19, max=19
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5004 ± 0.0074 | min=0.4831 max=0.5097
         : test loss mean=24.9387 ± 8.2338
         : individual accs = ['0.507518', '0.489357', '0.483107', '0.502286', '0.502528', '0.495095', '0.499930', '0.486047', '0.502379', '0.502609', '0.502301', '0.493288', '0.504528', '0.494778', '0.505237', '0.505592', '0.506151', '0.508031', '0.509719', '0.507257']
         : correct/total = [(7223, 14232), (6966, 14235), (6892, 14266), (7141, 14217), (7155, 14238), (7116, 14373), (7172, 14346), (6967, 14334), (7181, 14294), (7224, 14373), (7205, 14344), (7055, 14302), (7242, 14354), (7106, 14362), (7235, 14320), (7278, 14395), (7283, 14389), (7243, 14257), (7264, 14251), (7304, 14399)]
         : compromised: 0.5000, honest: 0.5006
Round 002: test acc mean=0.4961 ± 0.0034 | min=0.4902 max=0.5040
         : test loss mean=15.3670 ± 0.1593
         : individual accs = ['0.496698', '0.498911', '0.497126', '0.497995', '0.493468', '0.501218', '0.496445', '0.503977', '0.495942', '0.495234', '0.497560', '0.499371', '0.496377', '0.490182', '0.497765', '0.491421', '0.491626', '0.492320', '0.494211', '0.493437']
         : correct/total = [(7069, 14232), (7102, 14235), (7092, 14266), (7080, 14217), (7026, 14238), (7204, 14373), (7122, 14346), (7224, 14334), (7089, 14294), (7118, 14373), (7137, 14344), (7142, 14302), (7125, 14354), (7040, 14362), (7128, 14320), (7074, 14395), (7074, 14389), (7019, 14257), (7043, 14251), (7105, 14399)]
         : compromised: 0.4963, honest: 0.4959
Round 003: test acc mean=0.5023 ± 0.0052 | min=0.4947 max=0.5127
         : test loss mean=2.0600 ± 0.0242
         : individual accs = ['0.497119', '0.497014', '0.496565', '0.499472', '0.503441', '0.500591', '0.502509', '0.505232', '0.495663', '0.500383', '0.501325', '0.494686', '0.508917', '0.512672', '0.503282', '0.507607', '0.504969', '0.510276', '0.496176', '0.508646']
         : correct/total = [(7075, 14232), (7075, 14235), (7084, 14266), (7101, 14217), (7168, 14238), (7195, 14373), (7209, 14346), (7242, 14334), (7085, 14294), (7192, 14373), (7191, 14344), (7075, 14302), (7305, 14354), (7363, 14362), (7207, 14320), (7307, 14395), (7266, 14389), (7275, 14257), (7071, 14251), (7324, 14399)]
         : compromised: 0.5030, honest: 0.5019
Round 004: test acc mean=0.5140 ± 0.0039 | min=0.5069 max=0.5200
         : test loss mean=0.8366 ± 0.0053
         : individual accs = ['0.517636', '0.509449', '0.519697', '0.515791', '0.510746', '0.508940', '0.509898', '0.514650', '0.516720', '0.506853', '0.512409', '0.512446', '0.519367', '0.519983', '0.510056', '0.512609', '0.516367', '0.517220', '0.517297', '0.512397']
         : correct/total = [(7367, 14232), (7252, 14235), (7414, 14266), (7333, 14217), (7272, 14238), (7315, 14373), (7315, 14346), (7377, 14334), (7386, 14294), (7285, 14373), (7350, 14344), (7329, 14302), (7455, 14354), (7468, 14362), (7304, 14320), (7379, 14395), (7430, 14389), (7374, 14257), (7372, 14251), (7378, 14399)]
         : compromised: 0.5143, honest: 0.5138
Round 005: test acc mean=0.5155 ± 0.0037 | min=0.5071 max=0.5205
         : test loss mean=0.7658 ± 0.0033
         : individual accs = ['0.517566', '0.514436', '0.519066', '0.516143', '0.513906', '0.507131', '0.509480', '0.516604', '0.520288', '0.511306', '0.513316', '0.519298', '0.519367', '0.519148', '0.510265', '0.520458', '0.516853', '0.514274', '0.518069', '0.513855']
         : correct/total = [(7366, 14232), (7323, 14235), (7405, 14266), (7338, 14217), (7317, 14238), (7289, 14373), (7309, 14346), (7405, 14334), (7437, 14294), (7349, 14373), (7363, 14344), (7427, 14302), (7455, 14354), (7456, 14362), (7307, 14320), (7492, 14395), (7437, 14389), (7332, 14257), (7383, 14251), (7399, 14399)]
         : compromised: 0.5152, honest: 0.5157
Round 006: test acc mean=0.5120 ± 0.0044 | min=0.5034 max=0.5206
         : test loss mean=0.7392 ± 0.0022
         : individual accs = ['0.517144', '0.513734', '0.520608', '0.514947', '0.512502', '0.510193', '0.514359', '0.517511', '0.517630', '0.512419', '0.510527', '0.512516', '0.507663', '0.506893', '0.503422', '0.511289', '0.514490', '0.506418', '0.510069', '0.506216']
         : correct/total = [(7360, 14232), (7313, 14235), (7427, 14266), (7321, 14217), (7297, 14238), (7333, 14373), (7379, 14346), (7418, 14334), (7399, 14294), (7365, 14373), (7323, 14344), (7330, 14302), (7287, 14354), (7280, 14362), (7209, 14320), (7360, 14395), (7403, 14389), (7220, 14257), (7269, 14251), (7289, 14399)]
         : compromised: 0.5089, honest: 0.5141
Round 007: test acc mean=0.5182 ± 0.0042 | min=0.5086 max=0.5242
         : test loss mean=0.7173 ± 0.0020
         : individual accs = ['0.521431', '0.514436', '0.523903', '0.519730', '0.515030', '0.515202', '0.515754', '0.520720', '0.519519', '0.515063', '0.511503', '0.520137', '0.516441', '0.523395', '0.508589', '0.521570', '0.524220', '0.521218', '0.514069', '0.521147']
         : correct/total = [(7421, 14232), (7323, 14235), (7474, 14266), (7389, 14217), (7333, 14238), (7405, 14373), (7399, 14346), (7464, 14334), (7426, 14294), (7403, 14373), (7337, 14344), (7439, 14302), (7413, 14354), (7517, 14362), (7283, 14320), (7508, 14395), (7543, 14389), (7431, 14257), (7326, 14251), (7504, 14399)]
         : compromised: 0.5167, honest: 0.5191
Round 008: test acc mean=0.5226 ± 0.0036 | min=0.5158 max=0.5315
         : test loss mean=0.7095 ± 0.0022
         : individual accs = ['0.526841', '0.519002', '0.523202', '0.525709', '0.517699', '0.515828', '0.522236', '0.521418', '0.520988', '0.522160', '0.521054', '0.524892', '0.522293', '0.531542', '0.516341', '0.522265', '0.525193', '0.525426', '0.523612', '0.523995']
         : correct/total = [(7498, 14232), (7388, 14235), (7464, 14266), (7474, 14217), (7371, 14238), (7414, 14373), (7492, 14346), (7474, 14334), (7447, 14294), (7505, 14373), (7474, 14344), (7507, 14302), (7497, 14354), (7634, 14362), (7394, 14320), (7518, 14395), (7557, 14389), (7491, 14257), (7462, 14251), (7545, 14399)]
         : compromised: 0.5224, honest: 0.5227
Round 009: test acc mean=0.5244 ± 0.0043 | min=0.5192 max=0.5365
         : test loss mean=0.7037 ± 0.0019
         : individual accs = ['0.528527', '0.519986', '0.529090', '0.536541', '0.519244', '0.519864', '0.522166', '0.523790', '0.526864', '0.530926', '0.525376', '0.526220', '0.520552', '0.524579', '0.520950', '0.519764', '0.523108', '0.523953', '0.525577', '0.521842']
         : correct/total = [(7522, 14232), (7402, 14235), (7548, 14266), (7628, 14217), (7393, 14238), (7472, 14373), (7491, 14346), (7508, 14334), (7531, 14294), (7631, 14373), (7536, 14344), (7526, 14302), (7472, 14354), (7534, 14362), (7460, 14320), (7482, 14395), (7527, 14389), (7470, 14257), (7490, 14251), (7514, 14399)]
         : compromised: 0.5227, honest: 0.5256
Round 010: test acc mean=0.5284 ± 0.0031 | min=0.5243 max=0.5338
         : test loss mean=0.7000 ± 0.0016
         : individual accs = ['0.532743', '0.533755', '0.530843', '0.532672', '0.526830', '0.527865', '0.524815', '0.527906', '0.532601', '0.528908', '0.524540', '0.531464', '0.525637', '0.530776', '0.524302', '0.524488', '0.524567', '0.526969', '0.528173', '0.528856']
         : correct/total = [(7582, 14232), (7598, 14235), (7573, 14266), (7573, 14217), (7501, 14238), (7587, 14373), (7529, 14346), (7567, 14334), (7613, 14294), (7602, 14373), (7524, 14344), (7601, 14302), (7545, 14354), (7623, 14362), (7508, 14320), (7550, 14395), (7548, 14389), (7513, 14257), (7527, 14251), (7615, 14399)]
         : compromised: 0.5286, honest: 0.5283

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: fully, Aggregation: krum
Attack: directed_deviation, 40.0% compromised
Final accuracy - Compromised: 0.5286, Honest: 0.5283
Overall test accuracy: mean=0.5284 ± 0.0031
