Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5099 ± 0.0360 | min=0.4909 max=0.6193
         : test loss mean=22.8863 ± 13.7523
         : individual accs = ['0.504989', '0.496944', '0.500140', '0.614968', '0.496559', '0.500661', '0.500139', '0.498744', '0.493844', '0.619286', '0.503974', '0.493637', '0.499861', '0.504456', '0.490922', '0.496422', '0.492599', '0.494704', '0.496246', '0.497951']
         : correct/total = [(7187, 14232), (7074, 14235), (7135, 14266), (8743, 14217), (7070, 14238), (7196, 14373), (7175, 14346), (7149, 14334), (7059, 14294), (8901, 14373), (7229, 14344), (7060, 14302), (7175, 14354), (7245, 14362), (7030, 14320), (7146, 14395), (7088, 14389), (7053, 14257), (7072, 14251), (7170, 14399)]
         : compromised: 0.4999, honest: 0.5123
Round 002: test acc mean=0.6144 ± 0.0655 | min=0.4890 max=0.6669
         : test loss mean=2.2681 ± 4.6679
         : individual accs = ['0.642144', '0.489006', '0.641736', '0.648097', '0.507726', '0.646768', '0.664715', '0.657597', '0.658948', '0.660544', '0.501115', '0.660048', '0.510171', '0.666899', '0.643087', '0.641751', '0.644312', '0.501999', '0.656586', '0.645392']
         : correct/total = [(9139, 14232), (6961, 14235), (9155, 14266), (9214, 14217), (7229, 14238), (9296, 14373), (9536, 14346), (9426, 14334), (9419, 14294), (9494, 14373), (7188, 14344), (9440, 14302), (7323, 14354), (9578, 14362), (9209, 14320), (9238, 14395), (9271, 14389), (7157, 14257), (9357, 14251), (9293, 14399)]
         : compromised: 0.5815, honest: 0.6227
Round 003: test acc mean=0.6576 ± 0.0139 | min=0.6308 max=0.6784
         : test loss mean=0.6176 ± 0.0153
         : individual accs = ['0.630762', '0.676853', '0.665428', '0.668706', '0.678396', '0.633827', '0.639481', '0.644482', '0.665874', '0.666249', '0.663832', '0.645155', '0.660095', '0.670102', '0.659707', '0.662174', '0.673431', '0.644105', '0.656656', '0.647267']
         : correct/total = [(8977, 14232), (9635, 14235), (9493, 14266), (9507, 14217), (9659, 14238), (9110, 14373), (9174, 14346), (9238, 14334), (9518, 14294), (9576, 14373), (9522, 14344), (9227, 14302), (9475, 14354), (9624, 14362), (9447, 14320), (9532, 14395), (9690, 14389), (9183, 14257), (9358, 14251), (9320, 14399)]
         : compromised: 0.6520, honest: 0.6590
Round 004: test acc mean=0.6756 ± 0.0071 | min=0.6614 max=0.6869
         : test loss mean=0.6021 ± 0.0086
         : individual accs = ['0.680720', '0.673411', '0.667181', '0.678976', '0.676429', '0.680164', '0.661439', '0.663178', '0.681545', '0.677242', '0.680145', '0.662774', '0.682946', '0.684445', '0.672765', '0.672247', '0.674474', '0.676019', '0.679531', '0.686923']
         : correct/total = [(9688, 14232), (9586, 14235), (9518, 14266), (9653, 14217), (9631, 14238), (9776, 14373), (9489, 14346), (9506, 14334), (9742, 14294), (9734, 14373), (9756, 14344), (9479, 14302), (9803, 14354), (9830, 14362), (9634, 14320), (9677, 14395), (9705, 14389), (9638, 14257), (9684, 14251), (9891, 14399)]
         : compromised: 0.6809, honest: 0.6743
Round 005: test acc mean=0.6870 ± 0.0063 | min=0.6775 max=0.7043
         : test loss mean=0.5844 ± 0.0044
         : individual accs = ['0.683600', '0.690692', '0.688210', '0.677499', '0.704312', '0.685034', '0.685139', '0.685084', '0.684833', '0.687539', '0.690114', '0.685429', '0.686847', '0.683958', '0.678352', '0.682320', '0.698033', '0.695939', '0.680654', '0.686784']
         : correct/total = [(9729, 14232), (9832, 14235), (9818, 14266), (9632, 14217), (10028, 14238), (9846, 14373), (9829, 14346), (9820, 14334), (9789, 14294), (9882, 14373), (9899, 14344), (9803, 14302), (9859, 14354), (9823, 14362), (9714, 14320), (9822, 14395), (10044, 14389), (9922, 14257), (9700, 14251), (9889, 14399)]
         : compromised: 0.6879, honest: 0.6868
Round 006: test acc mean=0.6840 ± 0.0096 | min=0.6744 max=0.7099
         : test loss mean=0.5864 ± 0.0084
         : individual accs = ['0.681422', '0.709870', '0.687158', '0.682493', '0.683031', '0.680721', '0.677262', '0.677899', '0.683434', '0.682738', '0.698759', '0.676758', '0.674446', '0.678666', '0.676257', '0.674540', '0.692890', '0.703584', '0.676303', '0.682200']
         : correct/total = [(9698, 14232), (10105, 14235), (9803, 14266), (9703, 14217), (9725, 14238), (9784, 14373), (9716, 14346), (9717, 14334), (9769, 14294), (9813, 14373), (10023, 14344), (9679, 14302), (9681, 14354), (9747, 14362), (9684, 14320), (9710, 14395), (9970, 14389), (10031, 14257), (9638, 14251), (9823, 14399)]
         : compromised: 0.6844, honest: 0.6839
Round 007: test acc mean=0.6968 ± 0.0051 | min=0.6874 max=0.7072
         : test loss mean=0.5718 ± 0.0045
         : individual accs = ['0.687886', '0.705374', '0.690243', '0.698882', '0.707192', '0.699367', '0.698801', '0.697572', '0.697356', '0.694845', '0.702245', '0.698014', '0.696182', '0.697466', '0.687430', '0.696422', '0.696226', '0.691099', '0.692022', '0.700882']
         : correct/total = [(9790, 14232), (10041, 14235), (9847, 14266), (9936, 14217), (10069, 14238), (10052, 14373), (10025, 14346), (9999, 14334), (9968, 14294), (9987, 14373), (10073, 14344), (9983, 14302), (9993, 14354), (10017, 14362), (9844, 14320), (10025, 14395), (10018, 14389), (9853, 14257), (9862, 14251), (10092, 14399)]
         : compromised: 0.6960, honest: 0.6970
Round 008: test acc mean=0.7013 ± 0.0084 | min=0.6889 max=0.7149
         : test loss mean=0.5703 ± 0.0105
         : individual accs = ['0.704609', '0.694415', '0.691925', '0.697123', '0.705787', '0.711055', '0.699847', '0.696596', '0.713726', '0.690670', '0.709356', '0.701370', '0.714923', '0.695237', '0.707193', '0.693366', '0.688860', '0.714035', '0.690688', '0.705882']
         : correct/total = [(10028, 14232), (9885, 14235), (9871, 14266), (9911, 14217), (10049, 14238), (10220, 14373), (10040, 14346), (9985, 14334), (10202, 14294), (9927, 14373), (10175, 14344), (10031, 14302), (10262, 14354), (9985, 14362), (10127, 14320), (9981, 14395), (9912, 14389), (10180, 14257), (9843, 14251), (10164, 14399)]
         : compromised: 0.7088, honest: 0.6995
Round 009: test acc mean=0.7033 ± 0.0112 | min=0.6662 max=0.7250
         : test loss mean=0.5682 ± 0.0111
         : individual accs = ['0.696740', '0.702634', '0.713374', '0.695998', '0.706279', '0.704237', '0.666248', '0.707479', '0.713166', '0.696027', '0.725042', '0.698783', '0.705518', '0.709093', '0.698254', '0.700452', '0.716033', '0.702602', '0.700232', '0.707410']
         : correct/total = [(9916, 14232), (10002, 14235), (10177, 14266), (9895, 14217), (10056, 14238), (10122, 14373), (9558, 14346), (10141, 14334), (10194, 14294), (10004, 14373), (10400, 14344), (9994, 14302), (10127, 14354), (10184, 14362), (9999, 14320), (10083, 14395), (10303, 14389), (10017, 14257), (9979, 14251), (10186, 14399)]
         : compromised: 0.7054, honest: 0.7028
Round 010: test acc mean=0.7123 ± 0.0071 | min=0.6990 max=0.7264
         : test loss mean=0.5559 ± 0.0083
         : individual accs = ['0.714938', '0.722023', '0.712323', '0.702821', '0.710142', '0.714256', '0.712673', '0.718362', '0.714216', '0.699297', '0.726366', '0.713397', '0.711718', '0.711113', '0.698953', '0.712331', '0.717284', '0.716350', '0.699319', '0.717203']
         : correct/total = [(10175, 14232), (10278, 14235), (10162, 14266), (9992, 14217), (10111, 14238), (10266, 14373), (10224, 14346), (10297, 14334), (10209, 14294), (10051, 14373), (10419, 14344), (10203, 14302), (10216, 14354), (10213, 14362), (10009, 14320), (10254, 14395), (10321, 14389), (10213, 14257), (9966, 14251), (10327, 14399)]
         : compromised: 0.7134, honest: 0.7120

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 20.0% compromised
Final accuracy - Compromised: 0.7134, Honest: 0.7120
Overall test accuracy: mean=0.7123 ± 0.0071
