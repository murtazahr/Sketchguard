Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 10/20 nodes: [1, 2, 5, 11, 12, 13, 14, 15, 17, 18]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5033 ± 0.0079 | min=0.4871 max=0.5177
         : test loss mean=1.6142 ± 0.5680
         : individual accs = ['0.496979', '0.487109', '0.512828', '0.511711', '0.494381', '0.489599', '0.503904', '0.498256', '0.505947', '0.509010', '0.517708', '0.505594', '0.505016', '0.505988', '0.500628', '0.511289', '0.510876', '0.505226', '0.494562', '0.500243']
         : correct/total = [(7073, 14232), (6934, 14235), (7316, 14266), (7275, 14217), (7039, 14238), (7037, 14373), (7229, 14346), (7142, 14334), (7232, 14294), (7316, 14373), (7426, 14344), (7231, 14302), (7249, 14354), (7267, 14362), (7169, 14320), (7360, 14395), (7351, 14389), (7203, 14257), (7048, 14251), (7203, 14399)]
         : compromised: 0.5018, honest: 0.5049
Round 002: test acc mean=0.5042 ± 0.0083 | min=0.4869 max=0.5195
         : test loss mean=0.7275 ± 0.0254
         : individual accs = ['0.494309', '0.505023', '0.519487', '0.510445', '0.504635', '0.494886', '0.497281', '0.498047', '0.512383', '0.510888', '0.505089', '0.515452', '0.486903', '0.501184', '0.501676', '0.498159', '0.514977', '0.497720', '0.513438', '0.502882']
         : correct/total = [(7035, 14232), (7189, 14235), (7411, 14266), (7257, 14217), (7185, 14238), (7113, 14373), (7134, 14346), (7139, 14334), (7324, 14294), (7343, 14373), (7245, 14344), (7372, 14302), (6989, 14354), (7198, 14362), (7184, 14320), (7171, 14395), (7410, 14389), (7096, 14257), (7317, 14251), (7241, 14399)]
         : compromised: 0.5034, honest: 0.5051
Round 003: test acc mean=0.5086 ± 0.0105 | min=0.4831 max=0.5253
         : test loss mean=0.7011 ± 0.0081
         : individual accs = ['0.504146', '0.507692', '0.520749', '0.507139', '0.515873', '0.501218', '0.501394', '0.512348', '0.511124', '0.521673', '0.500976', '0.515802', '0.483141', '0.525345', '0.509148', '0.505384', '0.513309', '0.494985', '0.495334', '0.524481']
         : correct/total = [(7175, 14232), (7227, 14235), (7429, 14266), (7210, 14217), (7345, 14238), (7204, 14373), (7193, 14346), (7344, 14334), (7306, 14294), (7498, 14373), (7186, 14344), (7377, 14302), (6935, 14354), (7545, 14362), (7291, 14320), (7275, 14395), (7386, 14389), (7057, 14257), (7059, 14251), (7552, 14399)]
         : compromised: 0.5059, honest: 0.5112
Round 004: test acc mean=0.5326 ± 0.0211 | min=0.5016 max=0.5717
         : test loss mean=0.6901 ± 0.0044
         : individual accs = ['0.544618', '0.507833', '0.524884', '0.522684', '0.562228', '0.526334', '0.538199', '0.571718', '0.524696', '0.562443', '0.511921', '0.560341', '0.515257', '0.519217', '0.521299', '0.501633', '0.536729', '0.502280', '0.534980', '0.562261']
         : correct/total = [(7751, 14232), (7229, 14235), (7488, 14266), (7431, 14217), (8005, 14238), (7565, 14373), (7721, 14346), (8195, 14334), (7500, 14294), (8084, 14373), (7343, 14344), (8014, 14302), (7396, 14354), (7457, 14362), (7465, 14320), (7221, 14395), (7723, 14389), (7161, 14257), (7624, 14251), (8096, 14399)]
         : compromised: 0.5214, honest: 0.5437
Round 005: test acc mean=0.5763 ± 0.0140 | min=0.5387 max=0.5987
         : test loss mean=0.6801 ± 0.0041
         : individual accs = ['0.580804', '0.591430', '0.577247', '0.578814', '0.592218', '0.557991', '0.588945', '0.598716', '0.557297', '0.582342', '0.565045', '0.565935', '0.538665', '0.586687', '0.574930', '0.569086', '0.588436', '0.574665', '0.582135', '0.574554']
         : correct/total = [(8266, 14232), (8419, 14235), (8235, 14266), (8229, 14217), (8432, 14238), (8020, 14373), (8449, 14346), (8582, 14334), (7966, 14294), (8370, 14373), (8105, 14344), (8094, 14302), (7732, 14354), (8426, 14362), (8233, 14320), (8192, 14395), (8467, 14389), (8193, 14257), (8296, 14251), (8273, 14399)]
         : compromised: 0.5719, honest: 0.5807
Round 006: test acc mean=0.6014 ± 0.0049 | min=0.5913 max=0.6095
         : test loss mean=0.6667 ± 0.0031
         : individual accs = ['0.602586', '0.608992', '0.597785', '0.601182', '0.607810', '0.607041', '0.601073', '0.604437', '0.591297', '0.596953', '0.605898', '0.601105', '0.598021', '0.602145', '0.592668', '0.595901', '0.601223', '0.609455', '0.599467', '0.603514']
         : correct/total = [(8576, 14232), (8669, 14235), (8528, 14266), (8547, 14217), (8654, 14238), (8725, 14373), (8623, 14346), (8664, 14334), (8452, 14294), (8580, 14373), (8691, 14344), (8597, 14302), (8584, 14354), (8648, 14362), (8487, 14320), (8578, 14395), (8651, 14389), (8689, 14257), (8543, 14251), (8690, 14399)]
         : compromised: 0.6013, honest: 0.6016
Round 007: test acc mean=0.6119 ± 0.0032 | min=0.6054 max=0.6187
         : test loss mean=0.6566 ± 0.0013
         : individual accs = ['0.609191', '0.609413', '0.609141', '0.612295', '0.614974', '0.618730', '0.615572', '0.609181', '0.613124', '0.612398', '0.613915', '0.611803', '0.610283', '0.607297', '0.610894', '0.611810', '0.605393', '0.616469', '0.610764', '0.614695']
         : correct/total = [(8670, 14232), (8675, 14235), (8690, 14266), (8705, 14217), (8756, 14238), (8893, 14373), (8831, 14346), (8732, 14334), (8764, 14294), (8802, 14373), (8806, 14344), (8750, 14302), (8760, 14354), (8722, 14362), (8748, 14320), (8807, 14395), (8711, 14389), (8789, 14257), (8704, 14251), (8851, 14399)]
         : compromised: 0.6117, honest: 0.6121
Round 008: test acc mean=0.6178 ± 0.0028 | min=0.6122 max=0.6224
         : test loss mean=0.6511 ± 0.0018
         : individual accs = ['0.612212', '0.619248', '0.615519', '0.619751', '0.621295', '0.618799', '0.618012', '0.616157', '0.619701', '0.614903', '0.619562', '0.616277', '0.616274', '0.622406', '0.613897', '0.618340', '0.614080', '0.621730', '0.615957', '0.621571']
         : correct/total = [(8713, 14232), (8815, 14235), (8781, 14266), (8811, 14217), (8846, 14238), (8894, 14373), (8866, 14346), (8832, 14334), (8858, 14294), (8838, 14373), (8887, 14344), (8814, 14302), (8846, 14354), (8939, 14362), (8791, 14320), (8901, 14395), (8836, 14389), (8864, 14257), (8778, 14251), (8950, 14399)]
         : compromised: 0.6178, honest: 0.6177
Round 009: test acc mean=0.6229 ± 0.0038 | min=0.6134 max=0.6306
         : test loss mean=0.6470 ± 0.0019
         : individual accs = ['0.618536', '0.628381', '0.619024', '0.625659', '0.625018', '0.622626', '0.625052', '0.622087', '0.622429', '0.622695', '0.622978', '0.622500', '0.620106', '0.630553', '0.613408', '0.626745', '0.619918', '0.626850', '0.619746', '0.623307']
         : correct/total = [(8803, 14232), (8945, 14235), (8831, 14266), (8895, 14217), (8899, 14238), (8949, 14373), (8967, 14346), (8917, 14334), (8897, 14294), (8950, 14373), (8936, 14344), (8903, 14302), (8901, 14354), (9056, 14362), (8784, 14320), (9022, 14395), (8920, 14389), (8937, 14257), (8832, 14251), (8975, 14399)]
         : compromised: 0.6230, honest: 0.6228
Round 010: test acc mean=0.6286 ± 0.0038 | min=0.6236 max=0.6366
         : test loss mean=0.6425 ± 0.0018
         : individual accs = ['0.625070', '0.636108', '0.623581', '0.633045', '0.630847', '0.626383', '0.627283', '0.627110', '0.628935', '0.627218', '0.628555', '0.627884', '0.624774', '0.636610', '0.624372', '0.633623', '0.624574', '0.631409', '0.625781', '0.629488']
         : correct/total = [(8896, 14232), (9055, 14235), (8896, 14266), (9000, 14217), (8982, 14238), (9003, 14373), (8999, 14346), (8989, 14334), (8990, 14294), (9015, 14373), (9016, 14344), (8980, 14302), (8968, 14354), (9143, 14362), (8941, 14320), (9121, 14395), (8987, 14389), (9002, 14257), (8918, 14251), (9064, 14399)]
         : compromised: 0.6291, honest: 0.6282

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: krum, 50.0% compromised
Final accuracy - Compromised: 0.6291, Honest: 0.6282
Overall test accuracy: mean=0.6286 ± 0.0038

=== BALANCE SUMMARY ===
Node 0: acceptance=0.550
Node 1: acceptance=0.591
Node 2: acceptance=0.475
Node 3: acceptance=0.662
Node 4: acceptance=0.509
Node 5: acceptance=0.520
Node 6: acceptance=0.486
Node 7: acceptance=0.486
Node 8: acceptance=0.460
Node 9: acceptance=0.585
Node 10: acceptance=0.600
Node 11: acceptance=0.550
Node 12: acceptance=0.625
Node 13: acceptance=0.585
Node 14: acceptance=0.520
Node 15: acceptance=0.509
Node 16: acceptance=0.446
Node 17: acceptance=0.700
Node 18: acceptance=0.606
Node 19: acceptance=0.494

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.070s (82.1%)
    - Aggregation: 0.015s (17.9%)
  TOTALS:
    - Total computation: 0.085s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.085s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.054s
  - Aggregation: 0.008s
  - Model transfer: 0.000s
  - Total per node: 0.062s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 1.078s
  - Total aggregation: 0.159s
  - Total model transfer: 0.000s
  - Grand total: 1.237s
  - Mean acceptance rate: 0.548

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
