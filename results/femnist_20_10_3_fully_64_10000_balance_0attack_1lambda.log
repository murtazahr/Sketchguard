Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.5081 ± 0.0325 | min=0.4542 max=0.5589
         : test loss mean=3.7396 ± 0.0241
         : individual accs = ['0.558866', '0.514632', '0.532468', '0.500346', '0.464679', '0.551201', '0.497019', '0.499885', '0.540921', '0.475801', '0.477673', '0.534462', '0.481310', '0.467239', '0.525913', '0.541822', '0.472189', '0.553670', '0.517140', '0.454215']
         : correct/total = [(2307, 4128), (2163, 4203), (2173, 4081), (2168, 4333), (1901, 4091), (2363, 4287), (2084, 4193), (2174, 4349), (2267, 4191), (2035, 4277), (1979, 4143), (2241, 4193), (1970, 4093), (1961, 4197), (2131, 4052), (2183, 4029), (1961, 4153), (2316, 4183), (2112, 4084), (1875, 4128)]
Round 002: test acc mean=0.6826 ± 0.0200 | min=0.6184 max=0.7103
         : test loss mean=3.4470 ± 0.0253
         : individual accs = ['0.676357', '0.682370', '0.674590', '0.695130', '0.686629', '0.710287', '0.618412', '0.693723', '0.671916', '0.706336', '0.687907', '0.693060', '0.693868', '0.675006', '0.701382', '0.697195', '0.656152', '0.667703', '0.692458', '0.672238']
         : correct/total = [(2792, 4128), (2868, 4203), (2753, 4081), (3012, 4333), (2809, 4091), (3045, 4287), (2593, 4193), (3017, 4349), (2816, 4191), (3021, 4277), (2850, 4143), (2906, 4193), (2840, 4093), (2833, 4197), (2842, 4052), (2809, 4029), (2725, 4153), (2793, 4183), (2828, 4084), (2775, 4128)]
Round 003: test acc mean=0.7078 ± 0.0184 | min=0.6697 max=0.7346
         : test loss mean=3.2188 ± 0.0338
         : individual accs = ['0.734496', '0.700452', '0.685126', '0.718440', '0.690785', '0.669699', '0.716194', '0.725224', '0.725602', '0.688333', '0.705527', '0.734558', '0.731493', '0.716702', '0.726061', '0.706627', '0.685529', '0.702606', '0.690255', '0.701308']
         : correct/total = [(3032, 4128), (2944, 4203), (2796, 4081), (3113, 4333), (2826, 4091), (2871, 4287), (3003, 4193), (3154, 4349), (3041, 4191), (2944, 4277), (2923, 4143), (3080, 4193), (2994, 4093), (3008, 4197), (2942, 4052), (2847, 4029), (2847, 4153), (2939, 4183), (2819, 4084), (2895, 4128)]
Round 004: test acc mean=0.6969 ± 0.0266 | min=0.6454 max=0.7347
         : test loss mean=2.8140 ± 0.0499
         : individual accs = ['0.700339', '0.734713', '0.647145', '0.702054', '0.716206', '0.689293', '0.726449', '0.716716', '0.719876', '0.685995', '0.645426', '0.707608', '0.654043', '0.720991', '0.731491', '0.703152', '0.696605', '0.668420', '0.699314', '0.671996']
         : correct/total = [(2891, 4128), (3088, 4203), (2641, 4081), (3042, 4333), (2930, 4091), (2955, 4287), (3046, 4193), (3117, 4349), (3017, 4191), (2934, 4277), (2674, 4143), (2967, 4193), (2677, 4093), (3026, 4197), (2964, 4052), (2833, 4029), (2893, 4153), (2796, 4183), (2856, 4084), (2774, 4128)]
Round 005: test acc mean=0.6484 ± 0.0336 | min=0.5437 max=0.6929
         : test loss mean=2.2582 ± 0.0701
         : individual accs = ['0.677326', '0.649774', '0.543739', '0.621509', '0.655830', '0.659436', '0.672311', '0.669579', '0.674063', '0.681085', '0.617668', '0.654901', '0.651845', '0.641411', '0.661649', '0.623480', '0.675175', '0.597179', '0.692948', '0.647045']
         : correct/total = [(2796, 4128), (2731, 4203), (2219, 4081), (2693, 4333), (2683, 4091), (2827, 4287), (2819, 4193), (2912, 4349), (2825, 4191), (2913, 4277), (2559, 4143), (2746, 4193), (2668, 4093), (2692, 4197), (2681, 4052), (2512, 4029), (2804, 4153), (2498, 4183), (2830, 4084), (2671, 4128)]
Round 006: test acc mean=0.6847 ± 0.0202 | min=0.6456 max=0.7196
         : test loss mean=1.5441 ± 0.0637
         : individual accs = ['0.645591', '0.696169', '0.667974', '0.662589', '0.705451', '0.654070', '0.699738', '0.704760', '0.666189', '0.689502', '0.695873', '0.684713', '0.686538', '0.719562', '0.705331', '0.691487', '0.669877', '0.660292', '0.710578', '0.678537']
         : correct/total = [(2665, 4128), (2926, 4203), (2726, 4081), (2871, 4333), (2886, 4091), (2804, 4287), (2934, 4193), (3065, 4349), (2792, 4191), (2949, 4277), (2883, 4143), (2871, 4193), (2810, 4093), (3020, 4197), (2858, 4052), (2786, 4029), (2782, 4153), (2762, 4183), (2902, 4084), (2801, 4128)]
Round 007: test acc mean=0.7730 ± 0.0106 | min=0.7481 max=0.7911
         : test loss mean=0.9113 ± 0.0487
         : individual accs = ['0.772529', '0.782060', '0.748101', '0.763674', '0.767783', '0.785398', '0.791080', '0.784778', '0.771415', '0.776245', '0.771663', '0.758884', '0.760811', '0.781034', '0.781343', '0.768925', '0.772935', '0.765718', '0.787953', '0.767926']
         : correct/total = [(3189, 4128), (3287, 4203), (3053, 4081), (3309, 4333), (3141, 4091), (3367, 4287), (3317, 4193), (3413, 4349), (3233, 4191), (3320, 4277), (3197, 4143), (3182, 4193), (3114, 4093), (3278, 4197), (3166, 4052), (3098, 4029), (3210, 4153), (3203, 4183), (3218, 4084), (3170, 4128)]
Round 008: test acc mean=0.8140 ± 0.0071 | min=0.7968 max=0.8216
         : test loss mean=0.6154 ± 0.0242
         : individual accs = ['0.806686', '0.819177', '0.807890', '0.821602', '0.800293', '0.821320', '0.817553', '0.818809', '0.819375', '0.818331', '0.804248', '0.818746', '0.811630', '0.816774', '0.820829', '0.816083', '0.812906', '0.813292', '0.818071', '0.796754']
         : correct/total = [(3330, 4128), (3443, 4203), (3297, 4081), (3560, 4333), (3274, 4091), (3521, 4287), (3428, 4193), (3561, 4349), (3434, 4191), (3500, 4277), (3332, 4143), (3433, 4193), (3322, 4093), (3428, 4197), (3326, 4052), (3288, 4029), (3376, 4153), (3402, 4183), (3341, 4084), (3289, 4128)]
Round 009: test acc mean=0.8308 ± 0.0056 | min=0.8217 max=0.8444
         : test loss mean=0.5309 ± 0.0196
         : individual accs = ['0.824855', '0.835118', '0.827738', '0.834064', '0.823271', '0.832750', '0.836155', '0.832375', '0.844429', '0.834697', '0.823558', '0.825900', '0.827755', '0.830355', '0.837611', '0.834947', '0.829521', '0.826679', '0.833497', '0.821705']
         : correct/total = [(3405, 4128), (3510, 4203), (3378, 4081), (3614, 4333), (3368, 4091), (3570, 4287), (3506, 4193), (3620, 4349), (3539, 4191), (3570, 4277), (3412, 4143), (3463, 4193), (3388, 4093), (3485, 4197), (3394, 4052), (3364, 4029), (3445, 4153), (3458, 4183), (3404, 4084), (3392, 4128)]
Round 010: test acc mean=0.8396 ± 0.0057 | min=0.8281 max=0.8468
         : test loss mean=0.4956 ± 0.0191
         : individual accs = ['0.831880', '0.846538', '0.836070', '0.841911', '0.830848', '0.834616', '0.844264', '0.839963', '0.846815', '0.840542', '0.828144', '0.832578', '0.839726', '0.843936', '0.845508', '0.845371', '0.843246', '0.845804', '0.838639', '0.834787']
         : correct/total = [(3434, 4128), (3558, 4203), (3412, 4081), (3648, 4333), (3399, 4091), (3578, 4287), (3540, 4193), (3653, 4349), (3549, 4191), (3595, 4277), (3431, 4143), (3491, 4193), (3437, 4093), (3542, 4197), (3426, 4052), (3406, 4029), (3502, 4153), (3538, 4183), (3425, 4084), (3446, 4128)]

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: balance
Overall test accuracy: mean=0.8396 ± 0.0057

=== BALANCE SUMMARY ===
Node 0: acceptance=1.000
Node 1: acceptance=1.000
Node 2: acceptance=1.000
Node 3: acceptance=1.000
Node 4: acceptance=1.000
Node 5: acceptance=1.000
Node 6: acceptance=1.000
Node 7: acceptance=1.000
Node 8: acceptance=1.000
Node 9: acceptance=1.000
Node 10: acceptance=1.000
Node 11: acceptance=1.000
Node 12: acceptance=1.000
Node 13: acceptance=1.000
Node 14: acceptance=1.000
Node 15: acceptance=1.000
Node 16: acceptance=1.000
Node 17: acceptance=1.000
Node 18: acceptance=1.000
Node 19: acceptance=1.000

Performance Summary:
  - Distance computation time: 1.773s (43.7%)
  - Filtering time: 1.934s (47.6%)
  - Aggregation time: 0.352s (8.7%)
  - Total time: 4.058s
  - Mean acceptance rate: 1.000

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
