Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
Degree statistics: avg=4.80, min=2, max=7
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.0552 ± 0.0107 | min=0.0417 max=0.0857
         : test loss mean=3.6900 ± 0.0173
         : individual accs = ['0.045785', '0.052344', '0.050723', '0.052850', '0.051088', '0.050618', '0.042213', '0.058174', '0.085660', '0.074117', '0.050447', '0.072979', '0.058637', '0.047177', '0.050346', '0.041698', '0.058271', '0.050203', '0.055583', '0.054506']
         : correct/total = [(189, 4128), (220, 4203), (207, 4081), (229, 4333), (209, 4091), (217, 4287), (177, 4193), (253, 4349), (359, 4191), (317, 4277), (209, 4143), (306, 4193), (240, 4093), (198, 4197), (204, 4052), (168, 4029), (242, 4153), (210, 4183), (227, 4084), (225, 4128)]
         : compromised: 0.0489, honest: 0.0559
Round 002: test acc mean=0.0650 ± 0.0251 | min=0.0436 max=0.1230
         : test loss mean=3.6820 ± 0.0175
         : individual accs = ['0.044574', '0.048775', '0.123009', '0.043619', '0.112686', '0.045253', '0.088242', '0.045068', '0.051062', '0.050503', '0.045619', '0.061770', '0.095529', '0.088396', '0.051826', '0.100025', '0.054659', '0.048291', '0.053379', '0.048450']
         : correct/total = [(184, 4128), (205, 4203), (502, 4081), (189, 4333), (461, 4091), (194, 4287), (370, 4193), (196, 4349), (214, 4191), (216, 4277), (189, 4143), (259, 4193), (391, 4093), (371, 4197), (210, 4052), (403, 4029), (227, 4153), (202, 4183), (218, 4084), (200, 4128)]
         : compromised: 0.0668, honest: 0.0648
Round 003: test acc mean=0.0627 ± 0.0159 | min=0.0443 max=0.1009
         : test loss mean=3.6779 ± 0.0172
         : individual accs = ['0.085756', '0.054723', '0.080127', '0.076160', '0.074798', '0.049685', '0.044598', '0.051276', '0.058936', '0.081599', '0.050447', '0.078703', '0.058637', '0.046462', '0.100938', '0.050633', '0.058753', '0.050203', '0.058031', '0.044331']
         : correct/total = [(354, 4128), (230, 4203), (327, 4081), (330, 4333), (306, 4091), (213, 4287), (187, 4193), (223, 4349), (247, 4191), (349, 4277), (209, 4143), (330, 4193), (240, 4093), (195, 4197), (409, 4052), (204, 4029), (244, 4153), (210, 4183), (237, 4084), (183, 4128)]
         : compromised: 0.0481, honest: 0.0644
Round 004: test acc mean=0.0741 ± 0.0333 | min=0.0451 max=0.1445
         : test loss mean=3.6705 ± 0.0166
         : individual accs = ['0.059593', '0.050440', '0.135261', '0.053543', '0.138108', '0.045253', '0.050799', '0.045068', '0.116679', '0.054244', '0.099203', '0.054138', '0.058637', '0.063617', '0.051579', '0.144453', '0.058271', '0.098733', '0.055338', '0.048934']
         : correct/total = [(246, 4128), (212, 4203), (552, 4081), (232, 4333), (565, 4091), (194, 4287), (213, 4193), (196, 4349), (489, 4191), (232, 4277), (411, 4143), (227, 4193), (240, 4093), (267, 4197), (209, 4052), (582, 4029), (242, 4153), (413, 4183), (226, 4084), (202, 4128)]
         : compromised: 0.0544, honest: 0.0763
Round 005: test acc mean=0.1106 ± 0.0366 | min=0.0639 max=0.1737
         : test loss mean=3.6625 ± 0.0185
         : individual accs = ['0.069525', '0.100404', '0.076452', '0.063928', '0.113664', '0.099137', '0.075364', '0.080708', '0.162014', '0.065233', '0.172098', '0.120439', '0.082580', '0.098880', '0.173741', '0.131546', '0.081869', '0.161367', '0.134427', '0.149467']
         : correct/total = [(287, 4128), (422, 4203), (312, 4081), (277, 4333), (465, 4091), (425, 4287), (316, 4193), (351, 4349), (679, 4191), (279, 4277), (713, 4143), (505, 4193), (338, 4093), (415, 4197), (704, 4052), (530, 4029), (340, 4153), (675, 4183), (549, 4084), (617, 4128)]
         : compromised: 0.0990, honest: 0.1119
Round 006: test acc mean=0.0961 ± 0.0388 | min=0.0457 max=0.1646
         : test loss mean=3.6521 ± 0.0181
         : individual accs = ['0.067103', '0.142279', '0.048272', '0.084237', '0.139330', '0.103802', '0.145481', '0.113129', '0.164639', '0.080430', '0.060101', '0.084426', '0.045688', '0.093638', '0.070829', '0.152892', '0.049362', '0.059766', '0.149608', '0.066618']
         : correct/total = [(277, 4128), (598, 4203), (197, 4081), (365, 4333), (570, 4091), (445, 4287), (610, 4193), (492, 4349), (690, 4191), (344, 4277), (249, 4143), (354, 4193), (187, 4093), (393, 4197), (287, 4052), (616, 4029), (205, 4153), (250, 4183), (611, 4084), (275, 4128)]
         : compromised: 0.0987, honest: 0.0958
Round 007: test acc mean=0.1075 ± 0.0375 | min=0.0459 max=0.2062
         : test loss mean=3.6319 ± 0.0186
         : individual accs = ['0.085271', '0.150369', '0.103651', '0.119086', '0.047421', '0.124796', '0.148581', '0.079099', '0.206156', '0.084639', '0.137581', '0.087765', '0.082580', '0.137956', '0.112784', '0.072475', '0.083313', '0.045900', '0.128306', '0.111676']
         : correct/total = [(352, 4128), (632, 4203), (423, 4081), (516, 4333), (194, 4091), (535, 4287), (623, 4193), (344, 4349), (864, 4191), (362, 4277), (570, 4143), (368, 4193), (338, 4093), (579, 4197), (457, 4052), (292, 4029), (346, 4153), (192, 4183), (524, 4084), (461, 4128)]
         : compromised: 0.1314, honest: 0.1048
Round 008: test acc mean=0.1886 ± 0.0289 | min=0.1336 max=0.2572
         : test loss mean=3.5832 ± 0.0293
         : individual accs = ['0.185804', '0.200333', '0.223230', '0.191553', '0.223662', '0.188477', '0.195087', '0.193148', '0.257218', '0.156184', '0.173304', '0.163606', '0.133643', '0.187991', '0.223840', '0.182427', '0.137732', '0.198422', '0.187316', '0.168120']
         : correct/total = [(767, 4128), (842, 4203), (911, 4081), (830, 4333), (915, 4091), (808, 4287), (818, 4193), (840, 4349), (1078, 4191), (668, 4277), (718, 4143), (686, 4193), (547, 4093), (789, 4197), (907, 4052), (735, 4029), (572, 4153), (830, 4183), (765, 4084), (694, 4128)]
         : compromised: 0.1882, honest: 0.1886
Round 009: test acc mean=0.2116 ± 0.0217 | min=0.1641 max=0.2630
         : test loss mean=3.4712 ± 0.0267
         : individual accs = ['0.198401', '0.211278', '0.229846', '0.191092', '0.218528', '0.205972', '0.200811', '0.195907', '0.244572', '0.205986', '0.164132', '0.201765', '0.202541', '0.233024', '0.216190', '0.207247', '0.196003', '0.201530', '0.262977', '0.243702']
         : correct/total = [(819, 4128), (888, 4203), (938, 4081), (828, 4333), (894, 4091), (883, 4287), (842, 4193), (852, 4349), (1025, 4191), (881, 4277), (680, 4143), (846, 4193), (829, 4093), (978, 4197), (876, 4052), (835, 4029), (814, 4153), (843, 4183), (1074, 4084), (1006, 4128)]
         : compromised: 0.2195, honest: 0.2107
Round 010: test acc mean=0.2833 ± 0.0221 | min=0.2404 max=0.3333
         : test loss mean=3.1652 ± 0.0406
         : individual accs = ['0.290698', '0.279800', '0.275668', '0.284791', '0.279394', '0.289713', '0.297877', '0.305128', '0.283942', '0.266074', '0.240406', '0.279036', '0.305644', '0.279247', '0.241362', '0.316704', '0.281002', '0.281616', '0.333252', '0.254118']
         : correct/total = [(1200, 4128), (1176, 4203), (1125, 4081), (1234, 4333), (1143, 4091), (1242, 4287), (1249, 4193), (1327, 4349), (1190, 4191), (1138, 4277), (996, 4143), (1170, 4193), (1251, 4093), (1172, 4197), (978, 4052), (1276, 4029), (1167, 4153), (1178, 4183), (1361, 4084), (1049, 4128)]
         : compromised: 0.2845, honest: 0.2831

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: krum, 10.0% compromised
Final accuracy - Compromised: 0.2845, Honest: 0.2831
Overall test accuracy: mean=0.2833 ± 0.0221
