Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5011 ± 0.0106 | min=0.4839 max=0.5207
         : test loss mean=1.1225 ± 0.8054
         : individual accs = ['0.498384', '0.486758', '0.483878', '0.517409', '0.515873', '0.498295', '0.508295', '0.505860', '0.489716', '0.506923', '0.488776', '0.496224', '0.510589', '0.501741', '0.520670', '0.513095', '0.501355', '0.492320', '0.489860', '0.495659']
         : correct/total = [(7093, 14232), (6929, 14235), (6903, 14266), (7356, 14217), (7345, 14238), (7162, 14373), (7292, 14346), (7251, 14334), (7000, 14294), (7286, 14373), (7011, 14344), (7097, 14302), (7329, 14354), (7206, 14362), (7456, 14320), (7386, 14395), (7214, 14389), (7019, 14257), (6981, 14251), (7137, 14399)]
         : compromised: 0.5022, honest: 0.5006
Round 002: test acc mean=0.5095 ± 0.0128 | min=0.4894 max=0.5401
         : test loss mean=0.6995 ± 0.0133
         : individual accs = ['0.510399', '0.489357', '0.490467', '0.510867', '0.517840', '0.500174', '0.501673', '0.505511', '0.524906', '0.515689', '0.521054', '0.531045', '0.501254', '0.515736', '0.497416', '0.540118', '0.501355', '0.502560', '0.513297', '0.499479']
         : correct/total = [(7264, 14232), (6966, 14235), (6997, 14266), (7263, 14217), (7373, 14238), (7189, 14373), (7197, 14346), (7246, 14334), (7503, 14294), (7412, 14373), (7474, 14344), (7595, 14302), (7195, 14354), (7407, 14362), (7123, 14320), (7775, 14395), (7214, 14389), (7165, 14257), (7315, 14251), (7192, 14399)]
         : compromised: 0.5051, honest: 0.5114
Round 003: test acc mean=0.5120 ± 0.0157 | min=0.4863 max=0.5506
         : test loss mean=0.6924 ± 0.0020
         : individual accs = ['0.511523', '0.486266', '0.492640', '0.509812', '0.550569', '0.518403', '0.509201', '0.495396', '0.540017', '0.495860', '0.522518', '0.539505', '0.513028', '0.508912', '0.501536', '0.506982', '0.509486', '0.509995', '0.508456', '0.508924']
         : correct/total = [(7280, 14232), (6922, 14235), (7028, 14266), (7248, 14217), (7839, 14238), (7451, 14373), (7305, 14346), (7101, 14334), (7719, 14294), (7127, 14373), (7495, 14344), (7716, 14302), (7364, 14354), (7309, 14362), (7182, 14320), (7298, 14395), (7331, 14389), (7271, 14257), (7246, 14251), (7328, 14399)]
         : compromised: 0.5101, honest: 0.5128
Round 004: test acc mean=0.5196 ± 0.0191 | min=0.4943 max=0.5501
         : test loss mean=0.6918 ± 0.0012
         : individual accs = ['0.546164', '0.494275', '0.521239', '0.497714', '0.535188', '0.539066', '0.500488', '0.495256', '0.543095', '0.507201', '0.516523', '0.537477', '0.504877', '0.508982', '0.495810', '0.506426', '0.536312', '0.542470', '0.513017', '0.550108']
         : correct/total = [(7773, 14232), (7036, 14235), (7436, 14266), (7076, 14217), (7620, 14238), (7748, 14373), (7180, 14346), (7099, 14334), (7763, 14294), (7290, 14373), (7409, 14344), (7687, 14302), (7247, 14354), (7310, 14362), (7100, 14320), (7290, 14395), (7717, 14389), (7734, 14257), (7311, 14251), (7921, 14399)]
         : compromised: 0.5174, honest: 0.5205
Round 005: test acc mean=0.5198 ± 0.0226 | min=0.4905 max=0.5874
         : test loss mean=0.6908 ± 0.0019
         : individual accs = ['0.501405', '0.506568', '0.490467', '0.523950', '0.518401', '0.552425', '0.512826', '0.506697', '0.587449', '0.506366', '0.514919', '0.500909', '0.500697', '0.521376', '0.498953', '0.516707', '0.549864', '0.516378', '0.523963', '0.545038']
         : correct/total = [(7136, 14232), (7211, 14235), (6997, 14266), (7449, 14217), (7381, 14238), (7940, 14373), (7357, 14346), (7263, 14334), (8397, 14294), (7278, 14373), (7386, 14344), (7164, 14302), (7187, 14354), (7488, 14362), (7145, 14320), (7438, 14395), (7912, 14389), (7362, 14257), (7467, 14251), (7848, 14399)]
         : compromised: 0.5190, honest: 0.5201
Round 006: test acc mean=0.5319 ± 0.0233 | min=0.5002 max=0.5885
         : test loss mean=0.6894 ± 0.0022
         : individual accs = ['0.506043', '0.512399', '0.505748', '0.554618', '0.510395', '0.561261', '0.538687', '0.531603', '0.588499', '0.512489', '0.571249', '0.534331', '0.535251', '0.524648', '0.500209', '0.528725', '0.526930', '0.517781', '0.519964', '0.557817']
         : correct/total = [(7202, 14232), (7294, 14235), (7215, 14266), (7885, 14217), (7267, 14238), (8067, 14373), (7728, 14346), (7620, 14334), (8412, 14294), (7366, 14373), (8194, 14344), (7642, 14302), (7683, 14354), (7535, 14362), (7163, 14320), (7611, 14395), (7582, 14389), (7382, 14257), (7410, 14251), (8032, 14399)]
         : compromised: 0.5265, honest: 0.5343
Round 007: test acc mean=0.5564 ± 0.0163 | min=0.5321 max=0.5939
         : test loss mean=0.6865 ± 0.0024
         : individual accs = ['0.562816', '0.535371', '0.536310', '0.567490', '0.546636', '0.561678', '0.555346', '0.555253', '0.593886', '0.538788', '0.584844', '0.551601', '0.539919', '0.556608', '0.532053', '0.559847', '0.563000', '0.545767', '0.560101', '0.580110']
         : correct/total = [(8010, 14232), (7621, 14235), (7651, 14266), (8068, 14217), (7783, 14238), (8073, 14373), (7967, 14346), (7959, 14334), (8489, 14294), (7744, 14373), (8389, 14344), (7889, 14302), (7750, 14354), (7994, 14362), (7619, 14320), (8059, 14395), (8101, 14389), (7781, 14257), (7982, 14251), (8353, 14399)]
         : compromised: 0.5494, honest: 0.5594
Round 008: test acc mean=0.5807 ± 0.0140 | min=0.5468 max=0.6041
         : test loss mean=0.6807 ± 0.0034
         : individual accs = ['0.565627', '0.567194', '0.546825', '0.599353', '0.561525', '0.588743', '0.581835', '0.584484', '0.596684', '0.572254', '0.604085', '0.576493', '0.592378', '0.574293', '0.568575', '0.592220', '0.585517', '0.576419', '0.588239', '0.591152']
         : correct/total = [(8050, 14232), (8074, 14235), (7801, 14266), (8521, 14217), (7995, 14238), (8462, 14373), (8347, 14346), (8378, 14334), (8529, 14294), (8225, 14373), (8665, 14344), (8245, 14302), (8503, 14354), (8248, 14362), (8142, 14320), (8525, 14395), (8425, 14389), (8218, 14257), (8383, 14251), (8512, 14399)]
         : compromised: 0.5814, honest: 0.5804
Round 009: test acc mean=0.6010 ± 0.0070 | min=0.5840 max=0.6103
         : test loss mean=0.6703 ± 0.0036
         : individual accs = ['0.595489', '0.604074', '0.586780', '0.610326', '0.596713', '0.599944', '0.608323', '0.609600', '0.603470', '0.599179', '0.609384', '0.598168', '0.600111', '0.605974', '0.584008', '0.607364', '0.597331', '0.595988', '0.601431', '0.605667']
         : correct/total = [(8475, 14232), (8599, 14235), (8371, 14266), (8677, 14217), (8496, 14238), (8623, 14373), (8727, 14346), (8738, 14334), (8626, 14294), (8612, 14373), (8741, 14344), (8555, 14302), (8614, 14354), (8703, 14362), (8363, 14320), (8743, 14395), (8595, 14389), (8497, 14257), (8571, 14251), (8721, 14399)]
         : compromised: 0.5979, honest: 0.6023
Round 010: test acc mean=0.6131 ± 0.0033 | min=0.6050 max=0.6195
         : test loss mean=0.6593 ± 0.0020
         : individual accs = ['0.612915', '0.618686', '0.605005', '0.616586', '0.610198', '0.612259', '0.614318', '0.613995', '0.610886', '0.613511', '0.619492', '0.611942', '0.613975', '0.614051', '0.608869', '0.613755', '0.611022', '0.608683', '0.614624', '0.616362']
         : correct/total = [(8723, 14232), (8807, 14235), (8631, 14266), (8766, 14217), (8688, 14238), (8800, 14373), (8813, 14346), (8801, 14334), (8732, 14294), (8818, 14373), (8886, 14344), (8752, 14302), (8813, 14354), (8819, 14362), (8719, 14320), (8835, 14395), (8792, 14389), (8678, 14257), (8759, 14251), (8875, 14399)]
         : compromised: 0.6121, honest: 0.6135

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: krum, 30.0% compromised
Final accuracy - Compromised: 0.6121, Honest: 0.6135
Overall test accuracy: mean=0.6131 ± 0.0033

=== BALANCE SUMMARY ===
Node 0: acceptance=0.700
Node 1: acceptance=0.820
Node 2: acceptance=0.775
Node 3: acceptance=0.743
Node 4: acceptance=0.700
Node 5: acceptance=0.730
Node 6: acceptance=0.625
Node 7: acceptance=0.591
Node 8: acceptance=0.357
Node 9: acceptance=0.918
Node 10: acceptance=0.775
Node 11: acceptance=0.625
Node 12: acceptance=0.775
Node 13: acceptance=0.800
Node 14: acceptance=0.679
Node 15: acceptance=0.600
Node 16: acceptance=0.614
Node 17: acceptance=0.775
Node 18: acceptance=0.775
Node 19: acceptance=0.640

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.058s (78.5%)
    - Aggregation: 0.016s (21.5%)
  TOTALS:
    - Total computation: 0.074s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.074s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.044s
  - Aggregation: 0.008s
  - Model transfer: 0.000s
  - Total per node: 0.052s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 0.873s
  - Total aggregation: 0.159s
  - Total model transfer: 0.000s
  - Grand total: 1.033s
  - Mean acceptance rate: 0.701

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
