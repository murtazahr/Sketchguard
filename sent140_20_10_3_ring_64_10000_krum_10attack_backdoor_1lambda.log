Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 2/20 nodes: [5, 13]
Attack type: backdoor, lambda: 1.0
Backdoor target label: 1, trigger size: 3
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4965 ± 0.0152
Backdoor attack: Created poisoned datasets for 2 compromised nodes
Round 001: test acc mean=0.5902 ± 0.0287 | min=0.5064 max=0.6137
         : test loss mean=3.5490 ± 8.7410
         : individual accs = ['0.597175', '0.598806', '0.601991', '0.595414', '0.588847', '0.506436', '0.579395', '0.613716', '0.610886', '0.598831', '0.593698', '0.599217', '0.608402', '0.507102', '0.596229', '0.601806', '0.598096', '0.599846', '0.605431', '0.602264']
         : correct/total = [(8499, 14232), (8524, 14235), (8588, 14266), (8465, 14217), (8384, 14238), (7279, 14373), (8312, 14346), (8797, 14334), (8732, 14294), (8607, 14373), (8516, 14344), (8570, 14302), (8733, 14354), (7283, 14362), (8538, 14320), (8663, 14395), (8606, 14389), (8552, 14257), (8628, 14251), (8672, 14399)]
         : compromised: 0.5068, honest: 0.5994
Round 002: test acc mean=0.6008 ± 0.0412 | min=0.4949 max=0.6253
         : test loss mean=5.7583 ± 12.1659
         : individual accs = ['0.623033', '0.621426', '0.613767', '0.618204', '0.606405', '0.510123', '0.505576', '0.623901', '0.624388', '0.618451', '0.617959', '0.614110', '0.625261', '0.494917', '0.614106', '0.619660', '0.610258', '0.617100', '0.618062', '0.618932']
         : correct/total = [(8867, 14232), (8846, 14235), (8756, 14266), (8789, 14217), (8634, 14238), (7332, 14373), (7253, 14346), (8943, 14334), (8925, 14294), (8889, 14373), (8864, 14344), (8783, 14302), (8975, 14354), (7108, 14362), (8794, 14320), (8920, 14395), (8781, 14389), (8798, 14257), (8808, 14251), (8912, 14399)]
         : compromised: 0.5025, honest: 0.6117
Round 003: test acc mean=0.6103 ± 0.0466 | min=0.4939 max=0.6392
         : test loss mean=4.9469 ± 11.3294
         : individual accs = ['0.635048', '0.631401', '0.626805', '0.631146', '0.632603', '0.493912', '0.497491', '0.628017', '0.630614', '0.633410', '0.611475', '0.623759', '0.635990', '0.509678', '0.630587', '0.639180', '0.623532', '0.626429', '0.632447', '0.633447']
         : correct/total = [(9038, 14232), (8988, 14235), (8942, 14266), (8973, 14217), (9007, 14238), (7099, 14373), (7137, 14346), (9002, 14334), (9014, 14294), (9104, 14373), (8771, 14344), (8921, 14302), (9129, 14354), (7320, 14362), (9030, 14320), (9201, 14395), (8972, 14389), (8931, 14257), (9013, 14251), (9121, 14399)]
         : compromised: 0.5018, honest: 0.6224
Round 004: test acc mean=0.6189 ± 0.0502 | min=0.4919 max=0.6476
         : test loss mean=6.0710 ± 15.3613
         : individual accs = ['0.647555', '0.639480', '0.638651', '0.638109', '0.642717', '0.506088', '0.501882', '0.638273', '0.638030', '0.640994', '0.636294', '0.633338', '0.642190', '0.491923', '0.647067', '0.643487', '0.642713', '0.632461', '0.637780', '0.639906']
         : correct/total = [(9216, 14232), (9103, 14235), (9111, 14266), (9072, 14217), (9151, 14238), (7274, 14373), (7200, 14346), (9149, 14334), (9120, 14294), (9213, 14373), (9127, 14344), (9058, 14302), (9218, 14354), (7065, 14362), (9266, 14320), (9263, 14395), (9248, 14389), (9017, 14257), (9089, 14251), (9214, 14399)]
         : compromised: 0.4990, honest: 0.6323
Round 005: test acc mean=0.6236 ± 0.0527 | min=0.4904 max=0.6564
         : test loss mean=4.2601 ± 10.2408
         : individual accs = ['0.652614', '0.649315', '0.645311', '0.649996', '0.648616', '0.490433', '0.498118', '0.646854', '0.639079', '0.636332', '0.642359', '0.638932', '0.648112', '0.507798', '0.647486', '0.656408', '0.650844', '0.638073', '0.641780', '0.642961']
         : correct/total = [(9288, 14232), (9243, 14235), (9206, 14266), (9241, 14217), (9235, 14238), (7049, 14373), (7146, 14346), (9272, 14334), (9135, 14294), (9146, 14373), (9214, 14344), (9138, 14302), (9303, 14354), (7293, 14362), (9272, 14320), (9449, 14395), (9365, 14389), (9097, 14257), (9146, 14251), (9258, 14399)]
         : compromised: 0.4991, honest: 0.6374
Round 006: test acc mean=0.6270 ± 0.0540 | min=0.4907 max=0.6591
         : test loss mean=4.5239 ± 10.4376
         : individual accs = ['0.657392', '0.659150', '0.657017', '0.656679', '0.658168', '0.507410', '0.500349', '0.645877', '0.643277', '0.645864', '0.647379', '0.644875', '0.640727', '0.490739', '0.657961', '0.651893', '0.638891', '0.640738', '0.649568', '0.645809']
         : correct/total = [(9356, 14232), (9383, 14235), (9373, 14266), (9336, 14217), (9371, 14238), (7293, 14373), (7178, 14346), (9258, 14334), (9195, 14294), (9283, 14373), (9286, 14344), (9223, 14302), (9197, 14354), (7048, 14362), (9422, 14320), (9384, 14395), (9193, 14389), (9135, 14257), (9257, 14251), (9299, 14399)]
         : compromised: 0.4991, honest: 0.6412
Round 007: test acc mean=0.6339 ± 0.0560 | min=0.4970 max=0.6685
         : test loss mean=4.3155 ± 9.8766
         : individual accs = ['0.668494', '0.664278', '0.655264', '0.662165', '0.667158', '0.497043', '0.499303', '0.650830', '0.647474', '0.656578', '0.650098', '0.646273', '0.652431', '0.508286', '0.662570', '0.665787', '0.663354', '0.648874', '0.655252', '0.655740']
         : correct/total = [(9514, 14232), (9456, 14235), (9348, 14266), (9414, 14217), (9499, 14238), (7144, 14373), (7163, 14346), (9329, 14334), (9255, 14294), (9437, 14373), (9325, 14344), (9243, 14302), (9365, 14354), (7300, 14362), (9488, 14320), (9584, 14395), (9545, 14389), (9251, 14257), (9338, 14251), (9442, 14399)]
         : compromised: 0.5027, honest: 0.6484
Round 008: test acc mean=0.6371 ± 0.0581 | min=0.4934 max=0.6698
         : test loss mean=4.7522 ± 10.2579
         : individual accs = ['0.665261', '0.666315', '0.664307', '0.665049', '0.663014', '0.504140', '0.500558', '0.657039', '0.660347', '0.658874', '0.659579', '0.645574', '0.660304', '0.493385', '0.669553', '0.669816', '0.666968', '0.654415', '0.659041', '0.659004']
         : correct/total = [(9468, 14232), (9485, 14235), (9477, 14266), (9455, 14217), (9440, 14238), (7246, 14373), (7181, 14346), (9418, 14334), (9439, 14294), (9470, 14373), (9461, 14344), (9233, 14302), (9478, 14354), (7086, 14362), (9588, 14320), (9642, 14395), (9597, 14389), (9330, 14257), (9392, 14251), (9489, 14399)]
         : compromised: 0.4988, honest: 0.6525
Round 009: test acc mean=0.6420 ± 0.0570 | min=0.4958 max=0.6794
         : test loss mean=3.2066 ± 8.1766
         : individual accs = ['0.679384', '0.669968', '0.669914', '0.669199', '0.665824', '0.495791', '0.519030', '0.670504', '0.663355', '0.665414', '0.655466', '0.660677', '0.664693', '0.506963', '0.666480', '0.672386', '0.667593', '0.657572', '0.659533', '0.661018']
         : correct/total = [(9669, 14232), (9537, 14235), (9557, 14266), (9514, 14217), (9480, 14238), (7126, 14373), (7446, 14346), (9611, 14334), (9482, 14294), (9564, 14373), (9402, 14344), (9449, 14302), (9541, 14354), (7281, 14362), (9544, 14320), (9679, 14395), (9606, 14389), (9375, 14257), (9399, 14251), (9518, 14399)]
         : compromised: 0.5014, honest: 0.6577
Round 010: test acc mean=0.6465 ± 0.0596 | min=0.4916 max=0.6833
         : test loss mean=3.7915 ± 9.7770
         : individual accs = ['0.683319', '0.675729', '0.677064', '0.672012', '0.677764', '0.511793', '0.513174', '0.667434', '0.666433', '0.669241', '0.662298', '0.662075', '0.674098', '0.491645', '0.676397', '0.678777', '0.676072', '0.662762', '0.665637', '0.666713']
         : correct/total = [(9725, 14232), (9619, 14235), (9659, 14266), (9554, 14217), (9650, 14238), (7356, 14373), (7362, 14346), (9567, 14334), (9526, 14294), (9619, 14373), (9500, 14344), (9469, 14302), (9676, 14354), (7061, 14362), (9686, 14320), (9771, 14395), (9728, 14389), (9449, 14257), (9486, 14251), (9600, 14399)]
         : compromised: 0.5017, honest: 0.6626

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: krum
Attack: backdoor, 10.0% compromised
Final accuracy - Compromised: 0.5017, Honest: 0.6626
Overall test accuracy: mean=0.6465 ± 0.0596

=== BACKDOOR ATTACK SUCCESS RATE (ASR) ===
Target label: 1
Trigger size: 3x3
Overall ASR: 0.4411 ± 0.1159
Honest nodes ASR: 0.4731 ± 0.0629
Compromised nodes ASR: 0.1526 ± 0.0798
Note: Higher ASR indicates more successful backdoor attack
