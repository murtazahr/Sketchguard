Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5009 ± 0.0107 | min=0.4816 max=0.5201
         : test loss mean=1.1068 ± 0.7877
         : individual accs = ['0.481591', '0.482894', '0.486051', '0.496026', '0.510395', '0.502192', '0.507040', '0.510186', '0.495523', '0.504488', '0.489124', '0.498462', '0.506270', '0.513090', '0.520112', '0.512886', '0.514212', '0.497089', '0.497088', '0.493298']
         : correct/total = [(6854, 14232), (6874, 14235), (6934, 14266), (7052, 14217), (7267, 14238), (7218, 14373), (7274, 14346), (7313, 14334), (7083, 14294), (7251, 14373), (7016, 14344), (7129, 14302), (7267, 14354), (7369, 14362), (7448, 14320), (7383, 14395), (7399, 14389), (7087, 14257), (7084, 14251), (7103, 14399)]
         : compromised: 0.5060, honest: 0.4987
Round 002: test acc mean=0.5228 ± 0.0282 | min=0.4907 max=0.5924
         : test loss mean=0.6930 ± 0.0075
         : individual accs = ['0.517566', '0.490692', '0.532805', '0.524091', '0.499368', '0.504001', '0.571936', '0.492605', '0.497831', '0.592430', '0.566788', '0.535799', '0.505016', '0.544353', '0.493156', '0.546509', '0.507818', '0.509504', '0.504386', '0.519758']
         : correct/total = [(7366, 14232), (6985, 14235), (7601, 14266), (7451, 14217), (7110, 14238), (7244, 14373), (8205, 14346), (7061, 14334), (7116, 14294), (8515, 14373), (8130, 14344), (7663, 14302), (7249, 14354), (7818, 14362), (7062, 14320), (7867, 14395), (7307, 14389), (7264, 14257), (7188, 14251), (7484, 14399)]
         : compromised: 0.5101, honest: 0.5283
Round 003: test acc mean=0.5394 ± 0.0380 | min=0.4847 max=0.5978
         : test loss mean=0.6888 ± 0.0037
         : individual accs = ['0.592187', '0.484721', '0.589443', '0.491806', '0.562298', '0.512767', '0.515475', '0.493233', '0.513922', '0.518959', '0.502998', '0.574116', '0.559844', '0.566147', '0.569763', '0.497812', '0.575648', '0.597812', '0.500807', '0.568720']
         : correct/total = [(8428, 14232), (6900, 14235), (8409, 14266), (6992, 14217), (8006, 14238), (7370, 14373), (7395, 14346), (7070, 14334), (7346, 14294), (7459, 14373), (7215, 14344), (8211, 14302), (8036, 14354), (8131, 14362), (8159, 14320), (7166, 14395), (8283, 14389), (8523, 14257), (7137, 14251), (8189, 14399)]
         : compromised: 0.5512, honest: 0.5344
Round 004: test acc mean=0.5881 ± 0.0279 | min=0.5327 max=0.6241
         : test loss mean=0.6819 ± 0.0034
         : individual accs = ['0.607153', '0.613980', '0.617342', '0.574242', '0.576766', '0.619425', '0.556113', '0.549533', '0.583602', '0.621304', '0.573201', '0.572507', '0.565835', '0.612519', '0.532682', '0.579159', '0.621030', '0.552290', '0.624097', '0.608723']
         : correct/total = [(8641, 14232), (8740, 14235), (8807, 14266), (8164, 14217), (8212, 14238), (8903, 14373), (7978, 14346), (7877, 14334), (8342, 14294), (8930, 14373), (8222, 14344), (8188, 14302), (8122, 14354), (8797, 14362), (7628, 14320), (8337, 14395), (8936, 14389), (7874, 14257), (8894, 14251), (8765, 14399)]
         : compromised: 0.5845, honest: 0.5896
Round 005: test acc mean=0.6225 ± 0.0180 | min=0.5817 max=0.6437
         : test loss mean=0.6714 ± 0.0073
         : individual accs = ['0.620784', '0.641166', '0.620356', '0.639797', '0.637168', '0.581716', '0.643664', '0.624808', '0.634322', '0.615042', '0.638316', '0.632709', '0.616205', '0.603607', '0.595461', '0.587565', '0.627841', '0.630287', '0.615255', '0.643447']
         : correct/total = [(8835, 14232), (9127, 14235), (8850, 14266), (9096, 14217), (9072, 14238), (8361, 14373), (9234, 14346), (8956, 14334), (9067, 14294), (8840, 14373), (9156, 14344), (9049, 14302), (8845, 14354), (8669, 14362), (8527, 14320), (8458, 14395), (9034, 14389), (8986, 14257), (8768, 14251), (9265, 14399)]
         : compromised: 0.6071, honest: 0.6291
Round 006: test acc mean=0.6424 ± 0.0077 | min=0.6166 max=0.6510
         : test loss mean=0.6525 ± 0.0071
         : individual accs = ['0.646079', '0.651001', '0.641806', '0.647886', '0.645034', '0.648160', '0.648473', '0.647621', '0.645935', '0.647673', '0.631832', '0.616627', '0.642887', '0.646219', '0.641201', '0.641612', '0.639725', '0.637582', '0.634271', '0.646850']
         : correct/total = [(9195, 14232), (9267, 14235), (9156, 14266), (9211, 14217), (9184, 14238), (9316, 14373), (9303, 14346), (9283, 14334), (9233, 14294), (9309, 14373), (9063, 14344), (8819, 14302), (9228, 14354), (9281, 14362), (9182, 14320), (9236, 14395), (9205, 14389), (9090, 14257), (9039, 14251), (9314, 14399)]
         : compromised: 0.6417, honest: 0.6427
Round 007: test acc mean=0.6479 ± 0.0088 | min=0.6237 max=0.6582
         : test loss mean=0.6361 ± 0.0050
         : individual accs = ['0.653387', '0.657323', '0.645381', '0.653162', '0.650091', '0.658248', '0.651959', '0.623692', '0.653561', '0.656091', '0.640128', '0.641379', '0.654382', '0.628603', '0.651187', '0.647030', '0.649802', '0.651119', '0.642622', '0.649698']
         : correct/total = [(9299, 14232), (9357, 14235), (9207, 14266), (9286, 14217), (9256, 14238), (9461, 14373), (9353, 14346), (8940, 14334), (9342, 14294), (9430, 14373), (9182, 14344), (9173, 14302), (9393, 14354), (9028, 14362), (9325, 14320), (9314, 14395), (9350, 14389), (9283, 14257), (9158, 14251), (9355, 14399)]
         : compromised: 0.6477, honest: 0.6480
Round 008: test acc mean=0.6535 ± 0.0078 | min=0.6307 max=0.6647
         : test loss mean=0.6262 ± 0.0050
         : individual accs = ['0.653738', '0.645451', '0.630660', '0.664697', '0.647844', '0.662005', '0.662903', '0.658016', '0.658178', '0.661101', '0.654211', '0.654174', '0.651317', '0.652695', '0.651466', '0.658076', '0.653624', '0.648033', '0.642762', '0.659143']
         : correct/total = [(9304, 14232), (9188, 14235), (8997, 14266), (9450, 14217), (9224, 14238), (9515, 14373), (9510, 14346), (9432, 14334), (9408, 14294), (9502, 14373), (9384, 14344), (9356, 14302), (9349, 14354), (9374, 14362), (9329, 14320), (9473, 14395), (9405, 14389), (9239, 14257), (9160, 14251), (9491, 14399)]
         : compromised: 0.6514, honest: 0.6544
Round 009: test acc mean=0.6580 ± 0.0082 | min=0.6333 max=0.6695
         : test loss mean=0.6201 ± 0.0056
         : individual accs = ['0.633291', '0.668985', '0.659750', '0.668636', '0.650653', '0.669519', '0.659487', '0.656760', '0.652162', '0.657831', '0.648006', '0.654664', '0.659886', '0.656803', '0.659148', '0.652171', '0.660783', '0.662482', '0.661006', '0.667477']
         : correct/total = [(9013, 14232), (9523, 14235), (9412, 14266), (9506, 14217), (9264, 14238), (9623, 14373), (9461, 14346), (9414, 14334), (9322, 14294), (9455, 14373), (9295, 14344), (9363, 14302), (9472, 14354), (9433, 14362), (9439, 14320), (9388, 14395), (9508, 14389), (9445, 14257), (9420, 14251), (9611, 14399)]
         : compromised: 0.6615, honest: 0.6565
Round 010: test acc mean=0.6676 ± 0.0061 | min=0.6523 max=0.6765
         : test loss mean=0.6094 ± 0.0048
         : individual accs = ['0.664980', '0.672989', '0.652320', '0.673912', '0.673058', '0.669380', '0.674683', '0.672318', '0.663915', '0.665414', '0.669967', '0.667109', '0.676466', '0.667665', '0.669204', '0.660924', '0.667385', '0.668584', '0.654691', '0.667546']
         : correct/total = [(9464, 14232), (9580, 14235), (9306, 14266), (9581, 14217), (9583, 14238), (9621, 14373), (9679, 14346), (9637, 14334), (9490, 14294), (9564, 14373), (9610, 14344), (9541, 14302), (9710, 14354), (9589, 14362), (9583, 14320), (9514, 14395), (9603, 14389), (9532, 14257), (9330, 14251), (9612, 14399)]
         : compromised: 0.6677, honest: 0.6676

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: directed_deviation, 30.0% compromised
Final accuracy - Compromised: 0.6677, Honest: 0.6676
Overall test accuracy: mean=0.6676 ± 0.0061

=== BALANCE SUMMARY ===
Node 0: acceptance=0.700
Node 1: acceptance=0.820
Node 2: acceptance=0.775
Node 3: acceptance=0.743
Node 4: acceptance=0.700
Node 5: acceptance=0.730
Node 6: acceptance=0.625
Node 7: acceptance=0.591
Node 8: acceptance=0.357
Node 9: acceptance=0.918
Node 10: acceptance=0.775
Node 11: acceptance=0.625
Node 12: acceptance=0.775
Node 13: acceptance=0.800
Node 14: acceptance=0.679
Node 15: acceptance=0.600
Node 16: acceptance=0.614
Node 17: acceptance=0.775
Node 18: acceptance=0.775
Node 19: acceptance=0.640

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.057s (79.8%)
    - Aggregation: 0.014s (20.2%)
  TOTALS:
    - Total computation: 0.072s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.072s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.041s
  - Aggregation: 0.008s
  - Model transfer: 0.000s
  - Total per node: 0.049s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 0.815s
  - Total aggregation: 0.159s
  - Total model transfer: 0.000s
  - Grand total: 0.975s
  - Mean acceptance rate: 0.701

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
