Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4394 ± 0.0502 | min=0.3293 max=0.5223
         : test loss mean=3.7627 ± 0.0427
         : individual accs = ['0.522287', '0.478706', '0.487381', '0.419109', '0.446346', '0.425939', '0.454090', '0.429984', '0.413982', '0.417816', '0.397538', '0.521822', '0.421940', '0.329283', '0.466930', '0.482502', '0.406935', '0.507530', '0.356268', '0.402132']
         : correct/total = [(2156, 4128), (2012, 4203), (1989, 4081), (1816, 4333), (1826, 4091), (1826, 4287), (1904, 4193), (1870, 4349), (1735, 4191), (1787, 4277), (1647, 4143), (2188, 4193), (1727, 4093), (1382, 4197), (1892, 4052), (1944, 4029), (1690, 4153), (2123, 4183), (1455, 4084), (1660, 4128)]
         : compromised: 0.4180, honest: 0.4486
Round 002: test acc mean=0.6820 ± 0.0207 | min=0.6421 max=0.7202
         : test loss mean=2.9146 ± 0.4949
         : individual accs = ['0.709787', '0.711872', '0.678510', '0.698823', '0.651186', '0.666433', '0.663010', '0.673718', '0.706753', '0.694880', '0.696114', '0.720248', '0.682873', '0.642125', '0.686081', '0.686026', '0.675897', '0.665073', '0.671401', '0.659641']
         : correct/total = [(2930, 4128), (2992, 4203), (2769, 4081), (3028, 4333), (2664, 4091), (2857, 4287), (2780, 4193), (2930, 4349), (2962, 4191), (2972, 4277), (2884, 4143), (3020, 4193), (2795, 4093), (2695, 4197), (2780, 4052), (2764, 4029), (2807, 4153), (2782, 4183), (2742, 4084), (2723, 4128)]
         : compromised: 0.6690, honest: 0.6876
Round 003: test acc mean=0.7244 ± 0.0324 | min=0.6513 max=0.7810
         : test loss mean=2.2177 ± 0.5547
         : individual accs = ['0.765504', '0.748751', '0.734624', '0.744057', '0.705207', '0.651271', '0.740043', '0.726834', '0.780959', '0.722937', '0.733044', '0.750298', '0.723430', '0.685490', '0.685834', '0.708364', '0.751987', '0.688979', '0.681440', '0.759448']
         : correct/total = [(3160, 4128), (3147, 4203), (2998, 4081), (3224, 4333), (2885, 4091), (2792, 4287), (3103, 4193), (3161, 4349), (3273, 4191), (3092, 4277), (3037, 4143), (3146, 4193), (2961, 4093), (2877, 4197), (2779, 4052), (2854, 4029), (3123, 4153), (2882, 4183), (2783, 4084), (3135, 4128)]
         : compromised: 0.6861, honest: 0.7409
Round 004: test acc mean=0.7611 ± 0.0227 | min=0.7130 max=0.8043
         : test loss mean=1.5834 ± 0.4585
         : individual accs = ['0.776405', '0.782298', '0.770889', '0.769213', '0.769494', '0.756473', '0.770808', '0.778340', '0.804343', '0.763386', '0.757905', '0.760315', '0.713657', '0.744818', '0.712981', '0.775875', '0.765952', '0.746354', '0.723066', '0.778828']
         : correct/total = [(3205, 4128), (3288, 4203), (3146, 4081), (3333, 4333), (3148, 4091), (3243, 4287), (3232, 4193), (3385, 4349), (3371, 4191), (3265, 4277), (3140, 4143), (3188, 4193), (2921, 4093), (3126, 4197), (2889, 4052), (3126, 4029), (3181, 4153), (3122, 4183), (2953, 4084), (3215, 4128)]
         : compromised: 0.7329, honest: 0.7731
Round 005: test acc mean=0.7804 ± 0.0175 | min=0.7421 max=0.8187
         : test loss mean=1.1643 ± 0.3059
         : individual accs = ['0.789486', '0.786105', '0.769419', '0.791369', '0.769983', '0.784465', '0.783449', '0.783169', '0.818659', '0.794248', '0.776490', '0.779156', '0.763499', '0.761258', '0.742103', '0.790767', '0.803275', '0.762372', '0.757835', '0.800388']
         : correct/total = [(3259, 4128), (3304, 4203), (3140, 4081), (3429, 4333), (3150, 4091), (3363, 4287), (3285, 4193), (3406, 4349), (3431, 4191), (3397, 4277), (3217, 4143), (3267, 4193), (3125, 4093), (3195, 4197), (3007, 4052), (3186, 4029), (3336, 4153), (3189, 4183), (3095, 4084), (3304, 4128)]
         : compromised: 0.7619, honest: 0.7883
Round 006: test acc mean=0.8035 ± 0.0108 | min=0.7789 max=0.8227
         : test loss mean=0.8749 ± 0.1697
         : individual accs = ['0.789002', '0.803950', '0.792698', '0.813293', '0.799560', '0.798227', '0.807536', '0.810071', '0.822715', '0.813421', '0.797731', '0.801336', '0.795260', '0.815821', '0.804294', '0.813353', '0.817722', '0.790581', '0.778893', '0.803537']
         : correct/total = [(3257, 4128), (3379, 4203), (3235, 4081), (3524, 4333), (3271, 4091), (3422, 4287), (3386, 4193), (3523, 4349), (3448, 4191), (3479, 4277), (3305, 4143), (3360, 4193), (3255, 4093), (3424, 4197), (3259, 4052), (3277, 4029), (3396, 4153), (3307, 4183), (3181, 4084), (3317, 4128)]
         : compromised: 0.7972, honest: 0.8061
Round 007: test acc mean=0.8156 ± 0.0095 | min=0.7954 max=0.8277
         : test loss mean=0.7216 ± 0.1134
         : individual accs = ['0.817345', '0.819415', '0.795393', '0.825525', '0.806160', '0.814322', '0.821607', '0.824557', '0.824624', '0.827683', '0.803765', '0.822323', '0.806743', '0.822969', '0.813919', '0.823529', '0.827354', '0.804925', '0.803134', '0.807655']
         : correct/total = [(3374, 4128), (3444, 4203), (3246, 4081), (3577, 4333), (3298, 4091), (3491, 4287), (3445, 4193), (3586, 4349), (3456, 4191), (3540, 4277), (3330, 4143), (3448, 4193), (3302, 4093), (3454, 4197), (3298, 4052), (3318, 4029), (3436, 4153), (3367, 4183), (3280, 4084), (3334, 4128)]
         : compromised: 0.8110, honest: 0.8176
Round 008: test acc mean=0.8220 ± 0.0099 | min=0.8014 max=0.8349
         : test loss mean=0.6268 ± 0.0724
         : individual accs = ['0.814922', '0.820128', '0.806420', '0.832218', '0.816671', '0.829951', '0.828762', '0.829156', '0.828681', '0.833294', '0.809558', '0.830193', '0.816272', '0.827258', '0.834896', '0.832465', '0.821816', '0.808989', '0.816357', '0.801357']
         : correct/total = [(3364, 4128), (3447, 4203), (3291, 4081), (3606, 4333), (3341, 4091), (3558, 4287), (3475, 4193), (3606, 4349), (3473, 4191), (3564, 4277), (3354, 4143), (3481, 4193), (3341, 4093), (3472, 4197), (3383, 4052), (3354, 4029), (3413, 4153), (3384, 4183), (3334, 4084), (3308, 4128)]
         : compromised: 0.8223, honest: 0.8218
Round 009: test acc mean=0.8309 ± 0.0068 | min=0.8193 max=0.8419
         : test loss mean=0.5649 ± 0.0432
         : individual accs = ['0.821463', '0.836783', '0.825778', '0.836834', '0.828893', '0.830418', '0.835202', '0.834445', '0.841804', '0.841945', '0.823075', '0.832578', '0.830198', '0.838456', '0.835143', '0.834698', '0.822538', '0.819268', '0.822723', '0.825581']
         : correct/total = [(3391, 4128), (3517, 4203), (3370, 4081), (3626, 4333), (3391, 4091), (3560, 4287), (3502, 4193), (3629, 4349), (3528, 4191), (3601, 4277), (3410, 4143), (3491, 4193), (3398, 4093), (3519, 4197), (3384, 4052), (3363, 4029), (3416, 4153), (3427, 4183), (3360, 4084), (3408, 4128)]
         : compromised: 0.8294, honest: 0.8315
Round 010: test acc mean=0.8370 ± 0.0064 | min=0.8269 max=0.8473
         : test loss mean=0.5260 ± 0.0320
         : individual accs = ['0.830911', '0.842256', '0.835089', '0.841911', '0.830604', '0.827152', '0.843549', '0.840193', '0.847292', '0.845920', '0.826937', '0.835440', '0.835329', '0.843936', '0.842053', '0.842144', '0.834818', '0.835047', '0.830558', '0.828004']
         : correct/total = [(3430, 4128), (3540, 4203), (3408, 4081), (3648, 4333), (3398, 4091), (3546, 4287), (3537, 4193), (3654, 4349), (3551, 4191), (3618, 4277), (3426, 4143), (3503, 4193), (3419, 4093), (3542, 4197), (3412, 4052), (3393, 4029), (3467, 4153), (3493, 4183), (3392, 4084), (3418, 4128)]
         : compromised: 0.8357, honest: 0.8375

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: directed_deviation, 30.0% compromised
Final accuracy - Compromised: 0.8357, Honest: 0.8375
Overall test accuracy: mean=0.8370 ± 0.0064

=== BALANCE SUMMARY ===
Node 0: acceptance=0.833
Node 1: acceptance=1.000
Node 2: acceptance=0.600
Node 3: acceptance=0.750
Node 4: acceptance=0.500
Node 5: acceptance=0.400
Node 6: acceptance=0.800
Node 7: acceptance=0.600
Node 8: acceptance=0.500
Node 9: acceptance=1.000
Node 10: acceptance=0.750
Node 11: acceptance=0.571
Node 12: acceptance=0.714
Node 13: acceptance=0.750
Node 14: acceptance=0.429
Node 15: acceptance=0.500
Node 16: acceptance=0.400
Node 17: acceptance=0.600
Node 18: acceptance=1.000
Node 19: acceptance=1.000

Performance Summary:
  - Distance computation time: 2.093s (42.9%)
  - Filtering time: 2.645s (54.2%)
  - Aggregation time: 0.141s (2.9%)
  - Total time: 4.879s
  - Mean acceptance rate: 0.685

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
