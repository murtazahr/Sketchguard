Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: gaussian, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.0584 ± 0.0126 | min=0.0453 max=0.0863
         : test loss mean=3.6901 ± 0.0159
         : individual accs = ['0.059593', '0.052344', '0.048272', '0.048465', '0.045710', '0.045253', '0.086334', '0.051276', '0.085660', '0.053776', '0.050447', '0.049606', '0.053750', '0.062426', '0.080454', '0.056590', '0.058271', '0.050203', '0.074192', '0.054506']
         : correct/total = [(246, 4128), (220, 4203), (197, 4081), (210, 4333), (187, 4091), (194, 4287), (362, 4193), (223, 4349), (359, 4191), (230, 4277), (209, 4143), (208, 4193), (220, 4093), (262, 4197), (326, 4052), (228, 4029), (242, 4153), (210, 4183), (303, 4084), (225, 4128)]
         : compromised: 0.0610, honest: 0.0572
Round 002: test acc mean=0.0609 ± 0.0176 | min=0.0434 max=0.0953
         : test loss mean=3.6835 ± 0.0159
         : individual accs = ['0.049176', '0.047109', '0.095320', '0.043388', '0.079443', '0.048752', '0.077033', '0.058174', '0.047960', '0.047463', '0.045619', '0.046983', '0.049841', '0.093638', '0.087858', '0.054852', '0.054418', '0.048291', '0.055583', '0.086483']
         : correct/total = [(203, 4128), (198, 4203), (389, 4081), (188, 4333), (325, 4091), (209, 4287), (323, 4193), (253, 4349), (201, 4191), (203, 4277), (189, 4143), (197, 4193), (204, 4093), (393, 4197), (356, 4052), (221, 4029), (226, 4153), (202, 4183), (227, 4084), (357, 4128)]
         : compromised: 0.0640, honest: 0.0595
Round 003: test acc mean=0.0542 ± 0.0058 | min=0.0438 max=0.0679
         : test loss mean=3.6750 ± 0.0166
         : individual accs = ['0.050872', '0.052819', '0.056114', '0.043850', '0.054021', '0.048752', '0.044598', '0.058174', '0.059174', '0.053776', '0.049240', '0.049606', '0.062301', '0.062426', '0.067868', '0.052619', '0.055141', '0.050681', '0.055828', '0.055233']
         : correct/total = [(210, 4128), (222, 4203), (229, 4081), (190, 4333), (221, 4091), (209, 4287), (187, 4193), (253, 4349), (248, 4191), (230, 4277), (204, 4143), (208, 4193), (255, 4093), (262, 4197), (275, 4052), (212, 4029), (229, 4153), (212, 4183), (228, 4084), (228, 4128)]
         : compromised: 0.0580, honest: 0.0525
Round 004: test acc mean=0.0968 ± 0.0361 | min=0.0511 max=0.1545
         : test loss mean=3.6642 ± 0.0163
         : individual accs = ['0.106831', '0.143231', '0.057829', '0.085391', '0.154485', '0.051085', '0.095636', '0.120028', '0.053925', '0.094693', '0.069273', '0.073217', '0.059370', '0.104360', '0.058490', '0.153636', '0.152902', '0.142242', '0.056807', '0.102229']
         : correct/total = [(441, 4128), (602, 4203), (236, 4081), (370, 4333), (632, 4091), (219, 4287), (401, 4193), (522, 4349), (226, 4191), (405, 4277), (287, 4143), (307, 4193), (243, 4093), (438, 4197), (237, 4052), (619, 4029), (635, 4153), (595, 4183), (232, 4084), (422, 4128)]
         : compromised: 0.0787, honest: 0.1045
Round 005: test acc mean=0.1076 ± 0.0317 | min=0.0655 max=0.1577
         : test loss mean=3.6465 ± 0.0169
         : individual accs = ['0.070494', '0.073519', '0.127175', '0.123240', '0.068687', '0.138325', '0.067493', '0.118188', '0.143403', '0.065466', '0.132513', '0.069401', '0.139506', '0.122468', '0.157700', '0.070737', '0.083554', '0.104470', '0.143976', '0.132025']
         : correct/total = [(291, 4128), (309, 4203), (519, 4081), (534, 4333), (281, 4091), (593, 4287), (283, 4193), (514, 4349), (601, 4191), (280, 4277), (549, 4143), (291, 4193), (571, 4093), (514, 4197), (639, 4052), (285, 4029), (347, 4153), (437, 4183), (588, 4084), (545, 4128)]
         : compromised: 0.1344, honest: 0.0961
Round 006: test acc mean=0.1194 ± 0.0447 | min=0.0462 max=0.2108
         : test loss mean=3.6177 ± 0.0185
         : individual accs = ['0.046754', '0.114680', '0.051703', '0.131087', '0.048399', '0.046186', '0.107322', '0.117958', '0.185397', '0.120645', '0.141685', '0.083234', '0.124603', '0.129378', '0.210760', '0.131794', '0.129063', '0.174516', '0.152791', '0.139777']
         : correct/total = [(193, 4128), (482, 4203), (211, 4081), (568, 4333), (198, 4091), (198, 4287), (450, 4193), (513, 4349), (777, 4191), (516, 4277), (587, 4143), (349, 4193), (510, 4093), (543, 4197), (854, 4052), (531, 4029), (536, 4153), (730, 4183), (624, 4084), (577, 4128)]
         : compromised: 0.1397, honest: 0.1107
Round 007: test acc mean=0.1912 ± 0.0343 | min=0.1468 max=0.2462
         : test loss mean=3.5436 ± 0.0216
         : individual accs = ['0.206638', '0.200333', '0.224945', '0.147473', '0.200196', '0.163051', '0.164560', '0.149920', '0.201623', '0.225625', '0.157615', '0.156690', '0.243098', '0.166548', '0.220632', '0.246215', '0.241753', '0.146785', '0.204701', '0.155281']
         : correct/total = [(853, 4128), (842, 4203), (918, 4081), (639, 4333), (819, 4091), (699, 4287), (690, 4193), (652, 4349), (845, 4191), (965, 4277), (653, 4143), (657, 4193), (995, 4093), (699, 4197), (894, 4052), (992, 4029), (1004, 4153), (614, 4183), (836, 4084), (641, 4128)]
         : compromised: 0.1908, honest: 0.1913
Round 008: test acc mean=0.2341 ± 0.0175 | min=0.1906 max=0.2614
         : test loss mean=3.3728 ± 0.0262
         : individual accs = ['0.240310', '0.228646', '0.251409', '0.190630', '0.244195', '0.228132', '0.238016', '0.222350', '0.220234', '0.207622', '0.214096', '0.257334', '0.261422', '0.256135', '0.234699', '0.233805', '0.221045', '0.246952', '0.238737', '0.245640']
         : correct/total = [(992, 4128), (961, 4203), (1026, 4081), (826, 4333), (999, 4091), (978, 4287), (998, 4193), (967, 4349), (923, 4191), (888, 4277), (887, 4143), (1079, 4193), (1070, 4093), (1075, 4197), (951, 4052), (942, 4029), (918, 4153), (1033, 4183), (975, 4084), (1014, 4128)]
         : compromised: 0.2443, honest: 0.2297
Round 009: test acc mean=0.2967 ± 0.0182 | min=0.2689 max=0.3331
         : test loss mean=3.0416 ± 0.0290
         : individual accs = ['0.324128', '0.287176', '0.297476', '0.273944', '0.296993', '0.309074', '0.281183', '0.292251', '0.275591', '0.289689', '0.268887', '0.305271', '0.328610', '0.291399', '0.295410', '0.333085', '0.309896', '0.276357', '0.315377', '0.282946']
         : correct/total = [(1338, 4128), (1207, 4203), (1214, 4081), (1187, 4333), (1215, 4091), (1325, 4287), (1179, 4193), (1271, 4349), (1155, 4191), (1239, 4277), (1114, 4143), (1280, 4193), (1345, 4093), (1223, 4197), (1197, 4052), (1342, 4029), (1287, 4153), (1156, 4183), (1288, 4084), (1168, 4128)]
         : compromised: 0.3027, honest: 0.2942
Round 010: test acc mean=0.3468 ± 0.0121 | min=0.3245 max=0.3727
         : test loss mean=2.7014 ± 0.0324
         : individual accs = ['0.342297', '0.338568', '0.338888', '0.324486', '0.337815', '0.336599', '0.339375', '0.361232', '0.334765', '0.339490', '0.364470', '0.362509', '0.361593', '0.349297', '0.372655', '0.352197', '0.339514', '0.354052', '0.341332', '0.345203']
         : correct/total = [(1413, 4128), (1423, 4203), (1383, 4081), (1406, 4333), (1382, 4091), (1443, 4287), (1423, 4193), (1571, 4349), (1403, 4191), (1452, 4277), (1510, 4143), (1520, 4193), (1480, 4093), (1466, 4197), (1510, 4052), (1419, 4029), (1410, 4153), (1481, 4183), (1394, 4084), (1425, 4128)]
         : compromised: 0.3526, honest: 0.3443

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: gaussian, 30.0% compromised
Final accuracy - Compromised: 0.3526, Honest: 0.3443
Overall test accuracy: mean=0.3468 ± 0.0121
