Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: directed_deviation, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4958 ± 0.0338 | min=0.4460 max=0.5528
         : test loss mean=3.7446 ± 0.0250
         : individual accs = ['0.552810', '0.493457', '0.515560', '0.494346', '0.451968', '0.547469', '0.485333', '0.492297', '0.534956', '0.457096', '0.449916', '0.531839', '0.463230', '0.461282', '0.507404', '0.531646', '0.469299', '0.530959', '0.498776', '0.445979']
         : correct/total = [(2282, 4128), (2074, 4203), (2104, 4081), (2142, 4333), (1849, 4091), (2347, 4287), (2035, 4193), (2141, 4349), (2242, 4191), (1955, 4277), (1864, 4143), (2230, 4193), (1896, 4093), (1936, 4197), (2056, 4052), (2142, 4029), (1949, 4153), (2221, 4183), (2037, 4084), (1841, 4128)]
         : compromised: 0.5007, honest: 0.4945
Round 002: test acc mean=0.6834 ± 0.0187 | min=0.6446 max=0.7073
         : test loss mean=3.3893 ± 0.0636
         : individual accs = ['0.685804', '0.688080', '0.666258', '0.699515', '0.678807', '0.705622', '0.644646', '0.692803', '0.676688', '0.707271', '0.679701', '0.705461', '0.696066', '0.659995', '0.705824', '0.695954', '0.653744', '0.661726', '0.697356', '0.667151']
         : correct/total = [(2831, 4128), (2892, 4203), (2719, 4081), (3031, 4333), (2777, 4091), (3025, 4287), (2703, 4193), (3013, 4349), (2836, 4191), (3025, 4277), (2816, 4143), (2958, 4193), (2849, 4093), (2770, 4197), (2860, 4052), (2804, 4029), (2715, 4153), (2768, 4183), (2848, 4084), (2754, 4128)]
         : compromised: 0.6809, honest: 0.6841
Round 003: test acc mean=0.7053 ± 0.0234 | min=0.6429 max=0.7351
         : test loss mean=3.0755 ± 0.1122
         : individual accs = ['0.732800', '0.719724', '0.667483', '0.735057', '0.703495', '0.642874', '0.725733', '0.724764', '0.726080', '0.696984', '0.691045', '0.726449', '0.718300', '0.684537', '0.724087', '0.705138', '0.700939', '0.677265', '0.697845', '0.704457']
         : correct/total = [(3025, 4128), (3025, 4203), (2724, 4081), (3185, 4333), (2878, 4091), (2756, 4287), (3043, 4193), (3152, 4349), (3043, 4191), (2981, 4277), (2863, 4143), (3046, 4193), (2940, 4093), (2873, 4197), (2934, 4052), (2841, 4029), (2911, 4153), (2833, 4183), (2850, 4084), (2908, 4128)]
         : compromised: 0.6807, honest: 0.7114
Round 004: test acc mean=0.6959 ± 0.0310 | min=0.6213 max=0.7416
         : test loss mean=2.5604 ± 0.1606
         : individual accs = ['0.705426', '0.722103', '0.662828', '0.713593', '0.741628', '0.644273', '0.731457', '0.722235', '0.712002', '0.695113', '0.650253', '0.711424', '0.621305', '0.664284', '0.724580', '0.708116', '0.697086', '0.699259', '0.705681', '0.685320']
         : correct/total = [(2912, 4128), (3035, 4203), (2705, 4081), (3092, 4333), (3034, 4091), (2762, 4287), (3067, 4193), (3141, 4349), (2984, 4191), (2973, 4277), (2694, 4143), (2983, 4193), (2543, 4093), (2788, 4197), (2936, 4052), (2853, 4029), (2895, 4153), (2925, 4183), (2882, 4084), (2829, 4128)]
         : compromised: 0.6573, honest: 0.7056
Round 005: test acc mean=0.6724 ± 0.0316 | min=0.6016 max=0.7167
         : test loss mean=1.9276 ± 0.1598
         : individual accs = ['0.706395', '0.674518', '0.625582', '0.680360', '0.704473', '0.638442', '0.679704', '0.701081', '0.680029', '0.691606', '0.674391', '0.682566', '0.628634', '0.601620', '0.667078', '0.656242', '0.716350', '0.632082', '0.716699', '0.689196']
         : correct/total = [(2916, 4128), (2835, 4203), (2553, 4081), (2948, 4333), (2882, 4091), (2737, 4287), (2850, 4193), (3049, 4349), (2850, 4191), (2958, 4277), (2794, 4143), (2862, 4193), (2573, 4093), (2525, 4197), (2703, 4052), (2644, 4029), (2975, 4153), (2644, 4183), (2927, 4084), (2845, 4128)]
         : compromised: 0.6252, honest: 0.6841
Round 006: test acc mean=0.7285 ± 0.0164 | min=0.6905 max=0.7545
         : test loss mean=1.2347 ± 0.0890
         : individual accs = ['0.708818', '0.734000', '0.740505', '0.743826', '0.742361', '0.690460', '0.736466', '0.735112', '0.712241', '0.720832', '0.754526', '0.743859', '0.693868', '0.712890', '0.733959', '0.736163', '0.732483', '0.730576', '0.734574', '0.732074']
         : correct/total = [(2926, 4128), (3085, 4203), (3022, 4081), (3223, 4333), (3037, 4091), (2960, 4287), (3088, 4193), (3197, 4349), (2985, 4191), (3083, 4277), (3126, 4143), (3119, 4193), (2840, 4093), (2992, 4197), (2974, 4052), (2966, 4029), (3042, 4153), (3056, 4183), (3000, 4084), (3022, 4128)]
         : compromised: 0.7069, honest: 0.7339
Round 007: test acc mean=0.7917 ± 0.0075 | min=0.7718 max=0.8021
         : test loss mean=0.7803 ± 0.0412
         : individual accs = ['0.788517', '0.793243', '0.783877', '0.798292', '0.783916', '0.793329', '0.802051', '0.800644', '0.794321', '0.796820', '0.789042', '0.794181', '0.771806', '0.780081', '0.797384', '0.789030', '0.797977', '0.791298', '0.801175', '0.786822']
         : correct/total = [(3255, 4128), (3334, 4203), (3199, 4081), (3459, 4333), (3207, 4091), (3401, 4287), (3363, 4193), (3482, 4349), (3329, 4191), (3408, 4277), (3269, 4143), (3330, 4193), (3159, 4093), (3274, 4197), (3231, 4052), (3179, 4029), (3314, 4153), (3310, 4183), (3272, 4084), (3248, 4128)]
         : compromised: 0.7841, honest: 0.7936
Round 008: test acc mean=0.8177 ± 0.0074 | min=0.8023 max=0.8297
         : test loss mean=0.5930 ± 0.0211
         : individual accs = ['0.808866', '0.819653', '0.814261', '0.825756', '0.803715', '0.826219', '0.823992', '0.820189', '0.823908', '0.823708', '0.809076', '0.829716', '0.809919', '0.817012', '0.821323', '0.822288', '0.815073', '0.818551', '0.818071', '0.802326']
         : correct/total = [(3339, 4128), (3445, 4203), (3323, 4081), (3578, 4333), (3288, 4091), (3542, 4287), (3455, 4193), (3567, 4349), (3453, 4191), (3523, 4277), (3352, 4143), (3479, 4193), (3315, 4093), (3429, 4197), (3328, 4052), (3313, 4029), (3385, 4153), (3424, 4183), (3341, 4084), (3312, 4128)]
         : compromised: 0.8179, honest: 0.8176
Round 009: test acc mean=0.8324 ± 0.0049 | min=0.8258 max=0.8442
         : test loss mean=0.5231 ± 0.0178
         : individual accs = ['0.826066', '0.835118', '0.829944', '0.835218', '0.825959', '0.832284', '0.836632', '0.834445', '0.844190', '0.839841', '0.828144', '0.833055', '0.828732', '0.832976', '0.837858', '0.835443', '0.828798', '0.826201', '0.831783', '0.825824']
         : correct/total = [(3410, 4128), (3510, 4203), (3387, 4081), (3619, 4333), (3379, 4091), (3568, 4287), (3508, 4193), (3629, 4349), (3538, 4191), (3592, 4277), (3431, 4143), (3493, 4193), (3392, 4093), (3496, 4197), (3395, 4052), (3366, 4029), (3442, 4153), (3456, 4183), (3397, 4084), (3409, 4128)]
         : compromised: 0.8300, honest: 0.8330
Round 010: test acc mean=0.8407 ± 0.0052 | min=0.8296 max=0.8483
         : test loss mean=0.4912 ± 0.0182
         : individual accs = ['0.833333', '0.846538', '0.833619', '0.842142', '0.829626', '0.839748', '0.847126', '0.843412', '0.845860', '0.845219', '0.832730', '0.836394', '0.841192', '0.842507', '0.841807', '0.848349', '0.843005', '0.844609', '0.840842', '0.835998']
         : correct/total = [(3440, 4128), (3558, 4203), (3402, 4081), (3649, 4333), (3394, 4091), (3600, 4287), (3552, 4193), (3668, 4349), (3545, 4191), (3615, 4277), (3450, 4143), (3507, 4193), (3443, 4093), (3536, 4197), (3411, 4052), (3418, 4029), (3501, 4153), (3533, 4183), (3434, 4084), (3451, 4128)]
         : compromised: 0.8420, honest: 0.8404

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: directed_deviation, 20.0% compromised
Final accuracy - Compromised: 0.8420, Honest: 0.8404
Overall test accuracy: mean=0.8407 ± 0.0052

=== BALANCE SUMMARY ===
Node 0: acceptance=0.812
Node 1: acceptance=0.818
Node 2: acceptance=0.833
Node 3: acceptance=0.875
Node 4: acceptance=0.818
Node 5: acceptance=0.800
Node 6: acceptance=0.714
Node 7: acceptance=0.786
Node 8: acceptance=0.700
Node 9: acceptance=0.923
Node 10: acceptance=0.667
Node 11: acceptance=0.786
Node 12: acceptance=0.917
Node 13: acceptance=0.923
Node 14: acceptance=0.733
Node 15: acceptance=0.818
Node 16: acceptance=0.769
Node 17: acceptance=0.889
Node 18: acceptance=0.812
Node 19: acceptance=0.750

Performance Summary:
  - Distance computation time: 1.101s (43.7%)
  - Filtering time: 1.212s (48.1%)
  - Aggregation time: 0.206s (8.2%)
  - Total time: 2.519s
  - Mean acceptance rate: 0.807

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
