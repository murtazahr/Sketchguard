Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5038 ± 0.0105 | min=0.4867 max=0.5329
         : test loss mean=1.5202 ± 0.6164
         : individual accs = ['0.497330', '0.514015', '0.487032', '0.511078', '0.508358', '0.486676', '0.496445', '0.511302', '0.507276', '0.532874', '0.497699', '0.493358', '0.500766', '0.490948', '0.508170', '0.502952', '0.511154', '0.508101', '0.508736', '0.502118']
         : correct/total = [(7078, 14232), (7317, 14235), (6948, 14266), (7266, 14217), (7238, 14238), (6995, 14373), (7122, 14346), (7329, 14334), (7251, 14294), (7659, 14373), (7139, 14344), (7056, 14302), (7188, 14354), (7051, 14362), (7277, 14320), (7240, 14395), (7355, 14389), (7244, 14257), (7250, 14251), (7230, 14399)]
         : compromised: 0.5013, honest: 0.5055
Round 002: test acc mean=0.5044 ± 0.0138 | min=0.4827 max=0.5377
         : test loss mean=0.7193 ± 0.0262
         : individual accs = ['0.522766', '0.487109', '0.500000', '0.482732', '0.493819', '0.499617', '0.501394', '0.530696', '0.516650', '0.504001', '0.500558', '0.513215', '0.493242', '0.537738', '0.500978', '0.506912', '0.497950', '0.494284', '0.512385', '0.492256']
         : correct/total = [(7440, 14232), (6934, 14235), (7133, 14266), (6863, 14217), (7031, 14238), (7181, 14373), (7193, 14346), (7607, 14334), (7385, 14294), (7244, 14373), (7180, 14344), (7340, 14302), (7080, 14354), (7723, 14362), (7174, 14320), (7297, 14395), (7165, 14389), (7047, 14257), (7302, 14251), (7088, 14399)]
         : compromised: 0.5048, honest: 0.5041
Round 003: test acc mean=0.5186 ± 0.0184 | min=0.4832 max=0.5557
         : test loss mean=0.6945 ± 0.0059
         : individual accs = ['0.526981', '0.512891', '0.503575', '0.511078', '0.537295', '0.483198', '0.534295', '0.528813', '0.507835', '0.537188', '0.534579', '0.493288', '0.501533', '0.555703', '0.545461', '0.525391', '0.508583', '0.515256', '0.511403', '0.496771']
         : correct/total = [(7500, 14232), (7301, 14235), (7184, 14266), (7266, 14217), (7650, 14238), (6945, 14373), (7665, 14346), (7580, 14334), (7259, 14294), (7721, 14373), (7668, 14344), (7055, 14302), (7199, 14354), (7981, 14362), (7811, 14320), (7563, 14395), (7318, 14389), (7346, 14257), (7288, 14251), (7153, 14399)]
         : compromised: 0.5148, honest: 0.5210
Round 004: test acc mean=0.5443 ± 0.0232 | min=0.5048 max=0.5827
         : test loss mean=0.6887 ± 0.0043
         : individual accs = ['0.543002', '0.532350', '0.548297', '0.540691', '0.548251', '0.530300', '0.545727', '0.562439', '0.505667', '0.574410', '0.575920', '0.526710', '0.570155', '0.511837', '0.544274', '0.553803', '0.504830', '0.569405', '0.514981', '0.582749']
         : correct/total = [(7728, 14232), (7578, 14235), (7822, 14266), (7687, 14217), (7806, 14238), (7622, 14373), (7829, 14346), (8062, 14334), (7228, 14294), (8256, 14373), (8261, 14344), (7533, 14302), (8184, 14354), (7351, 14362), (7794, 14320), (7972, 14395), (7264, 14389), (8118, 14257), (7339, 14251), (8391, 14399)]
         : compromised: 0.5375, honest: 0.5488
Round 005: test acc mean=0.5759 ± 0.0113 | min=0.5509 max=0.5909
         : test loss mean=0.6819 ± 0.0038
         : individual accs = ['0.550942', '0.566913', '0.578719', '0.586059', '0.576205', '0.574550', '0.587411', '0.587275', '0.562124', '0.579976', '0.590212', '0.561390', '0.588756', '0.577844', '0.574092', '0.587496', '0.560984', '0.568493', '0.568311', '0.590944']
         : correct/total = [(7841, 14232), (8070, 14235), (8256, 14266), (8332, 14217), (8204, 14238), (8258, 14373), (8427, 14346), (8418, 14334), (8035, 14294), (8336, 14373), (8466, 14344), (8029, 14302), (8451, 14354), (8299, 14362), (8221, 14320), (8457, 14395), (8072, 14389), (8105, 14257), (8099, 14251), (8509, 14399)]
         : compromised: 0.5725, honest: 0.5782
Round 006: test acc mean=0.5927 ± 0.0086 | min=0.5759 max=0.6094
         : test loss mean=0.6731 ± 0.0040
         : individual accs = ['0.575885', '0.587496', '0.596523', '0.601041', '0.587442', '0.601823', '0.598494', '0.592438', '0.602910', '0.594030', '0.609384', '0.591176', '0.600878', '0.590934', '0.587221', '0.589649', '0.580860', '0.583292', '0.580591', '0.601917']
         : correct/total = [(8196, 14232), (8363, 14235), (8510, 14266), (8545, 14217), (8364, 14238), (8650, 14373), (8586, 14346), (8492, 14334), (8618, 14294), (8538, 14373), (8741, 14344), (8455, 14302), (8625, 14354), (8487, 14362), (8409, 14320), (8488, 14395), (8358, 14389), (8316, 14257), (8274, 14251), (8667, 14399)]
         : compromised: 0.5904, honest: 0.5942
Round 007: test acc mean=0.6052 ± 0.0042 | min=0.5965 max=0.6138
         : test loss mean=0.6628 ± 0.0025
         : individual accs = ['0.603148', '0.601475', '0.605355', '0.609341', '0.604158', '0.613790', '0.607208', '0.604716', '0.606058', '0.607319', '0.612730', '0.599007', '0.608123', '0.605417', '0.600489', '0.605419', '0.596497', '0.603633', '0.601081', '0.609556']
         : correct/total = [(8584, 14232), (8562, 14235), (8636, 14266), (8663, 14217), (8602, 14238), (8822, 14373), (8711, 14346), (8668, 14334), (8663, 14294), (8729, 14373), (8789, 14344), (8567, 14302), (8729, 14354), (8695, 14362), (8599, 14320), (8715, 14395), (8583, 14389), (8606, 14257), (8566, 14251), (8777, 14399)]
         : compromised: 0.6041, honest: 0.6060
Round 008: test acc mean=0.6136 ± 0.0047 | min=0.6038 max=0.6221
         : test loss mean=0.6552 ± 0.0027
         : individual accs = ['0.610104', '0.614893', '0.614117', '0.613702', '0.606054', '0.620678', '0.614666', '0.609600', '0.622149', '0.612537', '0.620887', '0.603762', '0.615229', '0.613703', '0.610196', '0.618687', '0.609424', '0.610858', '0.612378', '0.618237']
         : correct/total = [(8683, 14232), (8753, 14235), (8761, 14266), (8725, 14217), (8629, 14238), (8921, 14373), (8818, 14346), (8738, 14334), (8893, 14294), (8804, 14373), (8906, 14344), (8635, 14302), (8831, 14354), (8814, 14362), (8738, 14320), (8906, 14395), (8769, 14389), (8709, 14257), (8727, 14251), (8902, 14399)]
         : compromised: 0.6127, honest: 0.6142
Round 009: test acc mean=0.6207 ± 0.0041 | min=0.6107 max=0.6282
         : test loss mean=0.6495 ± 0.0022
         : individual accs = ['0.619449', '0.626133', '0.621548', '0.614968', '0.616238', '0.624156', '0.621567', '0.618878', '0.624738', '0.624365', '0.623675', '0.615788', '0.622057', '0.620805', '0.610684', '0.628204', '0.618042', '0.618573', '0.620728', '0.623307']
         : correct/total = [(8816, 14232), (8913, 14235), (8867, 14266), (8743, 14217), (8774, 14238), (8971, 14373), (8917, 14346), (8871, 14334), (8930, 14294), (8974, 14373), (8946, 14344), (8807, 14302), (8929, 14354), (8916, 14362), (8745, 14320), (9043, 14395), (8893, 14389), (8819, 14257), (8846, 14251), (8975, 14399)]
         : compromised: 0.6199, honest: 0.6212
Round 010: test acc mean=0.6277 ± 0.0039 | min=0.6205 max=0.6359
         : test loss mean=0.6440 ± 0.0018
         : individual accs = ['0.625984', '0.635125', '0.625543', '0.626785', '0.622068', '0.628261', '0.631605', '0.627250', '0.626067', '0.630836', '0.632948', '0.620543', '0.628605', '0.628116', '0.624441', '0.635915', '0.624574', '0.625728', '0.625079', '0.628585']
         : correct/total = [(8909, 14232), (9041, 14235), (8924, 14266), (8911, 14217), (8857, 14238), (9030, 14373), (9061, 14346), (8991, 14334), (8949, 14294), (9067, 14373), (9079, 14344), (8875, 14302), (9023, 14354), (9021, 14362), (8942, 14320), (9154, 14395), (8987, 14389), (8921, 14257), (8908, 14251), (9051, 14399)]
         : compromised: 0.6270, honest: 0.6282

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: krum, 40.0% compromised
Final accuracy - Compromised: 0.6270, Honest: 0.6282
Overall test accuracy: mean=0.6277 ± 0.0039

=== BALANCE SUMMARY ===
Node 0: acceptance=0.625
Node 1: acceptance=0.730
Node 2: acceptance=0.550
Node 3: acceptance=0.614
Node 4: acceptance=0.500
Node 5: acceptance=0.550
Node 6: acceptance=0.550
Node 7: acceptance=0.509
Node 8: acceptance=0.357
Node 9: acceptance=0.836
Node 10: acceptance=0.662
Node 11: acceptance=0.550
Node 12: acceptance=0.700
Node 13: acceptance=0.700
Node 14: acceptance=0.614
Node 15: acceptance=0.500
Node 16: acceptance=0.486
Node 17: acceptance=0.662
Node 18: acceptance=0.700
Node 19: acceptance=0.550

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.063s (81.2%)
    - Aggregation: 0.014s (18.8%)
  TOTALS:
    - Total computation: 0.077s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.077s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.044s
  - Aggregation: 0.007s
  - Model transfer: 0.000s
  - Total per node: 0.051s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 0.879s
  - Total aggregation: 0.148s
  - Total model transfer: 0.000s
  - Grand total: 1.027s
  - Mean acceptance rate: 0.597

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
