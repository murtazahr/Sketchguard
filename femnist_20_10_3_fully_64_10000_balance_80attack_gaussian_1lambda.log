Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Attack: Compromised 16/20 nodes: [1, 2, 3, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19]
Attack type: gaussian, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4415 ± 0.0387 | min=0.3675 max=0.5281
         : test loss mean=3.7813 ± 0.0272
         : individual accs = ['0.473110', '0.449441', '0.484440', '0.474267', '0.439501', '0.528108', '0.404961', '0.449299', '0.481747', '0.399579', '0.407434', '0.483663', '0.374298', '0.438885', '0.435834', '0.431373', '0.437033', '0.450155', '0.367532', '0.419816']
         : correct/total = [(1953, 4128), (1889, 4203), (1977, 4081), (2055, 4333), (1798, 4091), (2264, 4287), (1698, 4193), (1954, 4349), (2019, 4191), (1709, 4277), (1688, 4143), (2028, 4193), (1532, 4093), (1842, 4197), (1766, 4052), (1738, 4029), (1815, 4153), (1883, 4183), (1501, 4084), (1733, 4128)]
         : compromised: 0.4395, honest: 0.4497
Round 002: test acc mean=0.6507 ± 0.0296 | min=0.5885 max=0.6881
         : test loss mean=3.1407 ± 0.2629
         : individual accs = ['0.683140', '0.665715', '0.639794', '0.664436', '0.688096', '0.679729', '0.601002', '0.664751', '0.646862', '0.670330', '0.602221', '0.668495', '0.672367', '0.645461', '0.672014', '0.588483', '0.679268', '0.617978', '0.648384', '0.615552']
         : correct/total = [(2820, 4128), (2798, 4203), (2611, 4081), (2879, 4333), (2815, 4091), (2914, 4287), (2520, 4193), (2891, 4349), (2711, 4191), (2867, 4277), (2495, 4143), (2803, 4193), (2752, 4093), (2709, 4197), (2723, 4052), (2371, 4029), (2821, 4153), (2585, 4183), (2648, 4084), (2541, 4128)]
         : compromised: 0.6437, honest: 0.6788
Round 003: test acc mean=0.6994 ± 0.0373 | min=0.6069 max=0.7597
         : test loss mean=1.7669 ± 0.3379
         : individual accs = ['0.745397', '0.676897', '0.669934', '0.711978', '0.749206', '0.667600', '0.714524', '0.759715', '0.723216', '0.680617', '0.661598', '0.690436', '0.734913', '0.681439', '0.718904', '0.606850', '0.748134', '0.672484', '0.700294', '0.673207']
         : correct/total = [(3077, 4128), (2845, 4203), (2734, 4081), (3085, 4333), (3065, 4091), (2862, 4287), (2996, 4193), (3304, 4349), (3031, 4191), (2911, 4277), (2741, 4143), (2895, 4193), (3008, 4093), (2860, 4197), (2913, 4052), (2445, 4029), (3107, 4153), (2813, 4183), (2860, 4084), (2779, 4128)]
         : compromised: 0.6866, honest: 0.7506
Round 004: test acc mean=0.7922 ± 0.0073 | min=0.7762 max=0.8052
         : test loss mean=0.7409 ± 0.0474
         : individual accs = ['0.790698', '0.788484', '0.786082', '0.790907', '0.793449', '0.791929', '0.798951', '0.805243', '0.804104', '0.795417', '0.776249', '0.783210', '0.794772', '0.796760', '0.799605', '0.795731', '0.795329', '0.789386', '0.789422', '0.778585']
         : correct/total = [(3264, 4128), (3314, 4203), (3208, 4081), (3427, 4333), (3246, 4091), (3395, 4287), (3350, 4193), (3502, 4349), (3370, 4191), (3402, 4277), (3216, 4143), (3284, 4193), (3253, 4093), (3344, 4197), (3240, 4052), (3206, 4029), (3303, 4153), (3302, 4183), (3224, 4084), (3214, 4128)]
         : compromised: 0.7912, honest: 0.7962
Round 005: test acc mean=0.8167 ± 0.0057 | min=0.8071 max=0.8294
         : test loss mean=0.5794 ± 0.0215
         : individual accs = ['0.815165', '0.815846', '0.813036', '0.817447', '0.809093', '0.813389', '0.815645', '0.825707', '0.829396', '0.822305', '0.809317', '0.813499', '0.819936', '0.817012', '0.825518', '0.818814', '0.818926', '0.807076', '0.816846', '0.810320']
         : correct/total = [(3365, 4128), (3429, 4203), (3318, 4081), (3542, 4333), (3310, 4091), (3487, 4287), (3420, 4193), (3591, 4349), (3476, 4191), (3517, 4277), (3353, 4143), (3411, 4193), (3356, 4093), (3429, 4197), (3345, 4052), (3299, 4029), (3401, 4153), (3376, 4183), (3336, 4084), (3345, 4128)]
         : compromised: 0.8166, honest: 0.8172
Round 006: test acc mean=0.8307 ± 0.0065 | min=0.8178 max=0.8416
         : test loss mean=0.5246 ± 0.0194
         : individual accs = ['0.822190', '0.833928', '0.824308', '0.831987', '0.823271', '0.830418', '0.826377', '0.835824', '0.840372', '0.834230', '0.817765', '0.826854', '0.827510', '0.841553', '0.833416', '0.836932', '0.836022', '0.838872', '0.829579', '0.822432']
         : correct/total = [(3394, 4128), (3505, 4203), (3364, 4081), (3605, 4333), (3368, 4091), (3560, 4287), (3465, 4193), (3635, 4349), (3522, 4191), (3568, 4277), (3388, 4143), (3467, 4193), (3387, 4093), (3532, 4197), (3377, 4052), (3372, 4029), (3472, 4153), (3509, 4183), (3388, 4084), (3395, 4128)]
         : compromised: 0.8310, honest: 0.8293
Round 007: test acc mean=0.8410 ± 0.0053 | min=0.8298 max=0.8503
         : test loss mean=0.4912 ± 0.0205
         : individual accs = ['0.834060', '0.850345', '0.840725', '0.844219', '0.833293', '0.837182', '0.844264', '0.848241', '0.844429', '0.846388', '0.829833', '0.839733', '0.840215', '0.843221', '0.839832', '0.841648', '0.843487', '0.841501', '0.845005', '0.831880']
         : correct/total = [(3443, 4128), (3574, 4203), (3431, 4081), (3658, 4333), (3409, 4091), (3589, 4287), (3540, 4193), (3689, 4349), (3539, 4191), (3620, 4277), (3438, 4143), (3521, 4193), (3439, 4093), (3539, 4197), (3403, 4052), (3391, 4029), (3503, 4153), (3520, 4183), (3451, 4084), (3434, 4128)]
         : compromised: 0.8413, honest: 0.8398
Round 008: test acc mean=0.8430 ± 0.0057 | min=0.8314 max=0.8505
         : test loss mean=0.4751 ± 0.0201
         : individual accs = ['0.835029', '0.845586', '0.839010', '0.849065', '0.836959', '0.847213', '0.848557', '0.850540', '0.847292', '0.848726', '0.832247', '0.843072', '0.841437', '0.844651', '0.847236', '0.848846', '0.839634', '0.840067', '0.843536', '0.831395']
         : correct/total = [(3447, 4128), (3554, 4203), (3424, 4081), (3679, 4333), (3424, 4091), (3632, 4287), (3558, 4193), (3699, 4349), (3551, 4191), (3630, 4277), (3448, 4143), (3535, 4193), (3444, 4093), (3545, 4197), (3433, 4052), (3420, 4029), (3487, 4153), (3514, 4183), (3445, 4084), (3432, 4128)]
         : compromised: 0.8436, honest: 0.8405
Round 009: test acc mean=0.8486 ± 0.0058 | min=0.8382 max=0.8579
         : test loss mean=0.4564 ± 0.0187
         : individual accs = ['0.842539', '0.855579', '0.845626', '0.851835', '0.839159', '0.850245', '0.857858', '0.855829', '0.856120', '0.855740', '0.840454', '0.847842', '0.847056', '0.849178', '0.851185', '0.850831', '0.846617', '0.846761', '0.843781', '0.838178']
         : correct/total = [(3478, 4128), (3596, 4203), (3451, 4081), (3691, 4333), (3433, 4091), (3645, 4287), (3597, 4193), (3722, 4349), (3588, 4191), (3660, 4277), (3482, 4143), (3555, 4193), (3467, 4093), (3564, 4197), (3449, 4052), (3428, 4029), (3516, 4153), (3542, 4183), (3446, 4084), (3460, 4128)]
         : compromised: 0.8493, honest: 0.8460
Round 010: test acc mean=0.8518 ± 0.0057 | min=0.8400 max=0.8622
         : test loss mean=0.4479 ± 0.0190
         : individual accs = ['0.844961', '0.862241', '0.852977', '0.858297', '0.845270', '0.847446', '0.860005', '0.857668', '0.856836', '0.855272', '0.839971', '0.846172', '0.850232', '0.852514', '0.851431', '0.854803', '0.853841', '0.851064', '0.851861', '0.843508']
         : correct/total = [(3488, 4128), (3624, 4203), (3481, 4081), (3719, 4333), (3458, 4091), (3633, 4287), (3606, 4193), (3730, 4349), (3591, 4191), (3658, 4277), (3480, 4143), (3548, 4193), (3480, 4093), (3578, 4197), (3450, 4052), (3444, 4029), (3546, 4153), (3560, 4183), (3479, 4084), (3482, 4128)]
         : compromised: 0.8522, honest: 0.8504

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: balance
Attack: gaussian, 80.0% compromised
Final accuracy - Compromised: 0.8522, Honest: 0.8504
Overall test accuracy: mean=0.8518 ± 0.0057

=== BALANCE SUMMARY ===
Node 0: acceptance=0.158
Node 1: acceptance=0.211
Node 2: acceptance=0.211
Node 3: acceptance=0.211
Node 4: acceptance=0.158
Node 5: acceptance=0.211
Node 6: acceptance=0.211
Node 7: acceptance=0.158
Node 8: acceptance=0.211
Node 9: acceptance=0.211
Node 10: acceptance=0.211
Node 11: acceptance=0.211
Node 12: acceptance=0.211
Node 13: acceptance=0.211
Node 14: acceptance=0.211
Node 15: acceptance=0.211
Node 16: acceptance=0.158
Node 17: acceptance=0.211
Node 18: acceptance=0.211
Node 19: acceptance=0.211

Performance Summary:
  - Distance computation time: 1.638s (46.6%)
  - Filtering time: 1.739s (49.4%)
  - Aggregation time: 0.142s (4.0%)
  - Total time: 3.519s
  - Mean acceptance rate: 0.200

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
