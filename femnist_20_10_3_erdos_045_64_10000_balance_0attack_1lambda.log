Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4905 ± 0.0353 | min=0.4336 max=0.5528
         : test loss mean=3.7484 ± 0.0293
         : individual accs = ['0.550388', '0.489888', '0.508209', '0.461574', '0.442679', '0.552834', '0.491057', '0.461485', '0.516583', '0.454057', '0.460053', '0.526353', '0.469582', '0.433643', '0.515054', '0.522462', '0.466891', '0.539087', '0.484329', '0.463663']
         : correct/total = [(2272, 4128), (2059, 4203), (2074, 4081), (2000, 4333), (1811, 4091), (2370, 4287), (2059, 4193), (2007, 4349), (2165, 4191), (1942, 4277), (1906, 4143), (2207, 4193), (1922, 4093), (1820, 4197), (2087, 4052), (2105, 4029), (1939, 4153), (2255, 4183), (1978, 4084), (1914, 4128)]
Round 002: test acc mean=0.6873 ± 0.0182 | min=0.6308 max=0.7145
         : test loss mean=3.3741 ± 0.0303
         : individual accs = ['0.687258', '0.689983', '0.667238', '0.702746', '0.686140', '0.714486', '0.630813', '0.683605', '0.694584', '0.707505', '0.693217', '0.702361', '0.699976', '0.671909', '0.699408', '0.698685', '0.666988', '0.683242', '0.692214', '0.673207']
         : correct/total = [(2837, 4128), (2900, 4203), (2723, 4081), (3045, 4333), (2807, 4091), (3063, 4287), (2645, 4193), (2973, 4349), (2911, 4191), (3026, 4277), (2872, 4143), (2945, 4193), (2865, 4093), (2820, 4197), (2834, 4052), (2815, 4029), (2770, 4153), (2858, 4183), (2827, 4084), (2779, 4128)]
Round 003: test acc mean=0.7143 ± 0.0178 | min=0.6719 max=0.7422
         : test loss mean=3.0648 ± 0.0382
         : individual accs = ['0.742248', '0.712348', '0.671894', '0.728825', '0.708384', '0.682062', '0.722394', '0.728673', '0.719637', '0.701426', '0.704079', '0.740758', '0.734913', '0.715988', '0.730010', '0.720526', '0.699494', '0.716471', '0.703722', '0.702519']
         : correct/total = [(3064, 4128), (2994, 4203), (2742, 4081), (3158, 4333), (2898, 4091), (2924, 4287), (3029, 4193), (3169, 4349), (3016, 4191), (3000, 4277), (2917, 4143), (3106, 4193), (3008, 4093), (3005, 4197), (2958, 4052), (2903, 4029), (2905, 4153), (2997, 4183), (2874, 4084), (2900, 4128)]
Round 004: test acc mean=0.7219 ± 0.0183 | min=0.6809 max=0.7451
         : test loss mean=2.6046 ± 0.0617
         : individual accs = ['0.718992', '0.743517', '0.690027', '0.720748', '0.741384', '0.720317', '0.740758', '0.735112', '0.719876', '0.710779', '0.680908', '0.732650', '0.691180', '0.734096', '0.745064', '0.737404', '0.709848', '0.731054', '0.728208', '0.705669']
         : correct/total = [(2968, 4128), (3125, 4203), (2816, 4081), (3123, 4333), (3033, 4091), (3088, 4287), (3106, 4193), (3197, 4349), (3017, 4191), (3040, 4277), (2821, 4143), (3072, 4193), (2829, 4093), (3081, 4197), (3019, 4052), (2971, 4029), (2948, 4153), (3058, 4183), (2974, 4084), (2913, 4128)]
Round 005: test acc mean=0.7028 ± 0.0205 | min=0.6437 max=0.7370
         : test loss mean=2.0445 ± 0.0826
         : individual accs = ['0.722384', '0.689983', '0.643715', '0.674129', '0.713029', '0.718451', '0.712616', '0.707059', '0.716297', '0.708207', '0.677528', '0.683043', '0.718788', '0.701930', '0.705084', '0.707372', '0.715868', '0.690653', '0.737023', '0.713178']
         : correct/total = [(2982, 4128), (2900, 4203), (2627, 4081), (2921, 4333), (2917, 4091), (3080, 4287), (2988, 4193), (3075, 4349), (3002, 4191), (3029, 4277), (2807, 4143), (2864, 4193), (2942, 4093), (2946, 4197), (2857, 4052), (2850, 4029), (2973, 4153), (2889, 4183), (3010, 4084), (2944, 4128)]
Round 006: test acc mean=0.7371 ± 0.0165 | min=0.7013 max=0.7708
         : test loss mean=1.3944 ± 0.0889
         : individual accs = ['0.701308', '0.725196', '0.739280', '0.743134', '0.732339', '0.731514', '0.743859', '0.747298', '0.738249', '0.707739', '0.725078', '0.723825', '0.742487', '0.770789', '0.740869', '0.768925', '0.733686', '0.744203', '0.752938', '0.728682']
         : correct/total = [(2895, 4128), (3048, 4203), (3017, 4081), (3220, 4333), (2996, 4091), (3136, 4287), (3119, 4193), (3250, 4349), (3094, 4191), (3027, 4277), (3004, 4143), (3035, 4193), (3039, 4093), (3235, 4197), (3002, 4052), (3098, 4029), (3047, 4153), (3113, 4183), (3075, 4084), (3008, 4128)]
Round 007: test acc mean=0.7850 ± 0.0109 | min=0.7627 max=0.8001
         : test loss mean=0.8995 ± 0.0597
         : individual accs = ['0.786579', '0.785867', '0.765499', '0.787907', '0.772183', '0.797527', '0.800143', '0.789837', '0.797184', '0.775310', '0.778180', '0.762700', '0.774982', '0.790088', '0.791214', '0.797468', '0.790994', '0.781257', '0.798727', '0.775921']
         : correct/total = [(3247, 4128), (3303, 4203), (3124, 4081), (3414, 4333), (3159, 4091), (3419, 4287), (3355, 4193), (3435, 4349), (3341, 4191), (3316, 4277), (3224, 4143), (3198, 4193), (3172, 4093), (3316, 4197), (3206, 4052), (3213, 4029), (3285, 4153), (3268, 4183), (3262, 4084), (3203, 4128)]
Round 008: test acc mean=0.8129 ± 0.0092 | min=0.7880 max=0.8234
         : test loss mean=0.6419 ± 0.0335
         : individual accs = ['0.806928', '0.812515', '0.802744', '0.820909', '0.798827', '0.823420', '0.820892', '0.819729', '0.821761', '0.813421', '0.799662', '0.818507', '0.811141', '0.817012', '0.821816', '0.819558', '0.815555', '0.810901', '0.814153', '0.788033']
         : correct/total = [(3331, 4128), (3415, 4203), (3276, 4081), (3557, 4333), (3268, 4091), (3530, 4287), (3442, 4193), (3565, 4349), (3444, 4191), (3479, 4277), (3313, 4143), (3432, 4193), (3320, 4093), (3429, 4197), (3330, 4052), (3302, 4029), (3387, 4153), (3392, 4183), (3325, 4084), (3253, 4128)]
Round 009: test acc mean=0.8293 ± 0.0059 | min=0.8209 max=0.8449
         : test loss mean=0.5453 ± 0.0198
         : individual accs = ['0.823159', '0.830597', '0.827003', '0.834064', '0.821071', '0.833683', '0.833532', '0.829846', '0.844906', '0.834463', '0.822110', '0.826377', '0.827755', '0.829402', '0.835390', '0.832216', '0.830002', '0.820942', '0.828110', '0.820979']
         : correct/total = [(3398, 4128), (3491, 4203), (3375, 4081), (3614, 4333), (3359, 4091), (3574, 4287), (3495, 4193), (3609, 4349), (3541, 4191), (3569, 4277), (3406, 4143), (3465, 4193), (3388, 4093), (3481, 4197), (3385, 4052), (3353, 4029), (3447, 4153), (3434, 4183), (3382, 4084), (3389, 4128)]
Round 010: test acc mean=0.8383 ± 0.0056 | min=0.8265 max=0.8478
         : test loss mean=0.5033 ± 0.0184
         : individual accs = ['0.830426', '0.844397', '0.833864', '0.841680', '0.828404', '0.836482', '0.841402', '0.840653', '0.847769', '0.840309', '0.826454', '0.831386', '0.839726', '0.840839', '0.844028', '0.843882', '0.840597', '0.841023', '0.838639', '0.833576']
         : correct/total = [(3428, 4128), (3549, 4203), (3403, 4081), (3647, 4333), (3389, 4091), (3586, 4287), (3528, 4193), (3656, 4349), (3553, 4191), (3594, 4277), (3424, 4143), (3486, 4193), (3437, 4093), (3529, 4197), (3420, 4052), (3400, 4029), (3491, 4153), (3518, 4183), (3425, 4084), (3441, 4128)]

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: balance
Overall test accuracy: mean=0.8383 ± 0.0056

=== BALANCE SUMMARY ===
Node 0: acceptance=1.000
Node 1: acceptance=1.000
Node 2: acceptance=1.000
Node 3: acceptance=1.000
Node 4: acceptance=1.000
Node 5: acceptance=1.000
Node 6: acceptance=1.000
Node 7: acceptance=1.000
Node 8: acceptance=1.000
Node 9: acceptance=1.000
Node 10: acceptance=1.000
Node 11: acceptance=1.000
Node 12: acceptance=1.000
Node 13: acceptance=1.000
Node 14: acceptance=1.000
Node 15: acceptance=1.000
Node 16: acceptance=1.000
Node 17: acceptance=1.000
Node 18: acceptance=1.000
Node 19: acceptance=1.000

Performance Summary:
  - Distance computation time: 1.046s (41.5%)
  - Filtering time: 1.185s (47.0%)
  - Aggregation time: 0.290s (11.5%)
  - Total time: 2.521s
  - Mean acceptance rate: 1.000

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
