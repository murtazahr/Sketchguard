Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
Degree statistics: avg=4.80, min=2, max=7
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: backdoor, lambda: 1.0
Backdoor target label: 1, trigger size: 3
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Backdoor attack: Created poisoned datasets for 6 compromised nodes
Round 001: test acc mean=0.5025 ± 0.0101 | min=0.4852 max=0.5228
         : test loss mean=3.1834 ± 2.5683
         : individual accs = ['0.508010', '0.485213', '0.513879', '0.506084', '0.491080', '0.490920', '0.490659', '0.491628', '0.505177', '0.514367', '0.501743', '0.497902', '0.500697', '0.512394', '0.494204', '0.522820', '0.493432', '0.505787', '0.509087', '0.514272']
         : correct/total = [(7230, 14232), (6907, 14235), (7331, 14266), (7195, 14217), (6992, 14238), (7056, 14373), (7039, 14346), (7047, 14334), (7221, 14294), (7393, 14373), (7197, 14344), (7121, 14302), (7187, 14354), (7359, 14362), (7077, 14320), (7526, 14395), (7100, 14389), (7211, 14257), (7255, 14251), (7405, 14399)]
         : compromised: 0.5022, honest: 0.5026
Round 002: test acc mean=0.5025 ± 0.0063 | min=0.4886 max=0.5155
         : test loss mean=2.8483 ± 2.1607
         : individual accs = ['0.511313', '0.501510', '0.508131', '0.506577', '0.504355', '0.493912', '0.502300', '0.515488', '0.503708', '0.504766', '0.488567', '0.500489', '0.496517', '0.496449', '0.505587', '0.507885', '0.506568', '0.501227', '0.492808', '0.501910']
         : correct/total = [(7277, 14232), (7139, 14235), (7249, 14266), (7202, 14217), (7181, 14238), (7099, 14373), (7206, 14346), (7389, 14334), (7200, 14294), (7255, 14373), (7008, 14344), (7158, 14302), (7127, 14354), (7130, 14362), (7240, 14320), (7311, 14395), (7289, 14389), (7146, 14257), (7023, 14251), (7227, 14399)]
         : compromised: 0.4977, honest: 0.5045
Round 003: test acc mean=0.5033 ± 0.0090 | min=0.4898 max=0.5265
         : test loss mean=1.0980 ± 0.5884
         : individual accs = ['0.519042', '0.496312', '0.492500', '0.491595', '0.501896', '0.507410', '0.511780', '0.506000', '0.502868', '0.501218', '0.489822', '0.495945', '0.509057', '0.505152', '0.500559', '0.502397', '0.492877', '0.504103', '0.509719', '0.526495']
         : correct/total = [(7387, 14232), (7065, 14235), (7026, 14266), (6989, 14217), (7146, 14238), (7293, 14373), (7342, 14346), (7253, 14334), (7188, 14294), (7204, 14373), (7026, 14344), (7093, 14302), (7307, 14354), (7255, 14362), (7168, 14320), (7232, 14395), (7092, 14389), (7187, 14257), (7264, 14251), (7581, 14399)]
         : compromised: 0.5060, honest: 0.5022
Round 004: test acc mean=0.4999 ± 0.0119 | min=0.4702 max=0.5254
         : test loss mean=1.2573 ± 0.8316
         : individual accs = ['0.500632', '0.488725', '0.500421', '0.470212', '0.486655', '0.500035', '0.496445', '0.499721', '0.514062', '0.525360', '0.500349', '0.491400', '0.497562', '0.509469', '0.492947', '0.502813', '0.500799', '0.495686', '0.501789', '0.523300']
         : correct/total = [(7125, 14232), (6957, 14235), (7139, 14266), (6685, 14217), (6929, 14238), (7187, 14373), (7122, 14346), (7163, 14334), (7348, 14294), (7551, 14373), (7177, 14344), (7028, 14302), (7142, 14354), (7317, 14362), (7059, 14320), (7238, 14395), (7206, 14389), (7067, 14257), (7151, 14251), (7535, 14399)]
         : compromised: 0.4996, honest: 0.5001
Round 005: test acc mean=0.5042 ± 0.0138 | min=0.4836 max=0.5364
         : test loss mean=0.9533 ± 0.3977
         : individual accs = ['0.492060', '0.523779', '0.494042', '0.515299', '0.496278', '0.501565', '0.506552', '0.523580', '0.483629', '0.524595', '0.515198', '0.499511', '0.493382', '0.501601', '0.491830', '0.498854', '0.491348', '0.499544', '0.495895', '0.536426']
         : correct/total = [(7003, 14232), (7456, 14235), (7048, 14266), (7326, 14217), (7066, 14238), (7209, 14373), (7267, 14346), (7505, 14334), (6913, 14294), (7540, 14373), (7390, 14344), (7144, 14302), (7082, 14354), (7204, 14362), (7043, 14320), (7181, 14395), (7070, 14389), (7122, 14257), (7067, 14251), (7724, 14399)]
         : compromised: 0.4973, honest: 0.5072
Round 006: test acc mean=0.5139 ± 0.0227 | min=0.4898 max=0.5655
         : test loss mean=1.0279 ± 0.4284
         : individual accs = ['0.513350', '0.521250', '0.514160', '0.565520', '0.502037', '0.491338', '0.518472', '0.507325', '0.508535', '0.565087', '0.531442', '0.496294', '0.499303', '0.493803', '0.501397', '0.493783', '0.508374', '0.501438', '0.489790', '0.554344']
         : correct/total = [(7306, 14232), (7420, 14235), (7335, 14266), (8040, 14217), (7148, 14238), (7062, 14373), (7438, 14346), (7272, 14334), (7269, 14294), (8122, 14373), (7623, 14344), (7098, 14302), (7167, 14354), (7092, 14362), (7180, 14320), (7108, 14395), (7315, 14389), (7149, 14257), (6980, 14251), (7982, 14399)]
         : compromised: 0.4962, honest: 0.5214
Round 007: test acc mean=0.5134 ± 0.0190 | min=0.4892 max=0.5531
         : test loss mean=0.8889 ± 0.3186
         : individual accs = ['0.534148', '0.521531', '0.502664', '0.553141', '0.503582', '0.501774', '0.548236', '0.523859', '0.503498', '0.532944', '0.527747', '0.489162', '0.497910', '0.489208', '0.507193', '0.495658', '0.495170', '0.504875', '0.501509', '0.534343']
         : correct/total = [(7602, 14232), (7424, 14235), (7171, 14266), (7864, 14217), (7170, 14238), (7212, 14373), (7865, 14346), (7509, 14334), (7197, 14294), (7660, 14373), (7570, 14344), (6996, 14302), (7147, 14354), (7026, 14362), (7263, 14320), (7135, 14395), (7125, 14389), (7198, 14257), (7147, 14251), (7694, 14399)]
         : compromised: 0.5004, honest: 0.5190
Round 008: test acc mean=0.5123 ± 0.0200 | min=0.4839 max=0.5517
         : test loss mean=1.0619 ± 0.5720
         : individual accs = ['0.551714', '0.483878', '0.500210', '0.515369', '0.502248', '0.496278', '0.528998', '0.524906', '0.527074', '0.530926', '0.551729', '0.504894', '0.520621', '0.492898', '0.493436', '0.498576', '0.494892', '0.501017', '0.489299', '0.536634']
         : correct/total = [(7852, 14232), (6888, 14235), (7136, 14266), (7327, 14217), (7151, 14238), (7133, 14373), (7589, 14346), (7524, 14334), (7534, 14294), (7631, 14373), (7914, 14344), (7221, 14302), (7473, 14354), (7079, 14362), (7066, 14320), (7177, 14395), (7121, 14389), (7143, 14257), (6973, 14251), (7727, 14399)]
         : compromised: 0.4989, honest: 0.5180
Round 009: test acc mean=0.5144 ± 0.0158 | min=0.4877 max=0.5666
         : test loss mean=0.8182 ± 0.2495
         : individual accs = ['0.523117', '0.521531', '0.512267', '0.528452', '0.509833', '0.487720', '0.505646', '0.493931', '0.515321', '0.566618', '0.518823', '0.511397', '0.513933', '0.510583', '0.505936', '0.506148', '0.504344', '0.517079', '0.503052', '0.531981']
         : correct/total = [(7445, 14232), (7424, 14235), (7308, 14266), (7513, 14217), (7259, 14238), (7010, 14373), (7254, 14346), (7080, 14334), (7366, 14294), (8144, 14373), (7442, 14344), (7314, 14302), (7377, 14354), (7333, 14362), (7245, 14320), (7286, 14395), (7257, 14389), (7372, 14257), (7169, 14251), (7660, 14399)]
         : compromised: 0.5064, honest: 0.5178
Round 010: test acc mean=0.5082 ± 0.0167 | min=0.4835 max=0.5686
         : test loss mean=1.0782 ± 0.4121
         : individual accs = ['0.513702', '0.483456', '0.509814', '0.517198', '0.509763', '0.495721', '0.507807', '0.507395', '0.502588', '0.530509', '0.502091', '0.496015', '0.497213', '0.494708', '0.507542', '0.507190', '0.504066', '0.504664', '0.504386', '0.568581']
         : correct/total = [(7311, 14232), (6882, 14235), (7273, 14266), (7353, 14217), (7258, 14238), (7125, 14373), (7285, 14346), (7273, 14334), (7184, 14294), (7625, 14373), (7202, 14344), (7094, 14302), (7137, 14354), (7105, 14362), (7268, 14320), (7301, 14395), (7253, 14389), (7195, 14257), (7188, 14251), (8187, 14399)]
         : compromised: 0.5007, honest: 0.5114

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: d-fedavg
Attack: backdoor, 30.0% compromised
Final accuracy - Compromised: 0.5007, Honest: 0.5114
Overall test accuracy: mean=0.5082 ± 0.0167

=== BACKDOOR ATTACK SUCCESS RATE (ASR) ===
Target label: 1
Trigger size: 3x3
Overall ASR: 0.2022 ± 0.3043
Honest nodes ASR: 0.2703 ± 0.3367
Compromised nodes ASR: 0.0431 ± 0.0891
Note: Higher ASR indicates more successful backdoor attack
