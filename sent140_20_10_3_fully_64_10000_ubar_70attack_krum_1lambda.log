Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Degree statistics: avg=19.00, min=19, max=19
Attack: Compromised 14/20 nodes: [1, 2, 3, 5, 6, 8, 11, 12, 13, 14, 15, 17, 18, 19]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
UBAR ALGORITHM (Two-Stage Byzantine-resilient)
  - Model dimension: 1,174,986 parameters
  - Rho parameter: 0.30000000000000004
  - Stage 1: Distance-based filtering (select 30% closest neighbors)
  - Stage 2: Performance-based selection (loss comparison)
  - Complexity: O(deg(i)×d + deg(i)×inference)
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5386 ± 0.0203 | min=0.5066 max=0.5878
         : test loss mean=0.6911 ± 0.0015
         : individual accs = ['0.536959', '0.544995', '0.529230', '0.530070', '0.542281', '0.535170', '0.506622', '0.587833', '0.518609', '0.526473', '0.529141', '0.551391', '0.511147', '0.538922', '0.530377', '0.554081', '0.575092', '0.513362', '0.565995', '0.543649']
         : correct/total = [(7642, 14232), (7758, 14235), (7550, 14266), (7536, 14217), (7721, 14238), (7692, 14373), (7268, 14346), (8426, 14334), (7413, 14294), (7567, 14373), (7590, 14344), (7886, 14302), (7337, 14354), (7740, 14362), (7595, 14320), (7976, 14395), (8275, 14389), (7319, 14257), (8066, 14251), (7828, 14399)]
         : compromised: 0.5338, honest: 0.5496
         : ubar stats = ['Node 0: s1=0.263, s2=0.600', 'Node 1: s1=0.263, s2=0.200', 'Node 2: s1=0.263, s2=0.600']...
Round 002: test acc mean=0.5158 ± 0.0284 | min=0.4861 max=0.5767
         : test loss mean=0.6914 ± 0.0027
         : individual accs = ['0.489531', '0.498560', '0.486051', '0.492228', '0.495084', '0.495930', '0.507249', '0.513395', '0.488946', '0.570792', '0.514013', '0.558733', '0.532465', '0.508564', '0.495810', '0.576728', '0.503857', '0.505155', '0.566276', '0.516980']
         : correct/total = [(6967, 14232), (7097, 14235), (6934, 14266), (6998, 14217), (7049, 14238), (7128, 14373), (7277, 14346), (7359, 14334), (6989, 14294), (8204, 14373), (7373, 14344), (7991, 14302), (7643, 14354), (7304, 14362), (7100, 14320), (8302, 14395), (7250, 14389), (7202, 14257), (8070, 14251), (7444, 14399)]
         : compromised: 0.5164, honest: 0.5144
         : ubar stats = ['Node 0: s1=0.263, s2=0.700', 'Node 1: s1=0.263, s2=0.600', 'Node 2: s1=0.263, s2=0.700']...
Round 003: test acc mean=0.5081 ± 0.0265 | min=0.4861 max=0.5845
         : test loss mean=0.6918 ± 0.0028
         : individual accs = ['0.489109', '0.486266', '0.486051', '0.492228', '0.494030', '0.493843', '0.497560', '0.569485', '0.488667', '0.542406', '0.512619', '0.524402', '0.499512', '0.508564', '0.495810', '0.498367', '0.499757', '0.503051', '0.584520', '0.496354']
         : correct/total = [(6961, 14232), (6922, 14235), (6934, 14266), (6998, 14217), (7034, 14238), (7098, 14373), (7138, 14346), (8163, 14334), (6985, 14294), (7796, 14373), (7353, 14344), (7500, 14302), (7170, 14354), (7304, 14362), (7100, 14320), (7174, 14395), (7191, 14389), (7172, 14257), (8330, 14251), (7147, 14399)]
         : compromised: 0.5039, honest: 0.5179
         : ubar stats = ['Node 0: s1=0.263, s2=0.667', 'Node 1: s1=0.263, s2=0.667', 'Node 2: s1=0.263, s2=0.800']...
Round 004: test acc mean=0.5146 ± 0.0305 | min=0.4863 max=0.5957
         : test loss mean=0.6905 ± 0.0037
         : individual accs = ['0.513491', '0.486266', '0.486682', '0.500739', '0.496488', '0.493843', '0.497560', '0.574648', '0.492724', '0.559313', '0.551380', '0.534890', '0.499582', '0.508564', '0.495810', '0.498576', '0.506290', '0.503051', '0.595677', '0.496354']
         : correct/total = [(7308, 14232), (6922, 14235), (6943, 14266), (7119, 14217), (7069, 14238), (7098, 14373), (7138, 14346), (8237, 14334), (7043, 14294), (8039, 14373), (7909, 14344), (7650, 14302), (7171, 14354), (7304, 14362), (7100, 14320), (7177, 14395), (7285, 14389), (7172, 14257), (8489, 14251), (7147, 14399)]
         : compromised: 0.5065, honest: 0.5336
         : ubar stats = ['Node 0: s1=0.263, s2=0.650', 'Node 1: s1=0.263, s2=0.650', 'Node 2: s1=0.263, s2=0.850']...
Round 005: test acc mean=0.5367 ± 0.0365 | min=0.4901 max=0.6000
         : test loss mean=0.6875 ± 0.0052
         : individual accs = ['0.552347', '0.490130', '0.507150', '0.552367', '0.532448', '0.494121', '0.498118', '0.599414', '0.525745', '0.578863', '0.593279', '0.568871', '0.522224', '0.518382', '0.498534', '0.531851', '0.568907', '0.503191', '0.599958', '0.498298']
         : correct/total = [(7861, 14232), (6977, 14235), (7235, 14266), (7853, 14217), (7581, 14238), (7102, 14373), (7146, 14346), (8592, 14334), (7515, 14294), (8320, 14373), (8510, 14344), (8136, 14302), (7496, 14354), (7445, 14362), (7139, 14320), (7656, 14395), (8186, 14389), (7174, 14257), (8550, 14251), (7175, 14399)]
         : compromised: 0.5221, honest: 0.5709
         : ubar stats = ['Node 0: s1=0.263, s2=0.680', 'Node 1: s1=0.263, s2=0.560', 'Node 2: s1=0.263, s2=0.800']...
Round 006: test acc mean=0.5824 ± 0.0226 | min=0.5332 max=0.6081
         : test loss mean=0.6805 ± 0.0063
         : individual accs = ['0.593451', '0.597190', '0.581312', '0.596821', '0.594114', '0.556043', '0.543775', '0.606530', '0.598153', '0.603006', '0.608129', '0.594043', '0.592727', '0.564685', '0.533170', '0.584300', '0.596567', '0.557270', '0.599888', '0.546705']
         : correct/total = [(8446, 14232), (8501, 14235), (8293, 14266), (8485, 14217), (8459, 14238), (7992, 14373), (7801, 14346), (8694, 14334), (8550, 14294), (8667, 14373), (8723, 14344), (8496, 14302), (8508, 14354), (8110, 14362), (7635, 14320), (8411, 14395), (8584, 14389), (7945, 14257), (8549, 14251), (7872, 14399)]
         : compromised: 0.5747, honest: 0.6003
         : ubar stats = ['Node 0: s1=0.263, s2=0.667', 'Node 1: s1=0.263, s2=0.500', 'Node 2: s1=0.263, s2=0.800']...
Round 007: test acc mean=0.6066 ± 0.0059 | min=0.5973 max=0.6189
         : test loss mean=0.6695 ± 0.0064
         : individual accs = ['0.609682', '0.607446', '0.600519', '0.610044', '0.613288', '0.605789', '0.598425', '0.613785', '0.607458', '0.618938', '0.615031', '0.602713', '0.605824', '0.604442', '0.597277', '0.605488', '0.603795', '0.599355', '0.612799', '0.600458']
         : correct/total = [(8677, 14232), (8647, 14235), (8567, 14266), (8673, 14217), (8732, 14238), (8707, 14373), (8585, 14346), (8798, 14334), (8683, 14294), (8896, 14373), (8822, 14344), (8620, 14302), (8696, 14354), (8681, 14362), (8553, 14320), (8716, 14395), (8688, 14389), (8545, 14257), (8733, 14251), (8646, 14399)]
         : compromised: 0.6041, honest: 0.6124
         : ubar stats = ['Node 0: s1=0.263, s2=0.600', 'Node 1: s1=0.263, s2=0.514', 'Node 2: s1=0.263, s2=0.829']...
Round 008: test acc mean=0.6152 ± 0.0058 | min=0.6034 max=0.6299
         : test loss mean=0.6579 ± 0.0042
         : individual accs = ['0.616849', '0.615736', '0.603393', '0.621791', '0.620101', '0.617616', '0.610972', '0.620273', '0.615713', '0.629862', '0.619074', '0.609985', '0.616483', '0.611266', '0.613059', '0.610698', '0.616096', '0.611489', '0.617080', '0.605945']
         : correct/total = [(8779, 14232), (8765, 14235), (8608, 14266), (8840, 14217), (8829, 14238), (8877, 14373), (8765, 14346), (8891, 14334), (8801, 14294), (9053, 14373), (8880, 14344), (8724, 14302), (8849, 14354), (8779, 14362), (8779, 14320), (8791, 14395), (8865, 14389), (8718, 14257), (8794, 14251), (8725, 14399)]
         : compromised: 0.6129, honest: 0.6204
         : ubar stats = ['Node 0: s1=0.263, s2=0.550', 'Node 1: s1=0.263, s2=0.550', 'Node 2: s1=0.263, s2=0.850']...
Round 009: test acc mean=0.6220 ± 0.0045 | min=0.6151 max=0.6339
         : test loss mean=0.6509 ± 0.0026
         : individual accs = ['0.621908', '0.622761', '0.616150', '0.629036', '0.624175', '0.623252', '0.615991', '0.623901', '0.615083', '0.633897', '0.624651', '0.622430', '0.620594', '0.621362', '0.616550', '0.620632', '0.619362', '0.626920', '0.621641', '0.619974']
         : correct/total = [(8851, 14232), (8865, 14235), (8790, 14266), (8943, 14217), (8887, 14238), (8958, 14373), (8837, 14346), (8943, 14334), (8792, 14294), (9111, 14373), (8960, 14344), (8902, 14302), (8908, 14354), (8924, 14362), (8829, 14320), (8934, 14395), (8912, 14389), (8938, 14257), (8859, 14251), (8927, 14399)]
         : compromised: 0.6209, honest: 0.6246
         : ubar stats = ['Node 0: s1=0.263, s2=0.511', 'Node 1: s1=0.263, s2=0.600', 'Node 2: s1=0.263, s2=0.844']...
Round 010: test acc mean=0.6289 ± 0.0049 | min=0.6196 max=0.6395
         : test loss mean=0.6452 ± 0.0022
         : individual accs = ['0.628935', '0.632806', '0.622109', '0.634522', '0.637028', '0.632088', '0.619615', '0.628296', '0.624808', '0.639463', '0.629044', '0.630192', '0.626167', '0.626654', '0.627235', '0.628691', '0.621864', '0.633864', '0.627465', '0.626919']
         : correct/total = [(8951, 14232), (9008, 14235), (8875, 14266), (9021, 14217), (9070, 14238), (9085, 14373), (8889, 14346), (9006, 14334), (8931, 14294), (9191, 14373), (9023, 14344), (9013, 14302), (8988, 14354), (9000, 14362), (8982, 14320), (9050, 14395), (8948, 14389), (9037, 14257), (8942, 14251), (9027, 14399)]
         : compromised: 0.6281, honest: 0.6308
         : ubar stats = ['Node 0: s1=0.263, s2=0.480', 'Node 1: s1=0.263, s2=0.640', 'Node 2: s1=0.263, s2=0.860']...

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: fully, Aggregation: ubar
Attack: krum, 70.0% compromised
Final accuracy - Compromised: 0.6281, Honest: 0.6308
Overall test accuracy: mean=0.6289 ± 0.0049

=== UBAR SUMMARY ===
Node 0: stage1=0.263, stage2=0.480, overall=0.126
Node 1: stage1=0.263, stage2=0.640, overall=0.168
Node 2: stage1=0.263, stage2=0.860, overall=0.226
Node 3: stage1=0.263, stage2=0.480, overall=0.126
Node 4: stage1=0.263, stage2=0.580, overall=0.153
Node 5: stage1=0.263, stage2=0.740, overall=0.195
Node 6: stage1=0.263, stage2=0.520, overall=0.137
Node 7: stage1=0.263, stage2=0.400, overall=0.105
Node 8: stage1=0.263, stage2=0.560, overall=0.147
Node 9: stage1=0.263, stage2=0.360, overall=0.095
Node 10: stage1=0.263, stage2=0.480, overall=0.126
Node 11: stage1=0.263, stage2=0.340, overall=0.089
Node 12: stage1=0.263, stage2=0.480, overall=0.126
Node 13: stage1=0.263, stage2=0.840, overall=0.221
Node 14: stage1=0.263, stage2=0.600, overall=0.158
Node 15: stage1=0.263, stage2=0.480, overall=0.126
Node 16: stage1=0.263, stage2=0.660, overall=0.174
Node 17: stage1=0.263, stage2=0.760, overall=0.200
Node 18: stage1=0.263, stage2=0.320, overall=0.084
Node 19: stage1=0.263, stage2=0.580, overall=0.153

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Distance computation: 0.079s (71.0%)
    - Loss computation: 0.024s (21.9%)
    - Aggregation: 0.008s (7.1%)
  TOTALS:
    - Total computation: 0.112s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.112s

=== PER-NODE AVERAGE TIME ===
  - Distance computation: 0.076s
  - Loss computation: 0.021s
  - Aggregation: 0.006s
  - Model transfer: 0.000s
  - Total per node: 0.103s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total distance computation: 1.515s
  - Total loss computation: 0.423s
  - Total aggregation: 0.117s
  - Total model transfer: 0.000s
  - Grand total: 2.055s
  - Mean Stage 1 acceptance rate: 0.263
  - Mean Stage 2 acceptance rate: 0.558
  - Overall acceptance rate: 0.147

UBAR Algorithm Properties:
  - Model dimension: 1,174,986
  - Rho parameter: 0.30000000000000004
  - Two-stage approach: Distance filtering + loss evaluation
  - Stage 1 selects: 30% of neighbors
  - Stage 2 uses: Training sample loss comparison
  - Theoretical complexity: O(deg(i)×d + deg(i)×inference)
  - Approach: UBAR paper implementation
