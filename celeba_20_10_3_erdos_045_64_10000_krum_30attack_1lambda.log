Device: cuda
Seed: 987654321
Looking for images in: /home/student.unimelb.edu.au/mrangwala/Trust-Monitor/leaf/data/celeba/data/raw/img_align_celeba
Loading 1 LEAF CelebA train files...
LEAF CelebA train: 9343 users (celebrities), 177457 samples
Looking for images in: /home/student.unimelb.edu.au/mrangwala/Trust-Monitor/leaf/data/celeba/data/raw/img_align_celeba
Loading 1 LEAF CelebA test files...
LEAF CelebA test: 9343 users (celebrities), 22831 samples
Found 9343 train users, 9343 test users, 9343 common users
User sample counts range: 31 (max) to 4 (min)
Distributed ALL 9343 users across 20 clients
Users per client: 467 (with 3 clients getting +1 user)
Train partition sizes: [8843, 8998, 8728, 9034, 8866, 8946, 8873, 8776, 8816, 8801, 8913, 8656, 9115, 8921, 8699, 8823, 8912, 8766, 9102, 8869]
Test partition sizes: [1140, 1158, 1127, 1158, 1134, 1145, 1145, 1127, 1136, 1128, 1144, 1125, 1152, 1160, 1124, 1145, 1154, 1131, 1157, 1141]
  Client 0: 8843 train samples, 2 unique classes
  Client 1: 8998 train samples, 2 unique classes
  Client 2: 8728 train samples, 2 unique classes
  Client 3: 9034 train samples, 2 unique classes
  Client 4: 8866 train samples, 2 unique classes
  Client 5: 8946 train samples, 2 unique classes
  Client 6: 8873 train samples, 2 unique classes
  Client 7: 8776 train samples, 2 unique classes
  Client 8: 8816 train samples, 2 unique classes
  Client 9: 8801 train samples, 2 unique classes
  Client 10: 8913 train samples, 2 unique classes
  Client 11: 8656 train samples, 2 unique classes
  Client 12: 9115 train samples, 2 unique classes
  Client 13: 8921 train samples, 2 unique classes
  Client 14: 8699 train samples, 2 unique classes
  Client 15: 8823 train samples, 2 unique classes
  Client 16: 8912 train samples, 2 unique classes
  Client 17: 8766 train samples, 2 unique classes
  Client 18: 9102 train samples, 2 unique classes
  Client 19: 8869 train samples, 2 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Attack: Compromised 6/20 nodes: [5, 12, 13, 14, 17, 18]
Attack type: directed_deviation, lambda: 1.0
Initial test acc across nodes: mean=0.4969 ± 0.0214
Round 001: test acc mean=0.8660 ± 0.0727 | min=0.5625 max=0.9180
         : test loss mean=nan ± nan
         : individual accs = ['0.835088', '0.858377', '0.893523', '0.901554', '0.917989', '0.851528', '0.889956', '0.892635', '0.562500', '0.868794', '0.860140', '0.904000', '0.875868', '0.893103', '0.894128', '0.883843', '0.893414', '0.893015', '0.850475', '0.900088']
         : correct/total = [(952, 1140), (994, 1158), (1007, 1127), (1044, 1158), (1041, 1134), (975, 1145), (1019, 1145), (1006, 1127), (639, 1136), (980, 1128), (984, 1144), (1017, 1125), (1009, 1152), (1036, 1160), (1005, 1124), (1012, 1145), (1031, 1154), (1010, 1131), (984, 1157), (1027, 1141)]
         : compromised: 0.8764, honest: 0.8616
Round 002: test acc mean=0.8793 ± 0.0733 | min=0.5660 max=0.9167
         : test loss mean=42.8890 ± 185.7688
         : individual accs = ['0.913158', '0.899827', '0.886424', '0.910190', '0.869489', '0.912664', '0.868122', '0.908607', '0.566021', '0.896277', '0.892483', '0.904889', '0.916667', '0.903448', '0.877224', '0.900437', '0.874350', '0.900088', '0.885912', '0.899211']
         : correct/total = [(1041, 1140), (1042, 1158), (999, 1127), (1054, 1158), (986, 1134), (1045, 1145), (994, 1145), (1024, 1127), (643, 1136), (1011, 1128), (1021, 1144), (1018, 1125), (1056, 1152), (1048, 1160), (986, 1124), (1031, 1145), (1009, 1154), (1018, 1131), (1025, 1157), (1026, 1141)]
         : compromised: 0.8993, honest: 0.8707
Round 003: test acc mean=0.8889 ± 0.0754 | min=0.5625 max=0.9211
         : test loss mean=45.5890 ± 197.6726
         : individual accs = ['0.921053', '0.889465', '0.897072', '0.897237', '0.917989', '0.900437', '0.915284', '0.915705', '0.562500', '0.906028', '0.892483', '0.908444', '0.909722', '0.912069', '0.907473', '0.910044', '0.904679', '0.896552', '0.898876', '0.915863']
         : correct/total = [(1050, 1140), (1030, 1158), (1011, 1127), (1039, 1158), (1041, 1134), (1031, 1145), (1048, 1145), (1032, 1127), (639, 1136), (1022, 1128), (1021, 1144), (1022, 1125), (1048, 1152), (1058, 1160), (1020, 1124), (1042, 1145), (1044, 1154), (1014, 1131), (1040, 1157), (1045, 1141)]
         : compromised: 0.9042, honest: 0.8824
Round 004: test acc mean=0.8811 ± 0.0980 | min=0.4560 max=0.9173
         : test loss mean=4.2504 ± 17.4647
         : individual accs = ['0.914035', '0.892919', '0.897959', '0.900691', '0.909171', '0.903930', '0.914410', '0.894410', '0.455986', '0.897163', '0.904720', '0.895111', '0.912326', '0.912069', '0.917260', '0.906550', '0.908146', '0.889478', '0.879862', '0.915863']
         : correct/total = [(1042, 1140), (1034, 1158), (1012, 1127), (1043, 1158), (1031, 1134), (1035, 1145), (1047, 1145), (1008, 1127), (518, 1136), (1012, 1128), (1035, 1144), (1007, 1125), (1051, 1152), (1058, 1160), (1031, 1124), (1038, 1145), (1048, 1154), (1006, 1131), (1018, 1157), (1045, 1141)]
         : compromised: 0.9025, honest: 0.8719
Round 005: test acc mean=0.8851 ± 0.0989 | min=0.4551 max=0.9246
         : test loss mean=65.8838 ± 286.1766
         : individual accs = ['0.924561', '0.898100', '0.893523', '0.911917', '0.902998', '0.912664', '0.910044', '0.898846', '0.455106', '0.909574', '0.900350', '0.908444', '0.914062', '0.919828', '0.903915', '0.909170', '0.902946', '0.909814', '0.902334', '0.914110']
         : correct/total = [(1054, 1140), (1040, 1158), (1007, 1127), (1056, 1158), (1024, 1134), (1045, 1145), (1042, 1145), (1013, 1127), (517, 1136), (1026, 1128), (1030, 1144), (1022, 1125), (1053, 1152), (1067, 1160), (1016, 1124), (1041, 1145), (1042, 1154), (1029, 1131), (1044, 1157), (1043, 1141)]
         : compromised: 0.9104, honest: 0.8743
Round 006: test acc mean=0.8902 ± 0.0971 | min=0.4683 max=0.9254
         : test loss mean=35.6850 ± 154.5723
         : individual accs = ['0.925439', '0.921416', '0.892635', '0.905872', '0.917989', '0.917904', '0.912664', '0.915705', '0.468310', '0.921099', '0.902972', '0.915556', '0.919271', '0.912069', '0.915480', '0.917031', '0.908146', '0.903625', '0.895419', '0.914987']
         : correct/total = [(1055, 1140), (1067, 1158), (1006, 1127), (1049, 1158), (1041, 1134), (1051, 1145), (1045, 1145), (1032, 1127), (532, 1136), (1039, 1128), (1033, 1144), (1030, 1125), (1059, 1152), (1058, 1160), (1029, 1124), (1050, 1145), (1048, 1154), (1022, 1131), (1036, 1157), (1044, 1141)]
         : compromised: 0.9106, honest: 0.8814
Round 007: test acc mean=0.8926 ± 0.0760 | min=0.5634 max=0.9272
         : test loss mean=42.1704 ± 182.7960
         : individual accs = ['0.927193', '0.911054', '0.892635', '0.914508', '0.905644', '0.920524', '0.922271', '0.920142', '0.563380', '0.900709', '0.905594', '0.897778', '0.916667', '0.903448', '0.909253', '0.903930', '0.914211', '0.906278', '0.900605', '0.916740']
         : correct/total = [(1057, 1140), (1055, 1158), (1006, 1127), (1059, 1158), (1027, 1134), (1054, 1145), (1056, 1145), (1037, 1127), (640, 1136), (1016, 1128), (1036, 1144), (1010, 1125), (1056, 1152), (1048, 1160), (1022, 1124), (1035, 1145), (1055, 1154), (1025, 1131), (1042, 1157), (1046, 1141)]
         : compromised: 0.9095, honest: 0.8854
Round 008: test acc mean=0.8919 ± 0.0764 | min=0.5616 max=0.9254
         : test loss mean=18.9772 ± 81.6164
         : individual accs = ['0.925439', '0.901554', '0.889973', '0.912781', '0.901235', '0.909170', '0.917904', '0.918367', '0.561620', '0.907801', '0.894231', '0.920000', '0.917535', '0.915517', '0.904804', '0.919651', '0.913345', '0.906278', '0.890233', '0.909728']
         : correct/total = [(1055, 1140), (1044, 1158), (1003, 1127), (1057, 1158), (1022, 1134), (1041, 1145), (1051, 1145), (1035, 1127), (638, 1136), (1024, 1128), (1023, 1144), (1035, 1125), (1057, 1152), (1062, 1160), (1017, 1124), (1053, 1145), (1054, 1154), (1025, 1131), (1030, 1157), (1038, 1141)]
         : compromised: 0.9073, honest: 0.8853
Round 009: test acc mean=0.8871 ± 0.1015 | min=0.4472 max=0.9255
         : test loss mean=60.2762 ± 261.6745
         : individual accs = ['0.922807', '0.917962', '0.897072', '0.904145', '0.902998', '0.903930', '0.910917', '0.915705', '0.447183', '0.918440', '0.905594', '0.919111', '0.899306', '0.918103', '0.903025', '0.918777', '0.919411', '0.914235', '0.877269', '0.925504']
         : correct/total = [(1052, 1140), (1063, 1158), (1011, 1127), (1047, 1158), (1024, 1134), (1035, 1145), (1043, 1145), (1032, 1127), (508, 1136), (1036, 1128), (1036, 1144), (1034, 1125), (1036, 1152), (1065, 1160), (1015, 1124), (1052, 1145), (1061, 1154), (1034, 1131), (1015, 1157), (1056, 1141)]
         : compromised: 0.9026, honest: 0.8804
Round 010: test acc mean=0.8896 ± 0.1030 | min=0.4419 max=0.9219
         : test loss mean=20.9295 ± 90.1166
         : individual accs = ['0.921930', '0.918826', '0.894410', '0.918826', '0.912698', '0.914410', '0.910044', '0.916593', '0.441901', '0.918440', '0.907343', '0.914667', '0.919271', '0.914655', '0.907473', '0.914410', '0.915078', '0.916888', '0.894555', '0.920245']
         : correct/total = [(1051, 1140), (1064, 1158), (1008, 1127), (1064, 1158), (1035, 1134), (1047, 1145), (1042, 1145), (1033, 1127), (502, 1136), (1036, 1128), (1038, 1144), (1029, 1125), (1059, 1152), (1061, 1160), (1020, 1124), (1047, 1145), (1056, 1154), (1037, 1131), (1035, 1157), (1050, 1141)]
         : compromised: 0.9112, honest: 0.8804

=== FINAL RESULTS ===
Dataset: celeba, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 30.0% compromised
Final accuracy - Compromised: 0.9112, Honest: 0.8804
Overall test accuracy: mean=0.8896 ± 0.1030
