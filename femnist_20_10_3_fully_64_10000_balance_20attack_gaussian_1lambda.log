Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: fully, nodes: 20, edges: 190
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: gaussian, lambda: 1.0
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.5043 ± 0.0333 | min=0.4489 max=0.5564
         : test loss mean=3.7419 ± 0.0230
         : individual accs = ['0.556444', '0.513205', '0.523891', '0.509347', '0.468590', '0.549802', '0.491057', '0.497816', '0.542353', '0.462941', '0.475259', '0.535655', '0.475446', '0.462473', '0.513080', '0.537106', '0.462798', '0.547215', '0.512488', '0.448886']
         : correct/total = [(2297, 4128), (2157, 4203), (2138, 4081), (2207, 4333), (1917, 4091), (2357, 4287), (2059, 4193), (2165, 4349), (2273, 4191), (1980, 4277), (1969, 4143), (2246, 4193), (1946, 4093), (1941, 4197), (2079, 4052), (2164, 4029), (1922, 4153), (2289, 4183), (2093, 4084), (1853, 4128)]
         : compromised: 0.5087, honest: 0.5032
Round 002: test acc mean=0.6814 ± 0.0199 | min=0.6306 max=0.7135
         : test loss mean=3.4380 ± 0.0482
         : individual accs = ['0.678295', '0.678801', '0.672629', '0.698592', '0.684674', '0.702356', '0.630575', '0.691653', '0.669053', '0.710311', '0.679459', '0.702600', '0.690447', '0.664284', '0.713475', '0.690990', '0.654226', '0.659096', '0.688051', '0.668120']
         : correct/total = [(2800, 4128), (2853, 4203), (2745, 4081), (3027, 4333), (2801, 4091), (3011, 4287), (2644, 4193), (3008, 4349), (2804, 4191), (3038, 4277), (2815, 4143), (2946, 4193), (2826, 4093), (2788, 4197), (2891, 4052), (2784, 4029), (2717, 4153), (2757, 4183), (2810, 4084), (2758, 4128)]
         : compromised: 0.6790, honest: 0.6820
Round 003: test acc mean=0.7029 ± 0.0232 | min=0.6305 max=0.7287
         : test loss mean=3.1721 ± 0.0886
         : individual accs = ['0.728682', '0.704021', '0.688557', '0.726287', '0.700807', '0.630511', '0.717625', '0.726834', '0.727511', '0.681552', '0.698769', '0.718340', '0.723186', '0.686919', '0.725321', '0.698933', '0.688177', '0.682764', '0.690744', '0.711483']
         : correct/total = [(3008, 4128), (2959, 4203), (2810, 4081), (3147, 4333), (2867, 4091), (2703, 4287), (3009, 4193), (3161, 4349), (3049, 4191), (2915, 4277), (2895, 4143), (3012, 4193), (2960, 4093), (2883, 4197), (2939, 4052), (2816, 4029), (2858, 4153), (2856, 4183), (2821, 4084), (2937, 4128)]
         : compromised: 0.6808, honest: 0.7084
Round 004: test acc mean=0.6832 ± 0.0356 | min=0.5878 max=0.7294
         : test loss mean=2.6766 ± 0.1390
         : individual accs = ['0.678537', '0.711872', '0.645430', '0.695592', '0.721340', '0.633310', '0.715001', '0.711888', '0.729420', '0.675473', '0.646874', '0.702361', '0.587833', '0.680963', '0.728529', '0.692231', '0.700698', '0.643318', '0.686827', '0.675872']
         : correct/total = [(2801, 4128), (2992, 4203), (2634, 4081), (3014, 4333), (2951, 4091), (2715, 4287), (2998, 4193), (3096, 4349), (3057, 4191), (2889, 4277), (2680, 4143), (2945, 4193), (2406, 4093), (2858, 4197), (2952, 4052), (2789, 4029), (2910, 4153), (2691, 4183), (2805, 4084), (2790, 4128)]
         : compromised: 0.6364, honest: 0.6949
Round 005: test acc mean=0.6477 ± 0.0390 | min=0.5678 max=0.6995
         : test loss mean=2.0170 ± 0.1522
         : individual accs = ['0.669331', '0.655246', '0.588826', '0.644357', '0.683940', '0.615115', '0.662056', '0.690274', '0.680506', '0.672902', '0.630702', '0.673265', '0.577327', '0.597808', '0.659921', '0.628692', '0.699494', '0.567774', '0.694417', '0.662791']
         : correct/total = [(2763, 4128), (2754, 4203), (2403, 4081), (2792, 4333), (2798, 4091), (2637, 4287), (2776, 4193), (3002, 4349), (2852, 4191), (2878, 4277), (2613, 4143), (2823, 4193), (2363, 4093), (2509, 4197), (2674, 4052), (2533, 4029), (2905, 4153), (2375, 4183), (2836, 4084), (2736, 4128)]
         : compromised: 0.5895, honest: 0.6623
Round 006: test acc mean=0.7196 ± 0.0213 | min=0.6718 max=0.7453
         : test loss mean=1.2426 ± 0.0933
         : individual accs = ['0.690165', '0.719486', '0.723107', '0.727902', '0.740406', '0.671798', '0.740043', '0.730283', '0.718444', '0.720365', '0.739319', '0.742666', '0.681896', '0.710031', '0.745311', '0.723008', '0.730075', '0.682046', '0.733839', '0.722626']
         : correct/total = [(2849, 4128), (3024, 4203), (2951, 4081), (3154, 4333), (3029, 4091), (2880, 4287), (3103, 4193), (3176, 4349), (3011, 4191), (3081, 4277), (3063, 4143), (3114, 4193), (2791, 4093), (2980, 4197), (3020, 4052), (2913, 4029), (3032, 4153), (2853, 4183), (2997, 4084), (2983, 4128)]
         : compromised: 0.6864, honest: 0.7279
Round 007: test acc mean=0.7952 ± 0.0085 | min=0.7760 max=0.8094
         : test loss mean=0.7397 ± 0.0393
         : individual accs = ['0.790698', '0.800619', '0.783386', '0.796677', '0.782449', '0.797527', '0.809444', '0.805473', '0.803388', '0.802198', '0.791455', '0.797758', '0.775959', '0.790565', '0.803554', '0.791015', '0.799904', '0.791776', '0.802889', '0.786337']
         : correct/total = [(3264, 4128), (3365, 4203), (3197, 4081), (3452, 4333), (3201, 4091), (3419, 4287), (3394, 4193), (3503, 4349), (3367, 4191), (3431, 4277), (3279, 4143), (3345, 4193), (3176, 4093), (3318, 4197), (3256, 4052), (3187, 4029), (3322, 4153), (3312, 4183), (3279, 4084), (3246, 4128)]
         : compromised: 0.7890, honest: 0.7967
Round 008: test acc mean=0.8210 ± 0.0069 | min=0.8067 max=0.8285
         : test loss mean=0.5704 ± 0.0210
         : individual accs = ['0.809593', '0.823935', '0.817202', '0.828064', '0.808849', '0.828318', '0.828524', '0.824097', '0.828203', '0.825579', '0.813420', '0.826616', '0.814561', '0.820824', '0.827246', '0.826011', '0.819408', '0.822376', '0.820274', '0.806686']
         : correct/total = [(3342, 4128), (3463, 4203), (3335, 4081), (3588, 4333), (3309, 4091), (3551, 4287), (3474, 4193), (3584, 4349), (3471, 4191), (3531, 4277), (3370, 4143), (3466, 4193), (3334, 4093), (3445, 4197), (3352, 4052), (3328, 4029), (3403, 4153), (3440, 4183), (3350, 4084), (3330, 4128)]
         : compromised: 0.8215, honest: 0.8209
Round 009: test acc mean=0.8340 ± 0.0054 | min=0.8258 max=0.8466
         : test loss mean=0.5140 ± 0.0190
         : individual accs = ['0.826793', '0.836545', '0.831414', '0.838680', '0.826937', '0.834383', '0.840925', '0.836054', '0.846576', '0.840075', '0.827420', '0.832340', '0.830687', '0.833452', '0.840326', '0.835443', '0.831447', '0.829787', '0.834966', '0.825824']
         : correct/total = [(3413, 4128), (3516, 4203), (3393, 4081), (3634, 4333), (3383, 4091), (3577, 4287), (3526, 4193), (3636, 4349), (3548, 4191), (3593, 4277), (3428, 4143), (3490, 4193), (3400, 4093), (3498, 4197), (3405, 4052), (3366, 4029), (3453, 4153), (3471, 4183), (3410, 4084), (3409, 4128)]
         : compromised: 0.8321, honest: 0.8345
Round 010: test acc mean=0.8419 ± 0.0052 | min=0.8301 max=0.8483
         : test loss mean=0.4865 ± 0.0188
         : individual accs = ['0.836483', '0.847252', '0.838275', '0.843065', '0.830115', '0.839048', '0.844980', '0.848011', '0.848246', '0.844985', '0.833695', '0.834486', '0.840948', '0.844413', '0.846496', '0.848349', '0.844209', '0.844370', '0.842556', '0.837694']
         : correct/total = [(3453, 4128), (3561, 4203), (3421, 4081), (3653, 4333), (3396, 4091), (3597, 4287), (3543, 4193), (3688, 4349), (3555, 4191), (3614, 4277), (3454, 4143), (3499, 4193), (3442, 4093), (3544, 4197), (3430, 4052), (3418, 4029), (3506, 4153), (3532, 4183), (3441, 4084), (3458, 4128)]
         : compromised: 0.8422, honest: 0.8418

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: fully, Aggregation: balance
Attack: gaussian, 20.0% compromised
Final accuracy - Compromised: 0.8422, Honest: 0.8418
Overall test accuracy: mean=0.8419 ± 0.0052

=== BALANCE SUMMARY ===
Node 0: acceptance=0.789
Node 1: acceptance=0.789
Node 2: acceptance=0.789
Node 3: acceptance=0.789
Node 4: acceptance=0.789
Node 5: acceptance=0.842
Node 6: acceptance=0.789
Node 7: acceptance=0.789
Node 8: acceptance=0.789
Node 9: acceptance=0.789
Node 10: acceptance=0.789
Node 11: acceptance=0.789
Node 12: acceptance=0.842
Node 13: acceptance=0.842
Node 14: acceptance=0.789
Node 15: acceptance=0.789
Node 16: acceptance=0.789
Node 17: acceptance=0.842
Node 18: acceptance=0.789
Node 19: acceptance=0.789

Performance Summary:
  - Distance computation time: 1.709s (45.1%)
  - Filtering time: 1.816s (47.9%)
  - Aggregation time: 0.267s (7.0%)
  - Total time: 3.792s
  - Mean acceptance rate: 0.800

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
