Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 8/20 nodes: [1, 5, 11, 12, 13, 14, 17, 18]
Attack type: gaussian, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.0437 ± 0.0206 | min=0.0036 max=0.0747
         : test loss mean=12057901.5557 ± 21381821.9479
         : individual accs = ['0.051599', '0.052344', '0.048272', '0.012462', '0.003911', '0.050618', '0.049130', '0.074730', '0.003579', '0.053776', '0.050447', '0.071309', '0.053750', '0.049083', '0.061204', '0.012658', '0.019745', '0.050203', '0.050930', '0.054506']
         : correct/total = [(213, 4128), (220, 4203), (197, 4081), (54, 4333), (16, 4091), (217, 4287), (206, 4193), (325, 4349), (15, 4191), (230, 4277), (209, 4143), (299, 4193), (220, 4093), (206, 4197), (248, 4052), (51, 4029), (82, 4153), (210, 4183), (208, 4084), (225, 4128)]
         : compromised: 0.0549, honest: 0.0362
Round 002: test acc mean=0.0508 ± 0.0112 | min=0.0330 max=0.0871
         : test loss mean=nan ± nan
         : individual accs = ['0.044574', '0.087081', '0.050723', '0.033003', '0.052066', '0.052484', '0.044598', '0.049207', '0.034359', '0.048398', '0.045619', '0.070594', '0.045688', '0.055278', '0.050346', '0.051626', '0.052011', '0.050920', '0.051665', '0.045058']
         : correct/total = [(184, 4128), (366, 4203), (207, 4081), (143, 4333), (213, 4091), (225, 4287), (187, 4193), (214, 4349), (144, 4191), (207, 4277), (189, 4143), (296, 4193), (187, 4093), (232, 4197), (204, 4052), (208, 4029), (216, 4153), (213, 4183), (211, 4084), (186, 4128)]
         : compromised: 0.0580, honest: 0.0459
Round 003: test acc mean=0.0544 ± 0.0111 | min=0.0443 max=0.0929
         : test loss mean=nan ± nan
         : individual accs = ['0.050145', '0.049726', '0.092869', '0.048465', '0.052066', '0.059949', '0.063201', '0.074500', '0.048914', '0.048398', '0.045619', '0.053184', '0.053750', '0.049083', '0.051826', '0.051626', '0.052011', '0.045900', '0.051665', '0.044331']
         : correct/total = [(207, 4128), (209, 4203), (379, 4081), (210, 4333), (213, 4091), (257, 4287), (265, 4193), (324, 4349), (205, 4191), (207, 4277), (189, 4143), (223, 4193), (220, 4093), (206, 4197), (210, 4052), (208, 4029), (216, 4153), (192, 4183), (211, 4084), (183, 4128)]
         : compromised: 0.0519, honest: 0.0560
Round 004: test acc mean=0.0542 ± 0.0391 | min=0.0055 max=0.1500
         : test loss mean=nan ± nan
         : individual accs = ['0.059593', '0.007138', '0.059299', '0.043157', '0.043021', '0.050618', '0.145481', '0.090366', '0.049630', '0.092121', '0.046102', '0.008586', '0.024921', '0.049083', '0.150049', '0.051626', '0.052011', '0.005498', '0.006366', '0.049176']
         : correct/total = [(246, 4128), (30, 4203), (242, 4081), (187, 4333), (176, 4091), (217, 4287), (610, 4193), (393, 4349), (208, 4191), (394, 4277), (191, 4143), (36, 4193), (102, 4093), (206, 4197), (608, 4052), (208, 4029), (216, 4153), (23, 4183), (26, 4084), (203, 4128)]
         : compromised: 0.0378, honest: 0.0651
Round 005: test acc mean=0.0532 ± 0.0379 | min=0.0033 max=0.1407
         : test loss mean=nan ± nan
         : individual accs = ['0.091812', '0.006900', '0.084538', '0.043157', '0.043021', '0.014696', '0.132363', '0.047827', '0.049630', '0.075286', '0.057205', '0.003339', '0.017102', '0.049083', '0.140671', '0.051626', '0.052011', '0.011475', '0.012488', '0.080669']
         : correct/total = [(379, 4128), (29, 4203), (345, 4081), (187, 4333), (176, 4091), (63, 4287), (555, 4193), (208, 4349), (208, 4191), (322, 4277), (237, 4143), (14, 4193), (70, 4093), (206, 4197), (570, 4052), (208, 4029), (216, 4153), (48, 4183), (51, 4084), (333, 4128)]
         : compromised: 0.0320, honest: 0.0674
Round 006: test acc mean=0.0626 ± 0.0477 | min=0.0019 max=0.1688
         : test loss mean=nan ± nan
         : individual accs = ['0.044574', '0.026410', '0.168831', '0.043157', '0.043021', '0.043387', '0.129263', '0.143481', '0.049630', '0.100772', '0.061067', '0.001908', '0.024921', '0.049083', '0.140424', '0.051626', '0.052011', '0.003347', '0.001959', '0.072917']
         : correct/total = [(184, 4128), (111, 4203), (689, 4081), (187, 4333), (176, 4091), (186, 4287), (542, 4193), (624, 4349), (208, 4191), (431, 4277), (253, 4143), (8, 4193), (102, 4093), (206, 4197), (569, 4052), (208, 4029), (216, 4153), (14, 4183), (8, 4084), (301, 4128)]
         : compromised: 0.0364, honest: 0.0800
Round 007: test acc mean=0.0808 ± 0.0647 | min=0.0041 max=0.2536
         : test loss mean=nan ± nan
         : individual accs = ['0.253634', '0.027123', '0.174957', '0.043157', '0.043021', '0.134826', '0.131648', '0.105771', '0.049630', '0.150105', '0.125030', '0.004054', '0.038358', '0.049083', '0.021718', '0.051626', '0.052011', '0.011714', '0.016650', '0.132025']
         : correct/total = [(1047, 4128), (114, 4203), (714, 4081), (187, 4333), (176, 4091), (578, 4287), (552, 4193), (460, 4349), (208, 4191), (642, 4277), (518, 4143), (17, 4193), (157, 4093), (206, 4197), (88, 4052), (208, 4029), (216, 4153), (49, 4183), (68, 4084), (545, 4128)]
         : compromised: 0.0379, honest: 0.1094
Round 008: test acc mean=0.1151 ± 0.0950 | min=0.0041 max=0.2439
         : test loss mean=nan ± nan
         : individual accs = ['0.243944', '0.005948', '0.229601', '0.043157', '0.043021', '0.234430', '0.242070', '0.213382', '0.049630', '0.183774', '0.163408', '0.004054', '0.044222', '0.049083', '0.242596', '0.051626', '0.052011', '0.004542', '0.004897', '0.196463']
         : correct/total = [(1007, 4128), (25, 4203), (937, 4081), (187, 4333), (176, 4091), (1005, 4287), (1015, 4193), (928, 4349), (208, 4191), (786, 4277), (677, 4143), (17, 4193), (181, 4093), (206, 4197), (983, 4052), (208, 4029), (216, 4153), (19, 4183), (20, 4084), (811, 4128)]
         : compromised: 0.0737, honest: 0.1427
Round 009: test acc mean=0.1390 ± 0.1203 | min=0.0024 max=0.3055
         : test loss mean=nan ± nan
         : individual accs = ['0.276405', '0.020462', '0.290370', '0.043157', '0.043021', '0.266153', '0.276890', '0.264888', '0.049630', '0.256722', '0.246923', '0.005008', '0.014415', '0.049083', '0.305528', '0.051626', '0.052011', '0.002391', '0.015181', '0.250242']
         : correct/total = [(1141, 4128), (86, 4203), (1185, 4081), (187, 4333), (176, 4091), (1141, 4287), (1161, 4193), (1152, 4349), (208, 4191), (1098, 4277), (1023, 4143), (21, 4193), (59, 4093), (206, 4197), (1238, 4052), (208, 4029), (216, 4153), (10, 4183), (62, 4084), (1033, 4128)]
         : compromised: 0.0848, honest: 0.1752
Round 010: test acc mean=0.1527 ± 0.1460 | min=0.0030 max=0.3518
         : test loss mean=nan ± nan
         : individual accs = ['0.327519', '0.046158', '0.332272', '0.043157', '0.043021', '0.323070', '0.336275', '0.351805', '0.049630', '0.336918', '0.328265', '0.046983', '0.015881', '0.049083', '0.002962', '0.051626', '0.052011', '0.005020', '0.005877', '0.305717']
         : correct/total = [(1352, 4128), (194, 4203), (1356, 4081), (187, 4333), (176, 4091), (1385, 4287), (1410, 4193), (1530, 4349), (208, 4191), (1441, 4277), (1360, 4143), (197, 4193), (65, 4093), (206, 4197), (12, 4052), (208, 4029), (216, 4153), (21, 4183), (24, 4084), (1262, 4128)]
         : compromised: 0.0619, honest: 0.2132

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: gaussian, 40.0% compromised
Final accuracy - Compromised: 0.0619, Honest: 0.2132
Overall test accuracy: mean=0.1527 ± 0.1460
