Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 10/20 nodes: [1, 2, 5, 11, 12, 13, 14, 15, 17, 18]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5020 ± 0.0087 | min=0.4858 max=0.5161
         : test loss mean=1.6091 ± 0.5845
         : individual accs = ['0.487563', '0.485774', '0.512407', '0.516072', '0.501896', '0.488555', '0.506274', '0.496302', '0.504268', '0.510610', '0.508645', '0.506153', '0.505504', '0.499234', '0.503631', '0.505592', '0.512336', '0.500175', '0.487334', '0.501563']
         : correct/total = [(6939, 14232), (6915, 14235), (7310, 14266), (7337, 14217), (7146, 14238), (7022, 14373), (7263, 14346), (7114, 14334), (7208, 14294), (7339, 14373), (7296, 14344), (7239, 14302), (7256, 14354), (7170, 14362), (7212, 14320), (7278, 14395), (7372, 14389), (7131, 14257), (6945, 14251), (7222, 14399)]
         : compromised: 0.4994, honest: 0.5046
Round 002: test acc mean=0.5096 ± 0.0121 | min=0.4909 max=0.5382
         : test loss mean=0.6971 ± 0.0063
         : individual accs = ['0.511102', '0.538181', '0.490887', '0.515088', '0.512361', '0.491129', '0.511292', '0.499791', '0.503218', '0.504070', '0.533673', '0.506153', '0.517904', '0.512115', '0.493156', '0.512470', '0.511224', '0.504664', '0.522349', '0.500521']
         : correct/total = [(7274, 14232), (7661, 14235), (7003, 14266), (7323, 14217), (7295, 14238), (7059, 14373), (7335, 14346), (7164, 14334), (7193, 14294), (7245, 14373), (7655, 14344), (7239, 14302), (7434, 14354), (7355, 14362), (7062, 14320), (7377, 14395), (7356, 14389), (7195, 14257), (7444, 14251), (7207, 14399)]
         : compromised: 0.5089, honest: 0.5102
Round 003: test acc mean=0.5235 ± 0.0248 | min=0.4911 max=0.5813
         : test loss mean=0.6921 ± 0.0059
         : individual accs = ['0.522203', '0.523007', '0.501823', '0.515017', '0.505478', '0.504140', '0.581277', '0.508232', '0.555618', '0.513950', '0.561907', '0.537617', '0.502787', '0.496101', '0.562291', '0.506704', '0.539509', '0.506488', '0.491123', '0.534551']
         : correct/total = [(7432, 14232), (7445, 14235), (7159, 14266), (7322, 14217), (7197, 14238), (7246, 14373), (8339, 14346), (7285, 14334), (7942, 14294), (7387, 14373), (8060, 14344), (7689, 14302), (7217, 14354), (7125, 14362), (8052, 14320), (7294, 14395), (7763, 14389), (7221, 14257), (6999, 14251), (7697, 14399)]
         : compromised: 0.5132, honest: 0.5338
Round 004: test acc mean=0.5748 ± 0.0344 | min=0.5119 max=0.6126
         : test loss mean=0.6820 ± 0.0055
         : individual accs = ['0.606942', '0.588620', '0.586499', '0.589646', '0.604860', '0.609198', '0.612645', '0.511860', '0.589548', '0.576637', '0.554099', '0.517061', '0.560332', '0.536555', '0.597905', '0.515596', '0.600945', '0.605247', '0.526068', '0.605667']
         : correct/total = [(8638, 14232), (8379, 14235), (8367, 14266), (8383, 14217), (8612, 14238), (8756, 14373), (8789, 14346), (7337, 14334), (8427, 14294), (8288, 14373), (7948, 14344), (7395, 14302), (8043, 14354), (7706, 14362), (8562, 14320), (7422, 14395), (8647, 14389), (8629, 14257), (7497, 14251), (8721, 14399)]
         : compromised: 0.5643, honest: 0.5853
Round 005: test acc mean=0.6234 ± 0.0080 | min=0.6026 max=0.6367
         : test loss mean=0.6642 ± 0.0051
         : individual accs = ['0.625632', '0.626695', '0.618954', '0.629598', '0.624315', '0.626035', '0.630838', '0.636668', '0.616832', '0.622208', '0.602621', '0.631590', '0.613209', '0.622824', '0.614316', '0.615422', '0.622837', '0.632391', '0.620939', '0.633308']
         : correct/total = [(8904, 14232), (8921, 14235), (8830, 14266), (8951, 14217), (8889, 14238), (8998, 14373), (9050, 14346), (9126, 14334), (8817, 14294), (8943, 14373), (8644, 14344), (9033, 14302), (8802, 14354), (8945, 14362), (8797, 14320), (8859, 14395), (8962, 14389), (9016, 14257), (8849, 14251), (9119, 14399)]
         : compromised: 0.6222, honest: 0.6245
Round 006: test acc mean=0.6374 ± 0.0054 | min=0.6278 max=0.6508
         : test loss mean=0.6469 ± 0.0041
         : individual accs = ['0.633432', '0.640955', '0.633114', '0.640501', '0.633516', '0.642872', '0.641642', '0.650760', '0.639849', '0.630696', '0.634133', '0.630751', '0.627769', '0.635427', '0.639804', '0.634387', '0.638543', '0.636389', '0.638552', '0.644836']
         : correct/total = [(9015, 14232), (9124, 14235), (9032, 14266), (9106, 14217), (9020, 14238), (9240, 14373), (9205, 14346), (9328, 14334), (9146, 14294), (9065, 14373), (9096, 14344), (9021, 14302), (9011, 14354), (9126, 14362), (9162, 14320), (9132, 14395), (9188, 14389), (9073, 14257), (9100, 14251), (9285, 14399)]
         : compromised: 0.6360, honest: 0.6388
Round 007: test acc mean=0.6481 ± 0.0046 | min=0.6382 max=0.6541
         : test loss mean=0.6287 ± 0.0041
         : individual accs = ['0.647976', '0.649385', '0.641455', '0.652951', '0.651215', '0.653239', '0.650216', '0.651807', '0.647195', '0.645168', '0.638246', '0.652986', '0.651386', '0.638978', '0.648603', '0.647447', '0.648342', '0.649435', '0.642551', '0.654143']
         : correct/total = [(9222, 14232), (9244, 14235), (9151, 14266), (9283, 14217), (9272, 14238), (9389, 14373), (9328, 14346), (9343, 14334), (9251, 14294), (9273, 14373), (9155, 14344), (9339, 14302), (9350, 14354), (9177, 14362), (9288, 14320), (9320, 14395), (9329, 14389), (9259, 14257), (9157, 14251), (9419, 14399)]
         : compromised: 0.6475, honest: 0.6487
Round 008: test acc mean=0.6553 ± 0.0048 | min=0.6479 max=0.6637
         : test loss mean=0.6194 ± 0.0046
         : individual accs = ['0.650576', '0.648542', '0.650778', '0.659914', '0.647914', '0.659918', '0.661578', '0.663667', '0.660277', '0.657065', '0.654769', '0.651308', '0.654521', '0.654853', '0.648743', '0.653630', '0.654528', '0.660377', '0.651393', '0.661157']
         : correct/total = [(9259, 14232), (9232, 14235), (9284, 14266), (9382, 14217), (9225, 14238), (9485, 14373), (9491, 14346), (9513, 14334), (9438, 14294), (9444, 14373), (9392, 14344), (9315, 14302), (9395, 14354), (9405, 14362), (9290, 14320), (9409, 14395), (9418, 14389), (9415, 14257), (9283, 14251), (9520, 14399)]
         : compromised: 0.6534, honest: 0.6571
Round 009: test acc mean=0.6574 ± 0.0068 | min=0.6414 max=0.6695
         : test loss mean=0.6155 ± 0.0060
         : individual accs = ['0.642917', '0.665543', '0.651689', '0.659070', '0.652901', '0.661866', '0.641433', '0.660737', '0.656849', '0.657831', '0.657766', '0.651867', '0.669500', '0.660702', '0.659637', '0.653282', '0.665925', '0.661500', '0.660024', '0.656990']
         : correct/total = [(9150, 14232), (9474, 14235), (9297, 14266), (9370, 14217), (9296, 14238), (9513, 14373), (9202, 14346), (9471, 14334), (9389, 14294), (9455, 14373), (9435, 14344), (9323, 14302), (9610, 14354), (9489, 14362), (9446, 14320), (9404, 14395), (9582, 14389), (9431, 14257), (9406, 14251), (9460, 14399)]
         : compromised: 0.6596, honest: 0.6552
Round 010: test acc mean=0.6665 ± 0.0079 | min=0.6393 max=0.6745
         : test loss mean=0.6055 ± 0.0066
         : individual accs = ['0.663575', '0.673130', '0.639282', '0.672153', '0.673409', '0.670841', '0.672173', '0.674480', '0.660067', '0.664510', '0.670664', '0.668578', '0.673331', '0.670171', '0.662709', '0.658562', '0.668636', '0.669426', '0.662199', '0.661713']
         : correct/total = [(9444, 14232), (9582, 14235), (9120, 14266), (9556, 14217), (9588, 14238), (9642, 14373), (9643, 14346), (9668, 14334), (9435, 14294), (9551, 14373), (9620, 14344), (9562, 14302), (9665, 14354), (9625, 14362), (9490, 14320), (9480, 14395), (9621, 14389), (9544, 14257), (9437, 14251), (9528, 14399)]
         : compromised: 0.6648, honest: 0.6681

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: directed_deviation, 50.0% compromised
Final accuracy - Compromised: 0.6648, Honest: 0.6681
Overall test accuracy: mean=0.6665 ± 0.0079

=== BALANCE SUMMARY ===
Node 0: acceptance=0.550
Node 1: acceptance=0.591
Node 2: acceptance=0.475
Node 3: acceptance=0.662
Node 4: acceptance=0.509
Node 5: acceptance=0.520
Node 6: acceptance=0.486
Node 7: acceptance=0.486
Node 8: acceptance=0.460
Node 9: acceptance=0.585
Node 10: acceptance=0.600
Node 11: acceptance=0.550
Node 12: acceptance=0.625
Node 13: acceptance=0.585
Node 14: acceptance=0.520
Node 15: acceptance=0.509
Node 16: acceptance=0.446
Node 17: acceptance=0.700
Node 18: acceptance=0.606
Node 19: acceptance=0.494

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.065s (81.3%)
    - Aggregation: 0.015s (18.7%)
  TOTALS:
    - Total computation: 0.081s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.081s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.051s
  - Aggregation: 0.008s
  - Model transfer: 0.000s
  - Total per node: 0.059s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 1.023s
  - Total aggregation: 0.161s
  - Total model transfer: 0.000s
  - Grand total: 1.184s
  - Mean acceptance rate: 0.548

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
