Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: backdoor, lambda: 1.0
Backdoor target label: 1, trigger size: 3
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4953 ± 0.0174
Backdoor attack: Created poisoned datasets for 4 compromised nodes
Round 001: test acc mean=0.5099 ± 0.0360 | min=0.4909 max=0.6193
         : test loss mean=22.8863 ± 13.7523
         : individual accs = ['0.504989', '0.496944', '0.500140', '0.614968', '0.496559', '0.500661', '0.500139', '0.498744', '0.493844', '0.619286', '0.503974', '0.493637', '0.499861', '0.504456', '0.490922', '0.496422', '0.492599', '0.494704', '0.496246', '0.497951']
         : correct/total = [(7187, 14232), (7074, 14235), (7135, 14266), (8743, 14217), (7070, 14238), (7196, 14373), (7175, 14346), (7149, 14334), (7059, 14294), (8901, 14373), (7229, 14344), (7060, 14302), (7175, 14354), (7245, 14362), (7030, 14320), (7146, 14395), (7088, 14389), (7053, 14257), (7072, 14251), (7170, 14399)]
         : compromised: 0.4999, honest: 0.5123
Round 002: test acc mean=0.6144 ± 0.0655 | min=0.4890 max=0.6669
         : test loss mean=2.8516 ± 6.5012
         : individual accs = ['0.642144', '0.489006', '0.641736', '0.648097', '0.501967', '0.646768', '0.664715', '0.657597', '0.658948', '0.660544', '0.506553', '0.660048', '0.510171', '0.666899', '0.643087', '0.641751', '0.644312', '0.501999', '0.656586', '0.645392']
         : correct/total = [(9139, 14232), (6961, 14235), (9155, 14266), (9214, 14217), (7147, 14238), (9296, 14373), (9536, 14346), (9426, 14334), (9419, 14294), (9494, 14373), (7266, 14344), (9440, 14302), (7323, 14354), (9578, 14362), (9209, 14320), (9238, 14395), (9271, 14389), (7157, 14257), (9357, 14251), (9293, 14399)]
         : compromised: 0.5815, honest: 0.6227
Round 003: test acc mean=0.6626 ± 0.0086 | min=0.6480 max=0.6784
         : test loss mean=0.6131 ± 0.0100
         : individual accs = ['0.650295', '0.676853', '0.647974', '0.668706', '0.678396', '0.671050', '0.655723', '0.660946', '0.665874', '0.666249', '0.648285', '0.656272', '0.660095', '0.670102', '0.659707', '0.662174', '0.658211', '0.665147', '0.656656', '0.672408']
         : correct/total = [(9255, 14232), (9635, 14235), (9244, 14266), (9507, 14217), (9659, 14238), (9645, 14373), (9407, 14346), (9474, 14334), (9518, 14294), (9576, 14373), (9299, 14344), (9386, 14302), (9475, 14354), (9624, 14362), (9447, 14320), (9532, 14395), (9471, 14389), (9483, 14257), (9358, 14251), (9682, 14399)]
         : compromised: 0.6666, honest: 0.6615
Round 004: test acc mean=0.6742 ± 0.0069 | min=0.6540 max=0.6825
         : test loss mean=0.6003 ± 0.0062
         : individual accs = ['0.672569', '0.675659', '0.670896', '0.678976', '0.680784', '0.678703', '0.665551', '0.666597', '0.666364', '0.682530', '0.676729', '0.680884', '0.654034', '0.680755', '0.669693', '0.675582', '0.677879', '0.679175', '0.671883', '0.678728']
         : correct/total = [(9572, 14232), (9618, 14235), (9571, 14266), (9653, 14217), (9693, 14238), (9755, 14373), (9548, 14346), (9555, 14334), (9525, 14294), (9810, 14373), (9707, 14344), (9738, 14302), (9388, 14354), (9777, 14362), (9590, 14320), (9725, 14395), (9754, 14389), (9683, 14257), (9575, 14251), (9773, 14399)]
         : compromised: 0.6732, honest: 0.6745
Round 005: test acc mean=0.6807 ± 0.0064 | min=0.6651 max=0.6938
         : test loss mean=0.5920 ± 0.0084
         : individual accs = ['0.679525', '0.684580', '0.684284', '0.665119', '0.693777', '0.678634', '0.687300', '0.691154', '0.677067', '0.681486', '0.683003', '0.678367', '0.679880', '0.675254', '0.676955', '0.679819', '0.677045', '0.689556', '0.675040', '0.676505']
         : correct/total = [(9671, 14232), (9745, 14235), (9762, 14266), (9456, 14217), (9878, 14238), (9754, 14373), (9860, 14346), (9907, 14334), (9678, 14294), (9795, 14373), (9797, 14344), (9702, 14302), (9759, 14354), (9698, 14362), (9694, 14320), (9786, 14395), (9742, 14389), (9831, 14257), (9620, 14251), (9741, 14399)]
         : compromised: 0.6808, honest: 0.6807
Round 006: test acc mean=0.6891 ± 0.0040 | min=0.6848 max=0.6991
         : test loss mean=0.5827 ± 0.0038
         : individual accs = ['0.685006', '0.695820', '0.685055', '0.688120', '0.688088', '0.688861', '0.688624', '0.688921', '0.692458', '0.689209', '0.699108', '0.687386', '0.684757', '0.692383', '0.686103', '0.685307', '0.686566', '0.696430', '0.686759', '0.686784']
         : correct/total = [(9749, 14232), (9905, 14235), (9773, 14266), (9783, 14217), (9797, 14238), (9901, 14373), (9879, 14346), (9875, 14334), (9898, 14294), (9906, 14373), (10028, 14344), (9831, 14302), (9829, 14354), (9944, 14362), (9825, 14320), (9865, 14395), (9879, 14389), (9929, 14257), (9787, 14251), (9889, 14399)]
         : compromised: 0.6906, honest: 0.6887
Round 007: test acc mean=0.6974 ± 0.0054 | min=0.6844 max=0.7065
         : test loss mean=0.5710 ± 0.0065
         : individual accs = ['0.690978', '0.689779', '0.694028', '0.698671', '0.684366', '0.699228', '0.701241', '0.696735', '0.700644', '0.699297', '0.706149', '0.700461', '0.699944', '0.699833', '0.689944', '0.697673', '0.699215', '0.706530', '0.693215', '0.700326']
         : correct/total = [(9834, 14232), (9819, 14235), (9901, 14266), (9933, 14217), (9744, 14238), (10050, 14373), (10060, 14346), (9987, 14334), (10015, 14294), (10051, 14373), (10129, 14344), (10018, 14302), (10047, 14354), (10051, 14362), (9880, 14320), (10043, 14395), (10061, 14389), (10073, 14257), (9879, 14251), (10084, 14399)]
         : compromised: 0.7014, honest: 0.6964
Round 008: test acc mean=0.7010 ± 0.0080 | min=0.6856 max=0.7139
         : test loss mean=0.5718 ± 0.0090
         : individual accs = ['0.709247', '0.700246', '0.695149', '0.705212', '0.712249', '0.710916', '0.700056', '0.708734', '0.696306', '0.694497', '0.713887', '0.707943', '0.697645', '0.701086', '0.694204', '0.693713', '0.692334', '0.685628', '0.691951', '0.709910']
         : correct/total = [(10094, 14232), (9968, 14235), (9917, 14266), (10026, 14217), (10141, 14238), (10218, 14373), (10043, 14346), (10159, 14334), (9953, 14294), (9982, 14373), (10240, 14344), (10125, 14302), (10014, 14354), (10069, 14362), (9941, 14320), (9986, 14395), (9962, 14389), (9775, 14257), (9861, 14251), (10222, 14399)]
         : compromised: 0.6988, honest: 0.7016
Round 009: test acc mean=0.6993 ± 0.0170 | min=0.6641 max=0.7148
         : test loss mean=0.5712 ± 0.0179
         : individual accs = ['0.711495', '0.698068', '0.709729', '0.713512', '0.671162', '0.712795', '0.664506', '0.703363', '0.714845', '0.664092', '0.700363', '0.695148', '0.711161', '0.710347', '0.709986', '0.669052', '0.710473', '0.697903', '0.706126', '0.712272']
         : correct/total = [(10126, 14232), (9937, 14235), (10125, 14266), (10144, 14217), (9556, 14238), (10245, 14373), (9533, 14346), (10082, 14334), (10218, 14294), (9545, 14373), (10046, 14344), (9942, 14302), (10208, 14354), (10202, 14362), (10167, 14320), (9631, 14395), (10223, 14389), (9950, 14257), (10063, 14251), (10256, 14399)]
         : compromised: 0.7081, honest: 0.6971
Round 010: test acc mean=0.7093 ± 0.0041 | min=0.7039 max=0.7231
         : test loss mean=0.5637 ± 0.0077
         : individual accs = ['0.709879', '0.713031', '0.705173', '0.723078', '0.711195', '0.707020', '0.708699', '0.711944', '0.709179', '0.706394', '0.713539', '0.709831', '0.708235', '0.709233', '0.706983', '0.709830', '0.707276', '0.708073', '0.703880', '0.704285']
         : correct/total = [(10103, 14232), (10150, 14235), (10060, 14266), (10280, 14217), (10126, 14238), (10162, 14373), (10167, 14346), (10205, 14334), (10137, 14294), (10153, 14373), (10235, 14344), (10152, 14302), (10166, 14354), (10186, 14362), (10124, 14320), (10218, 14395), (10177, 14389), (10095, 14257), (10031, 14251), (10141, 14399)]
         : compromised: 0.7081, honest: 0.7096

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: backdoor, 20.0% compromised
Final accuracy - Compromised: 0.7081, Honest: 0.7096
Overall test accuracy: mean=0.7093 ± 0.0041

=== BACKDOOR ATTACK SUCCESS RATE (ASR) ===
Target label: 1
Trigger size: 3x3
Overall ASR: 0.3598 ± 0.0239
Honest nodes ASR: 0.3607 ± 0.0264
Compromised nodes ASR: 0.3564 ± 0.0060
Note: Higher ASR indicates more successful backdoor attack
