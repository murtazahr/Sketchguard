Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 10000 samples per client per epoch
Graph: erdos, nodes: 20, edges: 48
BALANCE algorithm:
  - Model dimension: 6,603,710 parameters
  - Complexity: O(N×d) = O(20×6,603,710)
Initial test acc across nodes: mean=0.0162 ± 0.0138
Round 001: test acc mean=0.4561 ± 0.0584 | min=0.3529 max=0.5388
         : test loss mean=3.7652 ± 0.0385
         : individual accs = ['0.521560', '0.478706', '0.499387', '0.431341', '0.386458', '0.534640', '0.465776', '0.452748', '0.387258', '0.417816', '0.423847', '0.530646', '0.453701', '0.352871', '0.520731', '0.504095', '0.463280', '0.538848', '0.356268', '0.402132']
         : correct/total = [(2153, 4128), (2012, 4203), (2038, 4081), (1869, 4333), (1581, 4091), (2292, 4287), (1953, 4193), (1969, 4349), (1623, 4191), (1787, 4277), (1756, 4143), (2225, 4193), (1857, 4093), (1481, 4197), (2110, 4052), (2031, 4029), (1924, 4153), (2254, 4183), (1455, 4084), (1660, 4128)]
Round 002: test acc mean=0.6877 ± 0.0210 | min=0.6361 max=0.7200
         : test loss mean=3.1468 ± 0.1317
         : individual accs = ['0.697917', '0.698073', '0.684636', '0.702746', '0.686385', '0.708887', '0.654186', '0.682686', '0.658315', '0.695347', '0.702631', '0.720010', '0.699243', '0.661663', '0.705824', '0.708861', '0.669877', '0.689696', '0.690500', '0.636143']
         : correct/total = [(2881, 4128), (2934, 4203), (2794, 4081), (3045, 4333), (2808, 4091), (3039, 4287), (2743, 4193), (2969, 4349), (2759, 4191), (2974, 4277), (2911, 4143), (3019, 4193), (2862, 4093), (2777, 4197), (2860, 4052), (2856, 4029), (2782, 4153), (2885, 4183), (2820, 4084), (2626, 4128)]
Round 003: test acc mean=0.7263 ± 0.0170 | min=0.6907 max=0.7539
         : test loss mean=2.5789 ± 0.2719
         : individual accs = ['0.750969', '0.729003', '0.717961', '0.732749', '0.714006', '0.690693', '0.738373', '0.708439', '0.704844', '0.719663', '0.735216', '0.753876', '0.744197', '0.717179', '0.736180', '0.731695', '0.711052', '0.727468', '0.709109', '0.753391']
         : correct/total = [(3100, 4128), (3064, 4203), (2930, 4081), (3175, 4333), (2921, 4091), (2961, 4287), (3096, 4193), (3081, 4349), (2954, 4191), (3078, 4277), (3046, 4143), (3161, 4193), (3046, 4093), (3010, 4197), (2983, 4052), (2948, 4029), (2953, 4153), (3043, 4183), (2896, 4084), (3110, 4128)]
Round 004: test acc mean=0.7538 ± 0.0107 | min=0.7351 max=0.7779
         : test loss mean=1.9928 ± 0.2845
         : individual accs = ['0.754603', '0.760885', '0.749081', '0.741749', '0.757272', '0.750175', '0.759838', '0.736951', '0.761632', '0.748422', '0.742216', '0.752206', '0.747129', '0.751966', '0.767275', '0.769918', '0.735131', '0.751375', '0.761263', '0.777859']
         : correct/total = [(3115, 4128), (3198, 4203), (3057, 4081), (3214, 4333), (3098, 4091), (3216, 4287), (3186, 4193), (3205, 4349), (3192, 4191), (3201, 4277), (3075, 4143), (3154, 4193), (3058, 4093), (3156, 4197), (3109, 4052), (3102, 4029), (3053, 4153), (3143, 4183), (3109, 4084), (3211, 4128)]
Round 005: test acc mean=0.7663 ± 0.0164 | min=0.7383 max=0.8029
         : test loss mean=1.5126 ± 0.2366
         : individual accs = ['0.774952', '0.738282', '0.742465', '0.767367', '0.760694', '0.766503', '0.763892', '0.756036', '0.802911', '0.776713', '0.768284', '0.759599', '0.780601', '0.742912', '0.752715', '0.766940', '0.760655', '0.762611', '0.783056', '0.798934']
         : correct/total = [(3199, 4128), (3103, 4203), (3030, 4081), (3325, 4333), (3112, 4091), (3286, 4287), (3203, 4193), (3288, 4349), (3365, 4191), (3322, 4277), (3183, 4143), (3185, 4193), (3195, 4093), (3118, 4197), (3050, 4052), (3090, 4029), (3159, 4153), (3190, 4183), (3198, 4084), (3298, 4128)]
Round 006: test acc mean=0.7876 ± 0.0122 | min=0.7642 max=0.8120
         : test loss mean=1.1098 ± 0.1594
         : individual accs = ['0.779554', '0.764216', '0.766969', '0.801292', '0.769005', '0.779333', '0.788218', '0.787767', '0.811978', '0.794482', '0.784456', '0.780825', '0.791107', '0.800572', '0.788993', '0.803425', '0.780159', '0.788190', '0.794564', '0.797238']
         : correct/total = [(3218, 4128), (3212, 4203), (3130, 4081), (3472, 4333), (3146, 4091), (3341, 4287), (3305, 4193), (3426, 4349), (3403, 4191), (3398, 4277), (3250, 4143), (3274, 4193), (3238, 4093), (3360, 4197), (3197, 4052), (3237, 4029), (3240, 4153), (3297, 4183), (3245, 4084), (3291, 4128)]
Round 007: test acc mean=0.8029 ± 0.0105 | min=0.7726 max=0.8188
         : test loss mean=0.8615 ± 0.1136
         : individual accs = ['0.802326', '0.795384', '0.772605', '0.818832', '0.786605', '0.809191', '0.807536', '0.810071', '0.816512', '0.815993', '0.792180', '0.799189', '0.798681', '0.802478', '0.805035', '0.811864', '0.806887', '0.801578', '0.805338', '0.800145']
         : correct/total = [(3312, 4128), (3343, 4203), (3153, 4081), (3548, 4333), (3218, 4091), (3469, 4287), (3386, 4193), (3523, 4349), (3422, 4191), (3490, 4277), (3282, 4143), (3351, 4193), (3269, 4093), (3368, 4197), (3262, 4052), (3271, 4029), (3351, 4153), (3353, 4183), (3289, 4084), (3303, 4128)]
Round 008: test acc mean=0.8146 ± 0.0102 | min=0.7942 max=0.8277
         : test loss mean=0.6969 ± 0.0762
         : individual accs = ['0.807413', '0.810849', '0.794168', '0.827371', '0.795893', '0.826919', '0.823992', '0.818809', '0.818659', '0.823241', '0.802317', '0.814930', '0.816516', '0.819395', '0.827739', '0.822288', '0.814833', '0.812575', '0.816846', '0.796512']
         : correct/total = [(3333, 4128), (3408, 4203), (3241, 4081), (3585, 4333), (3256, 4091), (3545, 4287), (3455, 4193), (3561, 4349), (3431, 4191), (3521, 4277), (3324, 4143), (3417, 4193), (3342, 4093), (3439, 4197), (3354, 4052), (3313, 4029), (3384, 4153), (3399, 4183), (3336, 4084), (3288, 4128)]
Round 009: test acc mean=0.8257 ± 0.0084 | min=0.8057 max=0.8408
         : test loss mean=0.6036 ± 0.0478
         : individual accs = ['0.815891', '0.825363', '0.805685', '0.837295', '0.818626', '0.831351', '0.832578', '0.828236', '0.840849', '0.836334', '0.814627', '0.819699', '0.829221', '0.831308', '0.828727', '0.827997', '0.825427', '0.822615', '0.823457', '0.818072']
         : correct/total = [(3368, 4128), (3469, 4203), (3288, 4081), (3628, 4333), (3349, 4091), (3564, 4287), (3491, 4193), (3602, 4349), (3524, 4191), (3577, 4277), (3375, 4143), (3437, 4193), (3394, 4093), (3489, 4197), (3358, 4052), (3336, 4029), (3428, 4153), (3441, 4183), (3363, 4084), (3377, 4128)]
Round 010: test acc mean=0.8342 ± 0.0063 | min=0.8239 max=0.8423
         : test loss mean=0.5448 ± 0.0301
         : individual accs = ['0.827762', '0.837735', '0.827248', '0.838911', '0.825226', '0.833450', '0.837586', '0.835364', '0.837986', '0.842179', '0.824765', '0.826139', '0.838260', '0.841792', '0.842300', '0.841400', '0.837226', '0.836481', '0.829089', '0.823886']
         : correct/total = [(3417, 4128), (3521, 4203), (3376, 4081), (3635, 4333), (3376, 4091), (3573, 4287), (3512, 4193), (3633, 4349), (3512, 4191), (3602, 4277), (3417, 4143), (3464, 4193), (3431, 4093), (3533, 4197), (3413, 4052), (3390, 4029), (3477, 4153), (3499, 4183), (3386, 4084), (3401, 4128)]

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: balance
Overall test accuracy: mean=0.8342 ± 0.0063

=== BALANCE SUMMARY ===
Node 0: acceptance=1.000
Node 1: acceptance=1.000
Node 2: acceptance=1.000
Node 3: acceptance=1.000
Node 4: acceptance=1.000
Node 5: acceptance=1.000
Node 6: acceptance=1.000
Node 7: acceptance=1.000
Node 8: acceptance=1.000
Node 9: acceptance=1.000
Node 10: acceptance=1.000
Node 11: acceptance=1.000
Node 12: acceptance=1.000
Node 13: acceptance=1.000
Node 14: acceptance=1.000
Node 15: acceptance=1.000
Node 16: acceptance=1.000
Node 17: acceptance=1.000
Node 18: acceptance=1.000
Node 19: acceptance=1.000

Performance Summary:
  - Distance computation time: 1.472s (42.3%)
  - Filtering time: 1.806s (51.9%)
  - Aggregation time: 0.204s (5.9%)
  - Total time: 3.482s
  - Mean acceptance rate: 1.000

BALANCE Algorithm Properties:
  - Model dimension: 6,603,710
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
