Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.5226 ± 0.0379 | min=0.4941 max=0.6059
         : test loss mean=17.8840 ± 9.9449
         : individual accs = ['0.507167', '0.510713', '0.591897', '0.592530', '0.506532', '0.503374', '0.501812', '0.515418', '0.494053', '0.598831', '0.517917', '0.499161', '0.508708', '0.605904', '0.495531', '0.498506', '0.504552', '0.501298', '0.495685', '0.502257']
         : correct/total = [(7218, 14232), (7270, 14235), (8444, 14266), (8424, 14217), (7212, 14238), (7235, 14373), (7199, 14346), (7388, 14334), (7062, 14294), (8607, 14373), (7429, 14344), (7139, 14302), (7302, 14354), (8702, 14362), (7096, 14320), (7176, 14395), (7260, 14389), (7147, 14257), (7064, 14251), (7232, 14399)]
         : compromised: 0.5298, honest: 0.5208
Round 002: test acc mean=0.5454 ± 0.0543 | min=0.4923 max=0.6160
         : test loss mean=11.6479 ± 9.2730
         : individual accs = ['0.609612', '0.492308', '0.607388', '0.614687', '0.610830', '0.497113', '0.493029', '0.500209', '0.507975', '0.615181', '0.495608', '0.606908', '0.496935', '0.616001', '0.511034', '0.494894', '0.503301', '0.511117', '0.611466', '0.511980']
         : correct/total = [(8676, 14232), (7008, 14235), (8665, 14266), (8739, 14217), (8697, 14238), (7145, 14373), (7073, 14346), (7170, 14334), (7261, 14294), (8842, 14373), (7109, 14344), (8680, 14302), (7133, 14354), (8847, 14362), (7318, 14320), (7124, 14395), (7242, 14389), (7287, 14257), (8714, 14251), (7372, 14399)]
         : compromised: 0.5303, honest: 0.5492
Round 003: test acc mean=0.5829 ± 0.0594 | min=0.4860 max=0.6316
         : test loss mean=1.2898 ± 0.9645
         : individual accs = ['0.626546', '0.631612', '0.621408', '0.627770', '0.626914', '0.497878', '0.629374', '0.625017', '0.501329', '0.630766', '0.627998', '0.619704', '0.508569', '0.626306', '0.624372', '0.486002', '0.506012', '0.509574', '0.624097', '0.506355']
         : correct/total = [(8917, 14232), (8991, 14235), (8865, 14266), (8925, 14217), (8926, 14238), (7156, 14373), (9029, 14346), (8959, 14334), (7166, 14294), (9066, 14373), (9008, 14344), (8863, 14302), (7300, 14354), (8995, 14362), (8941, 14320), (6996, 14395), (7281, 14389), (7265, 14257), (8894, 14251), (7291, 14399)]
         : compromised: 0.5356, honest: 0.5947
Round 004: test acc mean=0.6266 ± 0.0280 | min=0.5052 max=0.6397
         : test loss mean=1.1170 ± 2.0885
         : individual accs = ['0.634275', '0.633158', '0.630029', '0.632271', '0.636957', '0.632923', '0.635369', '0.628645', '0.505177', '0.634523', '0.633436', '0.630821', '0.630556', '0.634174', '0.630098', '0.639736', '0.633679', '0.629726', '0.634271', '0.631502']
         : correct/total = [(9027, 14232), (9013, 14235), (8988, 14266), (8989, 14217), (9069, 14238), (9097, 14373), (9115, 14346), (9011, 14334), (7221, 14294), (9120, 14373), (9086, 14344), (9022, 14302), (9051, 14354), (9108, 14362), (9023, 14320), (9209, 14395), (9118, 14389), (8978, 14257), (9039, 14251), (9093, 14399)]
         : compromised: 0.6318, honest: 0.6252
Round 005: test acc mean=0.6379 ± 0.0055 | min=0.6267 max=0.6484
         : test loss mean=0.6335 ± 0.0039
         : individual accs = ['0.640458', '0.646575', '0.630941', '0.635296', '0.632884', '0.636193', '0.645267', '0.628296', '0.626697', '0.640646', '0.642011', '0.637184', '0.640867', '0.640788', '0.634637', '0.648420', '0.638196', '0.636109', '0.637429', '0.638517']
         : correct/total = [(9115, 14232), (9204, 14235), (9001, 14266), (9032, 14217), (9011, 14238), (9144, 14373), (9257, 14346), (9006, 14334), (8958, 14294), (9208, 14373), (9209, 14344), (9113, 14302), (9199, 14354), (9203, 14362), (9088, 14320), (9334, 14395), (9183, 14389), (9069, 14257), (9084, 14251), (9194, 14399)]
         : compromised: 0.6385, honest: 0.6377
Round 006: test acc mean=0.6446 ± 0.0041 | min=0.6336 max=0.6497
         : test loss mean=0.6276 ± 0.0030
         : individual accs = ['0.645306', '0.646013', '0.639983', '0.649715', '0.648757', '0.646072', '0.649449', '0.644551', '0.633553', '0.646003', '0.649331', '0.645994', '0.644907', '0.646637', '0.638687', '0.644946', '0.642018', '0.638143', '0.645499', '0.647128']
         : correct/total = [(9184, 14232), (9196, 14235), (9130, 14266), (9237, 14217), (9237, 14238), (9286, 14373), (9317, 14346), (9239, 14334), (9056, 14294), (9285, 14373), (9314, 14344), (9239, 14302), (9257, 14354), (9287, 14362), (9146, 14320), (9284, 14395), (9238, 14389), (9098, 14257), (9199, 14251), (9318, 14399)]
         : compromised: 0.6439, honest: 0.6448
Round 007: test acc mean=0.6463 ± 0.0067 | min=0.6349 max=0.6562
         : test loss mean=0.6252 ± 0.0055
         : individual accs = ['0.644885', '0.646575', '0.636478', '0.655905', '0.640820', '0.634941', '0.654886', '0.643435', '0.638100', '0.655674', '0.656233', '0.640400', '0.655218', '0.649701', '0.648953', '0.643071', '0.642296', '0.640317', '0.647884', '0.650462']
         : correct/total = [(9178, 14232), (9204, 14235), (9080, 14266), (9325, 14217), (9124, 14238), (9126, 14373), (9395, 14346), (9223, 14334), (9121, 14294), (9424, 14373), (9413, 14344), (9159, 14302), (9405, 14354), (9331, 14362), (9293, 14320), (9257, 14395), (9242, 14389), (9129, 14257), (9233, 14251), (9366, 14399)]
         : compromised: 0.6450, honest: 0.6466
Round 008: test acc mean=0.6543 ± 0.0047 | min=0.6456 max=0.6631
         : test loss mean=0.6189 ± 0.0037
         : individual accs = ['0.652192', '0.663084', '0.645731', '0.659633', '0.654305', '0.649969', '0.656350', '0.650342', '0.653071', '0.657135', '0.658812', '0.656901', '0.656472', '0.657220', '0.648953', '0.660229', '0.650149', '0.652732', '0.645569', '0.658032']
         : correct/total = [(9282, 14232), (9439, 14235), (9212, 14266), (9378, 14217), (9316, 14238), (9342, 14373), (9416, 14346), (9322, 14334), (9335, 14294), (9445, 14373), (9450, 14344), (9395, 14302), (9423, 14354), (9439, 14362), (9293, 14320), (9504, 14395), (9355, 14389), (9306, 14257), (9200, 14251), (9475, 14399)]
         : compromised: 0.6541, honest: 0.6544
Round 009: test acc mean=0.6605 ± 0.0049 | min=0.6480 max=0.6718
         : test loss mean=0.6129 ± 0.0029
         : individual accs = ['0.663716', '0.671795', '0.655825', '0.657734', '0.663085', '0.654352', '0.664227', '0.655783', '0.647964', '0.664927', '0.663762', '0.661096', '0.660722', '0.660493', '0.659288', '0.666620', '0.659462', '0.658694', '0.658340', '0.661504']
         : correct/total = [(9446, 14232), (9563, 14235), (9356, 14266), (9351, 14217), (9441, 14238), (9405, 14373), (9529, 14346), (9400, 14334), (9262, 14294), (9557, 14373), (9521, 14344), (9455, 14302), (9484, 14354), (9486, 14362), (9441, 14320), (9596, 14395), (9489, 14389), (9391, 14257), (9382, 14251), (9525, 14399)]
         : compromised: 0.6586, honest: 0.6609
Round 010: test acc mean=0.6639 ± 0.0041 | min=0.6554 max=0.6718
         : test loss mean=0.6088 ± 0.0032
         : individual accs = ['0.667931', '0.671444', '0.660381', '0.662939', '0.665964', '0.655396', '0.665900', '0.663667', '0.657549', '0.667502', '0.662995', '0.663544', '0.666295', '0.663765', '0.663687', '0.671830', '0.663076', '0.658904', '0.659533', '0.666296']
         : correct/total = [(9506, 14232), (9558, 14235), (9421, 14266), (9425, 14217), (9482, 14238), (9420, 14373), (9553, 14346), (9513, 14334), (9399, 14294), (9594, 14373), (9510, 14344), (9490, 14302), (9564, 14354), (9533, 14362), (9504, 14320), (9671, 14395), (9541, 14389), (9394, 14257), (9399, 14251), (9594, 14399)]
         : compromised: 0.6611, honest: 0.6646

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: directed_deviation, 20.0% compromised
Final accuracy - Compromised: 0.6611, Honest: 0.6646
Overall test accuracy: mean=0.6639 ± 0.0041
