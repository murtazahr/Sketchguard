Device: cuda
Seed: 987654321
Loading 36 LEAF FEMNIST train files...
LEAF FEMNIST train: 3597 users, 734463 samples
Loading 36 LEAF FEMNIST test files...
LEAF FEMNIST test: 3597 users, 83388 samples
Found 3597 train users, 3597 test users, 3597 common users
User sample counts range: 525 (max) to 17 (min)
Distributed ALL 3597 users across 20 clients
Users per client: 179 (with 17 clients getting +1 user)
Train partition sizes: [36360, 37070, 35957, 38262, 36024, 37732, 36921, 38328, 36867, 37683, 36507, 36915, 36007, 37001, 35681, 35453, 36585, 36801, 35964, 36345]
Test partition sizes: [4128, 4203, 4081, 4333, 4091, 4287, 4193, 4349, 4191, 4277, 4143, 4193, 4093, 4197, 4052, 4029, 4153, 4183, 4084, 4128]
  Client 0: 36360 train samples, 62 unique classes
  Client 1: 37070 train samples, 62 unique classes
  Client 2: 35957 train samples, 62 unique classes
  Client 3: 38262 train samples, 62 unique classes
  Client 4: 36024 train samples, 62 unique classes
  Client 5: 37732 train samples, 62 unique classes
  Client 6: 36921 train samples, 62 unique classes
  Client 7: 38328 train samples, 62 unique classes
  Client 8: 36867 train samples, 62 unique classes
  Client 9: 37683 train samples, 62 unique classes
  Client 10: 36507 train samples, 62 unique classes
  Client 11: 36915 train samples, 62 unique classes
  Client 12: 36007 train samples, 62 unique classes
  Client 13: 37001 train samples, 62 unique classes
  Client 14: 35681 train samples, 62 unique classes
  Client 15: 35453 train samples, 62 unique classes
  Client 16: 36585 train samples, 62 unique classes
  Client 17: 36801 train samples, 62 unique classes
  Client 18: 35964 train samples, 62 unique classes
  Client 19: 36345 train samples, 62 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: gaussian, lambda: 1.0
Model variant: baseline
Model parameters: 6,603,710
Initial test acc across nodes: mean=0.0168 ± 0.0139
Round 001: test acc mean=0.0521 ± 0.0039 | min=0.0469 max=0.0618
         : test loss mean=3.6903 ± 0.0177
         : individual accs = ['0.051599', '0.052344', '0.057584', '0.048465', '0.057932', '0.048052', '0.049130', '0.051276', '0.047960', '0.053075', '0.050447', '0.061770', '0.053750', '0.046938', '0.048124', '0.056342', '0.055141', '0.050203', '0.052889', '0.048450']
         : correct/total = [(213, 4128), (220, 4203), (235, 4081), (210, 4333), (237, 4091), (206, 4287), (206, 4193), (223, 4349), (201, 4191), (227, 4277), (209, 4143), (259, 4193), (220, 4093), (197, 4197), (195, 4052), (227, 4029), (229, 4153), (210, 4183), (216, 4084), (200, 4128)]
         : compromised: 0.0497, honest: 0.0527
Round 002: test acc mean=0.0569 ± 0.0152 | min=0.0450 max=0.0945
         : test loss mean=3.6869 ± 0.0154
         : individual accs = ['0.049176', '0.048775', '0.055134', '0.060928', '0.044977', '0.048752', '0.087765', '0.094504', '0.051539', '0.047463', '0.047309', '0.093489', '0.049841', '0.045747', '0.051579', '0.054852', '0.054418', '0.048291', '0.052155', '0.050388']
         : correct/total = [(203, 4128), (205, 4203), (225, 4081), (264, 4333), (184, 4091), (209, 4287), (368, 4193), (411, 4349), (216, 4191), (203, 4277), (196, 4143), (392, 4193), (204, 4093), (192, 4197), (209, 4052), (221, 4029), (226, 4153), (202, 4183), (213, 4084), (208, 4128)]
         : compromised: 0.0482, honest: 0.0590
Round 003: test acc mean=0.0596 ± 0.0140 | min=0.0469 max=0.0949
         : test loss mean=3.6780 ± 0.0167
         : individual accs = ['0.059593', '0.052344', '0.050723', '0.048927', '0.057932', '0.094938', '0.090389', '0.058174', '0.047960', '0.053075', '0.072894', '0.053899', '0.053750', '0.046938', '0.048124', '0.056342', '0.058271', '0.050920', '0.052889', '0.084787']
         : correct/total = [(246, 4128), (220, 4203), (207, 4081), (212, 4333), (237, 4091), (407, 4287), (379, 4193), (253, 4349), (201, 4191), (227, 4277), (302, 4143), (226, 4193), (220, 4093), (197, 4197), (195, 4052), (227, 4029), (242, 4153), (213, 4183), (216, 4084), (350, 4128)]
         : compromised: 0.0616, honest: 0.0591
Round 004: test acc mean=0.0868 ± 0.0258 | min=0.0469 max=0.1154
         : test loss mean=3.6679 ± 0.0168
         : individual accs = ['0.113614', '0.104211', '0.106592', '0.075006', '0.109264', '0.105668', '0.049368', '0.108531', '0.048914', '0.078794', '0.088825', '0.115430', '0.055216', '0.046938', '0.048865', '0.111194', '0.110041', '0.103992', '0.053869', '0.101260']
         : correct/total = [(469, 4128), (438, 4203), (435, 4081), (325, 4333), (447, 4091), (453, 4287), (207, 4193), (472, 4349), (205, 4191), (337, 4277), (368, 4143), (484, 4193), (226, 4093), (197, 4197), (198, 4052), (448, 4029), (457, 4153), (435, 4183), (220, 4084), (418, 4128)]
         : compromised: 0.0780, honest: 0.0890
Round 005: test acc mean=0.1145 ± 0.0473 | min=0.0473 max=0.1704
         : test loss mean=3.6590 ± 0.0172
         : individual accs = ['0.168362', '0.047347', '0.055134', '0.065082', '0.057932', '0.074878', '0.069878', '0.071281', '0.157958', '0.150105', '0.154477', '0.069640', '0.165404', '0.170360', '0.164363', '0.073219', '0.099687', '0.150371', '0.163810', '0.161579']
         : correct/total = [(695, 4128), (199, 4203), (225, 4081), (282, 4333), (237, 4091), (321, 4287), (293, 4193), (310, 4349), (662, 4191), (642, 4277), (640, 4143), (292, 4193), (677, 4093), (715, 4197), (666, 4052), (295, 4029), (414, 4153), (629, 4183), (669, 4084), (667, 4128)]
         : compromised: 0.1403, honest: 0.1081
Round 006: test acc mean=0.1127 ± 0.0509 | min=0.0446 max=0.1785
         : test loss mean=3.6415 ± 0.0182
         : individual accs = ['0.044574', '0.090174', '0.048272', '0.126240', '0.100220', '0.162351', '0.055330', '0.057714', '0.109282', '0.050503', '0.137581', '0.068686', '0.097972', '0.178461', '0.176209', '0.176471', '0.177703', '0.166388', '0.175318', '0.055475']
         : correct/total = [(184, 4128), (379, 4203), (197, 4081), (547, 4333), (410, 4091), (696, 4287), (232, 4193), (251, 4349), (458, 4191), (216, 4277), (570, 4143), (288, 4193), (401, 4093), (749, 4197), (714, 4052), (711, 4029), (738, 4153), (696, 4183), (716, 4084), (229, 4128)]
         : compromised: 0.1513, honest: 0.1031
Round 007: test acc mean=0.1614 ± 0.0432 | min=0.0870 max=0.2127
         : test loss mean=3.5981 ± 0.0183
         : individual accs = ['0.120397', '0.188675', '0.212693', '0.087007', '0.128575', '0.117331', '0.185786', '0.193378', '0.179671', '0.185878', '0.096307', '0.129979', '0.201075', '0.191804', '0.201629', '0.202283', '0.199374', '0.088453', '0.199314', '0.117490']
         : correct/total = [(497, 4128), (793, 4203), (868, 4081), (377, 4333), (526, 4091), (503, 4287), (779, 4193), (841, 4349), (753, 4191), (795, 4277), (399, 4143), (545, 4193), (823, 4093), (805, 4197), (817, 4052), (815, 4029), (828, 4153), (370, 4183), (814, 4084), (485, 4128)]
         : compromised: 0.1497, honest: 0.1643
Round 008: test acc mean=0.1920 ± 0.0145 | min=0.1725 max=0.2372
         : test loss mean=3.5059 ± 0.0197
         : individual accs = ['0.189196', '0.237212', '0.202891', '0.188091', '0.190662', '0.181012', '0.181254', '0.207864', '0.172513', '0.178396', '0.204441', '0.194372', '0.179575', '0.186085', '0.196199', '0.194093', '0.182278', '0.205594', '0.193683', '0.175145']
         : correct/total = [(781, 4128), (997, 4203), (828, 4081), (815, 4333), (780, 4091), (776, 4287), (760, 4193), (904, 4349), (723, 4191), (763, 4277), (847, 4143), (815, 4193), (735, 4093), (781, 4197), (795, 4052), (782, 4029), (757, 4153), (860, 4183), (791, 4084), (723, 4128)]
         : compromised: 0.1881, honest: 0.1930
Round 009: test acc mean=0.2672 ± 0.0173 | min=0.2329 max=0.2904
         : test loss mean=3.2638 ± 0.0247
         : individual accs = ['0.285368', '0.271949', '0.290370', '0.249250', '0.282571', '0.270119', '0.239208', '0.273396', '0.232880', '0.259995', '0.265267', '0.276890', '0.281945', '0.273529', '0.277641', '0.289898', '0.245846', '0.237868', '0.278404', '0.262112']
         : correct/total = [(1178, 4128), (1143, 4203), (1185, 4081), (1080, 4333), (1156, 4091), (1158, 4287), (1003, 4193), (1189, 4349), (976, 4191), (1112, 4277), (1099, 4143), (1161, 4193), (1154, 4093), (1148, 4197), (1125, 4052), (1168, 4029), (1021, 4153), (995, 4183), (1137, 4084), (1082, 4128)]
         : compromised: 0.2659, honest: 0.2676
Round 010: test acc mean=0.3402 ± 0.0178 | min=0.3140 max=0.3733
         : test loss mean=2.8571 ± 0.0314
         : individual accs = ['0.345446', '0.332382', '0.348689', '0.334872', '0.351992', '0.335899', '0.322919', '0.368590', '0.314006', '0.317980', '0.343471', '0.372526', '0.337161', '0.322850', '0.363031', '0.373294', '0.333735', '0.324886', '0.341332', '0.319041']
         : correct/total = [(1426, 4128), (1397, 4203), (1423, 4081), (1451, 4333), (1440, 4091), (1440, 4287), (1354, 4193), (1603, 4349), (1316, 4191), (1360, 4277), (1423, 4143), (1562, 4193), (1380, 4093), (1355, 4197), (1471, 4052), (1504, 4029), (1386, 4153), (1359, 4183), (1394, 4084), (1317, 4128)]
         : compromised: 0.3302, honest: 0.3427

=== FINAL RESULTS ===
Dataset: femnist, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: gaussian, 20.0% compromised
Final accuracy - Compromised: 0.3302, Honest: 0.3427
Overall test accuracy: mean=0.3402 ± 0.0178
