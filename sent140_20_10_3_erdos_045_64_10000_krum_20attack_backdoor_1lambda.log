Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: backdoor, lambda: 1.0
Backdoor target label: 1, trigger size: 3
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4965 ± 0.0152
Backdoor attack: Created poisoned datasets for 4 compromised nodes
Round 001: test acc mean=0.5226 ± 0.0379 | min=0.4941 max=0.6059
         : test loss mean=17.8840 ± 9.9449
         : individual accs = ['0.507167', '0.510713', '0.591897', '0.592530', '0.506532', '0.503374', '0.501812', '0.515418', '0.494053', '0.598831', '0.517917', '0.499161', '0.508708', '0.605904', '0.495531', '0.498506', '0.504552', '0.501298', '0.495685', '0.502257']
         : correct/total = [(7218, 14232), (7270, 14235), (8444, 14266), (8424, 14217), (7212, 14238), (7235, 14373), (7199, 14346), (7388, 14334), (7062, 14294), (8607, 14373), (7429, 14344), (7139, 14302), (7302, 14354), (8702, 14362), (7096, 14320), (7176, 14395), (7260, 14389), (7147, 14257), (7064, 14251), (7232, 14399)]
         : compromised: 0.5298, honest: 0.5208
Round 002: test acc mean=0.5455 ± 0.0542 | min=0.4900 max=0.6160
         : test loss mean=11.8273 ± 9.6734
         : individual accs = ['0.609612', '0.500035', '0.607388', '0.614687', '0.610830', '0.497948', '0.503555', '0.493791', '0.513292', '0.615181', '0.513385', '0.606908', '0.489968', '0.616001', '0.509358', '0.496839', '0.503857', '0.504735', '0.611466', '0.492048']
         : correct/total = [(8676, 14232), (7118, 14235), (8665, 14266), (8739, 14217), (8697, 14238), (7157, 14373), (7224, 14346), (7078, 14334), (7337, 14294), (8842, 14373), (7364, 14344), (8680, 14302), (7033, 14354), (8847, 14362), (7294, 14320), (7152, 14395), (7250, 14389), (7196, 14257), (8714, 14251), (7085, 14399)]
         : compromised: 0.5272, honest: 0.5501
Round 003: test acc mean=0.6070 ± 0.0461 | min=0.4893 max=0.6316
         : test loss mean=1.0235 ± 1.0015
         : individual accs = ['0.628373', '0.631612', '0.621408', '0.627770', '0.626914', '0.489320', '0.629374', '0.625017', '0.494753', '0.628470', '0.627998', '0.620543', '0.625888', '0.627350', '0.624372', '0.630080', '0.622211', '0.624535', '0.624097', '0.509202']
         : correct/total = [(8943, 14232), (8991, 14235), (8865, 14266), (8925, 14217), (8926, 14238), (7033, 14373), (9029, 14346), (8959, 14334), (7072, 14294), (9033, 14373), (9008, 14344), (8875, 14302), (8984, 14354), (9010, 14362), (8941, 14320), (9070, 14395), (8953, 14389), (8904, 14257), (8894, 14251), (7332, 14399)]
         : compromised: 0.5918, honest: 0.6108
Round 004: test acc mean=0.6254 ± 0.0314 | min=0.4894 max=0.6415
         : test loss mean=1.1095 ± 2.0549
         : individual accs = ['0.636804', '0.628802', '0.630029', '0.632271', '0.636957', '0.632297', '0.634741', '0.628645', '0.489436', '0.634523', '0.632808', '0.631590', '0.630835', '0.634313', '0.629399', '0.641542', '0.631872', '0.629165', '0.631745', '0.630738']
         : correct/total = [(9063, 14232), (8951, 14235), (8988, 14266), (8989, 14217), (9069, 14238), (9088, 14373), (9106, 14346), (9011, 14334), (6996, 14294), (9120, 14373), (9077, 14344), (9033, 14302), (9055, 14354), (9110, 14362), (9013, 14320), (9235, 14395), (9092, 14389), (8970, 14257), (9003, 14251), (9082, 14399)]
         : compromised: 0.6317, honest: 0.6239
Round 005: test acc mean=0.6396 ± 0.0045 | min=0.6289 max=0.6473
         : test loss mean=0.6323 ± 0.0033
         : individual accs = ['0.643901', '0.647278', '0.634726', '0.641275', '0.640258', '0.635219', '0.643036', '0.640366', '0.633063', '0.642037', '0.642150', '0.628933', '0.639891', '0.643991', '0.634078', '0.645780', '0.638543', '0.638493', '0.637289', '0.641781']
         : correct/total = [(9164, 14232), (9214, 14235), (9055, 14266), (9117, 14217), (9116, 14238), (9130, 14373), (9225, 14346), (9179, 14334), (9049, 14294), (9228, 14373), (9211, 14344), (8995, 14302), (9185, 14354), (9249, 14362), (9080, 14320), (9296, 14395), (9188, 14389), (9103, 14257), (9082, 14251), (9241, 14399)]
         : compromised: 0.6394, honest: 0.6397
Round 006: test acc mean=0.6446 ± 0.0050 | min=0.6348 max=0.6549
         : test loss mean=0.6279 ± 0.0032
         : individual accs = ['0.651490', '0.654865', '0.634796', '0.646902', '0.652620', '0.644055', '0.648195', '0.643017', '0.640059', '0.644403', '0.644660', '0.639771', '0.649645', '0.646428', '0.645042', '0.637305', '0.645007', '0.639195', '0.643393', '0.640878']
         : correct/total = [(9272, 14232), (9322, 14235), (9056, 14266), (9197, 14217), (9292, 14238), (9257, 14373), (9299, 14346), (9217, 14334), (9149, 14294), (9262, 14373), (9247, 14344), (9150, 14302), (9325, 14354), (9284, 14362), (9237, 14320), (9174, 14395), (9281, 14389), (9113, 14257), (9169, 14251), (9228, 14399)]
         : compromised: 0.6448, honest: 0.6445
Round 007: test acc mean=0.6504 ± 0.0058 | min=0.6378 max=0.6658
         : test loss mean=0.6225 ± 0.0039
         : individual accs = ['0.656759', '0.665824', '0.645591', '0.652318', '0.654937', '0.648995', '0.645825', '0.653481', '0.637750', '0.655535', '0.651422', '0.650468', '0.650063', '0.653600', '0.641620', '0.645710', '0.649107', '0.648383', '0.651323', '0.649142']
         : correct/total = [(9347, 14232), (9478, 14235), (9210, 14266), (9274, 14217), (9325, 14238), (9328, 14373), (9265, 14346), (9367, 14334), (9116, 14294), (9422, 14373), (9344, 14344), (9303, 14302), (9331, 14354), (9387, 14362), (9188, 14320), (9295, 14395), (9340, 14389), (9244, 14257), (9282, 14251), (9347, 14399)]
         : compromised: 0.6503, honest: 0.6504
Round 008: test acc mean=0.6554 ± 0.0033 | min=0.6498 max=0.6626
         : test loss mean=0.6177 ± 0.0027
         : individual accs = ['0.658867', '0.660063', '0.649797', '0.653021', '0.657185', '0.653030', '0.654608', '0.653272', '0.655870', '0.654769', '0.659091', '0.656691', '0.655218', '0.656455', '0.654120', '0.662591', '0.651053', '0.651960', '0.651323', '0.658726']
         : correct/total = [(9377, 14232), (9396, 14235), (9270, 14266), (9284, 14217), (9357, 14238), (9386, 14373), (9391, 14346), (9364, 14334), (9375, 14294), (9411, 14373), (9454, 14344), (9392, 14302), (9405, 14354), (9428, 14362), (9367, 14320), (9538, 14395), (9368, 14389), (9295, 14257), (9282, 14251), (9485, 14399)]
         : compromised: 0.6542, honest: 0.6557
Round 009: test acc mean=0.6596 ± 0.0058 | min=0.6409 max=0.6701
         : test loss mean=0.6134 ± 0.0043
         : individual accs = ['0.662029', '0.670109', '0.655194', '0.659211', '0.663225', '0.657622', '0.661927', '0.661574', '0.640898', '0.662283', '0.662716', '0.658090', '0.656681', '0.662651', '0.659218', '0.667107', '0.655292', '0.656870', '0.655252', '0.663935']
         : correct/total = [(9422, 14232), (9539, 14235), (9347, 14266), (9372, 14217), (9443, 14238), (9452, 14373), (9496, 14346), (9483, 14334), (9161, 14294), (9519, 14373), (9506, 14344), (9412, 14302), (9426, 14354), (9517, 14362), (9440, 14320), (9603, 14395), (9429, 14389), (9365, 14257), (9338, 14251), (9560, 14399)]
         : compromised: 0.6585, honest: 0.6599
Round 010: test acc mean=0.6638 ± 0.0044 | min=0.6571 max=0.6754
         : test loss mean=0.6088 ± 0.0034
         : individual accs = ['0.666456', '0.675448', '0.657858', '0.663572', '0.668071', '0.657483', '0.666248', '0.665062', '0.658318', '0.667432', '0.663204', '0.663753', '0.665598', '0.662791', '0.662291', '0.669121', '0.661408', '0.659746', '0.657147', '0.665602']
         : correct/total = [(9485, 14232), (9615, 14235), (9385, 14266), (9434, 14217), (9512, 14238), (9450, 14373), (9558, 14346), (9533, 14334), (9410, 14294), (9593, 14373), (9513, 14344), (9493, 14302), (9554, 14354), (9519, 14362), (9484, 14320), (9632, 14395), (9517, 14389), (9406, 14257), (9365, 14251), (9584, 14399)]
         : compromised: 0.6614, honest: 0.6644

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: krum
Attack: backdoor, 20.0% compromised
Final accuracy - Compromised: 0.6614, Honest: 0.6644
Overall test accuracy: mean=0.6638 ± 0.0044

=== BACKDOOR ATTACK SUCCESS RATE (ASR) ===
Target label: 1
Trigger size: 3x3
Overall ASR: 0.4412 ± 0.0405
Honest nodes ASR: 0.4315 ± 0.0395
Compromised nodes ASR: 0.4802 ± 0.0094
Note: Higher ASR indicates more successful backdoor attack
