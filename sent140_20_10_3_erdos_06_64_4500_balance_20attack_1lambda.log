Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 126
Degree statistics: avg=12.60, min=8, max=16
Attack: Compromised 4/20 nodes: [5, 12, 13, 17]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.4986 ± 0.0184 | min=0.4583 max=0.5269
         : test loss mean=0.7446 ± 0.0754
         : individual accs = ['0.471402', '0.473059', '0.486331', '0.511078', '0.494873', '0.484172', '0.496515', '0.515278', '0.511753', '0.497252', '0.519520', '0.489862', '0.526891', '0.522072', '0.489944', '0.524001', '0.490097', '0.458301', '0.507122', '0.501910']
         : correct/total = [(6709, 14232), (6734, 14235), (6938, 14266), (7266, 14217), (7046, 14238), (6959, 14373), (7123, 14346), (7386, 14334), (7315, 14294), (7147, 14373), (7452, 14344), (7006, 14302), (7563, 14354), (7498, 14362), (7016, 14320), (7543, 14395), (7052, 14389), (6534, 14257), (7227, 14251), (7227, 14399)]
         : compromised: 0.4979, honest: 0.4987
Round 002: test acc mean=0.5447 ± 0.0343 | min=0.4931 max=0.6162
         : test loss mean=0.6891 ± 0.0017
         : individual accs = ['0.616217', '0.551668', '0.500280', '0.493142', '0.521913', '0.560704', '0.500279', '0.546323', '0.521687', '0.536701', '0.541620', '0.609146', '0.531629', '0.508843', '0.569763', '0.571309', '0.544583', '0.512099', '0.568943', '0.587124']
         : correct/total = [(8770, 14232), (7853, 14235), (7137, 14266), (7011, 14217), (7431, 14238), (8059, 14373), (7177, 14346), (7831, 14334), (7457, 14294), (7714, 14373), (7769, 14344), (8712, 14302), (7631, 14354), (7308, 14362), (8159, 14320), (8224, 14395), (7836, 14389), (7301, 14257), (8108, 14251), (8454, 14399)]
         : compromised: 0.5283, honest: 0.5488
Round 003: test acc mean=0.5472 ± 0.0383 | min=0.4918 max=0.6221
         : test loss mean=0.6892 ± 0.0014
         : individual accs = ['0.522695', '0.558553', '0.545142', '0.491806', '0.622068', '0.512628', '0.529625', '0.526789', '0.572898', '0.511097', '0.579406', '0.619004', '0.606730', '0.520610', '0.564804', '0.560681', '0.508235', '0.521148', '0.570907', '0.499340']
         : correct/total = [(7439, 14232), (7951, 14235), (7777, 14266), (6992, 14217), (8857, 14238), (7368, 14373), (7598, 14346), (7551, 14334), (8189, 14294), (7346, 14373), (8311, 14344), (8853, 14302), (8709, 14354), (7477, 14362), (8088, 14320), (8071, 14395), (7313, 14389), (7430, 14257), (8136, 14251), (7190, 14399)]
         : compromised: 0.5403, honest: 0.5489
Round 004: test acc mean=0.5881 ± 0.0338 | min=0.5227 max=0.6317
         : test loss mean=0.6867 ± 0.0013
         : individual accs = ['0.589306', '0.629645', '0.601009', '0.582964', '0.622208', '0.583455', '0.608114', '0.522673', '0.631734', '0.604675', '0.577454', '0.532932', '0.536227', '0.536137', '0.599651', '0.619937', '0.592258', '0.554885', '0.609431', '0.627891']
         : correct/total = [(8387, 14232), (8963, 14235), (8574, 14266), (8288, 14217), (8859, 14238), (8386, 14373), (8724, 14346), (7492, 14334), (9030, 14294), (8691, 14373), (8283, 14344), (7622, 14302), (7697, 14354), (7700, 14362), (8587, 14320), (8924, 14395), (8522, 14389), (7911, 14257), (8685, 14251), (9041, 14399)]
         : compromised: 0.5527, honest: 0.5970
Round 005: test acc mean=0.6180 ± 0.0176 | min=0.5643 max=0.6423
         : test loss mean=0.6788 ± 0.0025
         : individual accs = ['0.630340', '0.630488', '0.602341', '0.614405', '0.622559', '0.597648', '0.632232', '0.610646', '0.629355', '0.610868', '0.624094', '0.628653', '0.624843', '0.564267', '0.622486', '0.624383', '0.637223', '0.618433', '0.592099', '0.642267']
         : correct/total = [(8971, 14232), (8975, 14235), (8593, 14266), (8735, 14217), (8864, 14238), (8590, 14373), (9070, 14346), (8753, 14334), (8996, 14294), (8780, 14373), (8952, 14344), (8991, 14302), (8969, 14354), (8104, 14362), (8914, 14320), (8988, 14395), (9169, 14389), (8817, 14257), (8438, 14251), (9248, 14399)]
         : compromised: 0.6013, honest: 0.6222
Round 006: test acc mean=0.6357 ± 0.0065 | min=0.6205 max=0.6466
         : test loss mean=0.6583 ± 0.0031
         : individual accs = ['0.637015', '0.641517', '0.627506', '0.632131', '0.637800', '0.643150', '0.638854', '0.632971', '0.643137', '0.638419', '0.627649', '0.629283', '0.646579', '0.629369', '0.644902', '0.638277', '0.636667', '0.620537', '0.632236', '0.636850']
         : correct/total = [(9066, 14232), (9132, 14235), (8952, 14266), (8987, 14217), (9081, 14238), (9244, 14373), (9165, 14346), (9073, 14334), (9193, 14294), (9176, 14373), (9003, 14344), (9000, 14302), (9281, 14354), (9039, 14362), (9235, 14320), (9188, 14395), (9161, 14389), (8847, 14257), (9010, 14251), (9170, 14399)]
         : compromised: 0.6349, honest: 0.6360
Round 007: test acc mean=0.6393 ± 0.0091 | min=0.6162 max=0.6518
         : test loss mean=0.6411 ± 0.0051
         : individual accs = ['0.644674', '0.648894', '0.641525', '0.639657', '0.644683', '0.651847', '0.642758', '0.616227', '0.647265', '0.643081', '0.633157', '0.629143', '0.647973', '0.625470', '0.649581', '0.625842', '0.643478', '0.637231', '0.635745', '0.637614']
         : correct/total = [(9175, 14232), (9237, 14235), (9152, 14266), (9094, 14217), (9179, 14238), (9369, 14373), (9221, 14346), (8833, 14334), (9252, 14294), (9243, 14373), (9082, 14344), (8998, 14302), (9301, 14354), (8983, 14362), (9302, 14320), (9009, 14395), (9259, 14389), (9085, 14257), (9060, 14251), (9181, 14399)]
         : compromised: 0.6406, honest: 0.6390
Round 008: test acc mean=0.6467 ± 0.0067 | min=0.6280 max=0.6576
         : test loss mean=0.6317 ± 0.0042
         : individual accs = ['0.646501', '0.642079', '0.627997', '0.651052', '0.648476', '0.657552', '0.651959', '0.639249', '0.652022', '0.649969', '0.643196', '0.656482', '0.646579', '0.649561', '0.640712', '0.648836', '0.651122', '0.642000', '0.638341', '0.649559']
         : correct/total = [(9201, 14232), (9140, 14235), (8959, 14266), (9256, 14217), (9233, 14238), (9451, 14373), (9353, 14346), (9163, 14334), (9320, 14294), (9342, 14373), (9226, 14344), (9389, 14302), (9281, 14354), (9329, 14362), (9175, 14320), (9340, 14395), (9369, 14389), (9153, 14257), (9097, 14251), (9353, 14399)]
         : compromised: 0.6489, honest: 0.6461
Round 009: test acc mean=0.6533 ± 0.0078 | min=0.6238 max=0.6600
         : test loss mean=0.6257 ± 0.0063
         : individual accs = ['0.623806', '0.659080', '0.653792', '0.655272', '0.656342', '0.657065', '0.649031', '0.660039', '0.657129', '0.654074', '0.643684', '0.654943', '0.654034', '0.655480', '0.657891', '0.649878', '0.657169', '0.651960', '0.655673', '0.659351']
         : correct/total = [(8878, 14232), (9382, 14235), (9327, 14266), (9316, 14217), (9345, 14238), (9444, 14373), (9311, 14346), (9461, 14334), (9393, 14294), (9401, 14373), (9233, 14344), (9367, 14302), (9388, 14354), (9414, 14362), (9421, 14320), (9355, 14395), (9456, 14389), (9295, 14257), (9344, 14251), (9494, 14399)]
         : compromised: 0.6546, honest: 0.6529
Round 010: test acc mean=0.6608 ± 0.0090 | min=0.6308 max=0.6716
         : test loss mean=0.6179 ± 0.0067
         : individual accs = ['0.658446', '0.664981', '0.630801', '0.662095', '0.663928', '0.665066', '0.666039', '0.671550', '0.668742', '0.656648', '0.653235', '0.667319', '0.669848', '0.661537', '0.667318', '0.649045', '0.664188', '0.658694', '0.652516', '0.663241']
         : correct/total = [(9371, 14232), (9466, 14235), (8999, 14266), (9413, 14217), (9453, 14238), (9559, 14373), (9555, 14346), (9626, 14334), (9559, 14294), (9438, 14373), (9370, 14344), (9544, 14302), (9615, 14354), (9501, 14362), (9556, 14320), (9343, 14395), (9557, 14389), (9391, 14257), (9299, 14251), (9550, 14399)]
         : compromised: 0.6638, honest: 0.6600

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: directed_deviation, 20.0% compromised
Final accuracy - Compromised: 0.6638, Honest: 0.6600
Overall test accuracy: mean=0.6608 ± 0.0090

=== BALANCE SUMMARY ===
Node 0: acceptance=0.831
Node 1: acceptance=0.836
Node 2: acceptance=0.850
Node 3: acceptance=0.887
Node 4: acceptance=0.836
Node 5: acceptance=0.820
Node 6: acceptance=0.743
Node 7: acceptance=0.807
Node 8: acceptance=0.730
Node 9: acceptance=0.931
Node 10: acceptance=0.700
Node 11: acceptance=0.807
Node 12: acceptance=0.925
Node 13: acceptance=0.931
Node 14: acceptance=0.760
Node 15: acceptance=0.836
Node 16: acceptance=0.792
Node 17: acceptance=0.900
Node 18: acceptance=0.831
Node 19: acceptance=0.775

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.064s (79.2%)
    - Aggregation: 0.017s (20.7%)
  TOTALS:
    - Total computation: 0.081s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.081s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.050s
  - Aggregation: 0.010s
  - Model transfer: 0.000s
  - Total per node: 0.060s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 1.003s
  - Total aggregation: 0.195s
  - Total model transfer: 0.000s
  - Grand total: 1.198s
  - Mean acceptance rate: 0.827

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
