Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: erdos, nodes: 20, edges: 99
Degree statistics: avg=9.90, min=7, max=14
Attack: Compromised 14/20 nodes: [1, 2, 3, 5, 6, 8, 11, 12, 13, 14, 15, 17, 18, 19]
Attack type: directed_deviation, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
BALANCE algorithm:
Balance Config: BALANCEConfig(gamma=2, kappa=1, alpha=0.5, min_neighbors=1)
  - Model dimension: 1,174,986 parameters
  - Complexity: O(N×d) = O(20×1,174,986)
Initial test acc across nodes: mean=0.4953 ± 0.0174
Round 001: test acc mean=0.5010 ± 0.0099 | min=0.4807 max=0.5226
         : test loss mean=3.0828 ± 1.3146
         : individual accs = ['0.497962', '0.480717', '0.488013', '0.522614', '0.506743', '0.513602', '0.500279', '0.509209', '0.503148', '0.501565', '0.495259', '0.510558', '0.509335', '0.496031', '0.501327', '0.491837', '0.511224', '0.498422', '0.494211', '0.487951']
         : correct/total = [(7087, 14232), (6843, 14235), (6962, 14266), (7430, 14217), (7215, 14238), (7382, 14373), (7177, 14346), (7299, 14334), (7192, 14294), (7209, 14373), (7104, 14344), (7302, 14302), (7311, 14354), (7124, 14362), (7179, 14320), (7080, 14395), (7356, 14389), (7106, 14257), (7043, 14251), (7026, 14399)]
         : compromised: 0.4999, honest: 0.5037
Round 002: test acc mean=0.4989 ± 0.0118 | min=0.4698 max=0.5148
         : test loss mean=1.2213 ± 1.5871
         : individual accs = ['0.493536', '0.503618', '0.500350', '0.470141', '0.486796', '0.507271', '0.509898', '0.492954', '0.502519', '0.469770', '0.508993', '0.506922', '0.506897', '0.498886', '0.507193', '0.502605', '0.514768', '0.502911', '0.490071', '0.501146']
         : correct/total = [(7024, 14232), (7169, 14235), (7138, 14266), (6684, 14217), (6931, 14238), (7291, 14373), (7315, 14346), (7066, 14334), (7183, 14294), (6752, 14373), (7301, 14344), (7250, 14302), (7276, 14354), (7165, 14362), (7263, 14320), (7235, 14395), (7407, 14389), (7170, 14257), (6984, 14251), (7216, 14399)]
         : compromised: 0.5007, honest: 0.4945
Round 003: test acc mean=0.5126 ± 0.0134 | min=0.4929 max=0.5438
         : test loss mean=0.7041 ± 0.0158
         : individual accs = ['0.543845', '0.499543', '0.517594', '0.505522', '0.537786', '0.534405', '0.508086', '0.492884', '0.515601', '0.519933', '0.507041', '0.512586', '0.515745', '0.518521', '0.508240', '0.508510', '0.500382', '0.495756', '0.512946', '0.496910']
         : correct/total = [(7740, 14232), (7111, 14235), (7384, 14266), (7187, 14217), (7657, 14238), (7681, 14373), (7289, 14346), (7065, 14334), (7370, 14294), (7473, 14373), (7273, 14344), (7331, 14302), (7403, 14354), (7447, 14362), (7278, 14320), (7320, 14395), (7200, 14389), (7068, 14257), (7310, 14251), (7155, 14399)]
         : compromised: 0.5107, honest: 0.5170
Round 004: test acc mean=0.5426 ± 0.0241 | min=0.5005 max=0.5856
         : test loss mean=0.6879 ± 0.0075
         : individual accs = ['0.585582', '0.534106', '0.543180', '0.507069', '0.581191', '0.536979', '0.571658', '0.500488', '0.518050', '0.566618', '0.539598', '0.507132', '0.561098', '0.544701', '0.538757', '0.528934', '0.562791', '0.533843', '0.565294', '0.524689']
         : correct/total = [(8334, 14232), (7603, 14235), (7749, 14266), (7209, 14217), (8275, 14238), (7718, 14373), (8201, 14346), (7174, 14334), (7405, 14294), (8144, 14373), (7740, 14344), (7253, 14302), (8054, 14354), (7823, 14362), (7715, 14320), (7614, 14395), (8098, 14389), (7611, 14257), (8056, 14251), (7555, 14399)]
         : compromised: 0.5368, honest: 0.5560
Round 005: test acc mean=0.5879 ± 0.0135 | min=0.5590 max=0.6125
         : test loss mean=0.6712 ± 0.0060
         : individual accs = ['0.581577', '0.607306', '0.596103', '0.558979', '0.602472', '0.585612', '0.571797', '0.574438', '0.575976', '0.600779', '0.571110', '0.578381', '0.599902', '0.583693', '0.593785', '0.592081', '0.612482', '0.586098', '0.585573', '0.599764']
         : correct/total = [(8277, 14232), (8645, 14235), (8504, 14266), (7947, 14217), (8578, 14238), (8417, 14373), (8203, 14346), (8234, 14334), (8233, 14294), (8635, 14373), (8192, 14344), (8272, 14302), (8611, 14354), (8383, 14362), (8503, 14320), (8523, 14395), (8813, 14389), (8356, 14257), (8345, 14251), (8636, 14399)]
         : compromised: 0.5868, honest: 0.5905
Round 006: test acc mean=0.6161 ± 0.0070 | min=0.5991 max=0.6304
         : test loss mean=0.6532 ± 0.0053
         : individual accs = ['0.624016', '0.626695', '0.615029', '0.599072', '0.617502', '0.618382', '0.607696', '0.609390', '0.630404', '0.619286', '0.606804', '0.613760', '0.618434', '0.614608', '0.616061', '0.614936', '0.614358', '0.613944', '0.616869', '0.623793']
         : correct/total = [(8881, 14232), (8921, 14235), (8774, 14266), (8517, 14217), (8792, 14238), (8888, 14373), (8718, 14346), (8735, 14334), (9011, 14294), (8901, 14373), (8704, 14344), (8778, 14302), (8877, 14354), (8827, 14362), (8822, 14320), (8852, 14395), (8840, 14389), (8753, 14257), (8791, 14251), (8982, 14399)]
         : compromised: 0.6164, honest: 0.6152
Round 007: test acc mean=0.6333 ± 0.0056 | min=0.6215 max=0.6433
         : test loss mean=0.6387 ± 0.0039
         : individual accs = ['0.632589', '0.641377', '0.625473', '0.632623', '0.633586', '0.641133', '0.630838', '0.638621', '0.634322', '0.635497', '0.621514', '0.631800', '0.636896', '0.634522', '0.631774', '0.628968', '0.643269', '0.632602', '0.622904', '0.634905']
         : correct/total = [(9003, 14232), (9130, 14235), (8923, 14266), (8994, 14217), (9021, 14238), (9215, 14373), (9050, 14346), (9154, 14334), (9067, 14294), (9134, 14373), (8915, 14344), (9036, 14302), (9142, 14354), (9113, 14362), (9047, 14320), (9054, 14395), (9256, 14389), (9019, 14257), (8877, 14251), (9142, 14399)]
         : compromised: 0.6329, honest: 0.6342
Round 008: test acc mean=0.6445 ± 0.0065 | min=0.6289 max=0.6543
         : test loss mean=0.6300 ± 0.0045
         : individual accs = ['0.647695', '0.647770', '0.637179', '0.645776', '0.640539', '0.652752', '0.640945', '0.649714', '0.654330', '0.649343', '0.638455', '0.632849', '0.648948', '0.644270', '0.647346', '0.639041', '0.650636', '0.644315', '0.628868', '0.648448']
         : correct/total = [(9218, 14232), (9221, 14235), (9090, 14266), (9181, 14217), (9120, 14238), (9382, 14373), (9195, 14346), (9313, 14334), (9353, 14294), (9333, 14373), (9158, 14344), (9051, 14302), (9315, 14354), (9253, 14362), (9270, 14320), (9199, 14395), (9362, 14389), (9186, 14257), (8962, 14251), (9337, 14399)]
         : compromised: 0.6438, honest: 0.6461
Round 009: test acc mean=0.6476 ± 0.0072 | min=0.6261 max=0.6594
         : test loss mean=0.6242 ± 0.0060
         : individual accs = ['0.645306', '0.656621', '0.639492', '0.653373', '0.642998', '0.659431', '0.626098', '0.651319', '0.638939', '0.644751', '0.648215', '0.643267', '0.651595', '0.648656', '0.651816', '0.651198', '0.653416', '0.652451', '0.648305', '0.645531']
         : correct/total = [(9184, 14232), (9347, 14235), (9123, 14266), (9289, 14217), (9155, 14238), (9478, 14373), (8982, 14346), (9336, 14334), (9133, 14294), (9267, 14373), (9298, 14344), (9200, 14302), (9353, 14354), (9316, 14362), (9334, 14320), (9374, 14395), (9402, 14389), (9302, 14257), (9239, 14251), (9295, 14399)]
         : compromised: 0.6476, honest: 0.6477
Round 010: test acc mean=0.6582 ± 0.0056 | min=0.6443 max=0.6683
         : test loss mean=0.6132 ± 0.0038
         : individual accs = ['0.658165', '0.668282', '0.644329', '0.656397', '0.656623', '0.666667', '0.654817', '0.663737', '0.657619', '0.656370', '0.655675', '0.651447', '0.661627', '0.658126', '0.666131', '0.655922', '0.663493', '0.660167', '0.651393', '0.656990']
         : correct/total = [(9367, 14232), (9513, 14235), (9192, 14266), (9332, 14217), (9349, 14238), (9582, 14373), (9394, 14346), (9514, 14334), (9400, 14294), (9434, 14373), (9405, 14344), (9317, 14302), (9497, 14354), (9452, 14362), (9539, 14320), (9442, 14395), (9547, 14389), (9412, 14257), (9283, 14251), (9460, 14399)]
         : compromised: 0.6579, honest: 0.6590

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: erdos, Aggregation: balance
Attack: directed_deviation, 70.0% compromised
Final accuracy - Compromised: 0.6579, Honest: 0.6590
Overall test accuracy: mean=0.6582 ± 0.0056

=== BALANCE SUMMARY ===
Node 0: acceptance=0.400
Node 1: acceptance=0.460
Node 2: acceptance=0.438
Node 3: acceptance=0.486
Node 4: acceptance=0.400
Node 5: acceptance=0.280
Node 6: acceptance=0.325
Node 7: acceptance=0.345
Node 8: acceptance=0.314
Node 9: acceptance=0.427
Node 10: acceptance=0.325
Node 11: acceptance=0.325
Node 12: acceptance=0.400
Node 13: acceptance=0.289
Node 14: acceptance=0.357
Node 15: acceptance=0.400
Node 16: acceptance=0.357
Node 17: acceptance=0.550
Node 18: acceptance=0.325
Node 19: acceptance=0.280

=== PARALLEL EXECUTION TIME (realistic for distributed system) ===
  COMMUNICATION (max across nodes):
    - Full model transfer: 0.000s (0.0%)
  COMPUTATION (max across nodes):
    - Filtering: 0.056s (81.7%)
    - Aggregation: 0.013s (18.3%)
  TOTALS:
    - Total computation: 0.069s (100.0%)
    - Total communication: 0.000s (0.0%)
    - Total parallel time: 0.069s

=== PER-NODE AVERAGE TIME ===
  - Filtering: 0.041s
  - Aggregation: 0.006s
  - Model transfer: 0.000s
  - Total per node: 0.047s

=== TOTAL COMPUTATIONAL WORK (sum across all nodes) ===
  - Total filtering: 0.816s
  - Total aggregation: 0.125s
  - Total model transfer: 0.000s
  - Grand total: 0.941s
  - Mean acceptance rate: 0.374

BALANCE Algorithm Properties:
  - Model dimension: 1,174,986
  - No compression: Full parameter comparison
  - Theoretical complexity: O(deg(i)×d)
  - Approach: Full parameter filtering + averaging
