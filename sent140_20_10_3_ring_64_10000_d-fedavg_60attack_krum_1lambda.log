Device: cuda
Seed: 987654321
Loading 1 LEAF Sent140 train files...
LEAF Sent140 train: 254555 users, 908652 samples
Building vocabulary (max_size=10000)...
Vocabulary size: 10000
Loading 1 LEAF Sent140 test files...
LEAF Sent140 test: 254555 users, 286281 samples
Found 254555 train users, 254555 test users, 254555 common users
User sample counts range: 494 (max) to 1 (min)
Distributed ALL 254555 users across 20 clients
Users per client: 12727 (with 15 clients getting +1 user)
Train partition sizes: [44353, 44290, 44657, 44907, 44696, 45843, 45801, 45619, 45069, 45639, 45821, 45311, 45779, 46056, 45625, 45984, 46428, 44737, 45540, 46497]
Test partition sizes: [14232, 14235, 14266, 14217, 14238, 14373, 14346, 14334, 14294, 14373, 14344, 14302, 14354, 14362, 14320, 14395, 14389, 14257, 14251, 14399]
  Client 0: 44353 train samples, 2 unique classes
  Client 1: 44290 train samples, 2 unique classes
  Client 2: 44657 train samples, 2 unique classes
  Client 3: 44907 train samples, 2 unique classes
  Client 4: 44696 train samples, 2 unique classes
  Client 5: 45843 train samples, 2 unique classes
  Client 6: 45801 train samples, 2 unique classes
  Client 7: 45619 train samples, 2 unique classes
  Client 8: 45069 train samples, 2 unique classes
  Client 9: 45639 train samples, 2 unique classes
  Client 10: 45821 train samples, 2 unique classes
  Client 11: 45311 train samples, 2 unique classes
  Client 12: 45779 train samples, 2 unique classes
  Client 13: 46056 train samples, 2 unique classes
  Client 14: 45625 train samples, 2 unique classes
  Client 15: 45984 train samples, 2 unique classes
  Client 16: 46428 train samples, 2 unique classes
  Client 17: 44737 train samples, 2 unique classes
  Client 18: 45540 train samples, 2 unique classes
  Client 19: 46497 train samples, 2 unique classes
Will sample 4500 samples per client per epoch
Graph: ring, nodes: 20, edges: 20
Degree statistics: avg=2.00, min=2, max=2
Attack: Compromised 12/20 nodes: [1, 2, 3, 5, 8, 11, 12, 13, 14, 15, 17, 18]
Attack type: krum, lambda: 1.0
Model variant: baseline
Model parameters: 1,174,986
Initial test acc across nodes: mean=0.4965 ± 0.0152
Round 001: test acc mean=0.4992 ± 0.0059 | min=0.4843 max=0.5096
         : test loss mean=9.6854 ± 5.8883
         : individual accs = ['0.492411', '0.509589', '0.496916', '0.484279', '0.498314', '0.500104', '0.497491', '0.493931', '0.508745', '0.507410', '0.501813', '0.498811', '0.500348', '0.505013', '0.500000', '0.494616', '0.501008', '0.501718', '0.499053', '0.492673']
         : correct/total = [(7008, 14232), (7254, 14235), (7089, 14266), (6885, 14217), (7095, 14238), (7188, 14373), (7137, 14346), (7080, 14334), (7272, 14294), (7293, 14373), (7198, 14344), (7134, 14302), (7182, 14354), (7253, 14362), (7160, 14320), (7120, 14395), (7209, 14389), (7153, 14257), (7112, 14251), (7094, 14399)]
         : compromised: 0.4999, honest: 0.4981
Round 002: test acc mean=0.4953 ± 0.0071 | min=0.4801 max=0.5101
         : test loss mean=10.7299 ± 6.7392
         : individual accs = ['0.497611', '0.499473', '0.491518', '0.500317', '0.510114', '0.499339', '0.494284', '0.500558', '0.488457', '0.496973', '0.504253', '0.498672', '0.480145', '0.482871', '0.497835', '0.495380', '0.489054', '0.494915', '0.485861', '0.499340']
         : correct/total = [(7082, 14232), (7110, 14235), (7012, 14266), (7113, 14217), (7263, 14238), (7177, 14373), (7091, 14346), (7175, 14334), (6982, 14294), (7143, 14373), (7233, 14344), (7132, 14302), (6892, 14354), (6935, 14362), (7129, 14320), (7131, 14395), (7037, 14389), (7056, 14257), (6924, 14251), (7190, 14399)]
         : compromised: 0.4929, honest: 0.4990
Round 003: test acc mean=0.5020 ± 0.0079 | min=0.4844 max=0.5183
         : test loss mean=3.9325 ± 2.7058
         : individual accs = ['0.500281', '0.517457', '0.509253', '0.501794', '0.496488', '0.497878', '0.498118', '0.509139', '0.501819', '0.505462', '0.500976', '0.484408', '0.499930', '0.489068', '0.501955', '0.504550', '0.503093', '0.504805', '0.518350', '0.494826']
         : correct/total = [(7120, 14232), (7366, 14235), (7265, 14266), (7134, 14217), (7069, 14238), (7156, 14373), (7146, 14346), (7298, 14334), (7173, 14294), (7265, 14373), (7186, 14344), (6928, 14302), (7176, 14354), (7024, 14362), (7188, 14320), (7263, 14395), (7239, 14389), (7197, 14257), (7387, 14251), (7125, 14399)]
         : compromised: 0.5026, honest: 0.5010
Round 004: test acc mean=0.4971 ± 0.0081 | min=0.4836 max=0.5124
         : test loss mean=5.3350 ± 3.8915
         : individual accs = ['0.502530', '0.483597', '0.485770', '0.496378', '0.491572', '0.495304', '0.498257', '0.487094', '0.487407', '0.494747', '0.497490', '0.491400', '0.496377', '0.502576', '0.500838', '0.509344', '0.512405', '0.509574', '0.492878', '0.507327']
         : correct/total = [(7152, 14232), (6884, 14235), (6930, 14266), (7057, 14217), (6999, 14238), (7119, 14373), (7148, 14346), (6982, 14334), (6967, 14294), (7111, 14373), (7136, 14344), (7028, 14302), (7125, 14354), (7218, 14362), (7172, 14320), (7332, 14395), (7373, 14389), (7265, 14257), (7024, 14251), (7305, 14399)]
         : compromised: 0.4960, honest: 0.4989
Round 005: test acc mean=0.5054 ± 0.0064 | min=0.4947 max=0.5205
         : test loss mean=2.6382 ± 1.7634
         : individual accs = ['0.518409', '0.501089', '0.506449', '0.499261', '0.494662', '0.503305', '0.503416', '0.506837', '0.504827', '0.512350', '0.513664', '0.507831', '0.505295', '0.501532', '0.505028', '0.504759', '0.500035', '0.499264', '0.499263', '0.520453']
         : correct/total = [(7378, 14232), (7133, 14235), (7225, 14266), (7098, 14217), (7043, 14238), (7234, 14373), (7222, 14346), (7265, 14334), (7216, 14294), (7364, 14373), (7368, 14344), (7263, 14302), (7253, 14354), (7203, 14362), (7232, 14320), (7266, 14395), (7195, 14389), (7118, 14257), (7115, 14251), (7494, 14399)]
         : compromised: 0.5032, honest: 0.5087
Round 006: test acc mean=0.4996 ± 0.0076 | min=0.4853 max=0.5097
         : test loss mean=4.5953 ± 3.9994
         : individual accs = ['0.508221', '0.486266', '0.487102', '0.498206', '0.497963', '0.494886', '0.504461', '0.499093', '0.496642', '0.508871', '0.506065', '0.492309', '0.498607', '0.508495', '0.495670', '0.506773', '0.501077', '0.505716', '0.485299', '0.509688']
         : correct/total = [(7233, 14232), (6922, 14235), (6949, 14266), (7083, 14217), (7090, 14238), (7113, 14373), (7237, 14346), (7154, 14334), (7099, 14294), (7314, 14373), (7259, 14344), (7041, 14302), (7157, 14354), (7303, 14362), (7098, 14320), (7295, 14395), (7210, 14389), (7210, 14257), (6916, 14251), (7339, 14399)]
         : compromised: 0.4963, honest: 0.5044
Round 007: test acc mean=0.5055 ± 0.0126 | min=0.4910 max=0.5308
         : test loss mean=2.8171 ± 2.5193
         : individual accs = ['0.527754', '0.502915', '0.502243', '0.496026', '0.503512', '0.495721', '0.509341', '0.511581', '0.505597', '0.530369', '0.530814', '0.505244', '0.497840', '0.491157', '0.501117', '0.491004', '0.493224', '0.495686', '0.494983', '0.523092']
         : correct/total = [(7511, 14232), (7159, 14235), (7165, 14266), (7052, 14217), (7169, 14238), (7125, 14373), (7307, 14346), (7333, 14334), (7227, 14294), (7623, 14373), (7614, 14344), (7226, 14302), (7146, 14354), (7054, 14362), (7176, 14320), (7068, 14395), (7097, 14389), (7067, 14257), (7054, 14251), (7532, 14399)]
         : compromised: 0.4983, honest: 0.5162
Round 008: test acc mean=0.5000 ± 0.0097 | min=0.4804 max=0.5162
         : test loss mean=3.5923 ± 3.1315
         : individual accs = ['0.508642', '0.480365', '0.481494', '0.506225', '0.500421', '0.494121', '0.508016', '0.502163', '0.496852', '0.516246', '0.512200', '0.493497', '0.494148', '0.499513', '0.495112', '0.506009', '0.506776', '0.507330', '0.484457', '0.505799']
         : correct/total = [(7239, 14232), (6838, 14235), (6869, 14266), (7197, 14217), (7125, 14238), (7102, 14373), (7288, 14346), (7198, 14334), (7102, 14294), (7420, 14373), (7347, 14344), (7058, 14302), (7093, 14354), (7174, 14362), (7090, 14320), (7284, 14395), (7292, 14389), (7233, 14257), (6904, 14251), (7283, 14399)]
         : compromised: 0.4949, honest: 0.5075
Round 009: test acc mean=0.5097 ± 0.0119 | min=0.4943 max=0.5367
         : test loss mean=2.3846 ± 1.8840
         : individual accs = ['0.527684', '0.500667', '0.513459', '0.503411', '0.494311', '0.496069', '0.515544', '0.515906', '0.509305', '0.536701', '0.532906', '0.506852', '0.508290', '0.507102', '0.505028', '0.498367', '0.504413', '0.496809', '0.498983', '0.521842']
         : correct/total = [(7510, 14232), (7127, 14235), (7325, 14266), (7157, 14217), (7038, 14238), (7130, 14373), (7396, 14346), (7395, 14334), (7280, 14294), (7714, 14373), (7644, 14344), (7249, 14302), (7296, 14354), (7283, 14362), (7232, 14320), (7174, 14395), (7258, 14389), (7083, 14257), (7111, 14251), (7514, 14399)]
         : compromised: 0.5037, honest: 0.5187
Round 010: test acc mean=0.5012 ± 0.0101 | min=0.4824 max=0.5160
         : test loss mean=3.6702 ± 3.7578
         : individual accs = ['0.515107', '0.482403', '0.486121', '0.503060', '0.496348', '0.492312', '0.515963', '0.510813', '0.493004', '0.509288', '0.513385', '0.493497', '0.499512', '0.504526', '0.495112', '0.500660', '0.509486', '0.506909', '0.484808', '0.510799']
         : correct/total = [(7331, 14232), (6867, 14235), (6935, 14266), (7152, 14217), (7067, 14238), (7076, 14373), (7402, 14346), (7322, 14334), (7047, 14294), (7320, 14373), (7364, 14344), (7058, 14302), (7170, 14354), (7246, 14362), (7090, 14320), (7207, 14395), (7331, 14389), (7227, 14257), (6909, 14251), (7355, 14399)]
         : compromised: 0.4952, honest: 0.5101

=== FINAL RESULTS ===
Dataset: sent140, Nodes: 20, Graph: ring, Aggregation: d-fedavg
Attack: krum, 60.0% compromised
Final accuracy - Compromised: 0.4952, Honest: 0.5101
Overall test accuracy: mean=0.5012 ± 0.0101
